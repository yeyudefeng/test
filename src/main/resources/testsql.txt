delete from test.S1_AC_ACTUAL_PAYDETAIL  where SERIALNO = '20688947002';
delete from aaa where id in (select user_id from table2);
delete a from a,(select id from XXXX where XXX) b where a.id = b.id;
insert overwrite table db_dw_nstc.clife_nstc_dwd_order_detail_comment_info partition(part_date)
select
     a.comment_id                     -- '评论表id'
    ,a.product_id                     -- '产品id'
    ,a.goods_id                       -- '商品id'
    ,a.member_id                      -- '评论人'
    ,a.star                           -- '评价星级 1-5,默认5星'
    ,a.content                        -- '评价内容'
    ,a.comment_img                    -- '评论图片'
    ,c.receiver_province              -- '省份'
    ,c.receiver_city                  -- '城市'
    ,c.receiver_area                  -- '区县'
    ,c.receiver_town                  -- '街道'
    ,c.receiver_address               -- '地址'
    ,a.create_at                      -- '创建时间'
    ,a.part_date                      -- '分区日期'
from (
    select
         comment_id                   -- '评论表id'
        ,detail_id                    -- '订单详情表id'
        ,product_id                   -- '产品id'
        ,goods_id                     -- '商品id'
        ,member_id                    -- '评论人'
        ,star                         -- '评价星级 1-5,默认5星'
        ,content                      -- '评价内容'
        ,comment_img                  -- '评论图片'
        ,create_at                    -- '创建时间'
        ,part_date                    -- '分区日期'
    from db_ods_nstc.clife_nstc_ods_order_coment
    where part_date = regexp_replace(date_sub(current_date(),1),'-','') and del_flag = 0 and disply = 0
) a
left join db_ods_nstc.clife_nstc_ods_order_detail b
on a.part_date = b.part_date and a.detail_id = b.detail_id and b.del_flag = 0
left join db_ods_nstc.clife_nstc_ods_order_shipping c
on b.part_date = c.part_date and b.order_id = c.order_id and c.del_flag = 0;

UPDATE
    (
      SELECT/*+ bypass_ujvc*/
             t.exe_company,
             k.company_cd
        FROM nw_flight_base t,
             (
               SELECT a.rowid AS rid, b.company_cd
                 FROM nw_flight_base a,
                      (SELECT t.*,
                              nvl(lead(apply_dt)
                                  over(PARTITION BY ac_no ORDER BY apply_dt) - 1,
                                  to_date('2999-12-31', 'yyyy-mm-dd')) next_apply_dt
                         FROM sa_aircraft t) b
                WHERE a.ac_no = b.ac_no
                  AND a.flight_dt BETWEEN b.apply_dt AND b.next_apply_dt
                  AND a.flight_dt BETWEEN p_flight_dt_from AND p_flight_dt_to
              ) k
      WHERE t.rowid = k.rid
    ) SET exe_company = company_cd;
update mf_bus_pact p,(
select pact_no,pact_amt,sum(putout_amt) as putout_amt from mf_bus_finc_app
group by pact_no
) b
set p.usable_finc_amt = b.pact_amt - b.putout_amt
where p.pact_no = b.pact_no;
alter table a.order_info rename to a.order_info_1;
alter table a.order_info change column money money_1 double;
alter table a.order_info add column(age int);
alter table a.order_info set serdeproperties ('serialization.encoding'='GBK');
{"code":0,"msg":"成功","data":{"totalList":[{"id":861,"name":"db_nstc_task_workflow","version":0,"releaseState":"ONLINE","projectId":34,"processDefinitionJson":"{\"globalParams\":[],\"tasks\":[{\"type\":\"SUB_PROCESS\",\"id\":\"tasks-79238\",\"name\":\"db_ods_nstc\",\"params\":{\"processDefinitionId\":855},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[]},{\"type\":\"SUB_PROCESS\",\"id\":\"tasks-15711\",\"name\":\"db_dim_nstc\",\"params\":{\"processDefinitionId\":856},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"db_ods_nstc\"]},{\"type\":\"SUB_PROCESS\",\"id\":\"tasks-16265\",\"name\":\"db_dwd_nstc\",\"params\":{\"processDefinitionId\":857},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"db_dim_nstc\"]},{\"type\":\"SUB_PROCESS\",\"id\":\"tasks-52325\",\"name\":\"db_dws_nstc\",\"params\":{\"processDefinitionId\":858},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"db_dwd_nstc\"]},{\"type\":\"SUB_PROCESS\",\"id\":\"tasks-43010\",\"name\":\"db_ads_nstc\",\"params\":{\"processDefinitionId\":862},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"db_dws_nstc\"]}],\"tenantId\":-1,\"timeout\":0}","description":"苗木项目","globalParams":"[]","globalParamList":[],"globalParamMap":{},"createTime":"2021-11-10T05:47:34.000+0000","updateTime":"2021-11-11T03:44:01.000+0000","flag":"YES","userId":160,"userName":"data_warehouse","projectName":null,"locations":"{\"tasks-79238\":{\"name\":\"db_ods_nstc\",\"targetarr\":\"\",\"nodenumber\":\"1\",\"x\":183,\"y\":258},\"tasks-15711\":{\"name\":\"db_dim_nstc\",\"targetarr\":\"tasks-79238\",\"nodenumber\":\"1\",\"x\":436,\"y\":261},\"tasks-16265\":{\"name\":\"db_dwd_nstc\",\"targetarr\":\"tasks-15711\",\"nodenumber\":\"1\",\"x\":659,\"y\":261},\"tasks-52325\":{\"name\":\"db_dws_nstc\",\"targetarr\":\"tasks-16265\",\"nodenumber\":\"1\",\"x\":877,\"y\":258},\"tasks-43010\":{\"name\":\"db_ads_nstc\",\"targetarr\":\"tasks-52325\",\"nodenumber\":\"0\",\"x\":1073,\"y\":270}}","connects":"[{\"endPointSourceId\":\"tasks-79238\",\"endPointTargetId\":\"tasks-15711\"},{\"endPointSourceId\":\"tasks-15711\",\"endPointTargetId\":\"tasks-16265\"},{\"endPointSourceId\":\"tasks-16265\",\"endPointTargetId\":\"tasks-52325\"},{\"endPointSourceId\":\"tasks-52325\",\"endPointTargetId\":\"tasks-43010\"}]","receivers":"","receiversCc":"","leadMobile":"","ddAlarmId":0,"scheduleReleaseState":"ONLINE","timeout":0,"tenantId":-1,"taskType":"SHELL"},{"id":852,"name":"db_device","version":0,"releaseState":"ONLINE","projectId":34,"processDefinitionJson":"{\"globalParams\":[],\"tasks\":[{\"type\":\"SUB_PROCESS\",\"id\":\"tasks-67080\",\"name\":\"db_device_ods\",\"params\":{\"processDefinitionId\":818},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":36,\"preTasks\":[]},{\"type\":\"SUB_PROCESS\",\"id\":\"tasks-72287\",\"name\":\"db_device_dwd\",\"params\":{\"processDefinitionId\":848},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"db_device_dim\"]},{\"type\":\"SUB_PROCESS\",\"id\":\"tasks-73613\",\"name\":\"db_device_dws\",\"params\":{\"processDefinitionId\":850},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"db_device_dwd\"]},{\"type\":\"SUB_PROCESS\",\"id\":\"tasks-30796\",\"name\":\"db_device_dim\",\"params\":{\"processDefinitionId\":819},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"db_device_ods\"]}],\"tenantId\":-1,\"timeout\":0}","description":"","globalParams":null,"globalParamList":null,"globalParamMap":null,"createTime":"2021-11-04T02:17:06.000+0000","updateTime":"2021-11-04T02:17:06.000+0000","flag":"YES","userId":160,"userName":"data_warehouse","projectName":null,"locations":"{\"tasks-67080\":{\"name\":\"db_device_ods\",\"targetarr\":\"\",\"nodenumber\":\"1\",\"x\":366,\"y\":220},\"tasks-72287\":{\"name\":\"db_device_dwd\",\"targetarr\":\"tasks-30796\",\"nodenumber\":\"1\",\"x\":741,\"y\":221},\"tasks-73613\":{\"name\":\"db_device_dws\",\"targetarr\":\"tasks-72287\",\"nodenumber\":\"0\",\"x\":940,\"y\":222},\"tasks-30796\":{\"name\":\"db_device_dim\",\"targetarr\":\"tasks-67080\",\"nodenumber\":\"1\",\"x\":558,\"y\":220}}","connects":"[{\"endPointSourceId\":\"tasks-67080\",\"endPointTargetId\":\"tasks-30796\"},{\"endPointSourceId\":\"tasks-30796\",\"endPointTargetId\":\"tasks-72287\"},{\"endPointSourceId\":\"tasks-72287\",\"endPointTargetId\":\"tasks-73613\"}]","receivers":"","receiversCc":"","leadMobile":"","ddAlarmId":0,"scheduleReleaseState":"ONLINE","timeout":0,"tenantId":-1,"taskType":"SHELL"},{"id":858,"name":"db_dws_nstc","version":0,"releaseState":"ONLINE","projectId":34,"processDefinitionJson":"{\"globalParams\":[],\"tasks\":[{\"type\":\"SQL\",\"id\":\"tasks-46156\",\"name\":\"clife_nstc_dws_deal_message_info\",\"params\":{\"type\":\"HIVE\",\"datasource\":161,\"sql\":\"insert overwrite table db_dw_nstc.clife_nstc_dws_deal_message_info partition(part_date)\\nselect \\n     member_id                                                                                     -- '会员id'  \\n    ,goods_class                                                                                   -- '种类'\\n    ,start_place                                                                                   -- '开始地'\\n    ,end_place                                                                                     -- '目的地'\\n    ,substr(if(update_at is null, create_at, update_at),0,10)            as release_day   -- '发布时间'\\n    ,max(member_name)                                                    as member_name            -- '昵称'\\n    ,sum(case when action_type=0 then 1 else 0 end                 )     as purchase_cnt           -- '采购信息数量'\\n    ,sum(case when action_type=1 then 1 else 0 end                 )     as suppery_cnt            -- '供应信息数量'\\n    ,sum(case when action_type=2 then 1 else 0 end                 )     as rent_cnt               -- '车找苗信息数量'\\n    ,sum(case when action_type=3 then 1 else 0 end                 )     as lease_cnt              -- '苗找车信息数量'\\n    ,sum(case when action_type=0 and status = '0' then 1 else 0 end)     as purchase_release_cnt   -- '采购信息发布中数量'\\n    ,sum(case when action_type=1 and status = '0' then 1 else 0 end)     as suppery_release_cnt    -- '供应信息发布中数量'\\n    ,sum(case when action_type=2 and status = '0' then 1 else 0 end)     as rent_release_cnt       -- '车找苗信息发布中数量'\\n    ,sum(case when action_type=3 and status = '0' then 1 else 0 end)     as lease_release_cnt      -- '苗找车信息发布中数量'\\n    ,sum(case when action_type=0 and status = '1' then 1 else 0 end)     as purchase_finish_cnt    -- '采购信息已结束数量'\\n    ,sum(case when action_type=1 and status = '1' then 1 else 0 end)     as suppery_finish_cnt     -- '供应信息已结束数量'\\n    ,sum(case when action_type=2 and status = '1' then 1 else 0 end)     as rent_finish_cnt        -- '车找苗信息已结束数量'\\n    ,sum(case when action_type=3 and status = '1' then 1 else 0 end)     as lease_finish_cnt       -- '苗找车信息已结束数量'\\n    ,sum(case when action_type=0 and status = '2' then 1 else 0 end)     as purchase_return_cnt    -- '采购信息被驳回数量'\\n    ,sum(case when action_type=1 and status = '2' then 1 else 0 end)     as suppery_return_cnt     -- '供应信息被驳回数量'\\n    ,sum(case when action_type=2 and status = '2' then 1 else 0 end)     as rent_return_cnt        -- '车找苗信息被驳回数量'\\n    ,sum(case when action_type=3 and status = '2' then 1 else 0 end)     as lease_return_cnt       -- '苗找车信息被驳回数量'\\n    ,sum(case when action_type=0 then scannum else 0 end)                as purchase_scan_num      -- '采购信息浏览量'\\n    ,sum(case when action_type=1 then scannum else 0 end)                as suppery_scan_num       -- '供应信息浏览量'\\n    ,sum(case when action_type=2 then scannum else 0 end)                as rent_scan_num          -- '车找苗信息浏览量'\\n    ,sum(case when action_type=3 then scannum else 0 end)                as lease_scan_num         -- '苗找车信息浏览量'\\n    ,max(part_date)                                                      as part_date              -- '分区日期'\\nfrom db_dw_nstc.clife_nstc_dwd_deal_message_info\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','') \\ngroup by member_id, goods_class, start_place, end_place, substr(if(update_at is null, create_at, update_at),0,10)\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_dws_deal_message_info\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[]},{\"type\":\"SQL\",\"id\":\"tasks-10098\",\"name\":\"clife_nstc_dws_order_detail_comment_info\",\"params\":{\"type\":\"HIVE\",\"datasource\":161,\"sql\":\"insert overwrite table db_dw_nstc.clife_nstc_dws_order_detail_comment_info partition(part_date)\\nselect \\n product_id                                                              -- '产品id'\\n,goods_id                                                                -- '商品id'\\n,member_id                                                               -- '评论人id'\\n,receiver_province                                                       -- '省份'\\n,receiver_city                                                           -- '城市'\\n,receiver_area                                                           -- '区县'\\n,receiver_town                                                           -- '街道'\\n,substr(create_at,0,10)                      as comment_day              -- '评论日期'\\n,count(1)                                    as comment_cnt              -- '评价数'\\n,sum(case when star = 0 then 1 else 0 end)   as zero_star_comment_cnt    -- '0星级评价数量'\\n,sum(case when star = 1 then 1 else 0 end)   as one_star_comment_cnt     -- '1星级评价数量'\\n,sum(case when star = 2 then 1 else 0 end)   as two_star_comment_cnt     -- '2星级评价数量'\\n,sum(case when star = 3 then 1 else 0 end)   as three_star_comment_cnt   -- '3星级评价数量'\\n,sum(case when star = 4 then 1 else 0 end)   as four_star_comment_cnt    -- '4星级评价数量'\\n,sum(case when star = 5 then 1 else 0 end)   as five_star_comment_cnt    -- '5星级评价数量'\\n,max(part_date)                              as part_date                     -- '分区日期'\\nfrom db_dw_nstc.clife_nstc_dwd_order_detail_comment_info\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','') \\ngroup by product_id, goods_id, member_id, receiver_province, receiver_city, receiver_area, receiver_town, substr(create_at,0,10)\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_dws_order_detail_comment_info\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_dws_deal_message_info\"]},{\"type\":\"SQL\",\"id\":\"tasks-77030\",\"name\":\"clife_nstc_dws_order_detail_info\",\"params\":{\"type\":\"HIVE\",\"datasource\":161,\"sql\":\"insert overwrite table db_dw_nstc.clife_nstc_dws_order_detail_info partition(part_date)\\nselect                                                  \\n     member_id                                                               -- '买家id'\\n    ,product_id                                                              -- '产品id'\\n    ,goods_id                                                                -- '商品id'\\n    ,class_id                                                                -- '商品分类'\\n    ,type_id                                                                 -- '商品类型'\\n    ,receiver_province                                                       -- '省份'\\n    ,receiver_city                                                           -- '城市'\\n    ,receiver_area                                                           -- '区县'\\n    ,receiver_town                                                           -- '街道'\\n    ,substr(create_at,0,10)                           as order_detail_day    -- '订单创建日期'\\n    ,max(class_name)                                  as class_name          -- '商品分类名称' \\n    ,max(type_name)                                   as type_name           -- '商品类型名称' \\n    ,max(shop_id)                                     as shop_id             -- '店铺id' \\n    ,max(product_name)                                as product_name        -- '货品名' \\n    ,count(1)                                         as sale_cnt            -- '购买次数'\\n    ,sum(total)                                       as total_cnt           -- '购买总量'\\n    ,sum(recom_xq)                                    as total_recom_xq      -- '邮费总额'\\n    ,count(distinct sku)                              as sku_cnt             -- 'SKU数'\\n    ,sum(total * product_price)                       as total_price         -- '消费总额'\\n    ,sum(case when is_back = 1 then total else 0 end) as total_back_cnt      -- '退货数量'\\n    ,sum(case when is_back = 1 then 1 else 0 end)     as back_cnt            -- '退货次数'\\n    ,max(part_date)                                   as part_date           -- '分区日期'\\nfrom db_dw_nstc.clife_nstc_dwd_order_detail_info\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','') \\ngroup by  member_id, product_id ,goods_id, class_id, type_id, receiver_province, receiver_city, receiver_area, receiver_town, substr(create_at,0,10)\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_dws_order_detail_info\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_dws_order_detail_comment_info\"]},{\"type\":\"SQL\",\"id\":\"tasks-11359\",\"name\":\"clife_nstc_dws_order_converge\",\"params\":{\"type\":\"HIVE\",\"datasource\":161,\"sql\":\"insert overwrite table db_dw_nstc.clife_nstc_dws_order_converge partition(part_date)\\nselect \\n     cm.member_id         --会员ID\\n    ,cm.shop_id           --店铺id\\n    ,cm.receiver_province --省份\\n    ,cm.receiver_city     --城市\\n    ,cm.receiver_area     --区县\\n    ,cm.receiver_town     --街道\\n    ,cm.date_w as  date_time  --业务日期\\n    ,k.member_name         --会员名称\\n    ,k.`level` as member_identity --身份类型\\n    ,p.shop_name                  --店铺名称\\n    ,p.shop_main                  --店铺主营品种\\n    ,concat(p.shop_province,p.shop_city,p.shop_area,p.shop_town,p.shop_address) as shop_address --店铺地址\\n    ,coalesce(a.bug_product_num,0)           as bug_product_num           --产品购买量\\n    ,coalesce(a.bug_goods_num,0)             as bug_goods_num             --商品够买量\\n    ,coalesce(a.order_num,0)                 as order_num                 --下单总数\\n    ,coalesce(a.discuss_order_num,0)         as discuss_order_num         --商议订单数\\n    ,coalesce(a.wait_pay_order_num,0)        as wait_pay_order_num        --待支付订单数\\n    ,coalesce(a.wait_delivery_order_num,0)   as wait_delivery_order_num   --待发货订单数\\n    ,coalesce(a.wait_receiv_order_num,0)     as wait_receiv_order_num     --待收货订单数\\n    ,coalesce(a.wait_evaluation_order_num,0) as wait_evaluation_order_num --待评价订单数\\n    ,coalesce(a.return_order_o_num,0)        as return_order_o_num        --退货中订单数\\n    ,coalesce(a.return_order_s_num,0)        as return_order_s_num        --退货成功订单数\\n    ,coalesce(a.complete_order_num,0)        as complete_order_num        --订单完成订单数\\n    ,coalesce(a.complete_cancel_num,0)       as complete_cancel_num       --订单取消订单数\\n    ,coalesce(a.order_price_all,0)           as order_price_all           --订单总额\\n    ,coalesce(a.sub_money_all,0)             as sub_money_all             --优惠金额\\n    ,coalesce(b.payment,0)                   as payment                   --实付金额\\n    ,coalesce(b.pay_order_num,0)             as pay_order_num             --支付订单总数\\n    ,coalesce(b.no_pay_order_num,0)          as no_pay_order_num          --未支付订单数\\n    ,coalesce(b.wechar_pay_order_num,0)      as wechar_pay_order_num      --微信支付订单数\\n    ,coalesce(b.alipay_pay_order_num,0)      as alipay_pay_order_num      --支付宝支付订单数\\n    ,coalesce(b.app_pay_order_num,0)         as app_pay_order_num         --小程序支付订单数\\n    ,coalesce(b.icbc_app_pay_num,0)          as icbc_app_pay_num          --工行app支付订单数\\n    ,coalesce(b.icbc_pc_pay_num,0)           as icbc_pc_pay_num           --工行pc支付订单数\\n    ,coalesce(a.order_post,0)                as order_post                --邮费总额\\n    ,coalesce(c.shipping_order_num,0)        as shipping_order_num        --发货订单数\\n    ,coalesce(c.company_shipping_num,0)      as company_shipping_num      --发公司物流类型订单数\\n    ,coalesce(c.personal_shipping_num,0)     as personal_shipping_num     --发个人物流类型订单数\\n    ,coalesce(c.no_remind_shipping_num,0)    as no_remind_shipping_num    --发货未提醒数\\n    ,coalesce(c.remind_shipping_num,0)       as remind_shipping_num       --发货提醒数\\n    ,coalesce(d.receiving_order_num,0)       as receiving_order_num       --收货订单数\\n    ,coalesce(f.appeal_order_num,0)          as appeal_order_num          --申诉订单数\\n    ,coalesce(f.no_deal_appeal_num,0)        as no_deal_appeal_num        --申诉未处理订单数\\n    ,coalesce(f.deal_appeal_order_num,0)     as deal_appeal_order_num     --申诉已处理订单数\\n    ,coalesce(g.return_order_num,0)          as return_order_num          --退货订单总数\\n    ,coalesce(g.back_price_all,0)            as back_price_all            --退款总金额\\n    ,coalesce(g.unshipped_refunded_num,0)    as unshipped_refunded_num    --未发货退款订单数\\n    ,coalesce(g.shipped_no_received_num,0)   as shipped_no_received_num   --已发货未收到货退款订单数\\n    ,coalesce(g.received_back_num,0)         as received_back_num         --收到货仅退款订单数\\n    ,coalesce(g.received_pay_back_num,0)     as received_pay_back_num     --收到货退货退款订单数\\n    ,coalesce(g.company_back_num,0)          as company_back_num          --退货公司物流订单数\\n    ,coalesce(g.personal_back_num,0)         as personal_back_num         --退货个人找车订单数\\n    ,coalesce(g.inreview_back_num,0)         as inreview_back_num         --退货审核中订单数\\n    ,coalesce(g.agree_back_num,0)            as agree_back_num            --退货同意订单数\\n    ,coalesce(g.refuse_back_num,0)           as refuse_back_num           --退货拒绝订单数\\n    ,coalesce(e.evaluation_order_num,0)      as evaluation_order_num      --完成评价数\\n    ,coalesce(e.no_evaluation_num,0)         as no_evaluation_num         --未完成评价数\\n    ,coalesce(e.deal_complete_back_num,0)    as deal_complete_back_num    --退货订单交易完成数\\n    ,coalesce(e.deal_complete_no_back_num,0) as deal_complete_no_back_num --没有退货订单交易完成数\\n    ,coalesce(e.deal_complete_num,0)         as deal_complete_num         --交易完成订单数\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom \\n(\\n  select * \\n  from \\n  (\\n    select date_w \\n    from db_dw_nstc.clife_nstc_dim_date \\n    where dt_code<=regexp_replace(date_sub(current_date(),1),'-','') and dt_code>='20210101'\\n  ) tdate\\n  left join \\n  ( \\n    select\\n        member_id\\n       ,shop_id\\n       ,receiver_province\\n       ,receiver_city\\n       ,receiver_area\\n       ,max(receiver_town) as receiver_town\\n       ,count(1) as cnt\\n    from db_dw_nstc.clife_nstc_dwd_order_info\\n    where part_date = regexp_replace(date_sub(from_unixtime(unix_timestamp() ,'yyyy-MM-dd'),1),'-','') \\n    group by member_id\\n            ,shop_id\\n            ,receiver_province\\n            ,receiver_city\\n            ,receiver_area\\n   ) om on 1=1\\n) cm\\nleft join \\n(\\n   select \\n        member_id\\n       ,shop_id\\n       ,receiver_province\\n       ,receiver_city\\n       ,receiver_area\\n       ,max(receiver_town) as receiver_town\\n       ,substr(order_create_time,1,10)     as order_create_day --下单时间\\n       ,sum(size(split(product_ids,',')))       as bug_product_num  --产品购买量\\n       ,sum(size(split(good_ids,',')))          as bug_goods_num    --商品够买量\\n       ,count(1)                           as order_num        --下单总数\\n       ,sum(case when order_status = 0 then 1 else 0 end) as discuss_order_num         --商议订单数\\n       ,sum(case when order_status = 1 then 1 else 0 end) as wait_pay_order_num        --待支付订单数\\n       ,sum(case when order_status = 2 then 1 else 0 end) as wait_delivery_order_num   --待发货订单数\\n       ,sum(case when order_status = 3 then 1 else 0 end) as wait_receiv_order_num     --待收货订单数\\n       ,sum(case when order_status = 4 then 1 else 0 end) as wait_evaluation_order_num --待评价订单数\\n       ,sum(case when order_status = 5 then 1 else 0 end) as return_order_o_num        --退货中订单数\\n       ,sum(case when order_status = 6 then 1 else 0 end) as return_order_s_num        --退货成功订单数\\n       ,sum(case when order_status = 7 then 1 else 0 end) as complete_order_num        --订单完成订单数\\n       ,sum(case when order_status = 8 then 1 else 0 end) as complete_cancel_num       --订单取消订单数\\n       ,sum(order_price) as order_price_all --订单总额\\n       ,sum(sub_money)   as sub_money_all   --优惠金额\\n       ,sum(order_post)  as order_post      --邮费总额\\n  from db_dw_nstc.clife_nstc_dwd_order_info\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by member_id\\n          ,shop_id\\n          ,receiver_province\\n          ,receiver_city\\n          ,receiver_area\\n          ,substr(order_create_time,1,10)\\n)a on cm.member_id=a.member_id and cm.shop_id=a.shop_id and cm.receiver_province=a.receiver_province and cm.receiver_city=a.receiver_city and cm.receiver_area=a.receiver_area and cm.date_w=a.order_create_day \\nleft join \\n(\\n  select \\n       member_id\\n      ,shop_id\\n      ,receiver_province\\n      ,receiver_city\\n      ,receiver_area\\n      ,max(receiver_town) as receiver_town\\n      ,substr(pay_at,1,10) as pay_time_day --支付时间\\n      ,sum(case when pay_at is not null then 1 else 0 end) as pay_order_num --支付订单总数\\n      ,sum(case when order_status = 2 or order_status = 3 or order_status = 4 or order_status = 5 or order_status = 7 then payment else 0 end)     as payment         --交易金额\\n      ,sum(case when pay_type = 0 then 1 else 0 end) as no_pay_order_num      --未支付订单数\\n      ,sum(case when pay_type = 1 then 1 else 0 end) as wechar_pay_order_num  --微信支付订单数\\n      ,sum(case when pay_type = 2 then 1 else 0 end) as alipay_pay_order_num  --支付宝支付订单数\\n      ,sum(case when pay_type = 3 then 1 else 0 end) as app_pay_order_num     --小程序支付订单数\\n      ,sum(case when pay_type = 4 then 1 else 0 end) as icbc_app_pay_num      --工行app支付订单数\\n      ,sum(case when pay_type = 5 then 1 else 0 end) as icbc_pc_pay_num       --工行pc支付订单数\\n  from db_dw_nstc.clife_nstc_dwd_order_info\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by member_id\\n          ,shop_id\\n          ,receiver_province\\n          ,receiver_city\\n          ,receiver_area\\n          ,substr(pay_at,1,10)\\n)b on cm.member_id=b.member_id and cm.shop_id=b.shop_id and cm.receiver_province=b.receiver_province and cm.receiver_city=b.receiver_city and cm.receiver_area=b.receiver_area and cm.date_w=b.pay_time_day \\nleft join\\n(\\n  select \\n       member_id\\n      ,shop_id\\n      ,receiver_province\\n      ,receiver_city\\n      ,receiver_area\\n      ,max(receiver_town) as receiver_town\\n      ,substr(consign_at,1,10) as consign_time_day --发货时间\\n      ,sum(case when consign_at is not null then 1 else 0 end) as shipping_order_num     --发货订单数\\n      ,sum(case when shipping_type=0 then 1 else 0 end)        as company_shipping_num   --发公司物流类型订单数\\n      ,sum(case when shipping_type=1 then 1 else 0 end)        as personal_shipping_num  --发个人物流类型订单数\\n      ,sum(case when shipping_reminder=0 then 1 else 0 end)    as no_remind_shipping_num --发货未提醒数\\n      ,sum(case when shipping_reminder=1 then 1 else 0 end)    as remind_shipping_num    --发货提醒数\\n  from db_dw_nstc.clife_nstc_dwd_order_info\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by member_id\\n          ,shop_id\\n          ,receiver_province\\n          ,receiver_city\\n          ,receiver_area\\n          ,substr(consign_at,1,10)\\n\\n)c on cm.member_id=c.member_id and cm.shop_id=c.shop_id and cm.receiver_province=c.receiver_province and cm.receiver_city=c.receiver_city and cm.receiver_area=c.receiver_area and cm.date_w=c.consign_time_day \\nleft join\\n(\\n  select \\n       member_id\\n      ,shop_id\\n      ,receiver_province\\n      ,receiver_city\\n      ,receiver_area\\n      ,max(receiver_town) as receiver_town\\n      ,substr(receiving_at,1,10) as receiving_time_day --收货时间\\n      ,sum(case when receiving_at is not null then 1 else 0 end) as receiving_order_num     --收货订单数\\n  from db_dw_nstc.clife_nstc_dwd_order_info\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by member_id\\n          ,shop_id\\n          ,receiver_province\\n          ,receiver_city\\n          ,receiver_area\\n          ,substr(receiving_at,1,10)\\n)d on cm.member_id=d.member_id and cm.shop_id=d.shop_id and cm.receiver_province=d.receiver_province and cm.receiver_city=d.receiver_city and cm.receiver_area=d.receiver_area and cm.date_w=d.receiving_time_day   \\nleft join\\n(\\n  select \\n       member_id\\n      ,shop_id\\n      ,receiver_province\\n      ,receiver_city\\n      ,receiver_area\\n      ,max(receiver_town) as receiver_town\\n      ,substr(appeal_create_at,1,10) as appeal_time_day --申诉时间\\n      ,sum(case when appeal_create_at is not null then 1 else 0 end) as appeal_order_num --申诉订单数\\n      ,sum(case when appeal_status=0 then 1 else 0 end) as no_deal_appeal_num        --申诉未处理订单数\\n      ,sum(case when appeal_status=1 then 1 else 0 end) as deal_appeal_order_num     --申诉已处理订单数\\n  from db_dw_nstc.clife_nstc_dwd_order_info\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by member_id\\n          ,shop_id\\n          ,receiver_province\\n          ,receiver_city\\n          ,receiver_area\\n          ,substr(appeal_create_at,1,10)\\n)f on cm.member_id=f.member_id and cm.shop_id=f.shop_id and cm.receiver_province=f.receiver_province and cm.receiver_city=f.receiver_city and cm.receiver_area=f.receiver_area and cm.date_w=f.appeal_time_day\\nleft join\\n(\\n  select \\n       member_id\\n      ,shop_id\\n      ,receiver_province\\n      ,receiver_city\\n      ,receiver_area\\n      ,max(receiver_town) as receiver_town\\n      ,substr(return_at,1,10) as return_time_day --退货时间\\n      ,sum(case when return_at is not null and back_status<>2 then 1 else 0 end) as return_order_num --退货订单总数\\n      ,sum(back_price) as back_price_all --退款总金额\\n      ,sum(case when back_type=0 then 1 else 0 end)   as unshipped_refunded_num  --未发货退款订单数\\n      ,sum(case when back_type=1 then 1 else 0 end)   as shipped_no_received_num --已发货未收到货退款订单数\\n      ,sum(case when back_type=2 then 1 else 0 end)   as received_back_num       --收到货仅退款订单数\\n      ,sum(case when back_type=3 then 1 else 0 end)   as received_pay_back_num   --收到货退货退款订单数\\n      ,sum(case when back_way=0 then 1 else 0 end)    as company_back_num        --退货公司物流订单数\\n      ,sum(case when back_way=1 then 1 else 0 end)    as personal_back_num       --退货个人找车订单数\\n      ,sum(case when back_status=0 then 1 else 0 end) as inreview_back_num       --退货审核中订单数\\n      ,sum(case when back_status=1 then 1 else 0 end) as agree_back_num          --退货同意订单数\\n      ,sum(case when back_status=2 then 1 else 0 end) as refuse_back_num         --退货拒绝订单数\\n  from db_dw_nstc.clife_nstc_dwd_order_info\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by member_id\\n          ,shop_id\\n          ,receiver_province\\n          ,receiver_city\\n          ,receiver_area\\n          ,substr(return_at,1,10)\\n)g on cm.member_id=g.member_id and cm.shop_id=g.shop_id and cm.receiver_province=g.receiver_province and cm.receiver_city=g.receiver_city and cm.receiver_area=g.receiver_area and cm.date_w=g.return_time_day \\nleft join\\n(\\n  select \\n       member_id\\n      ,shop_id\\n      ,receiver_province\\n      ,receiver_city\\n      ,receiver_area\\n      ,max(receiver_town) as receiver_town\\n      ,substr(order_end_time,1,10) as end_time_day --交易完成时间\\n      ,sum(case when order_end_time is not null then 1 else 0 end) as deal_complete_num --交易完成订单数\\n      ,sum(case when coment=0 then 1 else 0 end) as no_evaluation_num          --未完成评价数\\n      ,sum(case when coment=1 then 1 else 0 end) as evaluation_order_num       --完成评价数\\n      ,sum(case when return_at is not null then 1 else 0 end) as  deal_complete_back_num --退货订单交易完成数\\n      ,sum(case when return_at is null then 1 else 0 end) as  deal_complete_no_back_num  --没有退货订单交易完成数\\n  from db_dw_nstc.clife_nstc_dwd_order_info\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by member_id\\n          ,shop_id\\n          ,receiver_province\\n          ,receiver_city\\n          ,receiver_area\\n          ,substr(order_end_time,1,10)\\n)e on cm.member_id=e.member_id and cm.shop_id=e.shop_id and cm.receiver_province=e.receiver_province and cm.receiver_city=e.receiver_city and cm.receiver_area=e.receiver_area and cm.date_w=e.end_time_day\\nleft join db_dw_nstc.clife_nstc_dim_member_user k on cm.member_id = k.member_id and k.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_dw_nstc.clife_nstc_dim_shop_shop p on cm.shop_id = p.shop_id and p.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_dws_order_detail_info\"]},{\"type\":\"SQL\",\"id\":\"tasks-41135\",\"name\":\"clife_nstc_dws_event_converge\",\"params\":{\"type\":\"HIVE\",\"datasource\":161,\"sql\":\"insert overwrite table db_dw_nstc.clife_nstc_dws_event_converge partition(part_date)\\nselect \\n     member_id                                --会员id\\n    ,object_id                                --被操作对象id\\n    ,substr(create_at,1,10)  as date_time     --业务日期\\n    ,max(object_type)        as  object_type  --对象类型\\n    ,max(member_name)        as  member_name  --会员名称\\n    ,max(object_name)        as  object_name  --被操作对象名称\\n    ,sum(case when behavior_type=0 then 1 else 0 end) as browse_num    --浏览量\\n    ,sum(case when behavior_type=1 then 1 else 0 end) as attention_num --关注量\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_dw_nstc.clife_nstc_dwd_event_info\\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','')\\ngroup by  member_id\\n         ,object_id\\n         ,substr(create_at,1,10)\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":3,\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_dws_order_converge\"]}],\"tenantId\":-1,\"timeout\":0}","description":"db_dws_nstc","globalParams":"[]","globalParamList":[],"globalParamMap":{},"createTime":"2021-11-09T06:50:42.000+0000","updateTime":"2021-11-12T03:01:40.000+0000","flag":"YES","userId":160,"userName":"data_warehouse","projectName":null,"locations":"{\"tasks-46156\":{\"name\":\"clife_nstc_dws_deal_message_info\",\"targetarr\":\"\",\"nodenumber\":\"1\",\"x\":161,\"y\":113},\"tasks-10098\":{\"name\":\"clife_nstc_dws_order_detail_comment_info\",\"targetarr\":\"tasks-46156\",\"nodenumber\":\"1\",\"x\":369,\"y\":113},\"tasks-77030\":{\"name\":\"clife_nstc_dws_order_detail_info\",\"targetarr\":\"tasks-10098\",\"nodenumber\":\"1\",\"x\":582,\"y\":116},\"tasks-11359\":{\"name\":\"clife_nstc_dws_order_converge\",\"targetarr\":\"tasks-77030\",\"nodenumber\":\"1\",\"x\":774,\"y\":118},\"tasks-41135\":{\"name\":\"clife_nstc_dws_event_converge\",\"targetarr\":\"tasks-11359\",\"nodenumber\":\"0\",\"x\":994,\"y\":115}}","connects":"[{\"endPointSourceId\":\"tasks-46156\",\"endPointTargetId\":\"tasks-10098\"},{\"endPointSourceId\":\"tasks-10098\",\"endPointTargetId\":\"tasks-77030\"},{\"endPointSourceId\":\"tasks-11359\",\"endPointTargetId\":\"tasks-41135\"},{\"endPointSourceId\":\"tasks-77030\",\"endPointTargetId\":\"tasks-11359\"}]","receivers":"","receiversCc":"","leadMobile":"","ddAlarmId":0,"scheduleReleaseState":null,"timeout":0,"tenantId":-1,"taskType":"SHELL"},{"id":857,"name":"db_dwd_nstc","version":0,"releaseState":"ONLINE","projectId":34,"processDefinitionJson":"{\"globalParams\":[],\"tasks\":[{\"type\":\"SQL\",\"id\":\"tasks-54868\",\"name\":\"clife_nstc_dwd_deal_message_info\",\"params\":{\"type\":\"HIVE\",\"datasource\":159,\"sql\":\"insert overwrite table db_dw_nstc.clife_nstc_dwd_deal_message_info partition(part_date) \\nselect \\n a.id                                             -- '消息发布id'       \\n,a.title                                          -- '标题'\\n,a.member_id                                      -- '会员id'\\n,b.member_name                                    -- '昵称' \\n,a.goods_class                                    -- '种类'\\n,a.goods_num                                      -- '买卖数量'\\n,a.price                                          -- '交易价格'\\n,a.start_place                                    -- '开始地'\\n,a.end_place                                      -- '目的地'\\n,a.image                                          -- '图片'\\n,a.comment                                        -- '备注内容'\\n,a.status                                         -- '发布状态' \\n,a.scannum                                        -- '浏览量'\\n,a.action_type                                    -- '消息类型（0 采购，1 供应，2 车找苗，3 苗找车）'\\n,a.create_at                                      -- '创建时间'\\n,a.update_at                                      -- '更新时间'\\n,a.part_date                                      -- '分区日期'\\nfrom (\\n    select \\n         purchase_id                as id               -- '消息发布id'       \\n        ,null                       as title            -- '标题'\\n        ,member_id                  as member_id        -- '会员id'\\n        ,purchase_class             as goods_class      -- '种类'\\n        ,purchase_num               as goods_num        -- '买卖数量'\\n        ,purchase_price             as price            -- '交易价格'\\n        ,fromword                   as start_place      -- '开始地'\\n        ,go                         as end_place        -- '目的地'\\n        ,image                      as image            -- '图片'\\n        ,conent                     as comment          -- '备注内容'\\n        ,statu                      as status           -- '发布状态' \\n        ,scannum                    as scannum          -- '浏览量'\\n        ,0                          as action_type      -- '消息类型（0 采购，1 供应，2 车找苗，3 苗找车）'\\n        ,create_at                  as create_at        -- '创建时间'\\n        ,update_at                  as update_at        -- '更新时间'\\n        ,part_date                                      -- '分区日期'\\n    from db_ods_nstc.clife_nstc_ods_apply_purchase\\n    where part_date = regexp_replace(date_sub(current_date(),1),'-','') and del_flag = 0 \\n    union all\\n    select \\n         suppery_Id                 as id               -- '消息发布id'       \\n        ,null                       as title            -- '标题'\\n        ,member_id                  as member_id        -- '会员id'\\n        ,goodclass                  as goods_class      -- '种类'\\n        ,supperNum                  as goods_num        -- '买卖数量'\\n        ,cast(supper_price as double) as price            -- '交易价格'\\n        ,fromword                   as start_place      -- '开始地'\\n        ,go                         as end_place        -- '目的地'\\n        ,image                      as image            -- '图片'\\n        ,conment                    as comment          -- '备注内容'\\n        ,statu                      as status           -- '发布状态' \\n        ,scannum                    as scannum          -- '浏览量'\\n        ,1                          as action_type      -- '消息类型（0 采购，1 供应，2 车找苗，3 苗找车）'\\n        ,create_at                  as create_at        -- '创建时间'\\n        ,update_at                  as update_at        -- '更新时间'\\n        ,part_date                                      -- '分区日期'\\n    from db_ods_nstc.clife_nstc_ods_apply_supply\\n    where part_date = regexp_replace(date_sub(current_date(),1),'-','') and del_flag = 0 \\n    union all\\n    select \\n         rent_id                    as id               -- '消息发布id'       \\n        ,title                      as title            -- '标题'\\n        ,member_id                  as member_id        -- '会员id'\\n        ,null                       as goods_class      -- '种类'\\n        ,null                       as goods_num        -- '买卖数量'\\n        ,price                      as price            -- '交易价格'\\n        ,stcity                     as start_place      -- '开始地'\\n        ,encity                     as end_place        -- '目的地'\\n        ,image                      as image            -- '图片'\\n        ,null                       as comment          -- '备注内容'\\n        ,statu                      as status           -- '发布状态' \\n        ,scannum                    as scannum          -- '浏览量'\\n        ,2                          as action_type      -- '消息类型（0 采购，1 供应，2 车找苗，3 苗找车）'\\n        ,create_at                  as create_at        -- '创建时间'\\n        ,update_at                  as update_at        -- '更新时间'\\n        ,part_date                                      -- '分区日期'\\n        from db_ods_nstc.clife_nstc_ods_storage_rent\\n    where part_date = regexp_replace(date_sub(current_date(),1),'-','') and del_flag = 0 \\n    union all\\n    select \\n         lease_id                   as id               -- '消息发布id'       \\n        ,title                      as title            -- '标题'\\n        ,member_id                  as member_id        -- '会员id'\\n        ,null                       as goods_class      -- '种类'\\n        ,null                       as goods_num        -- '买卖数量'\\n        ,price                      as price            -- '交易价格'\\n        ,stcity                     as start_place      -- '开始地'\\n        ,encity                     as end_place        -- '目的地'\\n        ,image                      as image            -- '图片'\\n        ,null                       as comment          -- '备注内容'\\n        ,statu                      as status           -- '发布状态' \\n        ,scannum                    as scannum          -- '浏览量'\\n        ,3                          as action_type      -- '消息类型（0 采购，1 供应，2 车找苗，3 苗找车）'\\n        ,create_at                  as create_at        -- '创建时间'\\n        ,update_at                  as update_at        -- '更新时间'\\n        ,part_date                                      -- '分区日期'\\n    from db_ods_nstc.clife_nstc_ods_storage_lease\\n    where part_date = regexp_replace(date_sub(current_date(),1),'-','') and del_flag = 0 \\n) a \\nleft join db_dw_nstc.clife_nstc_dim_member_user b\\non a.part_date = b.part_date and a.member_id = b.member_id\\n\\n\\n\\n\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_dwd_deal_message_info\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[]},{\"type\":\"SQL\",\"id\":\"tasks-90915\",\"name\":\"clife_nstc_dwd_order_info\",\"params\":{\"type\":\"HIVE\",\"datasource\":161,\"sql\":\"insert overwrite table db_dw_nstc.clife_nstc_dwd_order_info partition(part_date)\\nselect\\n     a.order_id                       --订单id\\n    ,a.shop_id                        --店铺id\\n    ,b.shop_name                      --店铺名称\\n    ,a.member_id                      --会员ID\\n    ,c.member_name                    --会员名称\\n    ,k.good_ids                         --商品ids\\n    ,k.product_ids                      --产品ids\\n    ,a.order_sn                       --订单号\\n    ,a.merge_sn                       --合单号\\n    ,a.status      as order_status    --订单状态\\n    ,a.order_price                    --订单总额\\n    ,a.create_at   as order_create_time --下单时间\\n    ,a.update_at   as order_update_time --订单更新时间\\n    ,a.coupon_id          --优惠券id\\n    ,d.coupon_name        --优惠券名称\\n    ,d.sub_money          --优惠金额\\n    ,a.payment            --实付金额\\n    ,case when a.pay_type is null then 0 else  a.pay_type end as pay_type --支付类型\\n    ,a.pay_at             --支付时间\\n    ,a.order_post         --发货邮费\\n    ,a.shipping_type      --发货物流类型\\n    ,a.shipping_name      --发货物流名称\\n    ,a.shipping_reminder  --发货提醒\\n    ,a.consign_at         --发货时间\\n    ,e.shipping_id        --订单收货信息id\\n    ,e.receiver_name      --收件人\\n    ,e.receiver_phone     --电话\\n    ,e.receiver_province  --省份\\n    ,e.receiver_city      --城市\\n    ,e.receiver_area      --区县\\n    ,e.receiver_town      --街道\\n    ,e.receiver_address   --地址\\n    ,a.receiving_at       --收货时间\\n    ,a.coment             --是否评价\\n    ,f.id             as appeal_id        --申诉id\\n    ,f.reason_content as appeal_reason    --申诉原因\\n    ,f.status         as appeal_status    --申诉状态\\n    ,f.create_at      as appeal_create_at --申诉时间\\n    ,g.back_id                            --退换货id\\n    ,g.status         as back_status      --退货审核状态\\n    ,g.price          as back_price       --退款金额\\n    ,g.back_type                          --退货类型\\n    ,g.reason        as back_reason       --退货原因\\n    ,g.create_at     as return_at         --退货时间(跟退货表的时间是否相同)\\n    ,g.type          as back_way          --退货方式\\n    ,g.express_name  as back_express_name --退货物流名\\n    ,g.express_code  as back_express_code --退货快物流单号\\n    ,a.end_at        as order_end_time    --订单交易完成时间\\n    ,a.close_at      as order_close_time  --订单交易关闭时间\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_ods_nstc.clife_nstc_ods_order_order a\\nleft join db_dw_nstc.clife_nstc_dim_shop_shop b on a.shop_id = b.shop_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_dw_nstc.clife_nstc_dim_member_user c on a.member_id = c.member_id and c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_dw_nstc.clife_nstc_dim_shop_coupon d on a.coupon_id = d.id and d.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_ods_nstc.clife_nstc_ods_order_shipping e on a.order_id = e.order_id and e.del_flag = 0 and e.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\n(\\n  select *\\n  from\\n  (\\n    select st.*,row_number()over(partition by order_id order by create_at desc) as ranks\\n    from db_ods_nstc.clife_nstc_ods_order_appeal st\\n    where del_flag = 0 \\n      and part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  )ls\\n  where ranks = 1\\n)f on a.order_id = f.order_id\\nleft join \\n(\\n  select *\\n  from\\n  (\\n    select sb.*,row_number()over(partition by order_id order by update_at desc) as ranks\\n    from db_ods_nstc.clife_nstc_ods_order_back sb\\n    where del_flag = 0 \\n      and part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  )ls\\n  where ranks = 1\\n)g on a.order_id = g.order_id\\nleft join \\n(\\n  select\\n       order_id\\n      ,concat_ws(',',collect_list(cast(product_id as string))) as product_ids\\n      ,concat_ws(',',collect_list(cast(goods_id as string))) as good_ids\\n  from db_ods_nstc.clife_nstc_ods_order_detail\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    and del_flag=0\\n  group by order_id\\n)k on a.order_id = k.order_id\\nwhere a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  and a.del_flag=0\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":3,\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_dwd_order_detail_info\"]},{\"type\":\"SQL\",\"id\":\"tasks-85125\",\"name\":\"clife_nstc_dwd_event_info\",\"params\":{\"type\":\"HIVE\",\"datasource\":161,\"sql\":\"insert overwrite table db_dw_nstc.clife_nstc_dwd_event_info partition(part_date)\\nselect \\n     t.id             --记录id\\n    ,t.member_id      --会员id\\n    ,c.member_name    --会员名称\\n    ,t.`object_id`    --被操作对象id （商品 店铺）\\n    ,t.`object_name`  --被操作对象名称\\n    ,t.object_type    --对象类型（0 商品 1 店铺）\\n    ,t.behavior_type  --行为动作类型\\n    ,t.`type`         --是否是新客户\\n    ,t.create_at      --行为时间\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom\\n(\\n  select\\n       a.id                             -- 记录id\\n      ,a.member_id                      -- 会员id\\n      ,a.goods_id   as `object_id`      -- 被操作对象id\\n      ,b.goods_name as `object_name`    -- 被操作对象名称\\n      ,'商品'  as object_type               -- 对象类型（0 商品 1 店铺）\\n      ,0   as behavior_type\\n      ,a.`type`                         -- 新老访客数0-新访客,1-老访客\\n      ,a.create_at                      -- 访问日期\\n  from db_ods_nstc.clife_nstc_ods_record_goods_member a \\n  left join db_dw_nstc.clife_nstc_dim_goods_goods b on a.goods_id = b.goods_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  union all\\n  select\\n       a.id                             -- 记录id\\n      ,a.member_id                      -- 会员id\\n      ,a.shop_id    as `object_id`      -- 被操作对象id\\n      ,b.shop_name  as `object_name`    -- 被操作对象名称\\n      ,'店铺'    as object_type               -- 对象类型（0 商品 1 店铺）\\n      ,0   as  behavior_type\\n      ,a.`type`                         -- 新老访客0-新访客,1-老访客\\n      ,a.create_at                      -- 访问日期\\n  from db_ods_nstc.clife_nstc_ods_record_shop_member a \\n  left join db_dw_nstc.clife_nstc_dim_shop_shop b on a.shop_id = b.shop_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  union all\\n  select\\n       a.id                             -- 记录id\\n      ,a.member_id                      -- 会员id\\n      ,a.shop_id    as `object_id`      -- 被操作对象id\\n      ,b.shop_name  as `object_name`    -- 被操作对象名称\\n      ,'店铺'   as object_type               -- 对象类型（0 商品 1 店铺）\\n      ,1   as  behavior_type\\n      ,null as  `type`                  -- 新老访客0-新访客,1-老访客\\n      ,a.create_at                      -- 关注日期\\n  from db_ods_nstc.clife_nstc_ods_member_shop a \\n  left join db_dw_nstc.clife_nstc_dim_shop_shop b on a.shop_id = b.shop_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  union all\\n  select\\n       a.follow_id as id                -- 记录id\\n      ,a.member_id                      -- 会员id\\n      ,a.goods_id   as `object_id`      -- 被操作对象id\\n      ,b.goods_name as `object_name`    -- 被操作对象名称\\n      ,'商品'   as object_type               -- 对象类型（0 商品 1 店铺）\\n      ,1   as behavior_type\\n      ,null as `type`                   -- 新老访客数0-新访客,1-老访客\\n      ,a.create_at                      -- 访问日期\\n  from db_ods_nstc.clife_nstc_ods_member_follow a \\n  left join db_dw_nstc.clife_nstc_dim_goods_goods b on a.goods_id = b.goods_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n)t\\nleft join db_dw_nstc.clife_nstc_dim_member_user c on t.member_id = c.member_id  and c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":3,\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_dwd_order_info\"]},{\"type\":\"SQL\",\"id\":\"tasks-55167\",\"name\":\"clife_nstc_dwd_order_detail_comment_info\",\"params\":{\"type\":\"HIVE\",\"datasource\":161,\"sql\":\"insert overwrite table db_dw_nstc.clife_nstc_dwd_order_detail_comment_info partition(part_date) \\nselect \\n     a.comment_id                     -- '评论表id' \\n    ,a.product_id                     -- '产品id' \\n    ,a.goods_id                       -- '商品id' \\n    ,a.member_id                      -- '评论人' \\n    ,a.star                           -- '评价星级 1-5,默认5星' \\n    ,a.content                        -- '评价内容' \\n    ,a.comment_img                    -- '评论图片' \\n    ,c.receiver_province              -- '省份' \\n    ,c.receiver_city                  -- '城市' \\n    ,c.receiver_area                  -- '区县' \\n    ,c.receiver_town                  -- '街道' \\n    ,c.receiver_address               -- '地址'     \\n    ,a.create_at                      -- '创建时间' \\n    ,a.part_date                      -- '分区日期'\\nfrom (\\n    select \\n         comment_id                   -- '评论表id'\\n        ,detail_id                    -- '订单详情表id' \\n        ,product_id                   -- '产品id' \\n        ,goods_id                     -- '商品id' \\n        ,member_id                    -- '评论人' \\n        ,star                         -- '评价星级 1-5,默认5星' \\n        ,content                      -- '评价内容' \\n        ,comment_img                  -- '评论图片'     \\n        ,create_at                    -- '创建时间' \\n        ,part_date                    -- '分区日期'\\n    from db_ods_nstc.clife_nstc_ods_order_coment  \\n    where part_date = regexp_replace(date_sub(current_date(),1),'-','') and del_flag = 0 and disply = 0\\n) a \\nleft join db_ods_nstc.clife_nstc_ods_order_detail b\\non a.part_date = b.part_date and a.detail_id = b.detail_id and b.del_flag = 0\\nleft join db_ods_nstc.clife_nstc_ods_order_shipping c \\non b.part_date = c.part_date and b.order_id = c.order_id and c.del_flag = 0\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_dwd_order_detail_comment_info\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_dwd_deal_message_info\"]},{\"type\":\"SQL\",\"id\":\"tasks-5-4k61bg\",\"name\":\"clife_nstc_dwd_order_detail_info\",\"params\":{\"type\":\"HIVE\",\"datasource\":161,\"sql\":\"insert overwrite table db_dw_nstc.clife_nstc_dwd_order_detail_info partition(part_date) \\nselect \\n     a.detail_id                      -- '订单详情id' \\n    ,a.order_id                       -- '订单ID' \\n    ,a.product_id                     -- '产品规格ID' \\n    ,b.member_id                      -- '买家ID' \\n    ,a.goods_id                       -- '商品ID' \\n    ,c.goods_name                     -- '商品名称' \\n    ,c.goods_title                    -- '商品标题' \\n    ,c.class_id                       -- '商品分类' \\n    ,c.class_name                     -- '商品分类名称' \\n    ,c.type_id                        -- '商品类型' \\n    ,c.type_name                      -- '商品类型名称' \\n    ,c.brand_id                       -- '商品品牌' \\n    ,c.brand_name                     -- '品牌名称' \\n    ,c.brand_url                      -- '品牌网址' \\n    ,c.shop_id                        -- '店铺id' \\n    ,c.shop_name                      -- '店铺名称' \\n    ,c.recom_xq                       -- '邮费,0-包邮,1-不包邮' \\n    ,d.sku                            -- 'SKU' \\n    ,d.product_name                   -- '货品名' \\n    ,d.product_img                    -- '产品图片' \\n    ,d.product_spec                   -- '货品规格' \\n    ,d.product_price                  -- '价格' \\n    ,d.product_post                   -- '期货购买价' \\n    ,a.total                          -- '购买数量' \\n    ,if(e.order_id is not null and e.status = 1, 1, 0) as is_back    -- '是否退货：1 退货，0 未退货'\\n    ,f.shipping_id                    -- '订单收货信息id' \\n    ,f.receiver_province              -- '省份' \\n    ,f.receiver_city                  -- '城市' \\n    ,f.receiver_area                  -- '区县' \\n    ,f.receiver_town                  -- '街道' \\n    ,a.create_at                      -- '创建时间' \\n    ,a.part_date                      -- '分区日期'\\nfrom (\\n    select \\n         detail_id                    -- '订单详情id' \\n        ,order_id                     -- '订单ID' \\n        ,product_id                   -- '产品规格ID' \\n        ,goods_id                     -- '商品ID' \\n        ,total                        -- '购买数量' \\n        ,create_at                    -- '创建时间' \\n        ,part_date                    -- '分区日期'\\n    from db_ods_nstc.clife_nstc_ods_order_detail \\n    where part_date = regexp_replace(date_sub(current_date(),1),'-','') and del_flag = 0 \\n) a \\nleft join db_ods_nstc.clife_nstc_ods_order_order b \\non a.part_date = b.part_date and a.order_id = b.order_id\\nleft join db_dw_nstc.clife_nstc_dim_goods_goods c \\non a.part_date = c.part_date and a.goods_id = c.goods_id\\nleft join db_dw_nstc.clife_nstc_dim_goods_product d\\non a.part_date = d.part_date and a.product_id = d.product_id\\nleft join (\\n    select \\n         order_id                                -- '订单ID'\\n        ,status                                  -- '退货状态0-审核中,1-同意,2-拒绝'\\n        ,part_date                               -- '分区日期'\\n    from\\n    (\\n        select \\n             order_id                            -- '订单ID'\\n            ,row_number() over(partition by order_id order by create_at desc) as rank_num    \\n            ,status                              -- '退货状态0-审核中,1-同意,2-拒绝'\\n            ,part_date                           -- '分区日期'\\n        from db_ods_nstc.clife_nstc_ods_order_back\\n        where part_date = regexp_replace(date_sub(current_date(),1),'-','') and del_flag = 0 \\n    ) tmp where rank_num = 1\\n) e\\non a.part_date = e.part_date and a.order_id = e.order_id\\nleft join db_ods_nstc.clife_nstc_ods_order_shipping f \\non a.part_date = f.part_date and a.order_id = f.order_id and f.del_flag = 0\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_dwd_order_detail_info\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_dwd_order_detail_comment_info\"]}],\"tenantId\":-1,\"timeout\":0}","description":"db_dwd_nstc","globalParams":"[]","globalParamList":[],"globalParamMap":{},"createTime":"2021-11-08T10:20:15.000+0000","updateTime":"2021-11-12T03:01:22.000+0000","flag":"YES","userId":160,"userName":"data_warehouse","projectName":null,"locations":"{\"tasks-54868\":{\"name\":\"clife_nstc_dwd_deal_message_info\",\"targetarr\":\"\",\"nodenumber\":\"2\",\"x\":164,\"y\":100},\"tasks-90915\":{\"name\":\"clife_nstc_dwd_order_info\",\"targetarr\":\"tasks-5-4k61bg\",\"nodenumber\":\"1\",\"x\":828,\"y\":102},\"tasks-85125\":{\"name\":\"clife_nstc_dwd_event_info\",\"targetarr\":\"tasks-90915\",\"nodenumber\":\"0\",\"x\":1039,\"y\":99},\"tasks-55167\":{\"name\":\"clife_nstc_dwd_order_detail_comment_info\",\"targetarr\":\"tasks-54868\",\"nodenumber\":\"1\",\"x\":373,\"y\":102},\"tasks-5-4k61bg\":{\"name\":\"clife_nstc_dwd_order_detail_info\",\"targetarr\":\"tasks-55167\",\"nodenumber\":\"1\",\"x\":587,\"y\":96}}","connects":"[{\"endPointSourceId\":\"tasks-90915\",\"endPointTargetId\":\"tasks-85125\"},{\"endPointSourceId\":\"tasks-54868\",\"endPointTargetId\":\"tasks-55167\"},{\"endPointSourceId\":\"tasks-55167\",\"endPointTargetId\":\"tasks-5-4k61bg\"},{\"endPointSourceId\":\"tasks-5-4k61bg\",\"endPointTargetId\":\"tasks-90915\"}]","receivers":"","receiversCc":"","leadMobile":"","ddAlarmId":0,"scheduleReleaseState":null,"timeout":0,"tenantId":-1,"taskType":"SHELL"},{"id":862,"name":"db_ads_nstc","version":0,"releaseState":"ONLINE","projectId":34,"processDefinitionJson":"{\"globalParams\":[],\"tasks\":[{\"type\":\"SQL\",\"id\":\"tasks-59219\",\"name\":\"clife_nstc_ads_deal_message_info_d\",\"params\":{\"type\":\"HIVE\",\"datasource\":162,\"sql\":\"insert overwrite table db_ads_nstc.clife_nstc_ads_deal_message_info_d partition(part_date)\\nselect \\n     member_id                                                    -- '会员id'  \\n    ,release_day                                                  -- '发布时间（日）'\\n    ,max(member_name)          as member_name                     -- '昵称'\\n    ,sum(purchase_cnt        ) as purchase_cnt                    -- '采购信息数量'\\n    ,sum(suppery_cnt         ) as suppery_cnt                     -- '供应信息数量'\\n    ,sum(rent_cnt            ) as rent_cnt                        -- '车找苗信息数量'\\n    ,sum(lease_cnt           ) as lease_cnt                       -- '苗找车信息数量'\\n    ,sum(purchase_release_cnt) as purchase_release_cnt            -- '采购信息发布中数量'\\n    ,sum(suppery_release_cnt ) as suppery_release_cnt             -- '供应信息发布中数量'\\n    ,sum(rent_release_cnt    ) as rent_release_cnt                -- '车找苗信息发布中数量'\\n    ,sum(lease_release_cnt   ) as lease_release_cnt               -- '苗找车信息发布中数量'\\n    ,sum(purchase_finish_cnt ) as purchase_finish_cnt             -- '采购信息已结束数量'\\n    ,sum(suppery_finish_cnt  ) as suppery_finish_cnt              -- '供应信息已结束数量'\\n    ,sum(rent_finish_cnt     ) as rent_finish_cnt                 -- '车找苗信息已结束数量'\\n    ,sum(lease_finish_cnt    ) as lease_finish_cnt                -- '苗找车信息已结束数量'\\n    ,sum(purchase_return_cnt ) as purchase_return_cnt             -- '采购信息被驳回数量'\\n    ,sum(suppery_return_cnt  ) as suppery_return_cnt              -- '供应信息被驳回数量'\\n    ,sum(rent_return_cnt     ) as rent_return_cnt                 -- '车找苗信息被驳回数量'\\n    ,sum(lease_return_cnt    ) as lease_return_cnt                -- '苗找车信息被驳回数量'\\n    ,sum(purchase_scan_num   ) as purchase_scan_num               -- '采购信息浏览量'\\n    ,sum(suppery_scan_num    ) as suppery_scan_num                -- '供应信息浏览量'\\n    ,sum(rent_scan_num       ) as rent_scan_num                   -- '车找苗信息浏览量'\\n    ,sum(lease_scan_num      ) as lease_scan_num                  -- '苗找车信息浏览量'\\n\\t,max(part_date)            as part_date                       -- '分区日期'\\nfrom db_dw_nstc.clife_nstc_dws_deal_message_info\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','') \\ngroup by member_id, release_day\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ads_deal_message_info_d\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[]},{\"type\":\"SQL\",\"id\":\"tasks-79480\",\"name\":\"clife_nstc_ads_deal_message_info_m\",\"params\":{\"type\":\"HIVE\",\"datasource\":162,\"sql\":\"insert overwrite table db_ads_nstc.clife_nstc_ads_deal_message_info_m partition(part_date)\\nselect \\n     member_id                                                    -- '会员id'  \\n    ,substr(release_day,0,7)   as release_month                   -- '发布时间（月）'\\n    ,max(member_name)          as member_name                     -- '昵称'\\n    ,sum(purchase_cnt        ) as purchase_cnt                    -- '采购信息数量'\\n    ,sum(suppery_cnt         ) as suppery_cnt                     -- '供应信息数量'\\n    ,sum(rent_cnt            ) as rent_cnt                        -- '车找苗信息数量'\\n    ,sum(lease_cnt           ) as lease_cnt                       -- '苗找车信息数量'\\n    ,sum(purchase_release_cnt) as purchase_release_cnt            -- '采购信息发布中数量'\\n    ,sum(suppery_release_cnt ) as suppery_release_cnt             -- '供应信息发布中数量'\\n    ,sum(rent_release_cnt    ) as rent_release_cnt                -- '车找苗信息发布中数量'\\n    ,sum(lease_release_cnt   ) as lease_release_cnt               -- '苗找车信息发布中数量'\\n    ,sum(purchase_finish_cnt ) as purchase_finish_cnt             -- '采购信息已结束数量'\\n    ,sum(suppery_finish_cnt  ) as suppery_finish_cnt              -- '供应信息已结束数量'\\n    ,sum(rent_finish_cnt     ) as rent_finish_cnt                 -- '车找苗信息已结束数量'\\n    ,sum(lease_finish_cnt    ) as lease_finish_cnt                -- '苗找车信息已结束数量'\\n    ,sum(purchase_return_cnt ) as purchase_return_cnt             -- '采购信息被驳回数量'\\n    ,sum(suppery_return_cnt  ) as suppery_return_cnt              -- '供应信息被驳回数量'\\n    ,sum(rent_return_cnt     ) as rent_return_cnt                 -- '车找苗信息被驳回数量'\\n    ,sum(lease_return_cnt    ) as lease_return_cnt                -- '苗找车信息被驳回数量'\\n    ,sum(purchase_scan_num   ) as purchase_scan_num               -- '采购信息浏览量'\\n    ,sum(suppery_scan_num    ) as suppery_scan_num                -- '供应信息浏览量'\\n    ,sum(rent_scan_num       ) as rent_scan_num                   -- '车找苗信息浏览量'\\n    ,sum(lease_scan_num      ) as lease_scan_num                  -- '苗找车信息浏览量'\\n\\t,max(part_date)            as part_date                       -- '分区日期'\\nfrom db_dw_nstc.clife_nstc_dws_deal_message_info\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','') \\ngroup by member_id, substr(release_day,0,7)\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ads_deal_message_info_m\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ads_deal_message_info_d\"]},{\"type\":\"SQL\",\"id\":\"tasks-41422\",\"name\":\"clife_nstc_ads_deal_message_info_y\",\"params\":{\"type\":\"HIVE\",\"datasource\":162,\"sql\":\"insert overwrite table db_ads_nstc.clife_nstc_ads_deal_message_info_y partition(part_date)\\nselect \\n     member_id                                                    -- '会员id'  \\n    ,substr(release_day,0,4)   as release_year                    -- '发布时间（年）'\\n    ,max(member_name)          as member_name                     -- '昵称'\\n    ,sum(purchase_cnt        ) as purchase_cnt                    -- '采购信息数量'\\n    ,sum(suppery_cnt         ) as suppery_cnt                     -- '供应信息数量'\\n    ,sum(rent_cnt            ) as rent_cnt                        -- '车找苗信息数量'\\n    ,sum(lease_cnt           ) as lease_cnt                       -- '苗找车信息数量'\\n    ,sum(purchase_release_cnt) as purchase_release_cnt            -- '采购信息发布中数量'\\n    ,sum(suppery_release_cnt ) as suppery_release_cnt             -- '供应信息发布中数量'\\n    ,sum(rent_release_cnt    ) as rent_release_cnt                -- '车找苗信息发布中数量'\\n    ,sum(lease_release_cnt   ) as lease_release_cnt               -- '苗找车信息发布中数量'\\n    ,sum(purchase_finish_cnt ) as purchase_finish_cnt             -- '采购信息已结束数量'\\n    ,sum(suppery_finish_cnt  ) as suppery_finish_cnt              -- '供应信息已结束数量'\\n    ,sum(rent_finish_cnt     ) as rent_finish_cnt                 -- '车找苗信息已结束数量'\\n    ,sum(lease_finish_cnt    ) as lease_finish_cnt                -- '苗找车信息已结束数量'\\n    ,sum(purchase_return_cnt ) as purchase_return_cnt             -- '采购信息被驳回数量'\\n    ,sum(suppery_return_cnt  ) as suppery_return_cnt              -- '供应信息被驳回数量'\\n    ,sum(rent_return_cnt     ) as rent_return_cnt                 -- '车找苗信息被驳回数量'\\n    ,sum(lease_return_cnt    ) as lease_return_cnt                -- '苗找车信息被驳回数量'\\n    ,sum(purchase_scan_num   ) as purchase_scan_num               -- '采购信息浏览量'\\n    ,sum(suppery_scan_num    ) as suppery_scan_num                -- '供应信息浏览量'\\n    ,sum(rent_scan_num       ) as rent_scan_num                   -- '车找苗信息浏览量'\\n    ,sum(lease_scan_num      ) as lease_scan_num                  -- '苗找车信息浏览量'\\n\\t,max(part_date)            as part_date                       -- '分区日期'\\nfrom db_dw_nstc.clife_nstc_dws_deal_message_info\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','') \\ngroup by member_id, substr(release_day,0,4)\\n\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ads_deal_message_info_y\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ads_deal_message_info_m\"]},{\"type\":\"SQL\",\"id\":\"tasks-7797\",\"name\":\"clife_nstc_ads_order_detail_comment_info_d\",\"params\":{\"type\":\"HIVE\",\"datasource\":162,\"sql\":\"insert overwrite table db_ads_nstc.clife_nstc_ads_order_detail_comment_info_d partition(part_date)\\nselect\\n     product_id                                                                           -- '产品id'\\n    ,comment_day                                                                          -- '评论日期（日）'\\n    ,sum(comment_cnt           )                            as  comment_cnt               -- '评价数'\\n    ,sum(zero_star_comment_cnt )                            as  zero_star_comment_cnt     -- '0星级评价数量'\\n    ,sum(one_star_comment_cnt  )                            as  one_star_comment_cnt      -- '1星级评价数量'\\n    ,sum(two_star_comment_cnt  )                            as  two_star_comment_cnt      -- '2星级评价数量'\\n    ,sum(three_star_comment_cnt)                            as  three_star_comment_cnt    -- '3星级评价数量'\\n    ,sum(four_star_comment_cnt )                            as  four_star_comment_cnt     -- '4星级评价数量'\\n    ,sum(five_star_comment_cnt )                            as  five_star_comment_cnt     -- '5星级评价数量'\\n    ,round(sum(zero_star_comment_cnt ) / sum(comment_cnt),2)  as  zero_star_comment_per     -- '0星级评价数量占比'\\n    ,round(sum(one_star_comment_cnt  ) / sum(comment_cnt),2)  as  one_star_comment_per      -- '1星级评价数量占比'\\n    ,round(sum(two_star_comment_cnt  ) / sum(comment_cnt),2)  as  two_star_comment_per      -- '2星级评价数量占比'\\n    ,round(sum(three_star_comment_cnt) / sum(comment_cnt),2)  as  three_star_comment_per    -- '3星级评价数量占比'\\n    ,round(sum(four_star_comment_cnt ) / sum(comment_cnt),2)  as  four_star_comment_per     -- '4星级评价数量占比'\\n    ,round(sum(five_star_comment_cnt ) / sum(comment_cnt),2)  as  five_star_comment_per     -- '5星级评价数量占比'\\n    ,max(part_date)              as  part_date                 -- '分区日期'\\nfrom db_dw_nstc.clife_nstc_dws_order_detail_comment_info\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','') \\ngroup by product_id, comment_day\\n\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ads_order_detail_comment_info_d\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ads_deal_message_info_y\"]},{\"type\":\"SQL\",\"id\":\"tasks-87488\",\"name\":\"clife_nstc_ads_order_detail_comment_info_y\",\"params\":{\"type\":\"HIVE\",\"datasource\":162,\"sql\":\"insert overwrite table db_ads_nstc.clife_nstc_ads_order_detail_comment_info_y partition(part_date)\\nselect\\n     product_id                                                                           -- '产品id'\\n    ,substr(comment_day,0,4)                                as  comment_year              -- '评论日期（年）'\\n    ,sum(comment_cnt           )                            as  comment_cnt               -- '评价数'\\n    ,sum(zero_star_comment_cnt )                            as  zero_star_comment_cnt     -- '0星级评价数量'\\n    ,sum(one_star_comment_cnt  )                            as  one_star_comment_cnt      -- '1星级评价数量'\\n    ,sum(two_star_comment_cnt  )                            as  two_star_comment_cnt      -- '2星级评价数量'\\n    ,sum(three_star_comment_cnt)                            as  three_star_comment_cnt    -- '3星级评价数量'\\n    ,sum(four_star_comment_cnt )                            as  four_star_comment_cnt     -- '4星级评价数量'\\n    ,sum(five_star_comment_cnt )                            as  five_star_comment_cnt     -- '5星级评价数量'\\n    ,round(sum(zero_star_comment_cnt ) / sum(comment_cnt),2)  as  zero_star_comment_per     -- '0星级评价数量占比'\\n    ,round(sum(one_star_comment_cnt  ) / sum(comment_cnt),2)  as  one_star_comment_per      -- '1星级评价数量占比'\\n    ,round(sum(two_star_comment_cnt  ) / sum(comment_cnt),2)  as  two_star_comment_per      -- '2星级评价数量占比'\\n    ,round(sum(three_star_comment_cnt) / sum(comment_cnt),2)  as  three_star_comment_per    -- '3星级评价数量占比'\\n    ,round(sum(four_star_comment_cnt ) / sum(comment_cnt),2)  as  four_star_comment_per     -- '4星级评价数量占比'\\n    ,round(sum(five_star_comment_cnt ) / sum(comment_cnt),2)  as  five_star_comment_per     -- '5星级评价数量占比'\\n    ,max(part_date)              as  part_date                 -- '分区日期'\\nfrom db_dw_nstc.clife_nstc_dws_order_detail_comment_info\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','') \\ngroup by product_id, substr(comment_day,0,4)\\n\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ads_order_detail_comment_info_y\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ads_order_detail_comment_info_m\"]},{\"type\":\"SQL\",\"id\":\"tasks-76303\",\"name\":\"clife_nstc_ads_order_detail_comment_info_m\",\"params\":{\"type\":\"HIVE\",\"datasource\":162,\"sql\":\"\\ninsert overwrite table db_ads_nstc.clife_nstc_ads_order_detail_comment_info_m partition(part_date)\\nselect\\n     product_id                                                                           -- '产品id'\\n    ,substr(comment_day,0,7)                                as  comment_month             -- '评论日期（月）'\\n    ,sum(comment_cnt           )                            as  comment_cnt               -- '评价数'\\n    ,sum(zero_star_comment_cnt )                            as  zero_star_comment_cnt     -- '0星级评价数量'\\n    ,sum(one_star_comment_cnt  )                            as  one_star_comment_cnt      -- '1星级评价数量'\\n    ,sum(two_star_comment_cnt  )                            as  two_star_comment_cnt      -- '2星级评价数量'\\n    ,sum(three_star_comment_cnt)                            as  three_star_comment_cnt    -- '3星级评价数量'\\n    ,sum(four_star_comment_cnt )                            as  four_star_comment_cnt     -- '4星级评价数量'\\n    ,sum(five_star_comment_cnt )                            as  five_star_comment_cnt     -- '5星级评价数量'\\n    ,round(sum(zero_star_comment_cnt ) / sum(comment_cnt),2)  as  zero_star_comment_per     -- '0星级评价数量占比'\\n    ,round(sum(one_star_comment_cnt  ) / sum(comment_cnt),2)  as  one_star_comment_per      -- '1星级评价数量占比'\\n    ,round(sum(two_star_comment_cnt  ) / sum(comment_cnt),2)  as  two_star_comment_per      -- '2星级评价数量占比'\\n    ,round(sum(three_star_comment_cnt) / sum(comment_cnt),2)  as  three_star_comment_per    -- '3星级评价数量占比'\\n    ,round(sum(four_star_comment_cnt ) / sum(comment_cnt),2)  as  four_star_comment_per     -- '4星级评价数量占比'\\n    ,round(sum(five_star_comment_cnt ) / sum(comment_cnt),2)  as  five_star_comment_per     -- '5星级评价数量占比'\\n    ,max(part_date)              as  part_date                 -- '分区日期'\\nfrom db_dw_nstc.clife_nstc_dws_order_detail_comment_info\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','') \\ngroup by product_id, substr(comment_day,0,7)\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ads_order_detail_comment_info_m\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ads_order_detail_comment_info_d\"]},{\"type\":\"SQL\",\"id\":\"tasks-38538\",\"name\":\"clife_nstc_ads_order_detail_info_d\",\"params\":{\"type\":\"HIVE\",\"datasource\":162,\"sql\":\"insert overwrite table db_ads_nstc.clife_nstc_ads_order_detail_info_d partition(part_date)\\nselect\\n     product_id                                    -- '产品id'\\n    ,order_detail_day                              -- '订单创建日期（日）'\\n    ,max(product_name)    as product_name          -- '货品名' \\n    ,sum(sale_cnt      )  as sale_cnt              -- '购买次数'\\n    ,sum(total_cnt     )  as total_cnt             -- '购买总量'\\n    ,sum(if(total_recom_xq is null, 0, total_recom_xq))  as total_recom_xq        -- '邮费总额'\\n    ,sum(sku_cnt       )  as sku_cnt               -- 'SKU数'\\n    ,sum(if(total_price is null, 0, total_price)   )     as total_price           -- '消费总额'\\n    ,sum(total_back_cnt)  as total_back_cnt        -- '退货数量'\\n    ,sum(back_cnt      )  as back_cnt              -- '退货次数'\\n    ,max(part_date)       as part_date             -- '分区日期'\\nfrom db_dw_nstc.clife_nstc_dws_order_detail_info\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','') \\ngroup by product_id, order_detail_day\\n\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ads_order_detail_info_d\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ads_order_detail_comment_info_y\"]},{\"type\":\"SQL\",\"id\":\"tasks-20992\",\"name\":\"clife_nstc_ads_order_detail_info_m\",\"params\":{\"type\":\"HIVE\",\"datasource\":162,\"sql\":\"\\ninsert overwrite table db_ads_nstc.clife_nstc_ads_order_detail_info_m partition(part_date)\\nselect\\n     product_id                                               -- '产品id'\\n    ,substr(order_detail_day,0,7)   as order_detail_month     -- '订单创建日期（月）'\\n    ,max(product_name)              as product_name           -- '货品名' \\n    ,sum(sale_cnt      )            as sale_cnt               -- '购买次数'\\n    ,sum(total_cnt     )            as total_cnt              -- '购买总量'\\n    ,sum(if(total_recom_xq is null, 0, total_recom_xq))  as total_recom_xq        -- '邮费总额'\\n    ,sum(sku_cnt       )            as sku_cnt               -- 'SKU数'\\n    ,sum(if(total_price is null, 0, total_price)   )     as total_price           -- '消费总额'\\n    ,sum(total_back_cnt)            as total_back_cnt        -- '退货数量'\\n    ,sum(back_cnt      )            as back_cnt              -- '退货次数'\\n    ,max(part_date)                 as part_date             -- '分区日期'\\nfrom db_dw_nstc.clife_nstc_dws_order_detail_info\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','') \\ngroup by product_id, substr(order_detail_day,0,7)\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ads_order_detail_info_m\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ads_order_detail_info_d\"]},{\"type\":\"SQL\",\"id\":\"tasks-55113\",\"name\":\"clife_nstc_ads_order_detail_info_y\",\"params\":{\"type\":\"HIVE\",\"datasource\":162,\"sql\":\"insert overwrite table db_ads_nstc.clife_nstc_ads_order_detail_info_y partition(part_date)\\nselect\\n     product_id                                              -- '产品id'\\n    ,substr(order_detail_day,0,4)   as order_detail_year     -- '订单创建日期（年）'\\n    ,max(product_name)              as product_name          -- '货品名' \\n    ,sum(sale_cnt      )            as sale_cnt              -- '购买次数'\\n    ,sum(total_cnt     )            as total_cnt             -- '购买总量'\\n    ,sum(if(total_recom_xq is null, 0, total_recom_xq))  as total_recom_xq        -- '邮费总额'\\n    ,sum(sku_cnt       )            as sku_cnt               -- 'SKU数'\\n    ,sum(if(total_price is null, 0, total_price)   )     as total_price           -- '消费总额'\\n    ,sum(total_back_cnt)            as total_back_cnt        -- '退货数量'\\n    ,sum(back_cnt      )            as back_cnt              -- '退货次数'\\n    ,max(part_date)                 as part_date             -- '分区日期'\\nfrom db_dw_nstc.clife_nstc_dws_order_detail_info\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','') \\ngroup by product_id, substr(order_detail_day,0,4)\\n\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ads_order_detail_info_y\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ads_order_detail_info_m\"]},{\"type\":\"SQL\",\"id\":\"tasks-87425\",\"name\":\"clife_nstc_ads_order_by_shop_d\",\"params\":{\"type\":\"HIVE\",\"datasource\":162,\"sql\":\"insert overwrite table db_ads_nstc.clife_nstc_ads_order_by_shop_d partition(part_date)\\nselect\\n     shop_id                    --店铺id\\n    ,date_time                  --业务日期\\n    ,shop_name                  --店铺名称\\n    ,shop_main                  --店铺主营品种\\n    ,shop_address               --店铺地址\\n    ,coalesce(bug_product_num,0)           as bug_product_num           --产品购买量\\n    ,coalesce(bug_goods_num,0)             as bug_goods_num             --商品够买量\\n    ,coalesce(order_num,0)                 as order_num                 --下单总数\\n    ,coalesce(discuss_order_num,0)         as discuss_order_num         --商议订单数\\n    ,coalesce(wait_pay_order_num,0)        as wait_pay_order_num        --待支付订单数\\n    ,coalesce(wait_delivery_order_num,0)   as wait_delivery_order_num   --待发货订单数\\n    ,coalesce(wait_receiv_order_num,0)     as wait_receiv_order_num     --待收货订单数\\n    ,coalesce(wait_evaluation_order_num,0) as wait_evaluation_order_num --待评价订单数\\n    ,coalesce(return_order_o_num,0)        as return_order_o_num        --退货中订单数\\n    ,coalesce(return_order_s_num,0)        as return_order_s_num        --退货成功订单数\\n    ,coalesce(complete_order_num,0)        as complete_order_num        --订单完成订单数\\n    ,coalesce(complete_cancel_num,0)       as complete_cancel_num       --订单取消订单数\\n    ,coalesce(order_price_all,0)           as order_price_all           --订单总额\\n    ,coalesce(sub_money_all,0)             as sub_money_all             --优惠金额\\n    ,coalesce(payment,0)                   as payment                   --实付金额\\n    ,coalesce(pay_order_num,0)             as pay_order_num             --支付订单总数\\n    ,coalesce(no_pay_order_num,0)          as no_pay_order_num          --未支付订单数\\n    ,coalesce(wechar_pay_order_num,0)      as wechar_pay_order_num      --微信支付订单数\\n    ,coalesce(alipay_pay_order_num,0)      as alipay_pay_order_num      --支付宝支付订单数\\n    ,coalesce(app_pay_order_num,0)         as app_pay_order_num         --小程序支付订单数\\n    ,coalesce(icbc_app_pay_num,0)          as icbc_app_pay_num          --工行app支付订单数\\n    ,coalesce(icbc_pc_pay_num,0)           as icbc_pc_pay_num           --工行pc支付订单数\\n    ,coalesce(order_post,0)                as order_post                --邮费总额\\n    ,coalesce(shipping_order_num,0)        as shipping_order_num        --发货订单数\\n    ,coalesce(company_shipping_num,0)      as company_shipping_num      --发公司物流类型订单数\\n    ,coalesce(personal_shipping_num,0)     as personal_shipping_num     --发个人物流类型订单数\\n    ,coalesce(no_remind_shipping_num,0)    as no_remind_shipping_num    --发货未提醒数\\n    ,coalesce(remind_shipping_num,0)       as remind_shipping_num       --发货提醒数\\n    ,coalesce(receiving_order_num,0)       as receiving_order_num       --收货订单数\\n    ,coalesce(appeal_order_num,0)          as appeal_order_num          --申诉订单数\\n    ,coalesce(no_deal_appeal_num,0)        as no_deal_appeal_num        --申诉未处理订单数\\n    ,coalesce(deal_appeal_order_num,0)     as deal_appeal_order_num     --申诉已处理订单数\\n    ,coalesce(return_order_num,0)          as return_order_num          --退货订单总数\\n    ,coalesce(back_price_all,0)            as back_price_all            --退款总金额\\n    ,coalesce(unshipped_refunded_num,0)    as unshipped_refunded_num    --未发货退款订单数\\n    ,coalesce(shipped_no_received_num,0)   as shipped_no_received_num   --已发货未收到货退款订单数\\n    ,coalesce(received_back_num,0)         as received_back_num         --收到货仅退款订单数\\n    ,coalesce(received_pay_back_num,0)     as received_pay_back_num    --收到货退货退款订单数\\n    ,coalesce(company_back_num,0)          as company_back_num          --退货公司物流订单数\\n    ,coalesce(personal_back_num,0)         as personal_back_num         --退货个人找车订单数\\n    ,coalesce(inreview_back_num,0)         as inreview_back_num         --退货审核中订单数\\n    ,coalesce(agree_back_num,0)            as agree_back_num            --退货同意订单数\\n    ,coalesce(refuse_back_num,0)           as refuse_back_num           --退货拒绝订单数\\n    ,coalesce(evaluation_order_num,0)      as evaluation_order_num      --完成评价数\\n    ,coalesce(no_evaluation_num,0)         as no_evaluation_num         --未完成评价数\\n    ,coalesce(deal_complete_back_num,0)    as deal_complete_back_num    --退货订单交易完成数\\n    ,coalesce(deal_complete_no_back_num,0) as deal_complete_no_back_num --没有退货订单交易完成数\\n    ,coalesce(deal_complete_num,0)         as deal_complete_num         --交易完成订单数\\n    ,coalesce(evaluation_order_num / order_num,0) as evaluation_rate --订单完成评价类型数量占比\\n    ,coalesce(no_evaluation_num / order_num,0) as  no_evaluation_rate   --订单未评价类型数量占比\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom\\n(\\n  select \\n       shop_id                    --店铺id\\n      ,date_time                  --业务日期\\n      ,max(shop_name)  as shop_name                --店铺名称\\n      ,max(shop_main)  as shop_main                --店铺主营品种\\n      ,max(shop_address) as  shop_address          --店铺地址\\n      ,sum(bug_product_num)            as bug_product_num          --产品购买量\\n      ,sum(bug_goods_num)              as bug_goods_num            --商品够买量\\n      ,sum(order_num)                  as order_num                --下单总数\\n      ,sum(discuss_order_num)          as discuss_order_num        --商议订单数\\n      ,sum(wait_pay_order_num)         as wait_pay_order_num       --待支付订单数\\n      ,sum(wait_delivery_order_num)    as wait_delivery_order_num  --待发货订单数\\n      ,sum(wait_receiv_order_num)      as wait_receiv_order_num    --待收货订单数\\n      ,sum(wait_evaluation_order_num)  as wait_evaluation_order_num--待评价订单数\\n      ,sum(return_order_o_num)         as return_order_o_num       --退货中订单数\\n      ,sum(return_order_s_num)         as return_order_s_num       --退货成功订单数\\n      ,sum(complete_order_num)         as complete_order_num       --订单完成订单数\\n      ,sum(complete_cancel_num)        as complete_cancel_num      --订单取消订单数\\n      ,sum(order_price_all)            as order_price_all          --订单总额\\n      ,sum(sub_money_all)              as sub_money_all            --优惠金额\\n      ,sum(payment)                    as payment                  --实付金额\\n      ,sum(pay_order_num)              as pay_order_num            --支付订单总数\\n      ,sum(no_pay_order_num)           as no_pay_order_num         --未支付订单数\\n      ,sum(wechar_pay_order_num)       as wechar_pay_order_num     --微信支付订单数\\n      ,sum(alipay_pay_order_num)       as alipay_pay_order_num     --支付宝支付订单数\\n      ,sum(app_pay_order_num)          as app_pay_order_num        --小程序支付订单数\\n      ,sum(icbc_app_pay_num)           as icbc_app_pay_num         --工行app支付订单数\\n      ,sum(icbc_pc_pay_num)            as icbc_pc_pay_num          --工行pc支付订单数\\n      ,sum(order_post)                 as order_post               --邮费总额\\n      ,sum(shipping_order_num)         as shipping_order_num       --发货订单数\\n      ,sum(company_shipping_num)       as company_shipping_num     --发公司物流类型订单数\\n      ,sum(personal_shipping_num)      as personal_shipping_num    --发个人物流类型订单数\\n      ,sum(no_remind_shipping_num)     as no_remind_shipping_num   --发货未提醒数\\n      ,sum(remind_shipping_num)        as remind_shipping_num      --发货提醒数\\n      ,sum(receiving_order_num)        as receiving_order_num      --收货订单数\\n      ,sum(appeal_order_num)           as appeal_order_num         --申诉订单数\\n      ,sum(no_deal_appeal_num)         as no_deal_appeal_num       --申诉未处理订单数\\n      ,sum(deal_appeal_order_num)      as deal_appeal_order_num    --申诉已处理订单数\\n      ,sum(return_order_num)           as return_order_num         --退货订单总数\\n      ,sum(back_price_all)             as back_price_all           --退款总金额\\n      ,sum(unshipped_refunded_num)     as unshipped_refunded_num   --未发货退款订单数\\n      ,sum(shipped_no_received_num)    as shipped_no_received_num  --已发货未收到货退款订单数\\n      ,sum(received_back_num)          as received_back_num        --收到货仅退款订单数\\n      ,sum(received_pay_back_num)      as received_pay_back_num    --收到货退货退款订单数\\n      ,sum(company_back_num)           as company_back_num         --退货公司物流订单数\\n      ,sum(personal_back_num)          as personal_back_num        --退货个人找车订单数\\n      ,sum(inreview_back_num)          as inreview_back_num        --退货审核中订单数\\n      ,sum(agree_back_num)             as agree_back_num           --退货同意订单数\\n      ,sum(refuse_back_num)            as refuse_back_num          --退货拒绝订单数\\n      ,sum(evaluation_order_num)       as evaluation_order_num     --完成评价数\\n      ,sum(no_evaluation_num)          as no_evaluation_num        --未完成评价数\\n      ,sum(deal_complete_back_num )    as deal_complete_back_num   --退货订单交易完成数\\n      ,sum(deal_complete_no_back_num)  as deal_complete_no_back_num--没有退货订单交易完成数\\n      ,sum(deal_complete_num)          as deal_complete_num        --交易完成订单数\\n  from db_dw_nstc.clife_nstc_dws_order_converge\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by shop_id\\n          ,date_time\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ads_order_detail_info_y\"]},{\"type\":\"SQL\",\"id\":\"tasks-14044\",\"name\":\"clife_nstc_ads_order_by_shop_m\",\"params\":{\"type\":\"HIVE\",\"datasource\":162,\"sql\":\"insert overwrite table db_ads_nstc.clife_nstc_ads_order_by_shop_m partition(part_date)\\nselect\\n     shop_id                    --店铺id\\n    ,month_date                 --业务日期\\n    ,shop_name                  --店铺名称\\n    ,shop_main                  --店铺主营品种\\n    ,shop_address               --店铺地址\\n    ,coalesce(bug_product_num,0)           as bug_product_num           --产品购买量\\n    ,coalesce(bug_goods_num,0)             as bug_goods_num             --商品够买量\\n    ,coalesce(order_num,0)                 as order_num                 --下单总数\\n    ,coalesce(discuss_order_num,0)         as discuss_order_num         --商议订单数\\n    ,coalesce(wait_pay_order_num,0)        as wait_pay_order_num        --待支付订单数\\n    ,coalesce(wait_delivery_order_num,0)   as wait_delivery_order_num   --待发货订单数\\n    ,coalesce(wait_receiv_order_num,0)     as wait_receiv_order_num     --待收货订单数\\n    ,coalesce(wait_evaluation_order_num,0) as wait_evaluation_order_num --待评价订单数\\n    ,coalesce(return_order_o_num,0)        as return_order_o_num        --退货中订单数\\n    ,coalesce(return_order_s_num,0)        as return_order_s_num        --退货成功订单数\\n    ,coalesce(complete_order_num,0)        as complete_order_num        --订单完成订单数\\n    ,coalesce(complete_cancel_num,0)       as complete_cancel_num       --订单取消订单数\\n    ,coalesce(order_price_all,0)           as order_price_all           --订单总额\\n    ,coalesce(sub_money_all,0)             as sub_money_all             --优惠金额\\n    ,coalesce(payment,0)                   as payment                   --实付金额\\n    ,coalesce(pay_order_num,0)             as pay_order_num             --支付订单总数\\n    ,coalesce(no_pay_order_num,0)          as no_pay_order_num          --未支付订单数\\n    ,coalesce(wechar_pay_order_num,0)      as wechar_pay_order_num      --微信支付订单数\\n    ,coalesce(alipay_pay_order_num,0)      as alipay_pay_order_num      --支付宝支付订单数\\n    ,coalesce(app_pay_order_num,0)         as app_pay_order_num         --小程序支付订单数\\n    ,coalesce(icbc_app_pay_num,0)          as icbc_app_pay_num          --工行app支付订单数\\n    ,coalesce(icbc_pc_pay_num,0)           as icbc_pc_pay_num           --工行pc支付订单数\\n    ,coalesce(order_post,0)                as order_post                --邮费总额\\n    ,coalesce(shipping_order_num,0)        as shipping_order_num        --发货订单数\\n    ,coalesce(company_shipping_num,0)      as company_shipping_num      --发公司物流类型订单数\\n    ,coalesce(personal_shipping_num,0)     as personal_shipping_num     --发个人物流类型订单数\\n    ,coalesce(no_remind_shipping_num,0)    as no_remind_shipping_num    --发货未提醒数\\n    ,coalesce(remind_shipping_num,0)       as remind_shipping_num       --发货提醒数\\n    ,coalesce(receiving_order_num,0)       as receiving_order_num       --收货订单数\\n    ,coalesce(appeal_order_num,0)          as appeal_order_num          --申诉订单数\\n    ,coalesce(no_deal_appeal_num,0)        as no_deal_appeal_num        --申诉未处理订单数\\n    ,coalesce(deal_appeal_order_num,0)     as deal_appeal_order_num     --申诉已处理订单数\\n    ,coalesce(return_order_num,0)          as return_order_num          --退货订单总数\\n    ,coalesce(back_price_all,0)            as back_price_all            --退款总金额\\n    ,coalesce(unshipped_refunded_num,0)    as unshipped_refunded_num    --未发货退款订单数\\n    ,coalesce(shipped_no_received_num,0)   as shipped_no_received_num   --已发货未收到货退款订单数\\n    ,coalesce(received_back_num,0)         as received_back_num         --收到货仅退款订单数\\n    ,coalesce(received_pay_back_num,0)     as received_pay_back_num    --收到货退货退款订单数\\n    ,coalesce(company_back_num,0)          as company_back_num          --退货公司物流订单数\\n    ,coalesce(personal_back_num,0)         as personal_back_num         --退货个人找车订单数\\n    ,coalesce(inreview_back_num,0)         as inreview_back_num         --退货审核中订单数\\n    ,coalesce(agree_back_num,0)            as agree_back_num            --退货同意订单数\\n    ,coalesce(refuse_back_num,0)           as refuse_back_num           --退货拒绝订单数\\n    ,coalesce(evaluation_order_num,0)      as evaluation_order_num      --完成评价数\\n    ,coalesce(no_evaluation_num,0)         as no_evaluation_num         --未完成评价数\\n    ,coalesce(deal_complete_back_num,0)    as deal_complete_back_num    --退货订单交易完成数\\n    ,coalesce(deal_complete_no_back_num,0) as deal_complete_no_back_num --没有退货订单交易完成数\\n    ,coalesce(deal_complete_num,0)         as deal_complete_num         --交易完成订单数\\n    ,coalesce(evaluation_order_num / order_num,0) as evaluation_rate --订单完成评价类型数量占比\\n    ,coalesce(no_evaluation_num / order_num,0) as  no_evaluation_rate   --订单未评价类型数量占比\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom\\n(\\n  select \\n       shop_id                    --店铺id\\n      ,substr(date_time,1,7) as month_date         --业务日期\\n      ,max(shop_name)  as shop_name                --店铺名称\\n      ,max(shop_main)  as shop_main                --店铺主营品种\\n      ,max(shop_address) as  shop_address          --店铺地址\\n      ,sum(bug_product_num)            as bug_product_num          --产品购买量\\n      ,sum(bug_goods_num)              as bug_goods_num            --商品够买量\\n      ,sum(order_num)                  as order_num                --下单总数\\n      ,sum(discuss_order_num)          as discuss_order_num        --商议订单数\\n      ,sum(wait_pay_order_num)         as wait_pay_order_num       --待支付订单数\\n      ,sum(wait_delivery_order_num)    as wait_delivery_order_num  --待发货订单数\\n      ,sum(wait_receiv_order_num)      as wait_receiv_order_num    --待收货订单数\\n      ,sum(wait_evaluation_order_num)  as wait_evaluation_order_num--待评价订单数\\n      ,sum(return_order_o_num)         as return_order_o_num       --退货中订单数\\n      ,sum(return_order_s_num)         as return_order_s_num       --退货成功订单数\\n      ,sum(complete_order_num)         as complete_order_num       --订单完成订单数\\n      ,sum(complete_cancel_num)        as complete_cancel_num      --订单取消订单数\\n      ,sum(order_price_all)            as order_price_all          --订单总额\\n      ,sum(sub_money_all)              as sub_money_all            --优惠金额\\n      ,sum(payment)                    as payment                  --实付金额\\n      ,sum(pay_order_num)              as pay_order_num            --支付订单总数\\n      ,sum(no_pay_order_num)           as no_pay_order_num         --未支付订单数\\n      ,sum(wechar_pay_order_num)       as wechar_pay_order_num     --微信支付订单数\\n      ,sum(alipay_pay_order_num)       as alipay_pay_order_num     --支付宝支付订单数\\n      ,sum(app_pay_order_num)          as app_pay_order_num        --小程序支付订单数\\n      ,sum(icbc_app_pay_num)           as icbc_app_pay_num         --工行app支付订单数\\n      ,sum(icbc_pc_pay_num)            as icbc_pc_pay_num          --工行pc支付订单数\\n      ,sum(order_post)                 as order_post               --邮费总额\\n      ,sum(shipping_order_num)         as shipping_order_num       --发货订单数\\n      ,sum(company_shipping_num)       as company_shipping_num     --发公司物流类型订单数\\n      ,sum(personal_shipping_num)      as personal_shipping_num    --发个人物流类型订单数\\n      ,sum(no_remind_shipping_num)     as no_remind_shipping_num   --发货未提醒数\\n      ,sum(remind_shipping_num)        as remind_shipping_num      --发货提醒数\\n      ,sum(receiving_order_num)        as receiving_order_num      --收货订单数\\n      ,sum(appeal_order_num)           as appeal_order_num         --申诉订单数\\n      ,sum(no_deal_appeal_num)         as no_deal_appeal_num       --申诉未处理订单数\\n      ,sum(deal_appeal_order_num)      as deal_appeal_order_num    --申诉已处理订单数\\n      ,sum(return_order_num)           as return_order_num         --退货订单总数\\n      ,sum(back_price_all)             as back_price_all           --退款总金额\\n      ,sum(unshipped_refunded_num)     as unshipped_refunded_num   --未发货退款订单数\\n      ,sum(shipped_no_received_num)    as shipped_no_received_num  --已发货未收到货退款订单数\\n      ,sum(received_back_num)          as received_back_num        --收到货仅退款订单数\\n      ,sum(received_pay_back_num)      as received_pay_back_num    --收到货退货退款订单数\\n      ,sum(company_back_num)           as company_back_num         --退货公司物流订单数\\n      ,sum(personal_back_num)          as personal_back_num        --退货个人找车订单数\\n      ,sum(inreview_back_num)          as inreview_back_num        --退货审核中订单数\\n      ,sum(agree_back_num)             as agree_back_num           --退货同意订单数\\n      ,sum(refuse_back_num)            as refuse_back_num          --退货拒绝订单数\\n      ,sum(evaluation_order_num)       as evaluation_order_num     --完成评价数\\n      ,sum(no_evaluation_num)          as no_evaluation_num        --未完成评价数\\n      ,sum(deal_complete_back_num )    as deal_complete_back_num   --退货订单交易完成数\\n      ,sum(deal_complete_no_back_num)  as deal_complete_no_back_num--没有退货订单交易完成数\\n      ,sum(deal_complete_num)          as deal_complete_num        --交易完成订单数\\n  from db_dw_nstc.clife_nstc_dws_order_converge\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by shop_id\\n          ,substr(date_time,1,7)\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ads_order_by_shop_d\"]},{\"type\":\"SQL\",\"id\":\"tasks-98694\",\"name\":\"clife_nstc_ads_order_by_shop_y\",\"params\":{\"type\":\"HIVE\",\"datasource\":162,\"sql\":\"insert overwrite table db_ads_nstc.clife_nstc_ads_order_by_shop_y partition(part_date)\\nselect\\n     shop_id                    --店铺id\\n    ,year_date                 --业务日期\\n    ,shop_name                  --店铺名称\\n    ,shop_main                  --店铺主营品种\\n    ,shop_address               --店铺地址\\n    ,coalesce(bug_product_num,0)           as bug_product_num           --产品购买量\\n    ,coalesce(bug_goods_num,0)             as bug_goods_num             --商品够买量\\n    ,coalesce(order_num,0)                 as order_num                 --下单总数\\n    ,coalesce(discuss_order_num,0)         as discuss_order_num         --商议订单数\\n    ,coalesce(wait_pay_order_num,0)        as wait_pay_order_num        --待支付订单数\\n    ,coalesce(wait_delivery_order_num,0)   as wait_delivery_order_num   --待发货订单数\\n    ,coalesce(wait_receiv_order_num,0)     as wait_receiv_order_num     --待收货订单数\\n    ,coalesce(wait_evaluation_order_num,0) as wait_evaluation_order_num --待评价订单数\\n    ,coalesce(return_order_o_num,0)        as return_order_o_num        --退货中订单数\\n    ,coalesce(return_order_s_num,0)        as return_order_s_num        --退货成功订单数\\n    ,coalesce(complete_order_num,0)        as complete_order_num        --订单完成订单数\\n    ,coalesce(complete_cancel_num,0)       as complete_cancel_num       --订单取消订单数\\n    ,coalesce(order_price_all,0)           as order_price_all           --订单总额\\n    ,coalesce(sub_money_all,0)             as sub_money_all             --优惠金额\\n    ,coalesce(payment,0)                   as payment                   --实付金额\\n    ,coalesce(pay_order_num,0)             as pay_order_num             --支付订单总数\\n    ,coalesce(no_pay_order_num,0)          as no_pay_order_num          --未支付订单数\\n    ,coalesce(wechar_pay_order_num,0)      as wechar_pay_order_num      --微信支付订单数\\n    ,coalesce(alipay_pay_order_num,0)      as alipay_pay_order_num      --支付宝支付订单数\\n    ,coalesce(app_pay_order_num,0)         as app_pay_order_num         --小程序支付订单数\\n    ,coalesce(icbc_app_pay_num,0)          as icbc_app_pay_num          --工行app支付订单数\\n    ,coalesce(icbc_pc_pay_num,0)           as icbc_pc_pay_num           --工行pc支付订单数\\n    ,coalesce(order_post,0)                as order_post                --邮费总额\\n    ,coalesce(shipping_order_num,0)        as shipping_order_num        --发货订单数\\n    ,coalesce(company_shipping_num,0)      as company_shipping_num      --发公司物流类型订单数\\n    ,coalesce(personal_shipping_num,0)     as personal_shipping_num     --发个人物流类型订单数\\n    ,coalesce(no_remind_shipping_num,0)    as no_remind_shipping_num    --发货未提醒数\\n    ,coalesce(remind_shipping_num,0)       as remind_shipping_num       --发货提醒数\\n    ,coalesce(receiving_order_num,0)       as receiving_order_num       --收货订单数\\n    ,coalesce(appeal_order_num,0)          as appeal_order_num          --申诉订单数\\n    ,coalesce(no_deal_appeal_num,0)        as no_deal_appeal_num        --申诉未处理订单数\\n    ,coalesce(deal_appeal_order_num,0)     as deal_appeal_order_num     --申诉已处理订单数\\n    ,coalesce(return_order_num,0)          as return_order_num          --退货订单总数\\n    ,coalesce(back_price_all,0)            as back_price_all            --退款总金额\\n    ,coalesce(unshipped_refunded_num,0)    as unshipped_refunded_num    --未发货退款订单数\\n    ,coalesce(shipped_no_received_num,0)   as shipped_no_received_num   --已发货未收到货退款订单数\\n    ,coalesce(received_back_num,0)         as received_back_num         --收到货仅退款订单数\\n    ,coalesce(received_pay_back_num,0)     as received_pay_back_num    --收到货退货退款订单数\\n    ,coalesce(company_back_num,0)          as company_back_num          --退货公司物流订单数\\n    ,coalesce(personal_back_num,0)         as personal_back_num         --退货个人找车订单数\\n    ,coalesce(inreview_back_num,0)         as inreview_back_num         --退货审核中订单数\\n    ,coalesce(agree_back_num,0)            as agree_back_num            --退货同意订单数\\n    ,coalesce(refuse_back_num,0)           as refuse_back_num           --退货拒绝订单数\\n    ,coalesce(evaluation_order_num,0)      as evaluation_order_num      --完成评价数\\n    ,coalesce(no_evaluation_num,0)         as no_evaluation_num         --未完成评价数\\n    ,coalesce(deal_complete_back_num,0)    as deal_complete_back_num    --退货订单交易完成数\\n    ,coalesce(deal_complete_no_back_num,0) as deal_complete_no_back_num --没有退货订单交易完成数\\n    ,coalesce(deal_complete_num,0)         as deal_complete_num         --交易完成订单数\\n    ,coalesce(evaluation_order_num / order_num,0) as evaluation_rate --订单完成评价类型数量占比\\n    ,coalesce(no_evaluation_num / order_num,0) as  no_evaluation_rate   --订单未评价类型数量占比\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom\\n(\\n  select \\n       shop_id                    --店铺id\\n      ,substr(date_time,1,4) as year_date         --业务日期\\n      ,max(shop_name)  as shop_name                --店铺名称\\n      ,max(shop_main)  as shop_main                --店铺主营品种\\n      ,max(shop_address) as  shop_address          --店铺地址\\n      ,sum(bug_product_num)            as bug_product_num          --产品购买量\\n      ,sum(bug_goods_num)              as bug_goods_num            --商品够买量\\n      ,sum(order_num)                  as order_num                --下单总数\\n      ,sum(discuss_order_num)          as discuss_order_num        --商议订单数\\n      ,sum(wait_pay_order_num)         as wait_pay_order_num       --待支付订单数\\n      ,sum(wait_delivery_order_num)    as wait_delivery_order_num  --待发货订单数\\n      ,sum(wait_receiv_order_num)      as wait_receiv_order_num    --待收货订单数\\n      ,sum(wait_evaluation_order_num)  as wait_evaluation_order_num--待评价订单数\\n      ,sum(return_order_o_num)         as return_order_o_num       --退货中订单数\\n      ,sum(return_order_s_num)         as return_order_s_num       --退货成功订单数\\n      ,sum(complete_order_num)         as complete_order_num       --订单完成订单数\\n      ,sum(complete_cancel_num)        as complete_cancel_num      --订单取消订单数\\n      ,sum(order_price_all)            as order_price_all          --订单总额\\n      ,sum(sub_money_all)              as sub_money_all            --优惠金额\\n      ,sum(payment)                    as payment                  --实付金额\\n      ,sum(pay_order_num)              as pay_order_num            --支付订单总数\\n      ,sum(no_pay_order_num)           as no_pay_order_num         --未支付订单数\\n      ,sum(wechar_pay_order_num)       as wechar_pay_order_num     --微信支付订单数\\n      ,sum(alipay_pay_order_num)       as alipay_pay_order_num     --支付宝支付订单数\\n      ,sum(app_pay_order_num)          as app_pay_order_num        --小程序支付订单数\\n      ,sum(icbc_app_pay_num)           as icbc_app_pay_num         --工行app支付订单数\\n      ,sum(icbc_pc_pay_num)            as icbc_pc_pay_num          --工行pc支付订单数\\n      ,sum(order_post)                 as order_post               --邮费总额\\n      ,sum(shipping_order_num)         as shipping_order_num       --发货订单数\\n      ,sum(company_shipping_num)       as company_shipping_num     --发公司物流类型订单数\\n      ,sum(personal_shipping_num)      as personal_shipping_num    --发个人物流类型订单数\\n      ,sum(no_remind_shipping_num)     as no_remind_shipping_num   --发货未提醒数\\n      ,sum(remind_shipping_num)        as remind_shipping_num      --发货提醒数\\n      ,sum(receiving_order_num)        as receiving_order_num      --收货订单数\\n      ,sum(appeal_order_num)           as appeal_order_num         --申诉订单数\\n      ,sum(no_deal_appeal_num)         as no_deal_appeal_num       --申诉未处理订单数\\n      ,sum(deal_appeal_order_num)      as deal_appeal_order_num    --申诉已处理订单数\\n      ,sum(return_order_num)           as return_order_num         --退货订单总数\\n      ,sum(back_price_all)             as back_price_all           --退款总金额\\n      ,sum(unshipped_refunded_num)     as unshipped_refunded_num   --未发货退款订单数\\n      ,sum(shipped_no_received_num)    as shipped_no_received_num  --已发货未收到货退款订单数\\n      ,sum(received_back_num)          as received_back_num        --收到货仅退款订单数\\n      ,sum(received_pay_back_num)      as received_pay_back_num    --收到货退货退款订单数\\n      ,sum(company_back_num)           as company_back_num         --退货公司物流订单数\\n      ,sum(personal_back_num)          as personal_back_num        --退货个人找车订单数\\n      ,sum(inreview_back_num)          as inreview_back_num        --退货审核中订单数\\n      ,sum(agree_back_num)             as agree_back_num           --退货同意订单数\\n      ,sum(refuse_back_num)            as refuse_back_num          --退货拒绝订单数\\n      ,sum(evaluation_order_num)       as evaluation_order_num     --完成评价数\\n      ,sum(no_evaluation_num)          as no_evaluation_num        --未完成评价数\\n      ,sum(deal_complete_back_num )    as deal_complete_back_num   --退货订单交易完成数\\n      ,sum(deal_complete_no_back_num)  as deal_complete_no_back_num--没有退货订单交易完成数\\n      ,sum(deal_complete_num)          as deal_complete_num        --交易完成订单数\\n  from db_dw_nstc.clife_nstc_dws_order_converge\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by shop_id\\n          ,substr(date_time,1,4)\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ads_order_by_shop_m\"]},{\"type\":\"SQL\",\"id\":\"tasks-37566\",\"name\":\"clife_nstc_ads_event_by_object_d\",\"params\":{\"type\":\"HIVE\",\"datasource\":162,\"sql\":\"insert overwrite table db_ads_nstc.clife_nstc_ads_event_by_object_d partition(part_date)\\nselect \\n     object_id     --被操作对象id\\n    ,date_time     --业务日期\\n    ,max(object_type)        as  object_type  --对象类型\\n    ,max(object_name)        as  object_name  --被操作对象名称\\n    ,sum(browse_num)    as browse_num    --浏览量\\n    ,sum(attention_num) as attention_num --关注量\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_dw_nstc.clife_nstc_dws_event_converge\\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','')\\ngroup by  object_id\\n         ,date_time\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ads_order_by_shop_y\"]},{\"type\":\"SQL\",\"id\":\"tasks-8250\",\"name\":\"clife_nstc_ads_event_by_object_m\",\"params\":{\"type\":\"HIVE\",\"datasource\":162,\"sql\":\"insert overwrite table db_ads_nstc.clife_nstc_ads_event_by_object_m partition(part_date)\\nselect \\n     object_id     --被操作对象id\\n    ,substr(date_time,1,7) as month_date     --业务日期\\n    ,max(object_type)        as  object_type  --对象类型\\n    ,max(object_name)        as  object_name  --被操作对象名称\\n    ,sum(browse_num)    as browse_num    --浏览量\\n    ,sum(attention_num) as attention_num --关注量\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_dw_nstc.clife_nstc_dws_event_converge\\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','')\\ngroup by  object_id\\n         ,substr(date_time,1,7)\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ads_event_by_object_d\"]},{\"type\":\"SQL\",\"id\":\"tasks-8-5oi3nh\",\"name\":\"clife_nstc_ads_event_by_object_y\",\"params\":{\"type\":\"HIVE\",\"datasource\":162,\"sql\":\"insert overwrite table db_ads_nstc.clife_nstc_ads_event_by_object_y partition(part_date)\\nselect \\n     object_id     --被操作对象id\\n    ,substr(date_time,1,4) as year_date     --业务日期\\n    ,max(object_type)        as  object_type  --对象类型\\n    ,max(object_name)        as  object_name  --被操作对象名称\\n    ,sum(browse_num)    as browse_num    --浏览量\\n    ,sum(attention_num) as attention_num --关注量\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_dw_nstc.clife_nstc_dws_event_converge\\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','')\\ngroup by  object_id\\n         ,substr(date_time,1,4)\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ads_event_by_object_m\"]},{\"type\":\"SQL\",\"id\":\"tasks-8-11a3dr\",\"name\":\"clife_nstc_ads_order_detail_info_f\",\"params\":{\"type\":\"HIVE\",\"datasource\":162,\"sql\":\"insert overwrite table db_ads_nstc.clife_nstc_ads_order_detail_info_f partition(part_date)\\nselect\\n     sum(sale_cnt)        as sale_cnt              -- '购买次数'\\n    ,sum(total_cnt)       as total_cnt             -- '购买总量'\\n    ,sum(if(total_recom_xq is null, 0, total_recom_xq))  as total_recom_xq        -- '邮费总额'\\n    ,sum(sku_cnt )        as sku_cnt               -- 'SKU数'\\n    ,sum(if(total_price is null, 0, total_price)   )     as total_price           -- '消费总额'\\n    ,sum(total_back_cnt)  as total_back_cnt        -- '退货数量'\\n    ,sum(back_cnt)        as back_cnt              -- '退货次数'\\n    ,max(part_date)       as part_date             -- '分区日期'\\nfrom db_dw_nstc.clife_nstc_dws_order_detail_info\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','') \",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ads_event_by_object_y\"]},{\"type\":\"SQL\",\"id\":\"tasks-8-3no7ik\",\"name\":\"clife_nstc_ads_order_detail_comment_info_f\",\"params\":{\"type\":\"HIVE\",\"datasource\":162,\"sql\":\"insert overwrite table db_ads_nstc.clife_nstc_ads_order_detail_comment_info_f partition(part_date)\\nselect\\n     comment_cnt               -- '评价数'\\n    ,zero_star_comment_cnt     -- '0星级评价数量'\\n    ,one_star_comment_cnt      -- '1星级评价数量'\\n    ,two_star_comment_cnt      -- '2星级评价数量'\\n    ,three_star_comment_cnt    -- '3星级评价数量'\\n    ,four_star_comment_cnt     -- '4星级评价数量'\\n    ,five_star_comment_cnt     -- '5星级评价数量'\\n    ,cast(coalesce(zero_star_comment_cnt/comment_cnt,0)  as decimal(5,2))  as  zero_star_comment_per     -- '0星级评价数量占比'\\n    ,cast(coalesce(one_star_comment_cnt/comment_cnt,0)   as decimal(5,2))  as  one_star_comment_per      -- '1星级评价数量占比'\\n    ,cast(coalesce(two_star_comment_cnt/comment_cnt,0)   as decimal(5,2))  as  two_star_comment_per      -- '2星级评价数量占比'\\n    ,cast(coalesce(three_star_comment_cnt/comment_cnt,0) as decimal(5,2))  as  three_star_comment_per    -- '3星级评价数量占比'\\n    ,cast(coalesce(four_star_comment_cnt/comment_cnt,0)  as decimal(5,2))  as  four_star_comment_per     -- '4星级评价数量占比'\\n    ,cast(coalesce(five_star_comment_cnt/comment_cnt,0)  as decimal(5,2))  as  five_star_comment_per     -- '5星级评价数量占比'\\n    ,part_date                 -- '分区日期'\\nfrom\\n(\\n  select\\n       sum(comment_cnt           )                            as  comment_cnt               -- '评价数'\\n      ,sum(zero_star_comment_cnt )                            as  zero_star_comment_cnt     -- '0星级评价数量'\\n      ,sum(one_star_comment_cnt  )                            as  one_star_comment_cnt      -- '1星级评价数量'\\n      ,sum(two_star_comment_cnt  )                            as  two_star_comment_cnt      -- '2星级评价数量'\\n      ,sum(three_star_comment_cnt)                            as  three_star_comment_cnt    -- '3星级评价数量'\\n      ,sum(four_star_comment_cnt )                            as  four_star_comment_cnt     -- '4星级评价数量'\\n      ,sum(five_star_comment_cnt )                            as  five_star_comment_cnt     -- '5星级评价数量'\\n      ,max(part_date)              as  part_date\\n  from db_dw_nstc.clife_nstc_dws_order_detail_comment_info\\n  where part_date = regexp_replace(date_sub(current_date(),1),'-','') \\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ads_order_detail_info_f\"]},{\"type\":\"SQL\",\"id\":\"tasks-8-1jj1lc\",\"name\":\"clife_nstc_ads_deal_message_info_f\",\"params\":{\"type\":\"HIVE\",\"datasource\":162,\"sql\":\"insert overwrite table db_ads_nstc.clife_nstc_ads_deal_message_info_f partition(part_date)\\nselect \\n     sum(purchase_cnt        ) as purchase_cnt                    -- '采购信息数量'\\n    ,sum(suppery_cnt         ) as suppery_cnt                     -- '供应信息数量'\\n    ,sum(rent_cnt            ) as rent_cnt                        -- '车找苗信息数量'\\n    ,sum(lease_cnt           ) as lease_cnt                       -- '苗找车信息数量'\\n    ,sum(purchase_release_cnt) as purchase_release_cnt            -- '采购信息发布中数量'\\n    ,sum(suppery_release_cnt ) as suppery_release_cnt             -- '供应信息发布中数量'\\n    ,sum(rent_release_cnt    ) as rent_release_cnt                -- '车找苗信息发布中数量'\\n    ,sum(lease_release_cnt   ) as lease_release_cnt               -- '苗找车信息发布中数量'\\n    ,sum(purchase_finish_cnt ) as purchase_finish_cnt             -- '采购信息已结束数量'\\n    ,sum(suppery_finish_cnt  ) as suppery_finish_cnt              -- '供应信息已结束数量'\\n    ,sum(rent_finish_cnt     ) as rent_finish_cnt                 -- '车找苗信息已结束数量'\\n    ,sum(lease_finish_cnt    ) as lease_finish_cnt                -- '苗找车信息已结束数量'\\n    ,sum(purchase_return_cnt ) as purchase_return_cnt             -- '采购信息被驳回数量'\\n    ,sum(suppery_return_cnt  ) as suppery_return_cnt              -- '供应信息被驳回数量'\\n    ,sum(rent_return_cnt     ) as rent_return_cnt                 -- '车找苗信息被驳回数量'\\n    ,sum(lease_return_cnt    ) as lease_return_cnt                -- '苗找车信息被驳回数量'\\n    ,sum(purchase_scan_num   ) as purchase_scan_num               -- '采购信息浏览量'\\n    ,sum(suppery_scan_num    ) as suppery_scan_num                -- '供应信息浏览量'\\n    ,sum(rent_scan_num       ) as rent_scan_num                   -- '车找苗信息浏览量'\\n    ,sum(lease_scan_num      ) as lease_scan_num                  -- '苗找车信息浏览量'\\n\\t,max(part_date)            as part_date                       -- '分区日期'\\nfrom db_dw_nstc.clife_nstc_dws_deal_message_info\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','') \",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ads_order_detail_comment_info_f\"]},{\"type\":\"SQL\",\"id\":\"tasks-8-7hz2ew\",\"name\":\"clife_nstc_ads_event_by_object_f\",\"params\":{\"type\":\"HIVE\",\"datasource\":162,\"sql\":\"insert overwrite table db_ads_nstc.clife_nstc_ads_event_by_object_f partition(part_date)\\nselect \\n     object_id     --被操作对象id\\n    ,max(object_type)        as  object_type  --对象类型\\n    ,max(object_name)        as  object_name  --被操作对象名称\\n    ,sum(browse_num)    as browse_num    --浏览量\\n    ,sum(attention_num) as attention_num --关注量\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_dw_nstc.clife_nstc_dws_event_converge\\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','')\\ngroup by  object_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ads_deal_message_info_f\"]},{\"type\":\"SQL\",\"id\":\"tasks-8-37x1lu\",\"name\":\"clife_nstc_ads_order_f\",\"params\":{\"type\":\"HIVE\",\"datasource\":162,\"sql\":\"insert overwrite table db_ads_nstc.clife_nstc_ads_order_f partition(part_date)\\nselect\\n     coalesce(bug_product_num,0)           as bug_product_num           --产品购买量\\n    ,coalesce(bug_goods_num,0)             as bug_goods_num             --商品够买量\\n    ,coalesce(order_num,0)                 as order_num                 --下单总数\\n    ,coalesce(discuss_order_num,0)         as discuss_order_num         --商议订单数\\n    ,coalesce(wait_pay_order_num,0)        as wait_pay_order_num        --待支付订单数\\n    ,coalesce(wait_delivery_order_num,0)   as wait_delivery_order_num   --待发货订单数\\n    ,coalesce(wait_receiv_order_num,0)     as wait_receiv_order_num     --待收货订单数\\n    ,coalesce(wait_evaluation_order_num,0) as wait_evaluation_order_num --待评价订单数\\n    ,coalesce(return_order_o_num,0)        as return_order_o_num        --退货中订单数\\n    ,coalesce(return_order_s_num,0)        as return_order_s_num        --退货成功订单数\\n    ,coalesce(complete_order_num,0)        as complete_order_num        --订单完成订单数\\n    ,coalesce(complete_cancel_num,0)       as complete_cancel_num       --订单取消订单数\\n    ,coalesce(order_price_all,0)           as order_price_all           --订单总额\\n    ,coalesce(sub_money_all,0)             as sub_money_all             --优惠金额\\n    ,coalesce(payment,0)                   as payment                   --实付金额\\n    ,coalesce(pay_order_num,0)             as pay_order_num             --支付订单总数\\n    ,coalesce(no_pay_order_num,0)          as no_pay_order_num          --未支付订单数\\n    ,coalesce(wechar_pay_order_num,0)      as wechar_pay_order_num      --微信支付订单数\\n    ,coalesce(alipay_pay_order_num,0)      as alipay_pay_order_num      --支付宝支付订单数\\n    ,coalesce(app_pay_order_num,0)         as app_pay_order_num         --小程序支付订单数\\n    ,coalesce(icbc_app_pay_num,0)          as icbc_app_pay_num          --工行app支付订单数\\n    ,coalesce(icbc_pc_pay_num,0)           as icbc_pc_pay_num           --工行pc支付订单数\\n    ,coalesce(order_post,0)                as order_post                --邮费总额\\n    ,coalesce(shipping_order_num,0)        as shipping_order_num        --发货订单数\\n    ,coalesce(company_shipping_num,0)      as company_shipping_num      --发公司物流类型订单数\\n    ,coalesce(personal_shipping_num,0)     as personal_shipping_num     --发个人物流类型订单数\\n    ,coalesce(no_remind_shipping_num,0)    as no_remind_shipping_num    --发货未提醒数\\n    ,coalesce(remind_shipping_num,0)       as remind_shipping_num       --发货提醒数\\n    ,coalesce(receiving_order_num,0)       as receiving_order_num       --收货订单数\\n    ,coalesce(appeal_order_num,0)          as appeal_order_num          --申诉订单数\\n    ,coalesce(no_deal_appeal_num,0)        as no_deal_appeal_num        --申诉未处理订单数\\n    ,coalesce(deal_appeal_order_num,0)     as deal_appeal_order_num     --申诉已处理订单数\\n    ,coalesce(return_order_num,0)          as return_order_num          --退货订单总数\\n    ,coalesce(back_price_all,0)            as back_price_all            --退款总金额\\n    ,coalesce(unshipped_refunded_num,0)    as unshipped_refunded_num    --未发货退款订单数\\n    ,coalesce(shipped_no_received_num,0)   as shipped_no_received_num   --已发货未收到货退款订单数\\n    ,coalesce(received_back_num,0)         as received_back_num         --收到货仅退款订单数\\n    ,coalesce(received_pay_back_num,0)     as received_pay_back_num    --收到货退货退款订单数\\n    ,coalesce(company_back_num,0)          as company_back_num          --退货公司物流订单数\\n    ,coalesce(personal_back_num,0)         as personal_back_num         --退货个人找车订单数\\n    ,coalesce(inreview_back_num,0)         as inreview_back_num         --退货审核中订单数\\n    ,coalesce(agree_back_num,0)            as agree_back_num            --退货同意订单数\\n    ,coalesce(refuse_back_num,0)           as refuse_back_num           --退货拒绝订单数\\n    ,coalesce(evaluation_order_num,0)      as evaluation_order_num      --完成评价数\\n    ,coalesce(no_evaluation_num,0)         as no_evaluation_num         --未完成评价数\\n    ,coalesce(deal_complete_back_num,0)    as deal_complete_back_num    --退货订单交易完成数\\n    ,coalesce(deal_complete_no_back_num,0) as deal_complete_no_back_num --没有退货订单交易完成数\\n    ,coalesce(deal_complete_num,0)         as deal_complete_num         --交易完成订单数\\n    ,coalesce(evaluation_order_num / order_num,0) as evaluation_rate --订单完成评价类型数量占比\\n    ,coalesce(no_evaluation_num / order_num,0) as  no_evaluation_rate   --订单未评价类型数量占比\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom\\n(\\n  select \\n       sum(bug_product_num)            as bug_product_num          --产品购买量\\n      ,sum(bug_goods_num)              as bug_goods_num            --商品够买量\\n      ,sum(order_num)                  as order_num                --下单总数\\n      ,sum(discuss_order_num)          as discuss_order_num        --商议订单数\\n      ,sum(wait_pay_order_num)         as wait_pay_order_num       --待支付订单数\\n      ,sum(wait_delivery_order_num)    as wait_delivery_order_num  --待发货订单数\\n      ,sum(wait_receiv_order_num)      as wait_receiv_order_num    --待收货订单数\\n      ,sum(wait_evaluation_order_num)  as wait_evaluation_order_num--待评价订单数\\n      ,sum(return_order_o_num)         as return_order_o_num       --退货中订单数\\n      ,sum(return_order_s_num)         as return_order_s_num       --退货成功订单数\\n      ,sum(complete_order_num)         as complete_order_num       --订单完成订单数\\n      ,sum(complete_cancel_num)        as complete_cancel_num      --订单取消订单数\\n      ,sum(order_price_all)            as order_price_all          --订单总额\\n      ,sum(sub_money_all)              as sub_money_all            --优惠金额\\n      ,sum(payment)                    as payment                  --实付金额\\n      ,sum(pay_order_num)              as pay_order_num            --支付订单总数\\n      ,sum(no_pay_order_num)           as no_pay_order_num         --未支付订单数\\n      ,sum(wechar_pay_order_num)       as wechar_pay_order_num     --微信支付订单数\\n      ,sum(alipay_pay_order_num)       as alipay_pay_order_num     --支付宝支付订单数\\n      ,sum(app_pay_order_num)          as app_pay_order_num        --小程序支付订单数\\n      ,sum(icbc_app_pay_num)           as icbc_app_pay_num         --工行app支付订单数\\n      ,sum(icbc_pc_pay_num)            as icbc_pc_pay_num          --工行pc支付订单数\\n      ,sum(order_post)                 as order_post               --邮费总额\\n      ,sum(shipping_order_num)         as shipping_order_num       --发货订单数\\n      ,sum(company_shipping_num)       as company_shipping_num     --发公司物流类型订单数\\n      ,sum(personal_shipping_num)      as personal_shipping_num    --发个人物流类型订单数\\n      ,sum(no_remind_shipping_num)     as no_remind_shipping_num   --发货未提醒数\\n      ,sum(remind_shipping_num)        as remind_shipping_num      --发货提醒数\\n      ,sum(receiving_order_num)        as receiving_order_num      --收货订单数\\n      ,sum(appeal_order_num)           as appeal_order_num         --申诉订单数\\n      ,sum(no_deal_appeal_num)         as no_deal_appeal_num       --申诉未处理订单数\\n      ,sum(deal_appeal_order_num)      as deal_appeal_order_num    --申诉已处理订单数\\n      ,sum(return_order_num)           as return_order_num         --退货订单总数\\n      ,sum(back_price_all)             as back_price_all           --退款总金额\\n      ,sum(unshipped_refunded_num)     as unshipped_refunded_num   --未发货退款订单数\\n      ,sum(shipped_no_received_num)    as shipped_no_received_num  --已发货未收到货退款订单数\\n      ,sum(received_back_num)          as received_back_num        --收到货仅退款订单数\\n      ,sum(received_pay_back_num)      as received_pay_back_num    --收到货退货退款订单数\\n      ,sum(company_back_num)           as company_back_num         --退货公司物流订单数\\n      ,sum(personal_back_num)          as personal_back_num        --退货个人找车订单数\\n      ,sum(inreview_back_num)          as inreview_back_num        --退货审核中订单数\\n      ,sum(agree_back_num)             as agree_back_num           --退货同意订单数\\n      ,sum(refuse_back_num)            as refuse_back_num          --退货拒绝订单数\\n      ,sum(evaluation_order_num)       as evaluation_order_num     --完成评价数\\n      ,sum(no_evaluation_num)          as no_evaluation_num        --未完成评价数\\n      ,sum(deal_complete_back_num )    as deal_complete_back_num   --退货订单交易完成数\\n      ,sum(deal_complete_no_back_num)  as deal_complete_no_back_num--没有退货订单交易完成数\\n      ,sum(deal_complete_num)          as deal_complete_num        --交易完成订单数\\n  from db_dw_nstc.clife_nstc_dws_order_converge\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ads_event_by_object_f\"]}],\"tenantId\":-1,\"timeout\":0}","description":"db_ads_nstc","globalParams":"[]","globalParamList":[],"globalParamMap":{},"createTime":"2021-11-10T06:01:49.000+0000","updateTime":"2021-11-12T02:56:12.000+0000","flag":"YES","userId":160,"userName":"data_warehouse","projectName":null,"locations":"{\"tasks-59219\":{\"name\":\"clife_nstc_ads_deal_message_info_d\",\"targetarr\":\"\",\"nodenumber\":\"1\",\"x\":0,\"y\":88},\"tasks-79480\":{\"name\":\"clife_nstc_ads_deal_message_info_m\",\"targetarr\":\"tasks-59219\",\"nodenumber\":\"1\",\"x\":238,\"y\":88},\"tasks-41422\":{\"name\":\"clife_nstc_ads_deal_message_info_y\",\"targetarr\":\"tasks-79480\",\"nodenumber\":\"1\",\"x\":454,\"y\":89},\"tasks-7797\":{\"name\":\"clife_nstc_ads_order_detail_comment_info_d\",\"targetarr\":\"tasks-41422\",\"nodenumber\":\"1\",\"x\":673,\"y\":88},\"tasks-87488\":{\"name\":\"clife_nstc_ads_order_detail_comment_info_y\",\"targetarr\":\"tasks-76303\",\"nodenumber\":\"1\",\"x\":1125,\"y\":96},\"tasks-76303\":{\"name\":\"clife_nstc_ads_order_detail_comment_info_m\",\"targetarr\":\"tasks-7797\",\"nodenumber\":\"1\",\"x\":901,\"y\":90},\"tasks-38538\":{\"name\":\"clife_nstc_ads_order_detail_info_d\",\"targetarr\":\"tasks-87488\",\"nodenumber\":\"1\",\"x\":1118,\"y\":310},\"tasks-20992\":{\"name\":\"clife_nstc_ads_order_detail_info_m\",\"targetarr\":\"tasks-38538\",\"nodenumber\":\"1\",\"x\":864,\"y\":305},\"tasks-55113\":{\"name\":\"clife_nstc_ads_order_detail_info_y\",\"targetarr\":\"tasks-20992\",\"nodenumber\":\"1\",\"x\":651,\"y\":308},\"tasks-87425\":{\"name\":\"clife_nstc_ads_order_by_shop_d\",\"targetarr\":\"tasks-55113\",\"nodenumber\":\"1\",\"x\":469,\"y\":306},\"tasks-14044\":{\"name\":\"clife_nstc_ads_order_by_shop_m\",\"targetarr\":\"tasks-87425\",\"nodenumber\":\"1\",\"x\":243,\"y\":305},\"tasks-98694\":{\"name\":\"clife_nstc_ads_order_by_shop_y\",\"targetarr\":\"tasks-14044\",\"nodenumber\":\"1\",\"x\":0,\"y\":315},\"tasks-37566\":{\"name\":\"clife_nstc_ads_event_by_object_d\",\"targetarr\":\"tasks-98694\",\"nodenumber\":\"1\",\"x\":0,\"y\":557},\"tasks-8250\":{\"name\":\"clife_nstc_ads_event_by_object_m\",\"targetarr\":\"tasks-37566\",\"nodenumber\":\"1\",\"x\":241,\"y\":559},\"tasks-8-5oi3nh\":{\"name\":\"clife_nstc_ads_event_by_object_y\",\"targetarr\":\"tasks-8250\",\"nodenumber\":\"1\",\"x\":506,\"y\":560},\"tasks-8-11a3dr\":{\"name\":\"clife_nstc_ads_order_detail_info_f\",\"targetarr\":\"tasks-8-5oi3nh\",\"nodenumber\":\"1\",\"x\":740,\"y\":559},\"tasks-8-3no7ik\":{\"name\":\"clife_nstc_ads_order_detail_comment_info_f\",\"targetarr\":\"tasks-8-11a3dr\",\"nodenumber\":\"1\",\"x\":967,\"y\":550},\"tasks-8-1jj1lc\":{\"name\":\"clife_nstc_ads_deal_message_info_f\",\"targetarr\":\"tasks-8-3no7ik\",\"nodenumber\":\"1\",\"x\":1176,\"y\":553},\"tasks-8-7hz2ew\":{\"name\":\"clife_nstc_ads_event_by_object_f\",\"targetarr\":\"tasks-8-1jj1lc\",\"nodenumber\":\"1\",\"x\":1167,\"y\":762},\"tasks-8-37x1lu\":{\"name\":\"clife_nstc_ads_order_f\",\"targetarr\":\"tasks-8-7hz2ew\",\"nodenumber\":\"0\",\"x\":924,\"y\":751}}","connects":"[{\"endPointSourceId\":\"tasks-59219\",\"endPointTargetId\":\"tasks-79480\"},{\"endPointSourceId\":\"tasks-79480\",\"endPointTargetId\":\"tasks-41422\"},{\"endPointSourceId\":\"tasks-41422\",\"endPointTargetId\":\"tasks-7797\"},{\"endPointSourceId\":\"tasks-7797\",\"endPointTargetId\":\"tasks-76303\"},{\"endPointSourceId\":\"tasks-76303\",\"endPointTargetId\":\"tasks-87488\"},{\"endPointSourceId\":\"tasks-87488\",\"endPointTargetId\":\"tasks-38538\"},{\"endPointSourceId\":\"tasks-38538\",\"endPointTargetId\":\"tasks-20992\"},{\"endPointSourceId\":\"tasks-20992\",\"endPointTargetId\":\"tasks-55113\"},{\"endPointSourceId\":\"tasks-87425\",\"endPointTargetId\":\"tasks-14044\"},{\"endPointSourceId\":\"tasks-14044\",\"endPointTargetId\":\"tasks-98694\"},{\"endPointSourceId\":\"tasks-98694\",\"endPointTargetId\":\"tasks-37566\"},{\"endPointSourceId\":\"tasks-37566\",\"endPointTargetId\":\"tasks-8250\"},{\"endPointSourceId\":\"tasks-8250\",\"endPointTargetId\":\"tasks-8-5oi3nh\"},{\"endPointSourceId\":\"tasks-8-5oi3nh\",\"endPointTargetId\":\"tasks-8-11a3dr\"},{\"endPointSourceId\":\"tasks-8-11a3dr\",\"endPointTargetId\":\"tasks-8-3no7ik\"},{\"endPointSourceId\":\"tasks-8-3no7ik\",\"endPointTargetId\":\"tasks-8-1jj1lc\"},{\"endPointSourceId\":\"tasks-8-1jj1lc\",\"endPointTargetId\":\"tasks-8-7hz2ew\"},{\"endPointSourceId\":\"tasks-8-7hz2ew\",\"endPointTargetId\":\"tasks-8-37x1lu\"},{\"endPointSourceId\":\"tasks-55113\",\"endPointTargetId\":\"tasks-87425\"}]","receivers":"","receiversCc":"","leadMobile":"","ddAlarmId":0,"scheduleReleaseState":null,"timeout":0,"tenantId":-1,"taskType":"SHELL"},{"id":848,"name":"db_device_dwd","version":0,"releaseState":"ONLINE","projectId":34,"processDefinitionJson":"{\"globalParams\":[],\"tasks\":[{\"type\":\"SQL\",\"id\":\"tasks-46403\",\"name\":\"clife_device_dwd_sleep_run_data\",\"params\":{\"type\":\"HIVE\",\"datasource\":147,\"sql\":\"insert overwrite table  db_device_dw.clife_device_dwd_sleep_run_data  partition(part_date)\\nselect\\n deviceid                  -- 设备id\\n,productid                 -- 产品id\\n,device_type_id            -- 设备大类\\n,device_subtype_id         -- 设备子类\\n,bind_user_id              -- 绑定用户\\n,macaddress                -- mac\\n,mactype                   -- mac地址类型 \\n,OnOff                     -- 开关机\\n,OximeterType              -- 血氧夹类型\\n,BleUpgradeType            -- 蓝牙升级类型\\n,ValueSet_Timeout as base_null_valueset_timeout         -- 上传实时波形\\n,BatteryPower              -- 电池电量\\n,OXimeterDataType           -- 血氧夹数据类型\\n,OximeterLink              -- 血氧夹接入状态\\n,OXimeterPower              -- 血氧夹电量等级\\n,ALinkStatus               -- A路接入状态\\n,BLinkStatus               -- B路接入状态\\n,NetworkStatus             -- 网络状态\\n,SDStatus                  -- SD卡状态\\n,OnOff_AdjustBodyMov  as base_null_onoff_adjustbodymov     -- 是否需要校准体动\\n,Step_AdjustBodyMov   as base_null_step_adjustbodymov     -- 校准体动状态\\n,OnOff_UpOriginalSignal  as  base_null_onOff_uporiginalsignal -- 上传原始信号开关\\n,updateFlag                -- 功能变更\\n,datasource                -- 数据来源\\n,fetchDateTime                  --采集时间\\n,part_date\\nfrom db_device_dw.clife_device_run_data_11619_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":3,\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"run_11619_tmp_create\"]},{\"type\":\"SQL\",\"id\":\"tasks-71244\",\"name\":\"clife_device_dwd_sleep_perception_data\",\"params\":{\"type\":\"HIVE\",\"datasource\":147,\"sql\":\"insert overwrite table db_device_dw.clife_device_dwd_sleep_perception_data partition(part_date)\\nselect\\n deviceid                 --设备id\\n,productid                --产品id\\n,device_type_id           --设备大类\\n,device_subtype_id        --设备子类\\n,bind_user_id             --绑定用户\\n,macaddress               --macaddress\\n,mactype                  --mac地址类型 \\n,OximeterSaturation       --血氧浓度\\n,OximeterPulse            --血氧脉率\\n,OximeterPerfusion        --血流灌注指数\\n,Onoroutofbed  as hasanybody           --在离床\\n,Heartrate                --心率\\n,Respiratoryrate     as breathrate        --呼吸率\\n,BodyActivityEnergy  as activityenergy    --体动能量\\n,TurnOverTimes            --体动次数\\n,BodyActivityType    as statusbodyactivitytype     --体动类型\\n,Bodyactivitytime    as valuecharbodyactivitytime     --体动持续时间\\n,Signalquality       as valuecharsignalquality     --信号质量\\n,sourceType               --数据来源\\n,fetchDateTime               --采集时间\\n,part_date\\nfrom db_device_dw.clife_device_perception_11619_tmp\\nwhere fetchDateTime is not null\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":3,\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"perception_11619_tmp_create\"]},{\"type\":\"SQL\",\"id\":\"tasks-4-4vh50\",\"name\":\"run_11619_tmp_drop\",\"params\":{\"type\":\"HIVE\",\"datasource\":147,\"sql\":\"drop table if exists db_device_dw.clife_device_run_data_11619_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":3,\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"run_6924_tmp_create\"]},{\"type\":\"SQL\",\"id\":\"tasks-8-2p030v\",\"name\":\"run_11619_tmp_create\",\"params\":{\"type\":\"HIVE\",\"datasource\":149,\"sql\":\"create table if not exists db_device_dw.clife_device_run_data_11619_tmp stored as parquet as \\nselect\\n     a.deviceid                  -- 设备id\\n    ,a.productid                 -- 产品id\\n    ,c.device_type_id            -- 设备大类\\n    ,c.device_subtype_id         -- 设备子类\\n    ,b.bind_user_id              -- 绑定用户\\n    ,a.macaddress                -- mac\\n    ,a.mactype                   -- mac地址类型 \\n    ,a.OnOff                     -- 开关机\\n    ,a.OximeterType              -- 血氧夹类型\\n    ,a.BleUpgradeType            -- 蓝牙升级类型\\n    ,a.ValueSet_Timeout          -- 上传实时波形\\n    ,a.BatteryPower              -- 电池电量\\n    ,a.OXimeterDataType           -- 血氧夹数据类型\\n    ,a.OximeterLink              -- 血氧夹接入状态\\n    ,a.OXimeterPower              -- 血氧夹电量等级\\n    ,a.ALinkStatus               -- A路接入状态\\n    ,a.BLinkStatus               -- B路接入状态\\n    ,a.NetworkStatus             -- 网络状态\\n    ,a.SDStatus                  -- SD卡状态\\n    ,a.OnOff_AdjustBodyMov       -- 是否需要校准体动\\n    ,a.Step_AdjustBodyMov        -- 校准体动状态\\n    ,a.OnOff_UpOriginalSignal    -- 上传原始信号开关\\n    ,a.updateFlag                -- 功能变更\\n    ,a.datasource                -- 数据来源\\n    ,from_unixtime(cast(a.fetchDateTime as bigint),'yyyy-MM-dd HH:mm:ss')  as  fetchDateTime  --采集时间\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date -- 分区时间\\nfrom \\n(\\n select\\n      deviceid\\n     ,productid\\n     ,macaddress\\n     ,cast(null as bigint)                    as mactype\\n\\t ,cast(null as bigint)                    as OnOff\\n     ,cast(null as bigint)                    as OximeterType\\n     ,cast(null as bigint)                    as BleUpgradeType\\n     ,cast(null as string)                 as ValueSet_Timeout\\n     ,cast(null as bigint)                 as BatteryPower\\n     ,cast(null as bigint)                    as OXimeterDataType\\n     ,cast(null as bigint)                    as OximeterLink\\n     ,cast(null as bigint)                    as OXimeterPower\\n     ,cast(null as bigint)                    as ALinkStatus\\n     ,cast(null as bigint)                    as BLinkStatus\\n     ,cast(null as bigint)                    as NetworkStatus\\n     ,cast(null as bigint)                    as SDStatus\\n     ,Base_Null_OnOff_AdjustBodyMov        as OnOff_AdjustBodyMov\\n     ,Base_Null_Step_AdjustBodyMov         as Step_AdjustBodyMov \\n     ,Base_Null_OnOff_UpOriginalSignal     as OnOff_UpOriginalSignal\\n     ,updateFlag\\n     ,'3代'      as datasource\\n     ,from_utc_timestamp(datatimestamp,'PRC') as fetchDateTime\\n from hive_iot_data.tb_properties_data_11619\\n where partitioned_date = regexp_replace(date_sub(current_date(),1),'-','')\\n   and Base_Null_OnOff_UpOriginalSignal is not null\\n order by fetchDateTime\\n)a \\nleft join db_device_dw.clife_device_dim_device_bind b on a.deviceid = b.device_id and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_device_dw.clife_device_dim_product c on a.productid = c.product_id and c.part_date = regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":3,\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"run_11619_tmp_drop\"]},{\"type\":\"SQL\",\"id\":\"tasks-6-2zf5kz\",\"name\":\"perception_11619_tmp_drop\",\"params\":{\"type\":\"HIVE\",\"datasource\":147,\"sql\":\"drop table if exists db_device_dw.clife_device_perception_11619_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":3,\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"perception_6924_tmp_create\"]},{\"type\":\"SQL\",\"id\":\"tasks-7-7mn68k\",\"name\":\"perception_11619_tmp_create\",\"params\":{\"type\":\"HIVE\",\"datasource\":147,\"sql\":\"create table if not exists db_device_dw.clife_device_perception_11619_tmp stored as parquet as \\nselect\\n     a.deviceid                 --设备id\\n    ,a.productid                --产品id\\n    ,c.device_type_id           --设备大类\\n    ,c.device_subtype_id        --设备子类\\n    ,b.bind_user_id             --绑定用户\\n    ,a.macaddress               --macaddress\\n    ,a.mactype                  --mac地址类型 \\n    ,a.OximeterSaturation       --血氧浓度\\n    ,a.OximeterPulse            --血氧脉率\\n    ,a.OximeterPerfusion        --血流灌注指数\\n    ,a.Onoroutofbed             --在离床\\n    ,cast(a.Heartrate as bigint) as  Heartrate   --心率\\n    ,cast(a.Respiratoryrate as bigint) as Respiratoryrate         --呼吸率\\n    ,cast(a.BodyActivityEnergy as bigint) as BodyActivityEnergy     --体动能量\\n    ,a.TurnOverTimes            --体动次数\\n    ,a.BodyActivityType         --体动类型\\n    ,a.Bodyactivitytime         --体动持续时间\\n    ,a.Signalquality            --信号质量\\n    ,a.sourceType               --数据来源\\n    ,from_unixtime(cast(a.fetchDateTime as bigint),'yyyy-MM-dd HH:mm:ss') as fetchDateTime  --采集时间(时间戳)\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --跑数时间\\nfrom \\n(\\n select\\n      deviceid\\n     ,productid\\n     ,macaddress\\n     ,cast(null as bigint)                    as mactype     \\n\\t ,cast(null as bigint)                    as OximeterSaturation\\n     ,cast(null as bigint)                    as OximeterPulse\\n     ,cast(null as bigint)                    as OximeterPerfusion\\n     ,base_1_status_onoroutofbed              as Onoroutofbed\\n     ,base_1_valuechar_heartrate              as Heartrate\\n     ,base_1_valuechar_respiratoryrate        as Respiratoryrate\\n     ,base_1_valueshort_bodyactivityenergy    as BodyActivityEnergy\\n     ,cast(null as bigint)                    as  TurnOverTimes \\n     ,base_1_status_bodyactivitytype          as BodyActivityType\\n     ,base_1_valuechar_bodyactivitytime       as Bodyactivitytime\\n     ,base_1_valuechar_signalquality          as Signalquality\\n     ,'3代'              as sourceType\\n     ,base_1_clock_null  as fetchDateTime\\n from hive_iot_data.tb_properties_data_11619\\n where partitioned_date = regexp_replace(date_sub(current_date(),1),'-','')\\n union all\\n select\\n      deviceid\\n     ,productid\\n     ,macaddress\\n     ,cast(null as bigint)                    as mactype     \\n\\t ,cast(null as bigint)                    as OximeterSaturation\\n     ,cast(null as bigint)                    as OximeterPulse\\n     ,cast(null as bigint)                    as OximeterPerfusion\\n     ,base_2_status_onoroutofbed              as Onoroutofbed\\n     ,base_2_valuechar_heartrate              as Heartrate\\n     ,base_2_valuechar_respiratoryrate        as Respiratoryrate\\n     ,base_2_valueshort_bodyactivityenergy    as BodyActivityEnergy\\n     ,cast(null as bigint)                    as TurnOverTimes \\n     ,base_2_status_bodyactivitytype          as BodyActivityType\\n     ,base_2_valuechar_bodyactivitytime       as Bodyactivitytime\\n     ,base_2_valuechar_signalquality          as Signalquality\\n     ,'3代'              as sourceType\\n     ,base_2_clock_null  as fetchDateTime\\n from hive_iot_data.tb_properties_data_11619\\n where partitioned_date = regexp_replace(date_sub(current_date(),1),'-','')\\n union all\\n select\\n      deviceid\\n     ,productid\\n     ,macaddress\\n     ,cast(null as bigint)                    as mactype     \\n\\t ,cast(null as bigint)                    as OximeterSaturation\\n     ,cast(null as bigint)                    as OximeterPulse\\n     ,cast(null as bigint)                    as OximeterPerfusion\\n     ,base_3_status_onoroutofbed              as Onoroutofbed\\n     ,base_3_valuechar_heartrate              as Heartrate\\n     ,base_3_valuechar_respiratoryrate        as Respiratoryrate\\n     ,base_3_valueshort_bodyactivityenergy    as BodyActivityEnergy\\n     ,cast(null as bigint)                    as  TurnOverTimes \\n     ,base_3_status_bodyactivitytype          as BodyActivityType\\n     ,base_3_valuechar_bodyactivitytime       as Bodyactivitytime\\n     ,base_3_valuechar_signalquality          as Signalquality\\n     ,'3代'              as sourceType\\n     ,base_3_clock_null  as fetchDateTime\\n from hive_iot_data.tb_properties_data_11619\\n where partitioned_date = regexp_replace(date_sub(current_date(),1),'-','')\\n union all\\n select\\n      deviceid\\n     ,productid\\n     ,macaddress\\n     ,cast(null as bigint)                    as mactype     \\n\\t ,cast(null as bigint)                    as OximeterSaturation\\n     ,cast(null as bigint)                    as OximeterPulse\\n     ,cast(null as bigint)                    as OximeterPerfusion\\n     ,base_4_status_onoroutofbed              as Onoroutofbed\\n     ,base_4_valuechar_heartrate              as Heartrate\\n     ,base_4_valuechar_respiratoryrate        as Respiratoryrate\\n     ,base_4_valueshort_bodyactivityenergy    as BodyActivityEnergy\\n     ,cast(null as bigint)                    as  TurnOverTimes \\n     ,base_4_status_bodyactivitytype          as BodyActivityType\\n     ,base_4_valuechar_bodyactivitytime       as Bodyactivitytime\\n     ,base_4_valuechar_signalquality          as Signalquality\\n     ,'3代'              as sourceType\\n     ,base_4_clock_null  as fetchDateTime\\n from hive_iot_data.tb_properties_data_11619\\n where partitioned_date = regexp_replace(date_sub(current_date(),1),'-','')\\n union all\\n select\\n      deviceid\\n     ,productid\\n     ,macaddress\\n     ,cast(null as bigint)                    as mactype     \\n\\t ,cast(null as bigint)                    as OximeterSaturation\\n     ,cast(null as bigint)                    as OximeterPulse\\n     ,cast(null as bigint)                    as OximeterPerfusion\\n     ,base_5_status_onoroutofbed              as Onoroutofbed\\n     ,base_5_valuechar_heartrate              as Heartrate\\n     ,base_5_valuechar_respiratoryrate        as Respiratoryrate\\n     ,base_5_valueshort_bodyactivityenergy    as BodyActivityEnergy\\n     ,cast(null as bigint)                    as  TurnOverTimes \\n     ,base_5_status_bodyactivitytype          as BodyActivityType\\n     ,base_5_valuechar_bodyactivitytime       as Bodyactivitytime\\n     ,base_5_valuechar_signalquality          as Signalquality\\n     ,'3代'              as sourceType\\n     ,base_5_clock_null  as fetchDateTime\\n from hive_iot_data.tb_properties_data_11619\\n where partitioned_date = regexp_replace(date_sub(current_date(),1),'-','')\\n)a \\nleft join db_device_dw.clife_device_dim_device_bind b on a.deviceid = b.device_id and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_device_dw.clife_device_dim_product c on a.productid = c.product_id and c.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\norder by from_unixtime(cast(fetchDateTime as bigint),'yyyy-MM-dd HH:mm:ss')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"perception_11619_tmp_drop\"]},{\"type\":\"SQL\",\"id\":\"tasks-99171\",\"name\":\"run_11762_tmp_drop\",\"params\":{\"type\":\"HIVE\",\"datasource\":149,\"sql\":\"drop table if exists db_device_dw.clife_device_run_11762_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":3,\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"run_7068_tmp_create\"]},{\"type\":\"SQL\",\"id\":\"tasks-23713\",\"name\":\"run_11762_tmp_create\",\"params\":{\"type\":\"HIVE\",\"datasource\":147,\"sql\":\"create table if not exists db_device_dw.clife_device_run_data_11762_tmp stored as parquet as \\nselect\\n     a.deviceid                        --设备id\\n    ,a.productid                       --产品id\\n    ,c.device_type_id                  --大类\\n    ,c.device_subtype_id               --小类\\n    ,b.bind_user_id                    --绑定用户\\n    ,a.macaddress                      --mac地址\\n    ,a.mactype                         --mac类型\\n    ,a.OnOffSet                        --控制数据开关机状态\\n    ,a.OnOffStatus                     --运行数据开关机状态\\n    ,a.PowerConsumption                --累计耗电量\\n    ,a.WorkMode                        --工作模式\\n    ,a.WorkPhase                       --工作阶段\\n    ,a.RealFanSpeed                    --实际风速\\n    ,a.BaseOnOffUpdownswing            --上下摆风开关\\n    ,a.BaseOnOffLeftrightswing         --左右摆风开关\\n    ,a.HorizontalSwingPosition         --水平摆风位置\\n    ,a.verticalSwingPosition           --垂直摆风位置\\n    ,a.HorizontalSwingAngle            --水平摆风角度\\n    ,a.VerticalSwingAngle              --垂直摆风角度\\n    ,a.RemainTimeOnMin                 --剩余定时开机时间\\n    ,a.RemainTimeOffMin                --剩余定时关机时间\\n    ,a.AccPowerOnTime                  --累计通电时间\\n    ,a.AccCompWorkTime                 --累计压机工作时间\\n    ,a.CompOnOffStatus                 --压机开关状态\\n    ,a.OutFanOnOffStatus               --外风扇开关状态\\n    ,a.ValveOnOffStatus                --四通阀开关状态\\n    ,a.HeaterOnOffStatus               --电加热开关状态\\n    ,a.setTempState                    --设置温度状态\\n    ,a.FanSpeedSet                     --设置风速\\n    ,a.sleepSetState                   --睡眠模式状态\\n    ,a.ChildLockStatus                 --童锁状态\\n    ,a.LearningStatus                  --学习状态\\n    ,a.LearningBrand                   --学习品牌\\n    ,a.LearningModel                   --学习型号\\n    ,a.Base_Mac_ValueShort_Power       --当前功率\\n\\t,a.InAmbientTemp                     --运行室内环境温度\\n\\t,a.WorkModeSet                       --运行数据的逻辑\\n\\t,a.SettingTemp  --运行设定温度\\n    ,from_unixtime(cast(a.fetchDateTime as bigint),'yyyy-MM-dd HH:mm:ss')  as  fetchDateTime  --采集时间\\n    ,a.datasource                       --数据来源\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date -- 分区时间\\nfrom \\n(\\n select\\n      deviceid  \\n     ,productid \\n     ,macaddress\\n     ,cast(null as int)    as mactype\\n     ,case when base_null_onoff_null = 0 then 2 else base_null_onoff_null end as OnOffSet\\n     ,cast(null as int) as OnOffStatus\\n     ,cast(null as string) as PowerConsumption\\n     ,(case \\n            when Base_Null_ModeSet_Null  = 0 then 5\\n            when Base_Null_ModeSet_Null  = 5 then 8 \\n       else Base_Null_ModeSet_Null  end)  as WorkMode\\n     ,cast(null as string) as WorkPhase\\n     ,cast(null as int) as RealFanSpeed\\n\\t ,base_mac_onoff_ventilation      as BaseOnOffUpdownswing\\n     ,base_mac_onoff_fan   as BaseOnOffLeftrightswing\\n     ,cast(null as string) as HorizontalSwingPosition\\n     ,cast(null as string) as verticalSwingPosition\\n     ,cast(null as double) as HorizontalSwingAngle\\n     ,cast(null as double) as VerticalSwingAngle\\n     ,cast(null as string) as RemainTimeOnMin\\n     ,cast(null as string) as RemainTimeOffMin\\n     ,cast(null as string) as AccPowerOnTime\\n     ,cast(null as string) as AccCompWorkTime\\n     ,cast(null as bigint) as CompOnOffStatus\\n     ,cast(null as bigint) as OutFanOnOffStatus\\n     ,cast(null as bigint) as ValveOnOffStatus\\n     ,cast(null as bigint) as HeaterOnOffStatus\\n     ,cast(base_null_valueset_null as bigint)  as setTempState --控制\\n     ,(case \\n            when base_null_levelset_null = 0 then 5\\n            when base_null_levelset_null = 1 then 0\\n            when base_null_levelset_null = 2 then 1\\n            when base_null_levelset_null = 3 then 2 \\n            when base_null_levelset_null = 4 then 3 \\n            when base_null_levelset_null = 5 then 4 \\n       else base_null_levelset_null end)  as FanSpeedSet\\n     ,cast(null as bigint) as sleepSetState\\n     ,(case when switch_null_onoff_null = 0 then 2 else switch_null_onoff_null end)  as ChildLockStatus\\n     ,(case \\n            when Base_Null_TypeSet_Null = 0 then 2\\n            when Base_Null_TypeSet_Null = 1 then 4\\n            when Base_Null_TypeSet_Null = 2 then 1  \\n       else Base_Null_TypeSet_Null end) as LearningStatus\\n     ,cast(null as string) as LearningBrand\\n     ,cast(null as string) as LearningModel\\n     ,cast(null as string) as Base_Mac_ValueShort_Power\\n     ,cast(null as int)    as workmodeset --运行\\n     ,cast(null as double) as InAmbientTemp\\n     ,cast(null as int) as SettingTemp --运行\\n     ,'科什' as datasource\\n     ,from_utc_timestamp(datatimestamp,'PRC')  as fetchDateTime\\n from hive_iot_data.tb_properties_data_11762\\n where partitioned_date = regexp_replace(date_sub(current_date(),1),'-','')\\n order by fetchDateTime\\n)a \\nleft join db_device_dw.clife_device_dim_device_bind b on a.deviceid = b.device_id and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_device_dw.clife_device_dim_product c on a.productid = c.product_id and c.part_date = regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":3,\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"run_11762_tmp_drop\"]},{\"type\":\"SQL\",\"id\":\"tasks-31355\",\"name\":\"clife_device_dwd_air_conditioning_run_data1\",\"params\":{\"type\":\"HIVE\",\"datasource\":147,\"sql\":\"insert overwrite table db_device_dw.clife_device_dwd_air_conditioning_run_data1 partition(part_date)\\nselect\\n     deviceid                        --设备id\\n    ,productid                       --产品id\\n    ,device_type_id                  --大类\\n    ,device_subtype_id               --小类\\n    ,bind_user_id                    --绑定用户\\n    ,macaddress                      --mac地址\\n    ,mactype                         --mac类型\\n    ,OnOffStatus                     --运行数据开关机状态\\n    ,OnOffSet                        --控制数据开关机状态\\n    ,PowerConsumption                --累计耗电量\\n    ,WorkMode                        --工作模式\\n    ,WorkPhase                       --工作阶段\\n    ,RealFanSpeed                    --实际风速\\n    ,HorizontalSwingPosition         --水平摆风位置\\n    ,verticalSwingPosition           --垂直摆风位置\\n    ,HorizontalSwingAngle            --水平摆风角度\\n    ,VerticalSwingAngle              --垂直摆风角度\\n    ,RemainTimeOnMin                 --剩余定时开机时间\\n    ,RemainTimeOffMin                --剩余定时关机时间\\n    ,AccPowerOnTime                  --累计通电时间\\n    ,AccCompWorkTime                 --累计压机工作时间\\n    ,CompOnOffStatus                 --压机开关状态\\n    ,OutFanOnOffStatus               --外风扇开关状态\\n    ,ValveOnOffStatus                --四通阀开关状态\\n    ,HeaterOnOffStatus               --电加热开关状态\\n    ,SettingTemp                     --设置温度状态\\n    ,FanSpeedSet                     --设置风速\\n    ,sleepSetState                   --睡眠模式状态\\n    ,ChildLockStatus                 --童锁状态\\n    ,LearningStatus                  --学习状态\\n    ,LearningBrand                   --学习品牌\\n    ,LearningModel                   --学习型号\\n    ,Base_Mac_ValueShort_Power       --当前功率\\n    ,fetchDateTime  --采集时间\\n    ,datasource                       --数据来源\\n    ,BaseOnOffUpdownswing            --上下摆风开关\\n    ,BaseOnOffLeftrightswing         --左右摆风开关\\n    ,cast(InAmbientTemp as string) as InAmbientTemp --运行室内环境温度\\n\\t,cast(WorkMode as bigint) as  WorkModeSet       --工作模式  1-制冷|2-除湿|3-送风|4-制热|5-自动|6-静音|7-睡眠\\n\\t,cast(setTempState as string)  as  TempSet  --运行设定温度\\n    ,part_date -- 分区时间\\nfrom  db_device_dw.clife_device_run_data_11762_tmp\\nunion all\\nselect\\n     deviceid                        --设备id\\n    ,productid                       --产品id\\n    ,device_type_id                  --大类\\n    ,device_subtype_id               --小类\\n    ,bind_user_id                    --绑定用户\\n    ,macaddress                      --mac地址\\n    ,mactype                         --mac类型\\n    ,OnOffStatus                        --运行数据开关\\n    ,OnOffSet     --控制数据开关\\n    ,PowerConsumption                --累计耗电量\\n\\t,WorkModeSet as  WorkMode        --运行数据的逻辑\\n    ,WorkPhase                       --工作阶段\\n    ,RealFanSpeed                    --实际风速\\n    ,HorizontalSwingPosition         --水平摆风位置\\n    ,verticalSwingPosition           --垂直摆风位置\\n    ,HorizontalSwingAngle            --水平摆风角度\\n    ,VerticalSwingAngle              --垂直摆风角度\\n    ,RemainTimeOnMin                 --剩余定时开机时间\\n    ,RemainTimeOffMin                --剩余定时关机时间\\n    ,AccPowerOnTime                  --累计通电时间\\n    ,AccCompWorkTime                 --累计压机工作时间\\n    ,CompOnOffStatus                 --压机开关状态\\n    ,OutFanOnOffStatus               --外风扇开关状态\\n    ,ValveOnOffStatus                --四通阀开关状态\\n    ,HeaterOnOffStatus               --电加热开关状态\\n\\t,SettingTemp                       --运行设定温度\\n    ,FanSpeedSet                     --设置风速\\n    ,sleepSetState                   --睡眠模式状态\\n    ,ChildLockStatus                 --童锁状态\\n    ,LearningStatus                  --学习状态\\n    ,LearningBrand                   --学习品牌\\n    ,LearningModel                   --学习型号\\n    ,Base_Mac_ValueShort_Power       --当前功率\\n    ,fetchDateTime  --采集时间\\n    ,datasource                      --数据来源\\n    ,BaseOnOffUpdownswing            --上下摆风开关\\n    ,BaseOnOffLeftrightswing         --左右摆风开关\\n    ,cast(InAmbientTemp as string) as InAmbientTemp --运行室内环境温度\\n    ,cast(WorkMode as bigint) as WorkModeSet --控制数据工作模型设定\\n    ,cast(setTempState as string)  as  TempSet       --控制设置温度状态\\n    ,part_date      -- 分区时间\\nfrom db_device_dw.clife_device_run_data_7068_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":3,\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"run_11762_tmp_create\"]},{\"type\":\"SQL\",\"id\":\"tasks-89128\",\"name\":\"run_7068_tmp_drop\",\"params\":{\"type\":\"HIVE\",\"datasource\":149,\"sql\":\"drop table if exists db_device_dw.clife_device_run_data_7068_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[]},{\"type\":\"SQL\",\"id\":\"tasks-39685\",\"name\":\"run_7068_tmp_create\",\"params\":{\"type\":\"HIVE\",\"datasource\":147,\"sql\":\"create table if not exists db_device_dw.clife_device_run_data_7068_tmp stored as parquet as \\nselect\\n     a.deviceid                        --设备id\\n    ,a.productid                       --产品id\\n    ,c.device_type_id                  --大类\\n    ,c.device_subtype_id               --小类\\n    ,b.bind_user_id                    --绑定用户\\n    ,a.macaddress                      --mac地址\\n    ,a.mactype                         --mac类型\\n    ,a.OnOffSet                        --控制数据开关机状态\\n    ,a.OnOffStatus                     --运行数据开关机状态\\n    ,a.PowerConsumption                --累计耗电量\\n    ,a.WorkMode                        --工作模式\\n    ,a.WorkPhase                       --工作阶段\\n    ,a.RealFanSpeed                    --实际风速\\n    ,a.BaseOnOffUpdownswing            --上下摆风开关\\n    ,a.BaseOnOffLeftrightswing         --左右摆风开关\\n    ,a.HorizontalSwingPosition         --水平摆风位置\\n    ,a.verticalSwingPosition           --垂直摆风位置\\n    ,a.HorizontalSwingAngle            --水平摆风角度\\n    ,a.VerticalSwingAngle              --垂直摆风角度\\n    ,a.RemainTimeOnMin                 --剩余定时开机时间\\n    ,a.RemainTimeOffMin                --剩余定时关机时间\\n    ,a.AccPowerOnTime                  --累计通电时间\\n    ,a.AccCompWorkTime                 --累计压机工作时间\\n    ,a.CompOnOffStatus                 --压机开关状态\\n    ,a.OutFanOnOffStatus               --外风扇开关状态\\n    ,a.ValveOnOffStatus                --四通阀开关状态\\n    ,a.HeaterOnOffStatus               --电加热开关状态\\n    ,a.setTempState                    --设置温度状态\\n    ,a.FanSpeedSet                     --设置风速\\n    ,a.sleepSetState                   --睡眠模式状态\\n    ,a.ChildLockStatus                 --童锁状态\\n    ,a.LearningStatus                  --学习状态\\n    ,a.LearningBrand                   --学习品牌\\n    ,a.LearningModel                   --学习型号\\n    ,a.Base_Mac_ValueShort_Power       --当前功率\\n\\t,a.InAmbientTemp                     --运行室内环境温度\\n\\t,a.WorkModeSet                       --运行数据的逻辑\\n\\t,a.SettingTemp  --运行设定温度\\n    ,from_unixtime(cast(a.fetchDateTime as bigint),'yyyy-MM-dd HH:mm:ss')  as  fetchDateTime  --采集时间\\n    ,a.datasource                       --数据来源\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date -- 分区时间\\nfrom \\n(\\n select\\n      deviceid  \\n     ,productid \\n     ,macaddress\\n     ,cast(null as int)    as mactype\\n     ,case when base_null_onoff_null = 0 then 2 else base_null_onoff_null end as OnOffSet\\n     ,Switch_Null_Status_PowerOn as OnOffStatus\\n     ,cast(Base_Null_Value_Electricity as string) as PowerConsumption\\n     ,(case \\n            when Base_Null_ModeSet_Null  = 0 then 5\\n            when Base_Null_ModeSet_Null  = 5 then 8 \\n       else Base_Null_ModeSet_Null  end)  as WorkMode\\n     ,cast(null as string) as WorkPhase\\n     ,cast(null as int) as RealFanSpeed\\n\\t ,base_null_onoff_updownswing      as BaseOnOffUpdownswing\\n     ,base_null_onoff_leftrightswing   as BaseOnOffLeftrightswing\\n     ,cast(null as string) as HorizontalSwingPosition\\n     ,cast(null as string) as verticalSwingPosition\\n     ,cast(null as double) as HorizontalSwingAngle\\n     ,cast(null as double) as VerticalSwingAngle\\n     ,cast(null as string) as RemainTimeOnMin\\n     ,cast(null as string) as RemainTimeOffMin\\n     ,cast(null as string) as AccPowerOnTime\\n     ,cast(null as string) as AccCompWorkTime\\n     ,cast(null as bigint) as CompOnOffStatus\\n     ,cast(null as bigint) as OutFanOnOffStatus\\n     ,cast(null as bigint) as ValveOnOffStatus\\n     ,cast(null as bigint) as HeaterOnOffStatus\\n     ,cast(base_null_valuecharset_temp as bigint)  as setTempState --控制\\n     ,(case \\n            when Base_Null_LevelSet_WindSpeed = 0 then 5\\n            when Base_Null_LevelSet_WindSpeed = 3 then 2 \\n            when Base_Null_LevelSet_WindSpeed = 5 then 3 \\n       else Base_Null_LevelSet_WindSpeed end)  as FanSpeedSet\\n     ,cast(null as bigint) as sleepSetState\\n     ,(case when base_null_onoff_childlock = 0 then 2 else base_null_onoff_childlock end)  as ChildLockStatus\\n     ,(case \\n            when base_null_step_selflearning = 0 then 2\\n            when base_null_step_selflearning = 2 then 1  \\n       else base_null_step_selflearning end) as LearningStatus\\n     ,cast(null as string) as LearningBrand\\n     ,cast(null as string) as LearningModel\\n     ,cast(Base_Mac_ValueShort_Power as string) as Base_Mac_ValueShort_Power\\n     ,NTC_Inside_ValueChar_Temp as InAmbientTemp\\n     ,IRSend_Null_Value_Temp as SettingTemp --运行\\n     ,(case \\n            when Base_Mac_Mode_Null  = 0 then 5\\n            when Base_Mac_Mode_Null  = 5 then 8 \\n       else Base_Mac_Mode_Null  end)  as WorkModeSet\\n     ,'科什' as datasource\\n     ,from_utc_timestamp(datatimestamp,'PRC')  as fetchDateTime\\n from hive_iot_data.tb_properties_data_7068\\n where partitioned_date = regexp_replace(date_sub(current_date(),1),'-','')\\n order by fetchDateTime\\n)a \\nleft join db_device_dw.clife_device_dim_device_bind b on a.deviceid = b.device_id and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_device_dw.clife_device_dim_product c on a.productid = c.product_id and c.part_date = regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":3,\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"run_7068_tmp_drop\"]},{\"type\":\"SQL\",\"id\":\"tasks-44935\",\"name\":\"perception_7068_tmp_drop\",\"params\":{\"type\":\"HIVE\",\"datasource\":149,\"sql\":\"drop table if exists db_device_dw.clife_device_perception_data_7068_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_device_dwd_sleep_perception_data\"]},{\"type\":\"SQL\",\"id\":\"tasks-18369\",\"name\":\"perception_7068_tmp_create\",\"params\":{\"type\":\"HIVE\",\"datasource\":146,\"sql\":\"create table if not exists db_device_dw.clife_device_perception_data_7068_tmp stored as parquet as \\nselect\\n     a.deviceid                        --设备id\\n    ,a.productid                       --产品id\\n    ,c.device_type_id                  --大类\\n    ,c.device_subtype_id               --小类\\n    ,b.bind_user_id                    --绑定用户\\n    ,a.macaddress                      --mac地址\\n    ,a.mactype                         --mac类型\\n    ,a.inambienttemp                   --室内环境温度\\n    ,a.incoiltemp                      --室内盘管温度\\n    ,a.outambienttemp                  --室外环境温度\\n    ,a.outcoiltemp                     --室外盘管温度\\n    ,a.base_null_percent_humidity      --室内湿度\\n    ,from_unixtime(cast(a.fetchDateTime as bigint),'yyyy-MM-dd HH:mm:ss')  as  fetchDateTime  --采集时间\\n    ,a.datasource                       --数据来源\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date -- 分区时间\\nfrom \\n(\\n select\\n      deviceid  \\n     ,productid \\n     ,macaddress\\n     ,cast(null as bigint) as mactype\\n     ,cast(NTC_Inside_ValueChar_Temp as double) as inambienttemp\\n     ,cast(null as double) as incoiltemp\\n     ,cast(null as double) as outambienttemp\\n     ,cast(null as double) as outcoiltemp\\n     ,cast(null as double) as base_null_percent_humidity\\n     ,'科什' as datasource\\n     ,from_utc_timestamp(datatimestamp,'PRC')          as fetchDateTime\\n from hive_iot_data.tb_properties_data_7068\\n where partitioned_date = regexp_replace(date_sub(current_date(),1),'-','')\\n order by fetchDateTime\\n)a \\nleft join db_device_dw.clife_device_dim_device_bind b on a.deviceid = b.device_id and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_device_dw.clife_device_dim_product c on a.productid = c.product_id and c.part_date = regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"perception_7068_tmp_drop\"]},{\"type\":\"SQL\",\"id\":\"tasks-73390\",\"name\":\"clife_device_dwd_air_conditioning_perception_data\",\"params\":{\"type\":\"HIVE\",\"datasource\":147,\"sql\":\"insert overwrite table db_device_dw.clife_device_dwd_air_conditioning_perception_data partition(part_date)\\nselect\\n     deviceid                        --设备id\\n    ,productid                       --产品id\\n    ,device_type_id                  --大类\\n    ,device_subtype_id               --小类\\n    ,bind_user_id                    --绑定用户\\n    ,macaddress                      --mac地址\\n    ,mactype                         --mac类型\\n    ,inambienttemp                   --室内环境温度\\n    ,incoiltemp                      --室内盘管温度\\n    ,outambienttemp                  --室外环境温度\\n    ,outcoiltemp                     --室外盘管温度\\n    ,base_null_percent_humidity      --室内湿度\\n    ,fetchDateTime  --采集时间\\n    ,datasource                       --数据来源\\n    ,part_date -- 分区时间\\nfrom db_device_dw.clife_device_perception_data_7068_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"perception_7068_tmp_create\"]},{\"type\":\"SQL\",\"id\":\"tasks-78953\",\"name\":\"run_6924_tmp_drop\",\"params\":{\"type\":\"HIVE\",\"datasource\":149,\"sql\":\"drop table if exists db_device_dw.clife_device_run_6924_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"FORBIDDEN\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[]},{\"type\":\"SQL\",\"id\":\"tasks-75645\",\"name\":\"run_6924_tmp_create\",\"params\":{\"type\":\"HIVE\",\"datasource\":146,\"sql\":\"create table if not exists db_device_dw.clife_device_run_6924_tmp stored as parquet as \\nselect\\n     a.deviceid                  -- 设备id\\n    ,a.productid                 -- 产品id\\n    ,c.device_type_id            -- 设备大类\\n    ,c.device_subtype_id         -- 设备子类\\n    ,b.bind_user_id              -- 绑定用户\\n    ,a.macaddress                -- mac\\n    ,a.mactype                   -- mac地址类型 \\n    ,a.OnOff                     -- 开关机\\n    ,a.OximeterType              -- 血氧夹类型\\n    ,a.BleUpgradeType            -- 蓝牙升级类型\\n    ,a.ValueSet_Timeout          -- 上传实时波形\\n    ,a.BatteryPower              -- 电池电量\\n    ,a.OXimeterDataType           -- 血氧夹数据类型\\n    ,a.OximeterLink              -- 血氧夹接入状态\\n    ,a.OXimeterPower              -- 血氧夹电量等级\\n    ,a.ALinkStatus               -- A路接入状态\\n    ,a.BLinkStatus               -- B路接入状态\\n    ,a.NetworkStatus             -- 网络状态\\n    ,a.SDStatus                  -- SD卡状态\\n    ,a.OnOff_AdjustBodyMov       -- 是否需要校准体动\\n    ,a.Step_AdjustBodyMov        -- 校准体动状态\\n    ,a.OnOff_UpOriginalSignal    -- 上传原始信号开关\\n    ,a.updateFlag                -- 功能变更\\n    ,a.datasource                -- 数据来源\\n    ,from_unixtime(cast(a.fetchDateTime as bigint),'yyyy-MM-dd HH:mm:ss')  as  fetchDateTime  --采集时间\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date -- 分区时间\\nfrom \\n(\\n select\\n      deviceid\\n     ,productid\\n     ,macaddress\\n     ,cast(null as bigint)                    as mactype\\n\\t ,cast(null as bigint)                    as OnOff\\n     ,cast(null as bigint)                    as OximeterType\\n     ,cast(null as bigint)                    as BleUpgradeType\\n     ,cast(null as string)                 as ValueSet_Timeout\\n     ,cast(null as bigint)                 as BatteryPower\\n     ,cast(null as bigint)                    as OXimeterDataType\\n     ,cast(null as bigint)                    as OximeterLink\\n     ,cast(null as bigint)                    as OXimeterPower\\n     ,cast(null as bigint)                    as ALinkStatus\\n     ,cast(null as bigint)                    as BLinkStatus\\n     ,cast(null as bigint)                    as NetworkStatus\\n     ,cast(null as bigint)                    as SDStatus\\n     ,Base_Null_OnOff_AdjustBodyMov        as OnOff_AdjustBodyMov\\n     ,Base_Null_Step_AdjustBodyMov         as Step_AdjustBodyMov \\n     ,Base_Null_OnOff_UpOriginalSignal     as OnOff_UpOriginalSignal\\n     ,updateFlag\\n     ,'3代'      as datasource\\n     ,from_utc_timestamp(datatimestamp,'PRC') as fetchDateTime\\n from hive_iot_data.tb_properties_data_6924\\n where partitioned_date = regexp_replace(date_sub(current_date(),1),'-','')\\n   and Base_Null_OnOff_UpOriginalSignal is not null\\n order by fetchDateTime\\n)a \\nleft join db_device_dw.clife_device_dim_device_bind b on a.deviceid = b.device_id and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_device_dw.clife_device_dim_product c on a.productid = c.product_id and c.part_date = regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"FORBIDDEN\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":3,\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"run_6924_tmp_drop\"]},{\"type\":\"SQL\",\"id\":\"tasks-23308\",\"name\":\"perception_6924_tmp_drop\",\"params\":{\"type\":\"HIVE\",\"datasource\":149,\"sql\":\"drop table if exists db_device_dw.clife_device_perception_6924_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"FORBIDDEN\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[]},{\"type\":\"SQL\",\"id\":\"tasks-13000\",\"name\":\"perception_6924_tmp_create\",\"params\":{\"type\":\"HIVE\",\"datasource\":147,\"sql\":\"create table if not exists db_device_dw.clife_device_perception_6924_tmp stored as parquet as \\nselect\\n     a.deviceid                 --设备id\\n    ,a.productid                --产品id\\n    ,c.device_type_id           --设备大类\\n    ,c.device_subtype_id        --设备子类\\n    ,b.bind_user_id             --绑定用户\\n    ,a.macaddress               --macaddress\\n    ,a.mactype                  --mac地址类型 \\n    ,a.OximeterSaturation       --血氧浓度\\n    ,a.OximeterPulse            --血氧脉率\\n    ,a.OximeterPerfusion        --血流灌注指数\\n    ,a.Onoroutofbed             --在离床\\n    ,cast(a.Heartrate as bigint) as  Heartrate   --心率\\n    ,cast(a.Respiratoryrate as bigint) as Respiratoryrate         --呼吸率\\n    ,cast(a.BodyActivityEnergy as bigint) as BodyActivityEnergy     --体动能量\\n    ,a.TurnOverTimes            --体动次数\\n    ,a.BodyActivityType         --体动类型\\n    ,a.Bodyactivitytime         --体动持续时间\\n    ,a.Signalquality            --信号质量\\n    ,a.sourceType               --数据来源\\n    ,from_unixtime(cast(a.fetchDateTime as bigint),'yyyy-MM-dd HH:mm:ss') as fetchDateTime  --采集时间(时间戳)\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --跑数时间\\nfrom \\n(\\n select\\n      deviceid\\n     ,productid\\n     ,macaddress\\n     ,cast(null as bigint)                    as mactype     \\n\\t ,cast(null as bigint)                    as OximeterSaturation\\n     ,cast(null as bigint)                    as OximeterPulse\\n     ,cast(null as bigint)                    as OximeterPerfusion\\n     ,base_1_status_onoroutofbed              as Onoroutofbed\\n     ,base_1_valuechar_heartrate              as Heartrate\\n     ,base_1_valuechar_respiratoryrate        as Respiratoryrate\\n     ,base_1_valueshort_bodyactivityenergy    as BodyActivityEnergy\\n     ,cast(null as bigint)                    as  TurnOverTimes \\n     ,base_1_status_bodyactivitytype          as BodyActivityType\\n     ,base_1_valuechar_bodyactivitytime       as Bodyactivitytime\\n     ,base_1_valuechar_signalquality          as Signalquality\\n     ,'3代'              as sourceType\\n     ,base_1_clock_null  as fetchDateTime\\n from hive_iot_data.tb_properties_data_6924\\n where partitioned_date = regexp_replace(date_sub(current_date(),1),'-','')\\n union all\\n select\\n      deviceid\\n     ,productid\\n     ,macaddress\\n     ,cast(null as bigint)                    as mactype     \\n\\t ,cast(null as bigint)                    as OximeterSaturation\\n     ,cast(null as bigint)                    as OximeterPulse\\n     ,cast(null as bigint)                    as OximeterPerfusion\\n     ,base_2_status_onoroutofbed              as Onoroutofbed\\n     ,base_2_valuechar_heartrate              as Heartrate\\n     ,base_2_valuechar_respiratoryrate        as Respiratoryrate\\n     ,base_2_valueshort_bodyactivityenergy    as BodyActivityEnergy\\n     ,cast(null as bigint)                    as TurnOverTimes \\n     ,base_2_status_bodyactivitytype          as BodyActivityType\\n     ,base_2_valuechar_bodyactivitytime       as Bodyactivitytime\\n     ,base_2_valuechar_signalquality          as Signalquality\\n     ,'3代'              as sourceType\\n     ,base_2_clock_null  as fetchDateTime\\n from hive_iot_data.tb_properties_data_6924\\n where partitioned_date = regexp_replace(date_sub(current_date(),1),'-','')\\n union all\\n select\\n      deviceid\\n     ,productid\\n     ,macaddress\\n     ,cast(null as bigint)                    as mactype     \\n\\t ,cast(null as bigint)                    as OximeterSaturation\\n     ,cast(null as bigint)                    as OximeterPulse\\n     ,cast(null as bigint)                    as OximeterPerfusion\\n     ,base_3_status_onoroutofbed              as Onoroutofbed\\n     ,base_3_valuechar_heartrate              as Heartrate\\n     ,base_3_valuechar_respiratoryrate        as Respiratoryrate\\n     ,base_3_valueshort_bodyactivityenergy    as BodyActivityEnergy\\n     ,cast(null as bigint)                    as  TurnOverTimes \\n     ,base_3_status_bodyactivitytype          as BodyActivityType\\n     ,base_3_valuechar_bodyactivitytime       as Bodyactivitytime\\n     ,base_3_valuechar_signalquality          as Signalquality\\n     ,'3代'              as sourceType\\n     ,base_3_clock_null  as fetchDateTime\\n from hive_iot_data.tb_properties_data_6924\\n where partitioned_date = regexp_replace(date_sub(current_date(),1),'-','')\\n union all\\n select\\n      deviceid\\n     ,productid\\n     ,macaddress\\n     ,cast(null as bigint)                    as mactype     \\n\\t ,cast(null as bigint)                    as OximeterSaturation\\n     ,cast(null as bigint)                    as OximeterPulse\\n     ,cast(null as bigint)                    as OximeterPerfusion\\n     ,base_4_status_onoroutofbed              as Onoroutofbed\\n     ,base_4_valuechar_heartrate              as Heartrate\\n     ,base_4_valuechar_respiratoryrate        as Respiratoryrate\\n     ,base_4_valueshort_bodyactivityenergy    as BodyActivityEnergy\\n     ,cast(null as bigint)                    as  TurnOverTimes \\n     ,base_4_status_bodyactivitytype          as BodyActivityType\\n     ,base_4_valuechar_bodyactivitytime       as Bodyactivitytime\\n     ,base_4_valuechar_signalquality          as Signalquality\\n     ,'3代'              as sourceType\\n     ,base_4_clock_null  as fetchDateTime\\n from hive_iot_data.tb_properties_data_6924\\n where partitioned_date = regexp_replace(date_sub(current_date(),1),'-','')\\n union all\\n select\\n      deviceid\\n     ,productid\\n     ,macaddress\\n     ,cast(null as bigint)                    as mactype     \\n\\t ,cast(null as bigint)                    as OximeterSaturation\\n     ,cast(null as bigint)                    as OximeterPulse\\n     ,cast(null as bigint)                    as OximeterPerfusion\\n     ,base_5_status_onoroutofbed              as Onoroutofbed\\n     ,base_5_valuechar_heartrate              as Heartrate\\n     ,base_5_valuechar_respiratoryrate        as Respiratoryrate\\n     ,base_5_valueshort_bodyactivityenergy    as BodyActivityEnergy\\n     ,cast(null as bigint)                    as  TurnOverTimes \\n     ,base_5_status_bodyactivitytype          as BodyActivityType\\n     ,base_5_valuechar_bodyactivitytime       as Bodyactivitytime\\n     ,base_5_valuechar_signalquality          as Signalquality\\n     ,'3代'              as sourceType\\n     ,base_5_clock_null  as fetchDateTime\\n from hive_iot_data.tb_properties_data_6924\\n where partitioned_date = regexp_replace(date_sub(current_date(),1),'-','')\\n)a \\nleft join db_device_dw.clife_device_dim_device_bind b on a.deviceid = b.device_id and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_device_dw.clife_device_dim_product c on a.productid = c.product_id and c.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\norder by from_unixtime(cast(fetchDateTime as bigint),'yyyy-MM-dd HH:mm:ss')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"FORBIDDEN\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":3,\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"perception_6924_tmp_drop\"]},{\"type\":\"SQL\",\"id\":\"tasks-81849\",\"name\":\"error_6924_tmp_drop\",\"params\":{\"type\":\"HIVE\",\"datasource\":147,\"sql\":\"drop table if exists db_device_dw.clife_device_error_6924_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"FORBIDDEN\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[]},{\"type\":\"SQL\",\"id\":\"tasks-30283\",\"name\":\"error_6924_tmp_create\",\"params\":{\"type\":\"HIVE\",\"datasource\":147,\"sql\":\"create table if not exists db_device_dw.clife_device_error_6924_tmp stored as parquet as \\nselect\\n     a.common_deviceid                  -- 设备id\\n    ,a.common_productid                 -- 产品id\\n    ,c.device_type_id            -- 设备大类\\n    ,c.device_subtype_id         -- 设备子类\\n    ,b.bind_user_id              -- 绑定用户\\n    ,a.common_macaddress                -- mac\\n    ,a.mactype                   -- mac地址类型 \\n    ,a.SDCardInsertStatus   -- sd卡插入\\n    ,a.SDCardCapacityStatus -- SD卡容量\\n    ,a.SDCardRWStatus       -- SD卡读写\\n    ,a.ALinkStatus          -- A路接入\\n    ,a.BLinkStatus          -- B路接入\\n    ,a.OximeterFault        -- 血氧夹故障\\n    ,a.error_longitude       -- 历史数据FLASH操作故障\\n    ,a.error_timing          -- 历史数据FLASH满故障\\n    ,a.error_deforst         -- MCU复位              \\n    ,a.error_notclosed       -- MCU看门狗复位        \\n    ,a.error_waterpresshigh  -- MCU命令复位          \\n    ,a.error_waterpresslow   -- WIFI无应答故障       \\n    ,a.error_wifitomcucomm   -- 断网故障             \\n    ,a.error_poweroffmemory  -- 时间故障             \\n    ,a.error_fccomm          -- 原始数据FLASH操作故障\\n    ,a.error_off             -- 原始数据FLASH满故障 \\n    ,a.error_fake            -- 绑定\\n    ,a.error_comm            -- 路由器断网故障 \\n    ,a.error_connect         -- 服务器断网故障 \\n    ,a.error_humilow         -- WIFI信号弱     \\n    ,a.error_on              -- ADC采样故障    \\n    ,a.datasource                -- 数据来源\\n    ,from_unixtime(cast(a.fetchDateTime/1000 as bigint),'yyyy-MM-dd HH:mm:ss')  as  fetchDateTime  --采集时间\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date -- 分区时间\\nfrom \\n(\\n select\\n      common_deviceid  -- 设备id\\n     ,common_productid -- 产品id\\n     ,common_macaddress                       -- macaddress\\n     ,cast(null as bigint) as mactype              -- mac地址类型\\n     ,cast(null as bigint) as SDCardInsertStatus   -- sd卡插入\\n     ,cast(null as bigint) as SDCardCapacityStatus -- SD卡容量\\n     ,cast(null as bigint) as SDCardRWStatus       -- SD卡读写\\n     ,cast(null as bigint) as ALinkStatus          -- A路接入\\n     ,cast(null as bigint) as BLinkStatus          -- B路接入\\n     ,cast(null as bigint) as OximeterFault        -- 血氧夹故障\\n     ,error_base_null_error_longitude      as   error_longitude       -- 历史数据FLASH操作故障\\n     ,error_base_null_error_timing         as   error_timing          -- 历史数据FLASH满故障\\n     ,error_base_null_error_deforst        as   error_deforst         -- MCU复位              \\n     ,error_base_null_error_notclosed      as   error_notclosed       -- MCU看门狗复位        \\n     ,error_base_null_error_waterpresshigh as   error_waterpresshigh  -- MCU命令复位          \\n     ,error_base_null_error_waterpresslow  as   error_waterpresslow   -- WIFI无应答故障       \\n     ,error_base_null_error_wifitomcucomm  as   error_wifitomcucomm   -- 断网故障             \\n     ,error_base_null_error_poweroffmemory as   error_poweroffmemory  -- 时间故障             \\n     ,error_base_null_error_fccomm         as   error_fccomm          -- 原始数据FLASH操作故障\\n     ,error_base_null_error_off            as   error_off             -- 原始数据FLASH满故障 \\n     ,error_base_null_error_fake           as   error_fake            -- 绑定\\n     ,error_base_null_error_comm           as   error_comm            -- 路由器断网故障 \\n     ,error_base_null_error_connect        as   error_connect         -- 服务器断网故障 \\n     ,error_base_null_error_humilow        as   error_humilow         -- WIFI信号弱     \\n     ,error_base_null_error_on             as   error_on              -- ADC采样故障    \\n     ,'3代' as datasource -- 数据来源\\n     ,common_datatimestamp as fetchDateTime --采集时间\\n from hive_iot_data.tb_event_data_6924\\n where partitioned_date = regexp_replace(date_sub(current_date(),1),'-','')\\n order by fetchDateTime\\n)a \\nleft join db_device_dw.clife_device_dim_device_bind b on a.common_deviceid = b.device_id and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_device_dw.clife_device_dim_product c on a.common_productid = c.product_id and c.part_date = regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"FORBIDDEN\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":3,\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"error_6924_tmp_drop\"]},{\"type\":\"SQL\",\"id\":\"tasks-8-13g6ew\",\"name\":\"error_11619_tmp_drop\",\"params\":{\"type\":\"HIVE\",\"datasource\":147,\"sql\":\"drop table if exists db_device_dw.clife_device_error_11619_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"error_6924_tmp_create\"]},{\"type\":\"SQL\",\"id\":\"tasks-3-76c29h\",\"name\":\"error_11619_tmp_create\",\"params\":{\"type\":\"HIVE\",\"datasource\":147,\"sql\":\"create table if not exists db_device_dw.clife_device_error_11619_tmp stored as parquet as \\nselect\\n     a.common_deviceid                  -- 设备id\\n    ,a.common_productid                 -- 产品id\\n    ,c.device_type_id            -- 设备大类\\n    ,c.device_subtype_id         -- 设备子类\\n    ,b.bind_user_id              -- 绑定用户\\n    ,a.common_macaddress                -- mac\\n    ,a.mactype                   -- mac地址类型 \\n    ,a.SDCardInsertStatus   -- sd卡插入\\n    ,a.SDCardCapacityStatus -- SD卡容量\\n    ,a.SDCardRWStatus       -- SD卡读写\\n    ,a.ALinkStatus          -- A路接入\\n    ,a.BLinkStatus          -- B路接入\\n    ,a.OximeterFault        -- 血氧夹故障\\n    ,a.error_longitude       -- 历史数据FLASH操作故障\\n    ,a.error_timing          -- 历史数据FLASH满故障\\n    ,a.error_deforst         -- MCU复位              \\n    ,a.error_notclosed       -- MCU看门狗复位        \\n    ,a.error_waterpresshigh  -- MCU命令复位          \\n    ,a.error_waterpresslow   -- WIFI无应答故障       \\n    ,a.error_wifitomcucomm   -- 断网故障             \\n    ,a.error_poweroffmemory  -- 时间故障             \\n    ,a.error_fccomm          -- 原始数据FLASH操作故障\\n    ,a.error_off             -- 原始数据FLASH满故障 \\n    ,a.error_fake            -- 绑定\\n    ,a.error_comm            -- 路由器断网故障 \\n    ,a.error_connect         -- 服务器断网故障 \\n    ,a.error_humilow         -- WIFI信号弱     \\n    ,a.error_on              -- ADC采样故障    \\n    ,a.datasource                -- 数据来源\\n    ,from_unixtime(cast(a.fetchDateTime/1000 as bigint),'yyyy-MM-dd HH:mm:ss')  as  fetchDateTime  --采集时间\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date -- 分区时间\\nfrom \\n(\\n select\\n      common_deviceid  -- 设备id\\n     ,common_productid -- 产品id\\n     ,common_macaddress                       -- macaddress\\n     ,cast(null as bigint) as mactype              -- mac地址类型\\n     ,cast(null as bigint) as SDCardInsertStatus   -- sd卡插入\\n     ,cast(null as bigint) as SDCardCapacityStatus -- SD卡容量\\n     ,cast(null as bigint) as SDCardRWStatus       -- SD卡读写\\n     ,cast(null as bigint) as ALinkStatus          -- A路接入\\n     ,cast(null as bigint) as BLinkStatus          -- B路接入\\n     ,cast(null as bigint) as OximeterFault        -- 血氧夹故障\\n     ,error_base_null_error_longitude      as   error_longitude       -- 历史数据FLASH操作故障\\n     ,error_base_null_error_timing         as   error_timing          -- 历史数据FLASH满故障\\n     ,error_base_null_error_deforst        as   error_deforst         -- MCU复位              \\n     ,error_base_null_error_notclosed      as   error_notclosed       -- MCU看门狗复位        \\n     ,error_base_null_error_waterpresshigh as   error_waterpresshigh  -- MCU命令复位          \\n     ,error_base_null_error_waterpresslow  as   error_waterpresslow   -- WIFI无应答故障       \\n     ,error_base_null_error_wifitomcucomm  as   error_wifitomcucomm   -- 断网故障             \\n     ,error_base_null_error_poweroffmemory as   error_poweroffmemory  -- 时间故障             \\n     ,error_base_null_error_fccomm         as   error_fccomm          -- 原始数据FLASH操作故障\\n     ,error_base_null_error_off            as   error_off             -- 原始数据FLASH满故障 \\n     ,error_base_null_error_fake           as   error_fake            -- 绑定\\n     ,error_base_null_error_comm           as   error_comm            -- 路由器断网故障 \\n     ,error_base_null_error_connect        as   error_connect         -- 服务器断网故障 \\n     ,error_base_null_error_humilow        as   error_humilow         -- WIFI信号弱     \\n     ,error_base_null_error_on             as   error_on              -- ADC采样故障    \\n     ,'3代' as datasource -- 数据来源\\n     ,common_datatimestamp as fetchDateTime --采集时间\\n from hive_iot_data.tb_event_data_11619\\n where partitioned_date = regexp_replace(date_sub(current_date(),1),'-','')\\n order by fetchDateTime\\n)a \\nleft join db_device_dw.clife_device_dim_device_bind b on a.common_deviceid = b.device_id and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_device_dw.clife_device_dim_product c on a.common_productid = c.product_id and c.part_date = regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":3,\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"error_11619_tmp_drop\"]},{\"type\":\"SQL\",\"id\":\"tasks-44986\",\"name\":\"clife_device_dwd_sleep_error_data\",\"params\":{\"type\":\"HIVE\",\"datasource\":147,\"sql\":\"insert overwrite table clife_device_dwd_sleep_error_data partition(part_date)\\nselect\\n common_deviceid   as    deviceid            -- 设备id\\n,common_productid  as    productid           -- 产品id\\n,device_type_id            -- 设备大类\\n,device_subtype_id         -- 设备子类\\n,bind_user_id              -- 绑定用户\\n,common_macaddress as   macaddress -- mac\\n,mactype              -- mac地址类型 \\n,SDCardInsertStatus   as error_sdcardinsertstatus -- sd卡插入\\n,SDCardCapacityStatus as error_sdcardcapacitystatus-- SD卡容量\\n,SDCardRWStatus       as error_sdcardrwstatus-- SD卡读写\\n,ALinkStatus          as error_alinkstatus-- A路接入\\n,BLinkStatus          as error_blinkstatus-- B路接入\\n,OximeterFault        as error_oximeterfault                  -- 血氧夹故障\\n,error_longitude      as error_base_null_error_longitude      -- 历史数据FLASH操作故障\\n,error_timing         as error_base_null_error_timing         -- 历史数据FLASH满故障\\n,error_deforst        as error_base_null_error_deforst        -- MCU复位              \\n,error_notclosed      as error_base_null_error_notclosed      -- MCU看门狗复位        \\n,error_waterpresshigh as error_base_null_error_waterpresshigh -- MCU命令复位          \\n,error_waterpresslow  as error_base_null_error_waterpresslow  -- WIFI无应答故障       \\n,error_wifitomcucomm  as error_base_null_error_wifitomcucomm  -- 断网故障             \\n,error_poweroffmemory as error_base_null_error_poweroffmemory -- 时间故障             \\n,error_fccomm         as error_base_null_error_fccomm         -- 原始数据FLASH操作故障\\n,error_off            as error_base_null_error_off            -- 原始数据FLASH满故障 \\n,error_fake           as error_base_null_error_fake           -- 绑定\\n,error_comm           as error_base_null_error_comm           -- 路由器断网故障 \\n,error_connect        as error_base_null_error_connect        -- 服务器断网故障 \\n,error_humilow        as error_base_null_error_humilow        -- WIFI信号弱     \\n,error_on             as error_base_null_error_on             -- ADC采样故障    \\n,datasource                -- 数据来源\\n,cast(fetchDateTime as timestamp) as fetchDateTime  --采集时间\\n,part_date -- 分区时间\\nfrom db_device_dw.clife_device_error_11619_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":3,\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"error_11619_tmp_create\"]},{\"type\":\"SQL\",\"id\":\"tasks-66590\",\"name\":\"clife_device_dwd_properties_data_4994\",\"params\":{\"type\":\"HIVE\",\"datasource\":149,\"sql\":\"insert overwrite table db_device_dw.clife_device_dwd_properties_data_4994 partition(part_date)\\nselect \\nscreenmode\\n,reserved  \\n,updateflag\\n,regexp_replace(date_sub(current_date(),1),'-','') as part_date --跑数日期\\nfrom hive_iot_data.tb_properties_data_4994\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_device_dwd_sleep_run_data\"]}],\"tenantId\":-1,\"timeout\":0}","description":"","globalParams":"[]","globalParamList":[],"globalParamMap":{},"createTime":"2021-10-26T03:42:21.000+0000","updateTime":"2021-11-10T09:01:39.000+0000","flag":"YES","userId":160,"userName":"data_warehouse","projectName":null,"locations":"{\"tasks-46403\":{\"name\":\"clife_device_dwd_sleep_run_data\",\"targetarr\":\"tasks-8-2p030v\",\"nodenumber\":\"1\",\"x\":834,\"y\":125},\"tasks-71244\":{\"name\":\"clife_device_dwd_sleep_perception_data\",\"targetarr\":\"tasks-7-7mn68k\",\"nodenumber\":\"1\",\"x\":817,\"y\":281},\"tasks-4-4vh50\":{\"name\":\"run_11619_tmp_drop\",\"targetarr\":\"tasks-75645\",\"nodenumber\":\"1\",\"x\":438,\"y\":128},\"tasks-8-2p030v\":{\"name\":\"run_11619_tmp_create\",\"targetarr\":\"tasks-4-4vh50\",\"nodenumber\":\"1\",\"x\":629,\"y\":124},\"tasks-6-2zf5kz\":{\"name\":\"perception_11619_tmp_drop\",\"targetarr\":\"tasks-13000\",\"nodenumber\":\"1\",\"x\":433,\"y\":278},\"tasks-7-7mn68k\":{\"name\":\"perception_11619_tmp_create\",\"targetarr\":\"tasks-6-2zf5kz\",\"nodenumber\":\"1\",\"x\":611,\"y\":284},\"tasks-99171\":{\"name\":\"run_11762_tmp_drop\",\"targetarr\":\"tasks-39685\",\"nodenumber\":\"1\",\"x\":428,\"y\":421},\"tasks-23713\":{\"name\":\"run_11762_tmp_create\",\"targetarr\":\"tasks-99171\",\"nodenumber\":\"1\",\"x\":626,\"y\":427},\"tasks-31355\":{\"name\":\"clife_device_dwd_air_conditioning_run_data1\",\"targetarr\":\"tasks-23713\",\"nodenumber\":\"0\",\"x\":838,\"y\":426},\"tasks-89128\":{\"name\":\"run_7068_tmp_drop\",\"targetarr\":\"\",\"nodenumber\":\"1\",\"x\":64,\"y\":429},\"tasks-39685\":{\"name\":\"run_7068_tmp_create\",\"targetarr\":\"tasks-89128\",\"nodenumber\":\"1\",\"x\":261,\"y\":422},\"tasks-44935\":{\"name\":\"perception_7068_tmp_drop\",\"targetarr\":\"tasks-71244\",\"nodenumber\":\"1\",\"x\":1014,\"y\":278},\"tasks-18369\":{\"name\":\"perception_7068_tmp_create\",\"targetarr\":\"tasks-44935\",\"nodenumber\":\"1\",\"x\":1218,\"y\":277},\"tasks-73390\":{\"name\":\"clife_device_dwd_air_conditioning_perception_data\",\"targetarr\":\"tasks-18369\",\"nodenumber\":\"0\",\"x\":1480,\"y\":274},\"tasks-78953\":{\"name\":\"run_6924_tmp_drop\",\"targetarr\":\"\",\"nodenumber\":\"1\",\"x\":96,\"y\":131},\"tasks-75645\":{\"name\":\"run_6924_tmp_create\",\"targetarr\":\"tasks-78953\",\"nodenumber\":\"1\",\"x\":278,\"y\":126},\"tasks-23308\":{\"name\":\"perception_6924_tmp_drop\",\"targetarr\":\"\",\"nodenumber\":\"1\",\"x\":93,\"y\":281},\"tasks-13000\":{\"name\":\"perception_6924_tmp_create\",\"targetarr\":\"tasks-23308\",\"nodenumber\":\"1\",\"x\":273,\"y\":274},\"tasks-81849\":{\"name\":\"error_6924_tmp_drop\",\"targetarr\":\"\",\"nodenumber\":\"1\",\"x\":47,\"y\":603},\"tasks-30283\":{\"name\":\"error_6924_tmp_create\",\"targetarr\":\"tasks-81849\",\"nodenumber\":\"1\",\"x\":260,\"y\":601},\"tasks-8-13g6ew\":{\"name\":\"error_11619_tmp_drop\",\"targetarr\":\"tasks-30283\",\"nodenumber\":\"1\",\"x\":441,\"y\":599},\"tasks-3-76c29h\":{\"name\":\"error_11619_tmp_create\",\"targetarr\":\"tasks-8-13g6ew\",\"nodenumber\":\"1\",\"x\":626,\"y\":599},\"tasks-44986\":{\"name\":\"clife_device_dwd_sleep_error_data\",\"targetarr\":\"tasks-3-76c29h\",\"nodenumber\":\"0\",\"x\":837,\"y\":599},\"tasks-66590\":{\"name\":\"clife_device_dwd_properties_data_4994\",\"targetarr\":\"tasks-46403\",\"nodenumber\":\"0\",\"x\":1051,\"y\":124}}","connects":"[{\"endPointSourceId\":\"tasks-4-4vh50\",\"endPointTargetId\":\"tasks-8-2p030v\"},{\"endPointSourceId\":\"tasks-8-2p030v\",\"endPointTargetId\":\"tasks-46403\"},{\"endPointSourceId\":\"tasks-6-2zf5kz\",\"endPointTargetId\":\"tasks-7-7mn68k\"},{\"endPointSourceId\":\"tasks-7-7mn68k\",\"endPointTargetId\":\"tasks-71244\"},{\"endPointSourceId\":\"tasks-99171\",\"endPointTargetId\":\"tasks-23713\"},{\"endPointSourceId\":\"tasks-23713\",\"endPointTargetId\":\"tasks-31355\"},{\"endPointSourceId\":\"tasks-89128\",\"endPointTargetId\":\"tasks-39685\"},{\"endPointSourceId\":\"tasks-39685\",\"endPointTargetId\":\"tasks-99171\"},{\"endPointSourceId\":\"tasks-44935\",\"endPointTargetId\":\"tasks-18369\"},{\"endPointSourceId\":\"tasks-18369\",\"endPointTargetId\":\"tasks-73390\"},{\"endPointSourceId\":\"tasks-78953\",\"endPointTargetId\":\"tasks-75645\"},{\"endPointSourceId\":\"tasks-75645\",\"endPointTargetId\":\"tasks-4-4vh50\"},{\"endPointSourceId\":\"tasks-23308\",\"endPointTargetId\":\"tasks-13000\"},{\"endPointSourceId\":\"tasks-13000\",\"endPointTargetId\":\"tasks-6-2zf5kz\"},{\"endPointSourceId\":\"tasks-81849\",\"endPointTargetId\":\"tasks-30283\"},{\"endPointSourceId\":\"tasks-30283\",\"endPointTargetId\":\"tasks-8-13g6ew\"},{\"endPointSourceId\":\"tasks-8-13g6ew\",\"endPointTargetId\":\"tasks-3-76c29h\"},{\"endPointSourceId\":\"tasks-3-76c29h\",\"endPointTargetId\":\"tasks-44986\"},{\"endPointSourceId\":\"tasks-71244\",\"endPointTargetId\":\"tasks-44935\"},{\"endPointSourceId\":\"tasks-46403\",\"endPointTargetId\":\"tasks-66590\"}]","receivers":"","receiversCc":"","leadMobile":"","ddAlarmId":0,"scheduleReleaseState":null,"timeout":0,"tenantId":-1,"taskType":"SHELL"},{"id":856,"name":"db_dim_nstc","version":0,"releaseState":"ONLINE","projectId":34,"processDefinitionJson":"{\"globalParams\":[],\"tasks\":[{\"type\":\"SQL\",\"id\":\"tasks-55317\",\"name\":\"clife_nstc_dim_township_area\",\"params\":{\"type\":\"HIVE\",\"datasource\":161,\"sql\":\"insert overwrite table db_dw_nstc.clife_nstc_dim_township_area partition(part_date)\\nselect \\n     id                             -- 'id' \\n    ,name_prov                      -- '省' \\n    ,code_prov                      -- '省code' \\n    ,name_city                      -- '市' \\n    ,code_city                      -- '市code' \\n    ,name_coun                      -- '区' \\n    ,code_coun                      -- '区code' \\n    ,name_town                      -- '镇' \\n    ,code_town                      -- '镇code'\\n    ,part_date                      -- '分区日期'\\nfrom db_ods_nstc.clife_nstc_ods_township_area\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','') \",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_dim_township_area\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_dim_goods_type\"]},{\"type\":\"SQL\",\"id\":\"tasks-97413\",\"name\":\"clife_nstc_dim_shop_coupon\",\"params\":{\"type\":\"HIVE\",\"datasource\":161,\"sql\":\"\\ninsert overwrite table db_dw_nstc.clife_nstc_dim_shop_coupon partition(part_date)\\nselect\\n     id                             -- 'ID' \\n    ,shop_id                        -- '店铺id' \\n    ,coupon_name                    -- '优惠券名称' \\n    ,`type`                         -- '优惠券类型(1-满减)' \\n    ,sub_money                      -- '优惠金额' \\n    ,enough_money                   -- '满减满足金额' \\n    ,total_num                      -- '总数量' \\n    ,limit_sartAt                   -- '使用期限起' \\n    ,limit_endAt                    -- '使用期限至' \\n    ,limit_number                   -- '允许单人领取数量' \\n    ,has_score                      -- '发送方式（0：余额购买，1：免费发放）' \\n    ,buy_money                      -- '所需余额' \\n    ,`status`                       -- '状态(0可用,1不可用)' \\n    ,create_at                      -- '创建时间' \\n    ,update_at                      -- '更新时间' \\n    ,part_date                      -- '分区日期'\\nfrom db_ods_nstc.clife_nstc_ods_shop_coupon\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','') and del_flag = 0 \\n\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_dim_shop_coupon\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_dim_township_area\"]},{\"type\":\"SQL\",\"id\":\"tasks-48409\",\"name\":\"clife_nstc_dim_goods_product\",\"params\":{\"type\":\"HIVE\",\"datasource\":161,\"sql\":\"insert overwrite table db_dw_nstc.clife_nstc_dim_goods_product partition(part_date)\\nselect\\n     product_id                     -- '产品id' \\n    ,batch_id                       -- '批次id' \\n    ,sku                            -- 'SKU' \\n    ,goods_id                       -- '商品ID' \\n    ,product_name                   -- '货品名' \\n    ,product_img                    -- '产品图片' \\n    ,product_spec                   -- '货品规格' \\n    ,product_price                  -- '价格' \\n    ,product_post                   -- '期货购买价' \\n    ,product_weight                 -- '一包的重量' \\n    ,product_buy_min                -- '期货卖出一包的重量' \\n    ,create_at                      -- '创建时间' \\n    ,update_at                      -- '修改时间' \\n    ,store_name                     -- '仓库名' \\n    ,product_loading\\n    ,part_date                      -- '分区日期'\\nfrom db_ods_nstc.clife_nstc_ods_goods_product\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','') and del_flag = 0 \\n\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_dim_goods_product\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_dim_shop_coupon\"]},{\"type\":\"SQL\",\"id\":\"tasks-65730\",\"name\":\"clife_nstc_dim_goods_brand\",\"params\":{\"type\":\"HIVE\",\"datasource\":161,\"sql\":\"insert overwrite table db_dw_nstc.clife_nstc_dim_goods_brand partition(part_date)\\nselect \\n     brand_id                       -- '品牌id' \\n    ,brand_name                     -- '品牌名称' \\n    ,brand_url                      -- '品牌网址' \\n    ,brand_img                      -- '图片地址' \\n    ,brand_note                     -- '品牌介绍' \\n    ,brand_location                 -- '排序字段' \\n    ,create_id                      -- '创建用户id' \\n    ,create_at                      -- '创建时间' \\n    ,update_at                      -- '修改时间' \\n    ,part_date                      -- '分区日期'\\nfrom db_ods_nstc.clife_nstc_ods_goods_brand\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','') and del_flag = 0 \",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_dim_goods_brand\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_dim_goods_product\"]},{\"type\":\"SQL\",\"id\":\"tasks-55844\",\"name\":\"clife_nstc_dim_goods_class\",\"params\":{\"type\":\"HIVE\",\"datasource\":161,\"sql\":\"insert overwrite table db_dw_nstc.clife_nstc_dim_goods_class partition(part_date)\\nselect  \\n     class_id                       -- '商品分类id' \\n    ,parent_id                      -- '父级ID' \\n    ,class_name                     -- '分类名称' \\n    ,class_img                      -- '图片路径' \\n    ,type_id                        -- '类型0-苗木分类,1-农资分类' \\n    ,class_level                    -- '类型等级(0-大类,1-小类)' \\n    ,class_show                     -- '是否显示(0-显示,1-隐藏)' \\n    ,create_id                      -- '创建用户id' \\n    ,create_at                      -- '创建时间' \\n    ,update_at                      -- '修改时间' \\n    ,part_date                      -- '分区日期'\\nfrom db_ods_nstc.clife_nstc_ods_goods_class\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','') and del_flag = 0 \",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_dim_goods_class\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_dim_goods_brand\"]},{\"type\":\"SQL\",\"id\":\"tasks-63481\",\"name\":\"clife_nstc_dim_goods_goods\",\"params\":{\"type\":\"HIVE\",\"datasource\":161,\"sql\":\"insert overwrite table db_dw_nstc.clife_nstc_dim_goods_goods partition(part_date)\\nselect   \\n     a.goods_id                       -- '商品id' \\n    ,a.shop_id                        -- '店铺id' \\n    ,d.shop_name                      -- '店铺名称' \\n    ,a.goods_name                     -- '商品名称' \\n    ,a.goods_title                    -- '商品标题' \\n    ,a.class_id                       -- '商品分类' \\n    ,b.class_name                     -- '分类名称' \\n    ,b.parent_id                      -- '父级ID' \\n    ,b.class_level                    -- '类型等级(0-大类,1-小类)' \\n    ,a.type_id                        -- '商品类型' \\n    ,e.type_name\\n    ,a.goods_img                      -- '商品主图' \\n    ,a.goods_note                     -- '0-农资商品,1-苗木商品' \\n    ,a.goods_prop                     -- '商品等级' \\n    ,a.goods_spec                     -- '规格详情' \\n    ,a.goods_param                    -- '参数详情' \\n    ,a.has_spec                       -- '启用规格' \\n    ,a.goods_unit                     -- '计量单位' \\n    ,a.goods_loading                  -- '是否下架(0-待上架，1-上架,2下架，3-待审核,4-拒绝5-卖出)' \\n    ,a.recommend                      -- '商品推荐0-不推荐,1-推荐' \\n    ,a.recom_xq                       -- '邮费,0-包邮,1-不包邮' \\n    ,a.recom_gwc                      -- '挂牌0-普通,1-挂牌' \\n    ,a.brand_id                       -- '商品品牌' \\n    ,c.brand_name                     -- '品牌名称' \\n    ,c.brand_url                      -- '品牌网址' \\n    ,a.create_at                      -- '创建时间' \\n    ,a.update_at                      -- '修改时间' \\n    ,a.part_date                      -- '分区日期'\\nfrom (\\n    select \\n         goods_id                     -- '商品id' \\n        ,shop_id                      -- '店铺id' \\n        ,goods_name                   -- '商品名称' \\n        ,goods_title                  -- '商品标题' \\n        ,class_id                     -- '商品分类' \\n        ,type_id                      -- '商品类型' \\n        ,goods_img                    -- '商品主图' \\n        ,goods_note                   -- '0-农资商品,1-苗木商品' \\n        ,goods_prop                   -- '商品等级' \\n        ,goods_spec                   -- '规格详情' \\n        ,goods_param                  -- '参数详情' \\n        ,has_spec                     -- '启用规格' \\n        ,goods_unit                   -- '计量单位' \\n        ,goods_loading                -- '是否下架(0-待上架，1-上架,2下架，3-待审核,4-拒绝5-卖出)' \\n        ,recommend                    -- '商品推荐0-不推荐,1-推荐' \\n        ,recom_xq                     -- '邮费,0-包邮,1-不包邮' \\n        ,recom_gwc                    -- '挂牌0-普通,1-挂牌' \\n        ,brand_id                     -- '商品品牌' \\n        ,create_at                    -- '创建时间' \\n        ,update_at                    -- '修改时间'\\n        ,part_date                    -- '分区日期'\\n    from db_ods_nstc.clife_nstc_ods_goods_goods\\n    where part_date = regexp_replace(date_sub(current_date(),1),'-','') and del_flag = 0 \\n) a \\nleft join db_dw_nstc.clife_nstc_dim_goods_class b \\non a.part_date = b.part_date and a.class_id = b.class_id\\nleft join db_dw_nstc.clife_nstc_dim_goods_brand c \\non a.part_date = b.part_date and a.brand_id = c.brand_id\\nleft join db_dw_nstc.clife_nstc_dim_shop_shop d \\non a.part_date = d.part_date and a.shop_id = d.shop_id\\nleft join db_dw_nstc.clife_nstc_dim_goods_type e \\non a.part_date = e.part_date and a.type_id = e.type_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_dim_goods_goods\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_dim_goods_class\"]},{\"type\":\"SQL\",\"id\":\"tasks-10806\",\"name\":\"clife_nstc_dim_member_address\",\"params\":{\"type\":\"HIVE\",\"datasource\":161,\"sql\":\"insert overwrite table db_dw_nstc.clife_nstc_dim_member_address partition(part_date)\\nselect   \\n     address_id                     -- '收货地址id' \\n    ,member_id                      -- '会员ID' \\n    ,province                       -- '所在省' \\n    ,city                           -- '所在市' \\n    ,area                           -- '所在县区' \\n    ,town                           -- '所在街道' \\n    ,address                        -- '详细地址' \\n    ,post_code                      -- '邮政编码' \\n    ,full_name                      -- '收货人姓名' \\n    ,phone                          -- '收货人电话' \\n    ,default_value                  -- '是否默认0-非默认,-1默认' \\n    ,create_at                      -- '创建时间' \\n    ,update_at                      -- '修改时间' \\n    ,part_date                      -- '分区日期'\\nfrom db_ods_nstc.clife_nstc_ods_member_address\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','') and del_flag = 0 \",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_dim_member_address\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_dim_goods_goods\"]},{\"type\":\"SQL\",\"id\":\"tasks-10260\",\"name\":\"clife_nstc_dim_shop_shop\",\"params\":{\"type\":\"HIVE\",\"datasource\":161,\"sql\":\"insert overwrite table db_dw_nstc.clife_nstc_dim_shop_shop partition(part_date)\\nselect    \\n     a.shop_id                        -- '店铺信息id' \\n    ,a.shop_main                      -- '主营品种' \\n    ,a.shop_user_id                   -- '商户ID' \\n    ,b.`name`                         -- '商家昵称' \\n    ,a.shop_name                      -- '店铺名称' \\n    ,a.shop_logo                      -- '店铺图片' \\n    ,a.shop_background                -- '背景图' \\n    ,a.shop_desc                      -- '店铺简介' \\n    ,a.shop_notice                    -- '店铺介绍内容' \\n    ,a.shop_type                      -- '认证类型0-个人，1-企业，2-经纪人,10-未认证' \\n    ,a.shop_phone                     -- '店铺手机号' \\n    ,a.shop_province                  -- '店铺所在省' \\n    ,a.shop_city                      -- '店铺所在城市' \\n    ,a.shop_area                      -- '店铺所在区域' \\n    ,a.shop_town                      -- '乡镇' \\n    ,a.shop_address                   -- '经营地址' \\n    ,a.shop_star                      -- '信誉值(默认80)' \\n    ,a.longitude                      -- '经度' \\n    ,a.latitude                       -- '纬度' \\n    ,a.create_id                      -- '操作人' \\n    ,a.create_at                      -- '创建时间'   \\n    ,recommend\\n    ,shop_check\\n    ,a.part_date                      -- '分区日期'    \\nfrom (\\n    select \\n         shop_id                        -- '店铺信息id' \\n        ,shop_main                      -- '主营品种' \\n        ,shop_user_id                   -- '商户ID' \\n        ,shop_name                      -- '店铺名称' \\n        ,shop_logo                      -- '店铺图片' \\n        ,shop_background                -- '背景图' \\n        ,shop_desc                      -- '店铺简介' \\n        ,shop_notice                    -- '店铺介绍内容' \\n        ,shop_type                      -- '认证类型0-个人，1-企业，2-经纪人,10-未认证' \\n        ,shop_phone                     -- '店铺手机号' \\n        ,shop_province                  -- '店铺所在省' \\n        ,shop_city                      -- '店铺所在城市' \\n        ,shop_area                      -- '店铺所在区域' \\n        ,shop_town                      -- '乡镇' \\n        ,shop_address                   -- '经营地址' \\n        ,shop_star                      -- '信誉值(默认80)' \\n        ,longitude                      -- '经度' \\n        ,latitude                       -- '纬度' \\n        ,create_id                      -- '操作人' \\n        ,create_at                      -- '创建时间'\\n        ,part_date                      -- '分区日期'\\n        ,recommend\\n        ,shop_check\\n    from db_ods_nstc.clife_nstc_ods_shop_shop \\n    where part_date = regexp_replace(date_sub(current_date(),1),'-','') and del_flag = 0 and disabled = 0\\n) a \\nleft join db_ods_nstc.clife_nstc_ods_shop_user b \\non a.part_date = b.part_date and a.shop_user_id = b.shop_user_id and b.del_flag = 0 -- and b.disabled = 0\\n\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_dim_shop_shop\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_dim_member_address\"]},{\"type\":\"SQL\",\"id\":\"tasks-470\",\"name\":\"clife_nstc_dim_member_user\",\"params\":{\"type\":\"HIVE\",\"datasource\":161,\"sql\":\"insert overwrite table db_dw_nstc.clife_nstc_dim_member_user partition(part_date)\\nselect   \\n     a.member_id                      -- '会员id' \\n    ,a.member_phone                   -- '手机号' \\n    ,a.member_name                    -- '昵称' \\n    ,a.member_avator                  -- '头像' \\n    ,a.intro_user                     -- '推荐人' \\n    ,a.`level`                        -- '身份0-个人,1-企业,2-经纪人,10-未选择' \\n    ,a.unionid                        -- '微信unionid' \\n    ,a.openid                         -- '微信openId' \\n    ,a.wx_name                        -- '微信昵称' \\n    ,a.ali_name                       -- '阿里名字' \\n    ,a.ali_account                    -- '阿里手机号' \\n    ,b.icbc_id                        -- '工行认证id' \\n    ,b.vendor_short_name              -- '企业用户简称' \\n    ,b.vendor_email                   -- '企业用户邮箱' \\n    ,b.province                       -- '所在省 code例130000' \\n    ,b.city                           -- '所在市 code例130100' \\n    ,b.county                         -- '所在区县code例130102' \\n    ,b.address                        -- '详细地址' \\n    ,b.postcode                       -- '邮政编码' \\n    ,b.vendor_type                    -- '企业用户类型，开通 E企付担保支付时必 输 01-企业 06-个体工商户' \\n    ,b.cert_type                      -- '企业用户注册证件类 型，100-全国组织机构代码 证书101-营业执照 102-行政机关 103-社会团体法人登记 证书104-军队单位开户核准 通知书 105-武警部队单位开户 核准通知书 106-下属机构(具有主管 单位批文号) 107-其他(包含统一社会 信用代码) 108-商业登记证 109-公司注册证' \\n    ,b.cert_no                        -- '企业用户注册证件号码，' \\n    ,b.cert_pic                       -- '企业用户注册证件图片' \\n    ,b.cert_validityl_str             -- '企业用户注册证件有 效期' \\n    ,a.create_at                      -- '注册时间' \\n    ,a.update_at                      -- '更新时间' \\n    ,a.part_date\\nfrom (\\nselect \\n     member_id                      -- '会员id' \\n    ,member_phone                   -- '手机号' \\n    ,member_name                    -- '昵称' \\n    ,member_avator                  -- '头像' \\n    ,intro_user                     -- '推荐人' \\n    ,`level`                        -- '身份0-个人,1-企业,2-经纪人,10-未选择' \\n    ,unionid                        -- '微信unionid' \\n    ,openid                         -- '微信openId' \\n    ,wx_name                        -- '微信昵称' \\n    ,ali_name                       -- '阿里名字' \\n    ,ali_account                    -- '阿里手机号' \\n    ,create_at                      -- '注册时间' \\n    ,update_at                      -- '更新时间' \\n    ,part_date                      -- '分区日期'\\nfrom db_ods_nstc.clife_nstc_ods_member_user\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','') and del_flag = 0 and disabled = 0\\n) a \\nleft join db_ods_nstc.clife_nstc_ods_member_icbc b \\non a.part_date = b.part_date and a.member_id = b.member_id  \\n\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_dim_member_user\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_dim_shop_shop\"]},{\"type\":\"SQL\",\"id\":\"tasks-7-xv21d\",\"name\":\"clife_nstc_dim_goods_type\",\"params\":{\"type\":\"HIVE\",\"datasource\":161,\"sql\":\"insert overwrite table db_dw_nstc.clife_nstc_dim_goods_type partition(part_date)\\nselect \\n     type_id                        -- '类型id' \\n    ,shop_id                        -- '店铺id' \\n    ,type_name                      -- '类型名称' \\n    ,is_physical                    -- '实物商品0-非实物,1-实物' \\n    ,has_spec                       -- '使用规格0-不使用,1-使用' \\n    ,has_param                      -- '使用参数0-不使用,1-使用' \\n    ,has_brand                      -- '关联品牌0-不关联,1-关联' \\n    ,create_id                      -- '创建用户ID' \\n    ,create_at                      -- '创建时间' \\n    ,update_at                      -- '修改时间' \\n    ,part_date                      -- '分区日期'\\nfrom db_ods_nstc.clife_nstc_ods_goods_type\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','') and del_flag = 0\\n\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_dim_goods_type\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[]},{\"type\":\"SQL\",\"id\":\"tasks-66524\",\"name\":\"clife_nstc_dim_shop_user\",\"params\":{\"type\":\"HIVE\",\"datasource\":161,\"sql\":\"insert overwrite table db_dw_nstc.clife_nstc_dim_shop_user partition(part_date)\\nselect \\n     shop_user_id                   -- 商家账号id\\n    ,shop_id                        -- 商家id\\n    ,`level`                        -- 代理等级\\n    ,phone                          -- 手机号\\n    ,`name`                         -- 昵称\\n    ,avator                         -- 头像\\n    ,intro_user                     -- 推荐人\\n    ,disabled                       -- 是否冻结账号(0-正常,1-冻结)\\n    ,create_at                      -- 操作时间\\n    ,update_at                      -- 修改时间\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_ods_nstc.clife_nstc_ods_shop_user\\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  and del_flag=0\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_dim_member_user\"]}],\"tenantId\":-1,\"timeout\":0}","description":"db_dim_nstc","globalParams":"[]","globalParamList":[],"globalParamMap":{},"createTime":"2021-11-08T03:48:06.000+0000","updateTime":"2021-11-10T07:12:39.000+0000","flag":"YES","userId":160,"userName":"data_warehouse","projectName":null,"locations":"{\"tasks-55317\":{\"name\":\"clife_nstc_dim_township_area\",\"targetarr\":\"tasks-7-xv21d\",\"nodenumber\":\"1\",\"x\":202,\"y\":54},\"tasks-97413\":{\"name\":\"clife_nstc_dim_shop_coupon\",\"targetarr\":\"tasks-55317\",\"nodenumber\":\"1\",\"x\":385,\"y\":60},\"tasks-48409\":{\"name\":\"clife_nstc_dim_goods_product\",\"targetarr\":\"tasks-97413\",\"nodenumber\":\"1\",\"x\":569,\"y\":55},\"tasks-65730\":{\"name\":\"clife_nstc_dim_goods_brand\",\"targetarr\":\"tasks-48409\",\"nodenumber\":\"1\",\"x\":779,\"y\":53},\"tasks-55844\":{\"name\":\"clife_nstc_dim_goods_class\",\"targetarr\":\"tasks-65730\",\"nodenumber\":\"1\",\"x\":796,\"y\":275},\"tasks-63481\":{\"name\":\"clife_nstc_dim_goods_goods\",\"targetarr\":\"tasks-55844\",\"nodenumber\":\"1\",\"x\":572,\"y\":277},\"tasks-10806\":{\"name\":\"clife_nstc_dim_member_address\",\"targetarr\":\"tasks-63481\",\"nodenumber\":\"1\",\"x\":379,\"y\":277},\"tasks-10260\":{\"name\":\"clife_nstc_dim_shop_shop\",\"targetarr\":\"tasks-10806\",\"nodenumber\":\"1\",\"x\":211,\"y\":288},\"tasks-470\":{\"name\":\"clife_nstc_dim_member_user\",\"targetarr\":\"tasks-10260\",\"nodenumber\":\"2\",\"x\":2,\"y\":290},\"tasks-7-xv21d\":{\"name\":\"clife_nstc_dim_goods_type\",\"targetarr\":\"\",\"nodenumber\":\"1\",\"x\":0,\"y\":57},\"tasks-66524\":{\"name\":\"clife_nstc_dim_shop_user\",\"targetarr\":\"tasks-470\",\"nodenumber\":\"0\",\"x\":4,\"y\":515}}","connects":"[{\"endPointSourceId\":\"tasks-55317\",\"endPointTargetId\":\"tasks-97413\"},{\"endPointSourceId\":\"tasks-97413\",\"endPointTargetId\":\"tasks-48409\"},{\"endPointSourceId\":\"tasks-48409\",\"endPointTargetId\":\"tasks-65730\"},{\"endPointSourceId\":\"tasks-65730\",\"endPointTargetId\":\"tasks-55844\"},{\"endPointSourceId\":\"tasks-55844\",\"endPointTargetId\":\"tasks-63481\"},{\"endPointSourceId\":\"tasks-63481\",\"endPointTargetId\":\"tasks-10806\"},{\"endPointSourceId\":\"tasks-10806\",\"endPointTargetId\":\"tasks-10260\"},{\"endPointSourceId\":\"tasks-10260\",\"endPointTargetId\":\"tasks-470\"},{\"endPointSourceId\":\"tasks-7-xv21d\",\"endPointTargetId\":\"tasks-55317\"},{\"endPointSourceId\":\"tasks-470\",\"endPointTargetId\":\"tasks-66524\"}]","receivers":"","receiversCc":"","leadMobile":"","ddAlarmId":0,"scheduleReleaseState":null,"timeout":0,"tenantId":-1,"taskType":"SHELL"},{"id":860,"name":"db_dim_nstc_once","version":0,"releaseState":"OFFLINE","projectId":34,"processDefinitionJson":"{\"globalParams\":[],\"tasks\":[{\"type\":\"DATAX\",\"id\":\"tasks-78739\",\"name\":\"clife_dim_date\",\"params\":{\"customConfig\":4,\"json\":{\"separator\":\"1\",\"resourceId\":769,\"fields\":[{\"columnName\":\"dt_code\",\"dataType\":\"string\"},{\"columnName\":\"date_s\",\"dataType\":\"string\"},{\"columnName\":\"date_w\",\"dataType\":\"string\"},{\"columnName\":\"date_cn\",\"dataType\":\"string\"},{\"columnName\":\"y_code\",\"dataType\":\"string\"},{\"columnName\":\"q_code\",\"dataType\":\"string\"},{\"columnName\":\"q_code_cn\",\"dataType\":\"string\"},{\"columnName\":\"m_code\",\"dataType\":\"string\"},{\"columnName\":\"m_code_cn\",\"dataType\":\"string\"},{\"columnName\":\"week_of_month_cn\",\"dataType\":\"string\"},{\"columnName\":\"week_of_year_cn\",\"dataType\":\"string\"},{\"columnName\":\"d_code\",\"dataType\":\"string\"},{\"columnName\":\"day_of_year_cn\",\"dataType\":\"string\"},{\"columnName\":\"week_cn\",\"dataType\":\"string\"}],\"targetDatasourceId\":161,\"targetTable\":\"clife_nstc_dim_date\",\"mode\":\"2\"}},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[]}],\"tenantId\":-1,\"timeout\":0}","description":"","globalParams":"[]","globalParamList":[],"globalParamMap":{},"createTime":"2021-11-10T04:17:06.000+0000","updateTime":"2021-11-10T04:18:10.000+0000","flag":"YES","userId":160,"userName":"data_warehouse","projectName":null,"locations":"{\"tasks-78739\":{\"name\":\"clife_dim_date\",\"targetarr\":\"\",\"nodenumber\":\"0\",\"x\":312,\"y\":281}}","connects":"[]","receivers":"","receiversCc":"","leadMobile":"","ddAlarmId":0,"scheduleReleaseState":null,"timeout":0,"tenantId":-1,"taskType":"SHELL"},{"id":855,"name":"db_ods_nstc","version":0,"releaseState":"ONLINE","projectId":34,"processDefinitionJson":"{\"globalParams\":[],\"tasks\":[{\"type\":\"DATAX\",\"id\":\"tasks-13173\",\"name\":\"clife_nstc_ods_township_area\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     id                             -- id\\n    ,name_prov                      -- 省\\n    ,code_prov                      -- 省code\\n    ,name_city                      -- 市\\n    ,code_city                      -- 市code\\n    ,name_coun                      -- 区\\n    ,code_coun                      -- 区code\\n    ,name_town                      -- 镇\\n    ,code_town                      -- 镇code\\nfrom guomiaozhishu.tb_township_area\\n\",\"targetTable\":\"clife_nstc_ods_township_area\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_township_area\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[]},{\"type\":\"DATAX\",\"id\":\"tasks-47581\",\"name\":\"clife_nstc_ods_shop_user\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     shop_user_id                   -- 商家账号id\\n    ,shop_id                        -- 商家id\\n    ,`level`                        -- 代理等级\\n    ,phone                          -- 手机号\\n    ,`password`                     -- 密码\\n    ,token                          -- token\\n    ,`name`                         -- 昵称\\n    ,avator                         -- 头像\\n    ,intro_user                     -- 推荐人\\n    ,aurora_id                      -- 极光推送id\\n    ,disabled                       -- 是否冻结账号(0-正常,1-冻结)\\n    ,create_at                      -- 操作时间\\n    ,update_at                      -- 修改时间\\n    ,del_flag                       -- 删除标记\\nfrom guomiaozhishu.tb_shop_user\\nwhere date_format(if(update_at is null ,create_at,update_at),'%Y-%m-%d') < date_format(now(),'%Y-%m-%d') \",\"targetTable\":\"clife_nstc_ods_shop_user\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_shop_user\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_township_area\"]},{\"type\":\"DATAX\",\"id\":\"tasks-76959\",\"name\":\"clife_nstc_ods_shop_shop\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     shop_id                        -- 店铺信息id\\n    ,shop_main                      -- 主营品种\\n    ,shop_user_id                   -- 商户ID\\n    ,shop_name                      -- 店铺名称\\n    ,shop_logo                      -- 店铺图片\\n    ,shop_background                -- 背景图\\n    ,shop_desc                      -- 店铺简介\\n    ,shop_notice                    -- 店铺介绍内容\\n    ,shop_type                      -- 认证类型0-个人，1-企业，2-经纪人,10-未认证\\n    ,shop_phone                     -- 店铺手机号\\n    ,shop_province                  -- 店铺所在省\\n    ,shop_city                      -- 店铺所在城市\\n    ,shop_area                      -- 店铺所在区域\\n    ,shop_town                      -- 乡镇\\n    ,shop_address                   -- 经营地址\\n    ,shop_sale                      -- 总销量\\n    ,shop_star                      -- 信誉值(默认80)\\n    ,longitude                      -- 经度\\n    ,latitude                       -- 纬度\\n    ,recommend                      -- 首页展示0-不展示,1-展示\\n    ,hits                           -- 浏览量\\n    ,shop_check                     -- 审核0-审核中,1-成功,2-失败\\n    ,money                          -- 账户余额\\n    ,freeze                         -- 冻结金额\\n    ,all_money                      -- 总成交额\\n    ,bank_card                      -- 银行卡号\\n    ,bank_user_name                 -- 持卡人姓名\\n    ,bank_name                      -- 银行名字\\n    ,bank_address                   -- 开户行地址\\n    ,intro_user                     -- 推荐人\\n    ,ali_number                     -- 支付宝账号\\n    ,ali_name                       -- 支付宝名字\\n    ,times                          -- 发货时间\\n    ,location                       -- 排序\\n    ,create_id                      -- 操作人\\n    ,create_at                      -- 创建时间\\n    ,disabled                       -- 是否禁用(0正常)\\n    ,del_flag                       -- 删除标记\\n    ,batchId                       \\nfrom guomiaozhishu.tb_shop_shop\\nwhere date_format(create_at,'%Y-%m-%d') < date_format(now(),'%Y-%m-%d')\",\"targetTable\":\"clife_nstc_ods_shop_shop\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_shop_shop\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_shop_user\"]},{\"type\":\"DATAX\",\"id\":\"tasks-50196\",\"name\":\"clife_nstc_ods_shop_coupon\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     id                             -- ID\\n    ,shop_id                        -- 店铺id\\n    ,coupon_name                    -- 优惠券名称\\n    ,`type`                         -- 优惠券类型(1-满减)\\n    ,sub_money                      -- 优惠金额\\n    ,enough_money                   -- 满减满足金额\\n    ,total_num                      -- 总数量\\n    ,send_num                       -- 已发数量\\n    ,limit_sartAt                   -- 使用期限起\\n    ,limit_endAt                    -- 使用期限至\\n    ,limit_number                   -- 允许单人领取数量\\n    ,has_score                      -- 发送方式（0：余额购买，1：免费发放）\\n    ,buy_money                      -- 所需余额\\n    ,`status`                       -- 状态(0可用,1不可用)\\n    ,create_at                      -- 创建时间\\n    ,update_at                      -- 更新时间\\n    ,del_flag                       -- 删除标记\\nfrom guomiaozhishu.tb_shop_coupon\\nwhere date_format(if(update_at is null ,create_at,update_at),'%Y-%m-%d') < date_format(now(),'%Y-%m-%d') \\n\",\"targetTable\":\"clife_nstc_ods_shop_coupon\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_shop_coupon\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_shop_shop\"]},{\"type\":\"DATAX\",\"id\":\"tasks-88345\",\"name\":\"clife_nstc_ods_record_shop_member\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     id                             -- 店铺访问记录\\n    ,member_id                      -- 会员id\\n    ,shop_id                        -- 店铺id\\n    ,`type`                         -- 新老访客0-新访客,1-老访客\\n    ,create_at                      -- 访问时间\\n    ,create_day                     -- 访问日期\\nfrom guomiaozhishu.tb_record_shop_member\\nwhere date_format(create_at,'%Y-%m-%d') < date_format(now(),'%Y-%m-%d')\",\"targetTable\":\"clife_nstc_ods_record_shop_member\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_record_shop_member\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_shop_coupon\"]},{\"type\":\"DATAX\",\"id\":\"tasks-12108\",\"name\":\"clife_nstc_ods_record_goods_member\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     id                             -- 访问记录id\\n    ,member_id                      -- 会员id\\n    ,goods_id                       -- 商品id\\n    ,shop_id                        -- 店铺id\\n    ,`type`                         -- 新老访客数0-新访客,1-老访客\\n    ,create_at                      -- 访问时间\\n    ,create_day                     -- 访问日期\\nfrom guomiaozhishu.tb_record_goods_member\\nwhere date_format(create_at,'%Y-%m-%d') < date_format(now(),'%Y-%m-%d')\",\"targetTable\":\"clife_nstc_ods_record_goods_member\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_record_goods_member\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_record_shop_member\"]},{\"type\":\"DATAX\",\"id\":\"tasks-33423\",\"name\":\"clife_nstc_ods_qa_question\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     question_id                    -- 问题id\\n    ,member_id                      -- 会员id\\n    ,question_content               -- 问题描述\\n    ,question_img                   -- 图片链接\\n    ,`status`                       -- 显示状态0-显示,1-隐藏\\n    ,like_num                       -- 点赞数\\n    ,create_at                      -- 发布时间\\n    ,del_flag                       -- 删除标记0-正常\\nfrom guomiaozhishu.tb_qa_question\\nwhere date_format(create_at,'%Y-%m-%d') < date_format(now(),'%Y-%m-%d')\",\"targetTable\":\"clife_nstc_ods_qa_question\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_qa_question\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_record_goods_member\"]},{\"type\":\"DATAX\",\"id\":\"tasks-28116\",\"name\":\"clife_nstc_ods_qa_answer\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     answer_id                      -- 答案id\\n    ,question_id                    -- 问题id\\n    ,member_id                      -- 回答人id\\n    ,answer_content                 -- 回答内容\\n    ,`status`                       -- 显示状态0-显示,1-隐藏\\n    ,like_num                       -- 回复点赞数\\n    ,create_at                      -- 回答时间\\n    ,del_flag                       -- 删除标记0-正常\\nfrom guomiaozhishu.tb_qa_answer\\nwhere date_format(create_at,'%Y-%m-%d') < date_format(now(),'%Y-%m-%d')\\n\",\"targetTable\":\"clife_nstc_ods_qa_answer\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_qa_answer\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_qa_question\"]},{\"type\":\"DATAX\",\"id\":\"tasks-38863\",\"name\":\"clife_nstc_ods_order_shipping\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     shipping_id                    -- 订单收货信息id\\n    ,order_id                       -- 订单ID\\n    ,receiver_name                  -- 收件人\\n    ,receiver_phone                 -- 电话\\n    ,receiver_province              -- 省份\\n    ,receiver_city                  -- 城市\\n    ,receiver_area                  -- 区县\\n    ,receiver_town                  -- 街道\\n    ,receiver_address               -- 地址\\n    ,create_at                      -- 创建时间\\n    ,update_at                      -- 修改时间\\n    ,del_flag                       -- 删除标记\\nfrom guomiaozhishu.tb_order_shipping\\nwhere date_format(if(update_at is null ,create_at,update_at),'%Y-%m-%d') < date_format(now(),'%Y-%m-%d') \",\"targetTable\":\"clife_nstc_ods_order_shipping\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_order_shipping\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_qa_answer\"]},{\"type\":\"DATAX\",\"id\":\"tasks-89206\",\"name\":\"clife_nstc_ods_order_order\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     order_id                       -- 订单id\\n    ,shop_id                        -- 店铺id\\n    ,member_id                      -- 会员ID\\n    ,order_price                    -- 订单总额\\n    ,payment                        -- 实付金额\\n    ,order_sn                       -- 订单号\\n    ,merge_sn                       -- 合单号\\n    ,order_post                     -- 邮费\\n    ,coupon_id                      -- 优惠券id\\n    ,`status`                       -- 订单状态(0-商议订单，1：待支付，2：待发货，3：待收货，4-待评价，5：退货中，6.退货成功，7：订单完成，8：订单取消）\\n    ,create_at                      -- 下单时间\\n    ,update_at                      -- 订单更新时间\\n    ,return_at                      -- 退货时间\\n    ,pay_at                         -- 支付时间\\n    ,pay_type                       -- 0-默认未支付1：微信支付，2：支付宝支付 ,3小程序支付 4工行app支付 5 工行pc支付\\n    ,consign_at                     -- 发货时间\\n    ,receiving_at                   -- 收货时间\\n    ,end_at                         -- 交易完成时间\\n    ,close_at                       -- 交易关闭时间\\n    ,coment                         -- 是否评价 0：未评价，1：已评价\\n    ,shipping_type                  -- 物流类型0-公司,1-个人\\n    ,shipping_name                  -- 物流名称\\n    ,shipping_code                  -- 物流单号\\n    ,shipping_reminder              -- 发货提醒0-未提醒,1-已提醒\\n    ,`read`                         -- 0未读 1已读\\n    ,buyer_msg                      -- 买家留言\\n    ,buyer_nick                     -- 买家昵称\\n    ,`export`                       -- 是否已经导出  0：未导出， 1：已导出\\n    ,del_flag                       -- 删除标记\\nfrom guomiaozhishu.tb_order_order\\nwhere date_format(if(update_at is null ,create_at,update_at),'%Y-%m-%d') < date_format(now(),'%Y-%m-%d') \",\"targetTable\":\"clife_nstc_ods_order_order\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_order_order\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_order_shipping\"]},{\"type\":\"DATAX\",\"id\":\"tasks-21777\",\"name\":\"clife_nstc_ods_order_detail\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     detail_id                      -- 订单详情id\\n    ,order_id                       -- 订单ID\\n    ,goods_id                       -- 商品ID\\n    ,product_id                     -- 产品规格ID\\n    ,order_sn                       -- 子订单号\\n    ,total                          -- 购买数量\\n    ,coment                         -- 0未评价  1已评价\\n    ,price                          -- 单价\\n    ,all_price                      -- 总价\\n    ,create_at                      -- 创建时间\\n    ,del_flag                       -- 删除标记\\nfrom guomiaozhishu.tb_order_detail\\nwhere date_format(create_at,'%Y-%m-%d') < date_format(now(),'%Y-%m-%d')\",\"targetTable\":\"clife_nstc_ods_order_detail\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_order_detail\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_order_order\"]},{\"type\":\"DATAX\",\"id\":\"tasks-87231\",\"name\":\"clife_nstc_ods_order_coment\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     comment_id                     -- 评论表id\\n    ,detail_id                      -- 订单详情表id\\n    ,goods_id                       -- 商品id\\n    ,product_id                     -- 产品id\\n    ,member_id                      -- 评论人\\n    ,star                           -- 评价星级 1-5,默认5星\\n    ,content                        -- 评价内容\\n    ,comment_img                    -- 评论图片\\n    ,disply                         -- 删除标记 0：未删除，1：删除\\n    ,create_at                      -- 创建时间\\n    ,del_flag                       -- 删除标记\\nfrom guomiaozhishu.tb_order_coment\\nwhere date_format(create_at,'%Y-%m-%d') < date_format(now(),'%Y-%m-%d')\",\"targetTable\":\"clife_nstc_ods_order_coment\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_order_coment\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_order_detail\"]},{\"type\":\"DATAX\",\"id\":\"tasks-19839\",\"name\":\"clife_nstc_ods_order_back\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     back_id                        -- 退换货id\\n    ,order_id                       -- 订单ID\\n    ,price                          -- 退款金额\\n    ,express_name                   -- 物流名/司机电话\\n    ,express_code                   -- 快物流单号/车牌号\\n    ,`type`                         -- 类型0-公司物流,1-个人找车\\n    ,`status`                       -- 状态0-审核中,1-同意,2-拒绝\\n    ,order_status                   -- 订单原状态\\n    ,reason                         -- 退货原因\\n    ,back_type                      -- 0-未发货退款、1-已发货未收到货退款、2-收到货仅退款、3-收到货退货退款\\n    ,reason_f                       -- 驳回原因\\n    ,create_at                      -- 创建时间\\n    ,update_at                      -- 更新时间\\n    ,del_flag                       -- 删除标记\\nfrom guomiaozhishu.tb_order_back\\nwhere date_format(if(update_at is null ,create_at,update_at),'%Y-%m-%d') < date_format(now(),'%Y-%m-%d') \",\"targetTable\":\"clife_nstc_ods_order_back\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_order_back\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_order_coment\"]},{\"type\":\"DATAX\",\"id\":\"tasks-82421\",\"name\":\"clife_nstc_ods_order_appeal\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     id                             -- 申诉id\\n    ,order_id                       -- 订单id\\n    ,reason_content                 -- 申诉原因\\n    ,reason_img                     -- 申诉图片\\n    ,`status`                       -- 处理状态0-未处理,1-已处理\\n    ,create_at                      -- 申诉时间\\n    ,del_flag                       -- 删除标记\\nfrom guomiaozhishu.tb_order_appeal\\nwhere date_format(create_at,'%Y-%m-%d') < date_format(now(),'%Y-%m-%d')\",\"targetTable\":\"clife_nstc_ods_order_appeal\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_order_appeal\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_order_back\"]},{\"type\":\"DATAX\",\"id\":\"tasks-70339\",\"name\":\"clife_nstc_ods_member_user\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     member_id                      -- 会员id\\n    ,member_phone                   -- 手机号\\n    ,member_name                    -- 昵称\\n    ,member_avator                  -- 头像\\n    ,`password`                     -- 密码\\n    ,token                          -- token\\n    ,`status`                       -- 工行E企付状态0-未提交,1-工行审核中,2-审核通过,3-审核拒绝\\n    ,intro_user                     -- 推荐人\\n    ,`level`                        -- 身份0-个人,1-企业,2-经纪人,10-未选择\\n    ,money                          -- 余额\\n    ,freeze                         -- 数字金额\\n    ,aurora_id                      -- 极光推送id\\n    ,create_at                      -- 注册时间\\n    ,update_at                      -- 更新时间\\n    ,unionid                        -- 微信unionid\\n    ,openid                         -- 微信openId\\n    ,xcxopenid                      -- 小程序openid\\n    ,wx_name                        -- 微信昵称\\n    ,ali_name                       -- 阿里名字\\n    ,ali_account                    -- 阿里手机号\\n    ,disabled                       -- 是否冻结账号(0-正常,1-冻结)（无用）\\n    ,del_flag                       -- 删除标记\\n    ,icbc_status                    -- 工行会员认证0-未认证,1-审核中,2-已认证,3-审核失败,4-提交失败\\nfrom guomiaozhishu.tb_member_user\\nwhere date_format(if(update_at is null ,create_at,update_at),'%Y-%m-%d') < date_format(now(),'%Y-%m-%d') \",\"targetTable\":\"clife_nstc_ods_member_user\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_member_user\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_order_appeal\"]},{\"type\":\"DATAX\",\"id\":\"tasks-55328\",\"name\":\"clife_nstc_ods_member_shop\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     id                            \\n    ,shop_id                        -- 店铺id\\n    ,member_id                      -- 会员id\\n    ,create_at                      -- 关注时间\\nfrom guomiaozhishu.tb_member_shop\\nwhere date_format(create_at,'%Y-%m-%d') < date_format(now(),'%Y-%m-%d')\",\"targetTable\":\"clife_nstc_ods_member_shop\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_member_shop\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_member_user\"]},{\"type\":\"DATAX\",\"id\":\"tasks-78644\",\"name\":\"clife_nstc_ods_member_question\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     member_id                      -- 会员id\\n    ,question_id                    -- 问题id\\nfrom guomiaozhishu.tb_member_question\\n\\n\",\"targetTable\":\"clife_nstc_ods_member_question\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_member_question\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_member_shop\"]},{\"type\":\"DATAX\",\"id\":\"tasks-73472\",\"name\":\"clife_nstc_ods_member_follow\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     follow_id                     \\n    ,goods_id                       -- 商品id\\n    ,member_id                      -- 会员id\\n    ,create_at                      -- 创建时间\\nfrom guomiaozhishu.tb_member_follow\\nwhere date_format(create_at,'%Y-%m-%d') < date_format(now(),'%Y-%m-%d')\",\"targetTable\":\"clife_nstc_ods_member_follow\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_member_follow\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_member_question\"]},{\"type\":\"DATAX\",\"id\":\"tasks-69883\",\"name\":\"clife_nstc_ods_member_coupon\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     id                             -- ID\\n    ,member_id                      -- 会员ID\\n    ,coupon_id                      -- 优惠券ID\\n    ,`type`                         -- 优惠券类型（1 满减 ）\\n    ,coupon_name                    -- 优惠券名称\\n    ,sub_money                      -- 优惠金额\\n    ,coupon_money                   -- 满减满足金额\\n    ,order_id                       -- 订单ID\\n    ,`status`                       -- 优惠券状态（0-未使用，1-已使用，2-已过期，3-已失效）\\n    ,create_at                      -- 获取时间\\n    ,order_at                       -- 使用时间\\n    ,update_at                      -- 更新时间\\n    ,del_flag                       -- 删除标记\\nfrom guomiaozhishu.tb_member_coupon\\nwhere date_format(if(update_at is null ,create_at,update_at),'%Y-%m-%d') < date_format(now(),'%Y-%m-%d') \",\"targetTable\":\"clife_nstc_ods_member_coupon\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_member_coupon\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_member_follow\"]},{\"type\":\"DATAX\",\"id\":\"tasks-60189\",\"name\":\"clife_nstc_ods_member_answer\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     member_id                      -- 会员id\\n    ,answer_id                      -- 回复id\\nfrom guomiaozhishu.tb_member_answer\\n\",\"targetTable\":\"clife_nstc_ods_member_answer\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_member_answer\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_member_coupon\"]},{\"type\":\"DATAX\",\"id\":\"tasks-80760\",\"name\":\"clife_nstc_ods_member_address\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     address_id                     -- 收货地址id\\n    ,member_id                      -- 会员ID\\n    ,province                       -- 所在省\\n    ,city                           -- 所在市\\n    ,area                           -- 所在县区\\n    ,town                           -- 所在街道\\n    ,address                        -- 详细地址\\n    ,post_code                      -- 邮政编码\\n    ,full_name                      -- 收货人姓名\\n    ,phone                          -- 收货人电话\\n    ,default_value                  -- 是否默认0-非默认,-1默认\\n    ,create_at                      -- 创建时间\\n    ,update_at                      -- 修改时间\\n    ,del_flag                       -- 删除标记\\nfrom guomiaozhishu.tb_member_address\\nwhere date_format(if(update_at is null ,create_at,update_at),'%Y-%m-%d') < date_format(now(),'%Y-%m-%d') \\n\",\"targetTable\":\"clife_nstc_ods_member_address\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_member_address\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_member_answer\"]},{\"type\":\"DATAX\",\"id\":\"tasks-56916\",\"name\":\"clife_nstc_ods_goods_product\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     product_id                     -- 产品id\\n    ,batch_id                       -- 批次id\\n    ,sku                            -- SKU\\n    ,goods_id                       -- 商品ID\\n    ,product_name                   -- 货品名\\n    ,product_img                    -- 产品图片\\n    ,product_spec                   -- 货品规格\\n    ,product_price                  -- 价格\\n    ,product_post                   -- 期货购买价\\n    ,product_weight                 -- 一包的重量\\n    ,product_stock                  -- 库存\\n    ,product_buy_min                -- 期货卖出一包的重量\\n    ,product_buy_max                -- 期货卖出库存\\n    ,product_unit                   -- 计量单位\\n    ,product_loading                -- 是否下架(0审核1-上架2下架,3-拒绝,5-卖出)\\n    ,product_default                -- 是否默认(1是默认)\\n    ,loading_at                     -- 上架时间\\n    ,unloading__at                  -- 下架时间\\n    ,product_sale_num               -- 销售量\\n    ,product_location               -- 排序字段\\n    ,create_at                      -- 创建时间\\n    ,update_at                      -- 修改时间\\n    ,del_flag                       -- 删除标记\\n    ,store_name                     -- 仓库名\\nfrom guomiaozhishu.tb_goods_product\\nwhere date_format(if(update_at is null ,create_at,update_at),'%Y-%m-%d') < date_format(now(),'%Y-%m-%d') \",\"targetTable\":\"clife_nstc_ods_goods_product\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_goods_product\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_member_address\"]},{\"type\":\"DATAX\",\"id\":\"tasks-71128\",\"name\":\"clife_nstc_ods_goods_goods\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     goods_id                       -- 商品id\\n    ,shop_id                        -- 店铺id\\n    ,goods_name                     -- 商品名称\\n    ,goods_title                    -- 商品标题\\n    ,class_id                       -- 商品分类\\n    ,type_id                        -- 商品类型\\n    ,goods_img                      -- 商品主图\\n    ,goods_note                     -- 0-农资商品,1-苗木商品\\n    ,goods_prop                     -- 商品等级\\n    ,goods_spec                     -- 规格详情\\n    ,goods_param                    -- 参数详情\\n    ,has_spec                       -- 启用规格\\n    ,goods_unit                     -- 计量单位\\n    ,goods_loading                  -- 是否下架(0-待上架，1-上架,2下架，3-待审核,4-拒绝5-卖出)\\n    ,examine                        -- 审核状态0-未审核,1-审核中,2-已通过,3-拒绝\\n    ,goods_reject                   -- 驳回原因\\n    ,goods_view_num                 -- 浏览量\\n    ,goods_comment_num              -- 评论量\\n    ,goods_sale_num                 -- 销售量\\n    ,goods_location                 -- 排序字段\\n    ,create_id                      -- 创建用户id\\n    ,create_at                      -- 创建时间\\n    ,update_at                      -- 修改时间\\n    ,del_flag                       -- 删除标记0-显示,1-删除\\n    ,recom_sy                       -- 0-优品优选,1-乡村振兴\\n    ,recommend                      -- 商品推荐0-不推荐,1-推荐\\n    ,recom_xq                       -- 邮费,0-包邮,1-不包邮\\n    ,recom_gwc                      -- 挂牌0-普通,1-挂牌\\n    ,brand_id                       -- 商品品牌\\n    ,unloading_at                   -- 下架时间\\n    ,loading_at                     -- 上架时间\\nfrom guomiaozhishu.tb_goods_goods\\nwhere date_format(if(update_at is null ,create_at,update_at),'%Y-%m-%d') < date_format(now(),'%Y-%m-%d') \\n\",\"targetTable\":\"clife_nstc_ods_goods_goods\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_goods_goods\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_goods_product\"]},{\"type\":\"DATAX\",\"id\":\"tasks-46076\",\"name\":\"clife_nstc_ods_goods_class\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     class_id                       -- 商品分类id\\n    ,parent_id                      -- 父级ID\\n    ,class_name                     -- 分类名称\\n    ,class_img                      -- 图片路径\\n    ,type_id                        -- 类型0-苗木分类,1-农资分类\\n    ,class_level                    -- 类型等级(0-大类,1-小类)\\n    ,class_show                     -- 是否显示(0-显示,1-隐藏)\\n    ,class_location                 -- 排序字段\\n    ,create_id                      -- 创建用户id\\n    ,create_at                      -- 创建时间\\n    ,update_at                      -- 修改时间\\n    ,del_flag                       -- 删除标记\\nfrom guomiaozhishu.tb_goods_class\\nwhere date_format(if(update_at is null ,create_at,update_at),'%Y-%m-%d') < date_format(now(),'%Y-%m-%d') \",\"targetTable\":\"clife_nstc_ods_goods_class\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_goods_class\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_goods_goods\"]},{\"type\":\"DATAX\",\"id\":\"tasks-77883\",\"name\":\"clife_nstc_ods_goods_brand\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     brand_id                       -- 品牌id\\n    ,brand_name                     -- 品牌名称\\n    ,brand_url                      -- 品牌网址\\n    ,brand_img                      -- 图片地址\\n    ,brand_note                     -- 品牌介绍\\n    ,brand_location                 -- 排序字段\\n    ,create_id                      -- 创建用户id\\n    ,create_at                      -- 创建时间\\n    ,update_at                      -- 修改时间\\n    ,del_flag                       -- 删除标记\\nfrom guomiaozhishu.tb_goods_brand\\nwhere date_format(if(update_at is null ,create_at,update_at),'%Y-%m-%d') < date_format(now(),'%Y-%m-%d') \\n\",\"targetTable\":\"clife_nstc_ods_goods_brand\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_goods_brand\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_goods_class\"]},{\"type\":\"DATAX\",\"id\":\"tasks-74618\",\"name\":\"clife_nstc_ods_member_icbc\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     icbc_id                        -- 工行认证id\\n    ,member_id                      -- 会员id\\n    ,vendor_short_name              -- 企业用户简称\\n    ,vendor_name                    -- 企业用户名称，开通 E企付担保支付时必 输\\n    ,vendor_phone                   -- 企业用户联系电话(会员手机号,带过来不可修改)\\n    ,vendor_email                   -- 企业用户邮箱\\n    ,province                       -- 所在省 code例130000\\n    ,city                           -- 所在市 code例130100\\n    ,county                         -- 所在区县code例130102\\n    ,address                        -- 详细地址\\n    ,postcode                       -- 邮政编码\\n    ,vendor_type                    -- 企业用户类型，开通 E企付担保支付时必 输 01-企业 06-个体工商户\\n    ,cert_type                      -- 企业用户注册证件类 型，100-全国组织机构代码 证书101-营业执照 102-行政机关 103-社会团体法人登记 证书104-军队单位开户核准 通知书 105-武警部队单位开户 核准通知书 106-下属机构(具有主管 单位批文号) 107-其他(包含统一社会 信用代码) 108-商业登记证 109-公司注册证\\n    ,cert_no                        -- 企业用户注册证件号码，\\n    ,cert_pic                       -- 企业用户注册证件图片\\n    ,cert_validityl_str             -- 企业用户注册证件有 效期\\n    ,operator_name                  -- 企业用户联系人姓名\\n    ,operator_mobile                -- 企业用户联系人手机\\n    ,operator_email                 -- 企业用户联系人邮箱\\n    ,operatorId_no                  -- 企业用户联系人身份 证号\\n    ,`status`                       -- 状态0-未提交,1-审核中,2-审核成功,3-审核失败,4-提交失败\\n    ,reason                         -- 失败原因\\nfrom guomiaozhishu.tb_member_icbc\",\"targetTable\":\"clife_nstc_ods_member_icbc\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_member_icbc\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_goods_brand\"]},{\"type\":\"DATAX\",\"id\":\"tasks-13618\",\"name\":\"clife_nstc_ods_apply_purchase\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     purchase_id                    -- 采购id\\n    ,member_id                      -- 会员id\\n    ,purchase_num                   -- 采购数量\\n    ,purchase_price                 -- 价格\\n    ,purchase_class                 -- 采购品种\\n    ,purchase_level                 -- (弃用)\\n    ,address                        -- 收货地址\\n    ,fromword                       -- 期望货源地\\n    ,go                             -- 收获地\\n    ,create_at                     \\n    ,create_by                      -- 创建者\\n    ,update_at                     \\n    ,conent                         -- 内容(选填）\\n    ,image                          -- 图片地址\\n    ,del_flag                      \\n    ,title                          -- 标题\\n    ,memeber_level                  -- 会员身份\\n    ,memeber_avator                 -- 头像\\n    ,member_phone                   -- 手机号\\n    ,statu                          -- 0发布中 1已结束 2被驳回\\n    ,scannum                        -- 浏览次数\\nfrom guomiaozhishu.tb_apply_purchase\\nwhere date_format(if(update_at is null ,create_at,update_at),'%Y-%m-%d') < date_format(now(),'%Y-%m-%d') \",\"targetTable\":\"clife_nstc_ods_apply_purchase\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_apply_purchase\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_member_icbc\"]},{\"type\":\"DATAX\",\"id\":\"tasks-36532\",\"name\":\"clife_nstc_ods_apply_supply\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     suppery_Id                    \\n    ,member_id                     \\n    ,goodclass                      -- 品类\\n    ,supper_price                   -- 供货价格\\n    ,`level`                        -- 商品等级\\n    ,fromword                       -- 货源地\\n    ,go                             -- 收获地\\n    ,image                          -- 图片\\n    ,conment                        -- 内容\\n    ,update_at                      -- 更新时间\\n    ,createby                       -- 创建者\\n    ,create_at                      -- 创建时间\\n    ,del_flag                      \\n    ,title                          -- 标题\\n    ,memeber_level                  -- 会员身份\\n    ,memeber_avator                 -- 头像\\n    ,member_phone                   -- 手机号\\n    ,statu                          -- 0采购中   1已结束  2被驳回\\n    ,scannum                        -- 浏览次数\\n    ,supperNum                      -- 供货数量\\nfrom guomiaozhishu.tb_apply_supply\\nwhere date_format(if(update_at is null ,create_at,update_at),'%Y-%m-%d') < date_format(now(),'%Y-%m-%d') \\n\",\"targetTable\":\"clife_nstc_ods_apply_supply\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_apply_supply\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_apply_purchase\"]},{\"type\":\"DATAX\",\"id\":\"tasks-13829\",\"name\":\"clife_nstc_ods_storage_rent\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     rent_id                        -- 出租拉货id\\n    ,title                          -- 标题\\n    ,price                          -- 价格\\n    ,area                           -- 货车类型\\n    ,stcity                         -- 起运城市\\n    ,staddress                      -- 起运地址\\n    ,encity                         -- 目的城市\\n    ,address                        -- 目的地范围\\n    ,conent                         -- 备注内容\\n    ,image                          -- 图片\\n    ,create_at                      -- 发布时间\\n    ,create_by                      -- 创造者\\n    ,member_id                      -- 会员id\\n    ,memeber_level                  -- 会员身份\\n    ,memeber_avator                 -- 头像\\n    ,member_phone                   -- 手机号\\n    ,statu                          -- 0采购中   1已结束  2被驳回\\n    ,scannum                        -- 浏览量\\n    ,longitude                      -- 经度\\n    ,latitude                       -- 纬度\\n    ,localNo                        -- 库位\\n    ,update_at                      -- 更新时间\\n    ,del_flag                       -- 删除标记\\nfrom guomiaozhishu.tb_storage_rent\\nwhere date_format(if(update_at is null ,create_at,update_at),'%Y-%m-%d') < date_format(now(),'%Y-%m-%d') \\n\",\"targetTable\":\"clife_nstc_ods_storage_rent\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_storage_rent\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_apply_supply\"]},{\"type\":\"DATAX\",\"id\":\"tasks-59742\",\"name\":\"clife_nstc_ods_storage_lease\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     lease_id                       -- 用车id\\n    ,member_id                      -- 会员id\\n    ,title                          -- 标题\\n    ,price                          -- 价格\\n    ,local_no                       -- 冷库库位\\n    ,stcity                         -- 起运城市\\n    ,address                        -- 起运地详细地址\\n    ,encity                         -- 目的城市\\n    ,area                           -- 目的地地址\\n    ,content                        -- 备注\\n    ,image                          -- 图片\\n    ,create_at                      -- 发布时间\\n    ,create_by                      -- 创建人\\n    ,memeber_level                  -- 会员身份\\n    ,memeber_avator                 -- 头像\\n    ,member_phone                   -- 手机号\\n    ,statu                          -- 0采购中   1已结束  2被驳回\\n    ,scannum                        -- 浏览次数\\n    ,longitude                      -- 经度\\n    ,latitude                       -- 纬度\\n    ,update_at                      -- 更新时间\\n    ,del_flag                       -- 删除标记\\nfrom guomiaozhishu.tb_storage_lease\\nwhere date_format(if(update_at is null ,create_at,update_at),'%Y-%m-%d') < date_format(now(),'%Y-%m-%d') \",\"targetTable\":\"clife_nstc_ods_storage_lease\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_storage_lease\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_storage_rent\"]},{\"type\":\"DATAX\",\"id\":\"tasks-77344\",\"name\":\"clife_nstc_ods_goods_type\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":158,\"dtType\":\"HIVE\",\"dataTarget\":159,\"sql\":\"select \\n     type_id                        -- 类型id\\n    ,shop_id                        -- 店铺id\\n    ,type_name                      -- 类型名称\\n    ,is_physical                    -- 实物商品0-非实物,1-实物\\n    ,has_spec                       -- 使用规格0-不使用,1-使用\\n    ,has_param                      -- 使用参数0-不使用,1-使用\\n    ,has_brand                      -- 关联品牌0-不关联,1-关联\\n    ,create_id                      -- 创建用户ID\\n    ,create_at                      -- 创建时间\\n    ,update_at                      -- 修改时间\\n    ,del_flag                       -- 删除标记\\nfrom guomiaozhishu.tb_goods_type\\nwhere date_format(if(update_at is null ,create_at,update_at),'%Y-%m-%d') < date_format(now(),'%Y-%m-%d') \",\"targetTable\":\"clife_nstc_ods_goods_type\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"clife_nstc_ods_goods_type\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_nstc_ods_storage_lease\"]}],\"tenantId\":-1,\"timeout\":0}","description":"db_ods_nstc","globalParams":"[]","globalParamList":[],"globalParamMap":{},"createTime":"2021-11-05T09:04:25.000+0000","updateTime":"2021-11-10T04:15:21.000+0000","flag":"YES","userId":160,"userName":"data_warehouse","projectName":null,"locations":"{\"tasks-13173\":{\"name\":\"clife_nstc_ods_township_area\",\"targetarr\":\"\",\"nodenumber\":\"1\",\"x\":42,\"y\":73},\"tasks-47581\":{\"name\":\"clife_nstc_ods_shop_user\",\"targetarr\":\"tasks-13173\",\"nodenumber\":\"1\",\"x\":212,\"y\":73},\"tasks-76959\":{\"name\":\"clife_nstc_ods_shop_shop\",\"targetarr\":\"tasks-47581\",\"nodenumber\":\"1\",\"x\":379,\"y\":73},\"tasks-50196\":{\"name\":\"clife_nstc_ods_shop_coupon\",\"targetarr\":\"tasks-76959\",\"nodenumber\":\"1\",\"x\":577,\"y\":70},\"tasks-88345\":{\"name\":\"clife_nstc_ods_record_shop_member\",\"targetarr\":\"tasks-50196\",\"nodenumber\":\"1\",\"x\":780,\"y\":68},\"tasks-12108\":{\"name\":\"clife_nstc_ods_record_goods_member\",\"targetarr\":\"tasks-88345\",\"nodenumber\":\"1\",\"x\":779,\"y\":220},\"tasks-33423\":{\"name\":\"clife_nstc_ods_qa_question\",\"targetarr\":\"tasks-12108\",\"nodenumber\":\"1\",\"x\":571,\"y\":221},\"tasks-28116\":{\"name\":\"clife_nstc_ods_qa_answer\",\"targetarr\":\"tasks-33423\",\"nodenumber\":\"1\",\"x\":386,\"y\":218},\"tasks-38863\":{\"name\":\"clife_nstc_ods_order_shipping\",\"targetarr\":\"tasks-28116\",\"nodenumber\":\"1\",\"x\":200,\"y\":218},\"tasks-89206\":{\"name\":\"clife_nstc_ods_order_order\",\"targetarr\":\"tasks-38863\",\"nodenumber\":\"1\",\"x\":38,\"y\":220},\"tasks-21777\":{\"name\":\"clife_nstc_ods_order_detail\",\"targetarr\":\"tasks-89206\",\"nodenumber\":\"1\",\"x\":30,\"y\":386},\"tasks-87231\":{\"name\":\"clife_nstc_ods_order_coment\",\"targetarr\":\"tasks-21777\",\"nodenumber\":\"1\",\"x\":239,\"y\":384},\"tasks-19839\":{\"name\":\"clife_nstc_ods_order_back\",\"targetarr\":\"tasks-87231\",\"nodenumber\":\"1\",\"x\":398,\"y\":389},\"tasks-82421\":{\"name\":\"clife_nstc_ods_order_appeal\",\"targetarr\":\"tasks-19839\",\"nodenumber\":\"1\",\"x\":581,\"y\":392},\"tasks-70339\":{\"name\":\"clife_nstc_ods_member_user\",\"targetarr\":\"tasks-82421\",\"nodenumber\":\"1\",\"x\":773,\"y\":382},\"tasks-55328\":{\"name\":\"clife_nstc_ods_member_shop\",\"targetarr\":\"tasks-70339\",\"nodenumber\":\"1\",\"x\":769,\"y\":583},\"tasks-78644\":{\"name\":\"clife_nstc_ods_member_question\",\"targetarr\":\"tasks-55328\",\"nodenumber\":\"1\",\"x\":566,\"y\":574},\"tasks-73472\":{\"name\":\"clife_nstc_ods_member_follow\",\"targetarr\":\"tasks-78644\",\"nodenumber\":\"1\",\"x\":367,\"y\":573},\"tasks-69883\":{\"name\":\"clife_nstc_ods_member_coupon\",\"targetarr\":\"tasks-73472\",\"nodenumber\":\"1\",\"x\":197,\"y\":568},\"tasks-60189\":{\"name\":\"clife_nstc_ods_member_answer\",\"targetarr\":\"tasks-69883\",\"nodenumber\":\"1\",\"x\":0,\"y\":553},\"tasks-80760\":{\"name\":\"clife_nstc_ods_member_address\",\"targetarr\":\"tasks-60189\",\"nodenumber\":\"1\",\"x\":12,\"y\":763},\"tasks-56916\":{\"name\":\"clife_nstc_ods_goods_product\",\"targetarr\":\"tasks-80760\",\"nodenumber\":\"1\",\"x\":216,\"y\":757},\"tasks-71128\":{\"name\":\"clife_nstc_ods_goods_goods\",\"targetarr\":\"tasks-56916\",\"nodenumber\":\"1\",\"x\":430,\"y\":768},\"tasks-46076\":{\"name\":\"clife_nstc_ods_goods_class\",\"targetarr\":\"tasks-71128\",\"nodenumber\":\"1\",\"x\":594,\"y\":772},\"tasks-77883\":{\"name\":\"clife_nstc_ods_goods_brand\",\"targetarr\":\"tasks-46076\",\"nodenumber\":\"1\",\"x\":767,\"y\":762},\"tasks-74618\":{\"name\":\"clife_nstc_ods_member_icbc\",\"targetarr\":\"tasks-77883\",\"nodenumber\":\"1\",\"x\":777,\"y\":939},\"tasks-13618\":{\"name\":\"clife_nstc_ods_apply_purchase\",\"targetarr\":\"tasks-74618\",\"nodenumber\":\"1\",\"x\":585,\"y\":948},\"tasks-36532\":{\"name\":\"clife_nstc_ods_apply_supply\",\"targetarr\":\"tasks-13618\",\"nodenumber\":\"1\",\"x\":398,\"y\":954},\"tasks-13829\":{\"name\":\"clife_nstc_ods_storage_rent\",\"targetarr\":\"tasks-36532\",\"nodenumber\":\"1\",\"x\":223,\"y\":947},\"tasks-59742\":{\"name\":\"clife_nstc_ods_storage_lease\",\"targetarr\":\"tasks-13829\",\"nodenumber\":\"1\",\"x\":16,\"y\":951},\"tasks-77344\":{\"name\":\"clife_nstc_ods_goods_type\",\"targetarr\":\"tasks-59742\",\"nodenumber\":\"1\",\"x\":0,\"y\":1108}}","connects":"[{\"endPointSourceId\":\"tasks-13173\",\"endPointTargetId\":\"tasks-47581\"},{\"endPointSourceId\":\"tasks-47581\",\"endPointTargetId\":\"tasks-76959\"},{\"endPointSourceId\":\"tasks-76959\",\"endPointTargetId\":\"tasks-50196\"},{\"endPointSourceId\":\"tasks-50196\",\"endPointTargetId\":\"tasks-88345\"},{\"endPointSourceId\":\"tasks-88345\",\"endPointTargetId\":\"tasks-12108\"},{\"endPointSourceId\":\"tasks-12108\",\"endPointTargetId\":\"tasks-33423\"},{\"endPointSourceId\":\"tasks-33423\",\"endPointTargetId\":\"tasks-28116\"},{\"endPointSourceId\":\"tasks-28116\",\"endPointTargetId\":\"tasks-38863\"},{\"endPointSourceId\":\"tasks-38863\",\"endPointTargetId\":\"tasks-89206\"},{\"endPointSourceId\":\"tasks-89206\",\"endPointTargetId\":\"tasks-21777\"},{\"endPointSourceId\":\"tasks-21777\",\"endPointTargetId\":\"tasks-87231\"},{\"endPointSourceId\":\"tasks-87231\",\"endPointTargetId\":\"tasks-19839\"},{\"endPointSourceId\":\"tasks-19839\",\"endPointTargetId\":\"tasks-82421\"},{\"endPointSourceId\":\"tasks-82421\",\"endPointTargetId\":\"tasks-70339\"},{\"endPointSourceId\":\"tasks-70339\",\"endPointTargetId\":\"tasks-55328\"},{\"endPointSourceId\":\"tasks-55328\",\"endPointTargetId\":\"tasks-78644\"},{\"endPointSourceId\":\"tasks-78644\",\"endPointTargetId\":\"tasks-73472\"},{\"endPointSourceId\":\"tasks-73472\",\"endPointTargetId\":\"tasks-69883\"},{\"endPointSourceId\":\"tasks-69883\",\"endPointTargetId\":\"tasks-60189\"},{\"endPointSourceId\":\"tasks-60189\",\"endPointTargetId\":\"tasks-80760\"},{\"endPointSourceId\":\"tasks-80760\",\"endPointTargetId\":\"tasks-56916\"},{\"endPointSourceId\":\"tasks-56916\",\"endPointTargetId\":\"tasks-71128\"},{\"endPointSourceId\":\"tasks-71128\",\"endPointTargetId\":\"tasks-46076\"},{\"endPointSourceId\":\"tasks-46076\",\"endPointTargetId\":\"tasks-77883\"},{\"endPointSourceId\":\"tasks-77883\",\"endPointTargetId\":\"tasks-74618\"},{\"endPointSourceId\":\"tasks-74618\",\"endPointTargetId\":\"tasks-13618\"},{\"endPointSourceId\":\"tasks-13618\",\"endPointTargetId\":\"tasks-36532\"},{\"endPointSourceId\":\"tasks-36532\",\"endPointTargetId\":\"tasks-13829\"},{\"endPointSourceId\":\"tasks-13829\",\"endPointTargetId\":\"tasks-59742\"},{\"endPointSourceId\":\"tasks-59742\",\"endPointTargetId\":\"tasks-77344\"}]","receivers":"","receiversCc":"","leadMobile":"","ddAlarmId":0,"scheduleReleaseState":null,"timeout":0,"tenantId":-1,"taskType":"SHELL"},{"id":850,"name":"db_device_dws","version":0,"releaseState":"ONLINE","projectId":34,"processDefinitionJson":"{\"globalParams\":[],\"tasks\":[{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"drop table if exists db_device_dw.clife_device_dws_run_data_tmp1\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp1_drop\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[],\"id\":\"tasks-22568\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"drop table if exists db_device_dw.clife_device_dws_run_data_tmp2\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_timp2_drop\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_sleep_tmp1_create\"],\"id\":\"tasks-2-cq7bl\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"drop table if exists db_device_dw.clife_device_dws_run_data_tmp3\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp3_drop\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp2_create\"],\"id\":\"tasks-2-2y02g5\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"create table if not exists db_device_dw.clife_device_dws_run_data_tmp3 stored as parquet as\\nselect \\n     deviceid            --'设备id'\\n    ,productid           --'产品id'\\n    ,device_type_id             -- '设备大类'\\n    ,device_subtype_id          -- '设备小类'\\n    ,bind_user_id               -- '绑定用户'\\n    ,macaddress                 -- 'macaddress 地址'\\n    ,mactype                    -- 'macaddress 地址类型'\\n    ,base_null_onOff_uporiginalsignal as onoff    -- '上传原始信号开关'\\n    ,lag(base_null_onOff_uporiginalsignal, 1, null) over (partition by deviceid order by fetchDateTime)  last_onoff  --'设备上一条开关机状态'\\n\\t,base_null_onoff_adjustbodymov as adjustbodymov    -- '是否需要校准体动'\\n    ,lag(base_null_onoff_adjustbodymov, 1, null) over (partition by deviceid order by fetchDateTime)  last_adjustbodymov  --'设备上一条开关机状态'\\n    ,datasource                 --  '数据来源' \\n    ,fetchDateTime              --  '采集时间'\\n    ,lag(fetchDateTime, 1, null) over (partition by deviceid order by fetchDateTime)  last_fetchDateTime  --'设备上一条采集时间' \\nfrom db_device_dw.clife_device_dwd_sleep_run_data \\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','') \\n  and datasource='3代'\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp3_create\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp3_drop\"],\"id\":\"tasks-4-de5po\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"drop table if exists db_device_dw.clife_device_dws_run_data_tmp4\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp4_drop\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp3_create\"],\"id\":\"tasks-2-7ji5uy\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"create table if not exists db_device_dw.clife_device_dws_run_data_tmp4 stored as parquet as\\nselect\\n     t1.deviceid            --'设备id'\\n    ,t1.productid           --'产品id'\\n    ,t1.device_type_id             -- '设备大类'\\n    ,t1.device_subtype_id          -- '设备小类'\\n    ,t1.bind_user_id               -- '绑定用户'\\n    ,t1.macaddress                 -- 'macaddress 地址'\\n    ,t1.mactype                    -- 'macaddress 地址类型'\\n    ,t1.on_cnt               -- '在线次数'\\n    ,t1.off_cnt                -- '离线次数'\\n    ,t1.sum_on_time                -- '在线时长'\\n    ,t1.sum_off_time                -- '离线时长'\\n    ,0 as sum_oximeterlink_time  --'血氧夹接入时长'\\n    ,0 as sum_alinkstatus_time  --'A路接入时长'\\n    ,0 as sum_blinkstatus_time  --'B路接入时长'\\n    ,sum_adjustbodymov   --'需要校准体动次数'\\n    ,'3代' as datasource      --'数据来源'\\nfrom\\n(\\n select\\n     deviceid            --'设备id'\\n    ,max(productid)   productid        --'产品id'\\n    ,max(device_type_id)  device_type_id           -- '设备大类'\\n    ,max(device_subtype_id) device_subtype_id         -- '设备小类'\\n    ,max(bind_user_id)   bind_user_id           -- '绑定用户'\\n    ,max(macaddress)     macaddress            -- 'macaddress 地址'\\n    ,max(mactype)        mactype            -- 'macaddress 地址类型'\\n    ,sum(case when last_onoff=1 and onoff=0 then 1 else 0 end) as on_cnt  --'在线次数'   0-不上传|1-上传\\n    ,sum(case when last_onoff=0 and onoff=1 then 1 else 0 end) as off_cnt  --'离线次数'\\n    ,sum(case when adjustbodymov = 0 and last_adjustbodymov = 1 then 1 else 0 end) as sum_adjustbodymov --'需要校准体动次数'\\n    ,sum(case when last_onoff = 1 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_on_time --'在线时长'\\n    ,sum(case when last_onoff = 0 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_off_time --'离线时长'\\n from db_device_dw.clife_device_dws_run_data_tmp3\\n group by deviceid\\n)t1\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp4_create\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp4_drop\"],\"id\":\"tasks-4-3443br\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"drop table if exists db_device_dw.clife_device_dws_error_data_tmp1\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"error_data_tmp1_drop\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[],\"id\":\"tasks-2-1e64q2\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"create table if not exists db_device_dw.clife_device_dws_error_data_tmp1 stored as parquet as \\nselect\\ndeviceid                                --设备id\\n,productid                               --产品id\\n,device_type_id                          --设备大类\\n,device_subtype_id                       --设备小类\\n,bind_user_id                            --绑定用户\\n,macaddress                              --macaddress 地址\\n,mactype                                 --macaddress 地址类型\\n,error_sdcardinsertstatus                      --SD卡插入\\n,lag(error_sdcardinsertstatus,1,null) over(partition by deviceid order by fetchDateTime) last_error_sdcardinsertstatus   -- 上一条SD卡插入状态\\n,error_sdcardcapacitystatus                           --SD卡容量\\n,lag(error_sdcardcapacitystatus,1,null) over(partition by deviceid order by fetchDateTime) last_error_sdcardcapacitystatus   -- 上一条SD卡容量状态\\n,error_sdcardrwstatus                       --SD卡读写\\n,lag(error_sdcardrwstatus,1,null) over(partition by deviceid order by fetchDateTime) last_error_sdcardrwstatus   -- 上一条SD卡读写状态\\n,error_alinkstatus                              --A路接入\\n,lag(error_alinkstatus,1,null) over(partition by deviceid order by fetchDateTime) last_error_alinkstatus   -- 上一条A路接入状态\\n,error_blinkstatus                               --B路接入\\n,lag(error_blinkstatus,1,null) over(partition by deviceid order by fetchDateTime) last_error_blinkstatus   -- 上一条B路接入状态\\n,error_oximeterfault                              --血氧夹故障\\n,lag(error_oximeterfault,1,null) over(partition by deviceid order by fetchDateTime) last_error_oximeterfault   -- 上一条血氧夹故障状态\\n,datasource                                        -- 数据来源\\n,fetchDateTime                    -- 采集时间\\n,lag(fetchDateTime,1,null) over(partition by deviceid order by fetchDateTime) last_fetchDateTime   -- 上一条采集时间\\nfrom db_device_dw.clife_device_dwd_sleep_error_data \\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','') and datasource='2代'\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"error_data_tmp1_create\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"error_data_tmp1_drop\"],\"id\":\"tasks-1-6602fd\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"drop table if exists db_device_dw.clife_device_dws_error_data_tmp2\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"error_data_tmp2_drop\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"error_data_tmp1_create\"],\"id\":\"tasks-2-55k39y\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"create table if not exists db_device_dw.clife_device_dws_error_data_tmp2 stored as parquet as\\nselect\\n t1.deviceid            --'设备id'\\n,t1.productid           --'产品id'\\n,t1.device_type_id             -- '设备大类'\\n,t1.device_subtype_id          -- '设备小类'\\n,t1.bind_user_id               -- '绑定用户'\\n,t1.macaddress                 -- 'macaddress 地址'\\n,t1.mactype                    -- 'macaddress 地址类型'\\n,t2.sum_error_sdcardinsertstatus_time     -- 'sd卡插入故障时长，单位秒'\\n,t3.sum_error_sdcardcapacitystatus_time   -- 'sd卡容量故障时长，单位秒'\\n,t4.sum_error_sdcardrwstatus_time         -- 'sd卡读写故障时长，单位秒'\\n,t5.sum_error_alinkstatus_time                  -- 'A路接入故障时长，单位秒'\\n,t6.sum_error_blinkstatus_time                  -- 'B路接入故障时长，单位秒'\\n,t7.sum_error_oximeterfault_time                 -- '血氧夹故障时长，单位秒'\\n,0 as error_base_null_error_longitude_time  --       ' 历史数据FLASH操作故障时长'\\n,0 as error_base_null_error_timing_time     --      ' 历史数据FLASH满故障时长'\\n,0 as error_base_null_error_deforst_time    --      ' MCU复位时长'\\n,0 as error_base_null_error_notclosed_time  --      ' MCU看门狗复位时长'\\n,0 as error_base_null_error_waterpresshigh_time --  ' MCU命令复位时长'\\n,0 as error_base_null_error_waterpresslow_time  --  ' WIFI无应答故障时长'\\n,0 as error_base_null_error_wifitomcucomm_time  --  ' 断网故障时长'\\n,0 as error_base_null_error_poweroffmemory_time --  ' 时间故障时长'\\n,0 as error_base_null_error_fccomm_time   --        ' 原始数据FLASH操作故障时长'\\n,0 as error_base_null_error_off_time      --        ' 原始数据FLASH满故障时长'\\n,0 as error_base_null_error_fake_time     --        ' 绑定故障时长'\\n,0 as error_base_null_error_comm_time     --       ' 路由器断网故障时长'\\n,0 as error_base_null_error_connect_time  --        ' 服务器断网故障时长'\\n,0 as error_base_null_error_humilow_time  --        ' WIFI信号弱时长'\\n,0 as error_base_null_error_on_time       --        ' ADC采样故障时长'\\n,t8.error_sdcardinsertstatus_cnt          -- 'sd卡插入故障次数'\\n,t9.error_sdcardcapacitystatus_cnt          -- 'sd卡容量故障次数'\\n,t10.error_sdcardrwstatus_cnt          -- 'sd卡读写故障次数'\\n,t11.error_alinkstatus_cnt                  -- 'A路接入故障次数'\\n,t12.error_blinkstatus_cnt                  -- 'B路接入故障次数'\\n,t13.error_oximeterfault_cnt                 -- '血氧夹故障次数'\\n,0 as error_base_null_error_longitude_cnt  --       ' 历史数据FLASH操作故障次数'\\n,0 as error_base_null_error_timing_cnt     --      ' 历史数据FLASH满故障次数'\\n,0 as error_base_null_error_deforst_cnt    --      ' MCU复位次数'\\n,0 as error_base_null_error_notclosed_cnt  --      ' MCU看门狗复位次数'\\n,0 as error_base_null_error_waterpresshigh_cnt --  ' MCU命令复位次数'\\n,0 as error_base_null_error_waterpresslow_cnt  --  ' WIFI无应答故障次数'\\n,0 as error_base_null_error_wifitomcucomm_cnt  --  ' 断网故障次数'\\n,0 as error_base_null_error_poweroffmemory_cnt --  ' 时间故障次数'\\n,0 as error_base_null_error_fccomm_cnt   --        ' 原始数据FLASH操作故障次数'\\n,0 as error_base_null_error_off_cnt      --        ' 原始数据FLASH满故障次数'\\n,0 as error_base_null_error_fake_cnt     --        ' 绑定故障次数'\\n,0 as error_base_null_error_comm_cnt     --       ' 路由器断网故障次数'\\n,0 as error_base_null_error_connect_cnt  --        ' 服务器断网故障次数'\\n,0 as error_base_null_error_humilow_cnt  --        ' WIFI信号弱次数'\\n,0 as error_base_null_error_on_cnt       --        ' ADC采样故障次数'\\n,'2代' as datasource      --'数据来源'\\nfrom\\n(select\\ndeviceid            --'设备id'\\n,max(productid)   productid        --'产品id'\\n,max(device_type_id)  device_type_id           -- '设备大类'\\n,max(device_subtype_id) device_subtype_id         -- '设备小类'\\n,max(bind_user_id)   bind_user_id           -- '绑定用户'\\n,max(macaddress)     macaddress            -- 'macaddress 地址'\\n,max(mactype)        mactype            -- 'macaddress 地址类型'\\nfrom db_device_dw.clife_device_dws_error_data_tmp1\\ngroup by deviceid\\n)\\nt1\\nleft join \\n(select\\ndeviceid            --'设备id'\\n,sum(error_sdcardinsertstatus_time)     sum_error_sdcardinsertstatus_time  --'SD卡插入故障时长' 0正常，1故障\\nfrom\\n(\\nselect \\ndeviceid            --'设备id'\\n,(unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) as error_sdcardinsertstatus_time  --sd卡插入故障时长，单位秒\\nfrom db_device_dw.clife_device_dws_error_data_tmp1\\nwhere last_error_sdcardinsertstatus=1\\n) a \\ngroup by a.deviceid)\\nt2\\non t1.deviceid=t2.deviceid\\nleft join \\n(select\\ndeviceid            --'设备id'\\n,sum(error_sdcardcapacitystatus_time)     sum_error_sdcardcapacitystatus_time  --'sd卡容量故障时长，单位秒'\\nfrom\\n(\\nselect \\ndeviceid            --'设备id'\\n,(unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) as error_sdcardcapacitystatus_time  --sd卡容量故障时长，单位秒\\nfrom db_device_dw.clife_device_dws_error_data_tmp1\\nwhere last_error_sdcardcapacitystatus=1\\n) a \\ngroup by a.deviceid)\\nt3\\non t1.deviceid=t3.deviceid\\nleft join \\n(select\\ndeviceid            --'设备id'\\n,sum(error_sdcardrwstatus_time)     sum_error_sdcardrwstatus_time  --'sd卡读写故障时长，单位秒'\\nfrom\\n(\\nselect \\ndeviceid            --'设备id'\\n,(unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) as error_sdcardrwstatus_time  --sd卡读写故障时长，单位秒\\nfrom db_device_dw.clife_device_dws_error_data_tmp1\\nwhere last_error_sdcardrwstatus=1\\n) a \\ngroup by a.deviceid)\\nt4\\non t1.deviceid=t4.deviceid\\nleft join \\n(\\nselect\\ndeviceid            --'设备id'\\n,sum(error_alinkstatus_time)     sum_error_alinkstatus_time  --'A路接入故障时长'\\nfrom\\n(\\nselect \\ndeviceid            --'设备id'\\n,(unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) as error_alinkstatus_time  --A路接入故障时长，单位秒\\nfrom db_device_dw.clife_device_dws_error_data_tmp1\\nwhere last_error_alinkstatus=1\\n) a \\ngroup by a.deviceid\\n)\\nt5\\non t1.deviceid=t5.deviceid\\nleft join \\n(\\nselect\\ndeviceid            --'设备id'\\n,sum(error_blinkstatus_time)     sum_error_blinkstatus_time  --'B路接入时长'\\nfrom\\n(\\nselect \\ndeviceid            --'设备id'\\n,(unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) as error_blinkstatus_time  --在线时长，单位秒\\nfrom db_device_dw.clife_device_dws_error_data_tmp1\\nwhere last_error_blinkstatus=1\\n) a \\ngroup by a.deviceid\\n)\\nt6\\non t1.deviceid=t6.deviceid\\nleft join \\n(\\nselect\\ndeviceid            --'设备id'\\n,sum(error_oximeterfault_time)     sum_error_oximeterfault_time  --'血氧夹故障时长'\\nfrom\\n(\\nselect \\ndeviceid            --'设备id'\\n,(unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) as error_oximeterfault_time  --血氧夹故障时长，单位秒\\nfrom db_device_dw.clife_device_dws_error_data_tmp1\\nwhere last_error_oximeterfault=1\\n) a \\ngroup by a.deviceid\\n)\\nt7\\non t1.deviceid=t7.deviceid\\nleft join \\n(select\\ndeviceid            --'设备id'\\n,count(error_sdcardinsertstatus)     error_sdcardinsertstatus_cnt  --'SD卡插入故障次数'\\nfrom db_device_dw.clife_device_dws_error_data_tmp1\\nwhere last_error_sdcardinsertstatus=0 and error_sdcardinsertstatus=1\\ngroup by deviceid)\\nt8\\non t1.deviceid=t8.deviceid\\nleft join \\n(select\\ndeviceid            --'设备id'\\n,count(error_sdcardcapacitystatus)     error_sdcardcapacitystatus_cnt  --'SD卡容量故障次数'\\nfrom db_device_dw.clife_device_dws_error_data_tmp1\\nwhere last_error_sdcardcapacitystatus=0 and error_sdcardcapacitystatus=1 \\ngroup by deviceid)\\nt9\\non t1.deviceid=t9.deviceid\\nleft join \\n(select\\ndeviceid            --'设备id'\\n,count(error_sdcardrwstatus)     error_sdcardrwstatus_cnt  --'SD卡读写故障次数'\\nfrom db_device_dw.clife_device_dws_error_data_tmp1\\nwhere last_error_sdcardrwstatus=0 and error_sdcardrwstatus=1\\ngroup by deviceid)\\nt10\\non t1.deviceid=t10.deviceid\\nleft join \\n(select\\ndeviceid            --'设备id'\\n,count(error_alinkstatus)     error_alinkstatus_cnt  --'A路接入故障次数'\\nfrom db_device_dw.clife_device_dws_error_data_tmp1\\nwhere last_error_alinkstatus=0 and error_alinkstatus=1\\ngroup by deviceid)\\nt11\\non t1.deviceid=t11.deviceid\\nleft join \\n(select\\ndeviceid            --'设备id'\\n,count(error_blinkstatus)     error_blinkstatus_cnt  --'B路接入故障次数'\\nfrom db_device_dw.clife_device_dws_error_data_tmp1\\nwhere last_error_blinkstatus=0 and error_blinkstatus=1\\ngroup by deviceid)\\nt12\\non t1.deviceid=t12.deviceid\\nleft join \\n(select\\ndeviceid            --'设备id'\\n,count(error_oximeterfault)     error_oximeterfault_cnt  --'血氧夹故障次数'\\nfrom db_device_dw.clife_device_dws_error_data_tmp1\\nwhere last_error_oximeterfault=0 and error_oximeterfault=1\\ngroup by deviceid)\\nt13\\non t1.deviceid=t13.deviceid\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"error_data_tmp2_create\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"error_data_tmp2_drop\"],\"id\":\"tasks-1-3oo6k0\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"drop table if exists db_device_dw.clife_device_dws_error_data_tmp3\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"error_data_tmp3_drop\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"error_data_tmp2_create\"],\"id\":\"tasks-2-6xa6k1\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"create table if not exists db_device_dw.clife_device_dws_error_data_tmp3 stored as parquet as \\nselect\\n     deviceid                                --设备id\\n    ,productid                               --产品id\\n    ,device_type_id                          --设备大类\\n    ,device_subtype_id                       --设备小类\\n    ,bind_user_id                            --绑定用户\\n    ,macaddress                              --macaddress 地址\\n    ,mactype                                 --macaddress 地址类型\\n    ,error_base_null_error_longitude as  error_longitude     --历史数据FLASH操作故障\\n    ,lag(error_base_null_error_longitude,1,null) over(partition by deviceid order by fetchDateTime) last_error_longitude   -- 上一条历史数据FLASH操作故障\\n    ,error_base_null_error_timing   as  error_timing  --历史数据FLASH满故障\\n    ,lag(error_base_null_error_timing,1,null) over(partition by deviceid order by fetchDateTime) last_error_timing   -- 上一条历史数据FLASH满故障\\n    ,error_base_null_error_deforst  as  error_deforst --MCU复位\\n    ,lag(error_base_null_error_deforst,1,null) over(partition by deviceid order by fetchDateTime) last_error_deforst   -- 上一条MCU复位\\n    ,error_base_null_error_notclosed as error_notclosed --MCU看门狗复位\\n    ,lag(error_base_null_error_notclosed,1,null) over(partition by deviceid order by fetchDateTime) last_error_notclosed   -- 上一条MCU看门狗复位\\n    ,error_base_null_error_waterpresshigh  as error_waterpresshigh --MCU命令复位\\n    ,lag(error_base_null_error_waterpresshigh,1,null) over(partition by deviceid order by fetchDateTime) last_error_waterpresshigh   -- 上一条MCU命令复位\\n    ,error_base_null_error_waterpresslow as error_waterpresslow --WIFI无应答故障\\n    ,lag(error_base_null_error_waterpresslow,1,null) over(partition by deviceid order by fetchDateTime) last_error_waterpresslow   -- 上一条WIFI无应答故障\\n    ,error_base_null_error_wifitomcucomm as error_wifitomcucomm --断网故障\\n    ,lag(error_base_null_error_wifitomcucomm,1,null) over(partition by deviceid order by fetchDateTime) last_error_wifitomcucomm   -- 上一条断网故障\\n    ,error_base_null_error_poweroffmemory as error_poweroffmemory --时间故障\\n    ,lag(error_base_null_error_poweroffmemory,1,null) over(partition by deviceid order by fetchDateTime) last_error_poweroffmemory   -- 上一条时间故障\\n    ,error_base_null_error_fccomm as error_fccomm --原始数据FLASH操作故障\\n    ,lag(error_base_null_error_fccomm,1,null) over(partition by deviceid order by fetchDateTime) last_error_fccomm   -- 上一条原始数据FLASH操作故障\\n    ,error_base_null_error_off as error_off --原始数据FLASH满故障\\n    ,lag(error_base_null_error_off,1,null) over(partition by deviceid order by fetchDateTime) last_error_off   -- 上一条原始数据FLASH满故障\\n    ,error_base_null_error_fake as error_fake --绑定\\n    ,lag(error_base_null_error_fake,1,null) over(partition by deviceid order by fetchDateTime) last_error_fake   -- 上一条绑定\\n    ,error_base_null_error_comm as error_comm --路由器断网故障\\n    ,lag(error_base_null_error_comm,1,null) over(partition by deviceid order by fetchDateTime) last_error_comm   -- 上一条路由器断网故障\\n    ,error_base_null_error_connect as error_connect --服务器断网故障\\n    ,lag(error_base_null_error_connect,1,null) over(partition by deviceid order by fetchDateTime) last_error_connect   -- 上一条服务器断网故障\\n    ,error_base_null_error_humilow as error_humilow --WIFI信号弱\\n    ,lag(error_base_null_error_humilow,1,null) over(partition by deviceid order by fetchDateTime) last_error_humilow   -- 上一条WIFI信号弱\\n    ,error_base_null_error_on as error_on --ADC采样故障\\n    ,lag(error_base_null_error_on,1,null) over(partition by deviceid order by fetchDateTime) last_error_on   -- 上一条ADC采样故障\\n    ,datasource                                        -- 数据来源\\n    ,fetchDateTime                    -- 采集时间\\n    ,lag(fetchDateTime,1,null) over(partition by deviceid order by fetchDateTime) last_fetchDateTime   -- 上一条采集时间\\nfrom db_device_dw.clife_device_dwd_sleep_error_data \\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','') \\n  and datasource='3代'\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"error_data_tmp3_create\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"error_data_tmp3_drop\"],\"id\":\"tasks-1-34z536\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"drop table if exists db_device_dw.clife_device_dws_error_data_tmp4\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"error_data_tmp4_drop\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"error_data_tmp3_create\"],\"id\":\"tasks-2-4am43\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"create table if not exists db_device_dw.clife_device_dws_error_data_tmp4 stored as parquet as\\nselect\\n     t1.deviceid                                  --'设备id'\\n    ,t1.productid                                 --'产品id'\\n    ,t1.device_type_id                            --'设备大类'\\n    ,t1.device_subtype_id                         --'设备小类'\\n    ,t1.bind_user_id                              --'绑定用户'\\n    ,t1.macaddress                                --'macaddress 地址'\\n    ,t1.mactype                                   --'macaddress 地址类型'\\n    ,0 as sum_error_sdcardinsertstatus_time       --'sd卡插入故障时长，单位秒'\\n    ,0 as sum_error_sdcardcapacitystatus_time     --'sd卡容量故障时长，单位秒'\\n    ,0 as sum_error_sdcardrwstatus_time           --'sd卡读写故障时长，单位秒'\\n    ,0 as sum_error_alinkstatus_time              --'A路接入故障时长，单位秒'\\n    ,0 as sum_error_blinkstatus_time              --'B路接入故障时长，单位秒'\\n    ,0 as sum_error_oximeterlink_time             --'血氧夹故障时长，单位秒'\\n    ,error_base_null_error_longitude_time         --'历史数据FLASH操作故障时长'\\n    ,error_base_null_error_timing_time            --'历史数据FLASH满故障时长'\\n    ,error_base_null_error_deforst_time           --'MCU复位时长'\\n    ,error_base_null_error_notclosed_time         --'MCU看门狗复位时长'\\n    ,error_base_null_error_waterpresshigh_time    --'MCU命令复位时长'\\n    ,error_base_null_error_waterpresslow_time     --'WIFI无应答故障时长'\\n    ,error_base_null_error_wifitomcucomm_time     --'断网故障时长'\\n    ,error_base_null_error_poweroffmemory_time    --'时间故障时长'\\n    ,error_base_null_error_fccomm_time            --'原始数据FLASH操作故障时长'\\n    ,error_base_null_error_off_time               --'原始数据FLASH满故障时长'\\n    ,error_base_null_error_fake_time              --'绑定故障时长'\\n    ,error_base_null_error_comm_time              --'路由器断网故障时长'\\n    ,error_base_null_error_connect_time           --'服务器断网故障时长'\\n    ,error_base_null_error_humilow_time           --'WIFI信号弱时长'\\n    ,error_base_null_error_on_time                --'ADC采样故障时长'\\n    ,0 as error_sdcardinsertstatus_cnt            --'sd卡插入故障次数'\\n    ,0 as error_sdcardcapacitystatus_cnt          --'sd卡容量故障次数'\\n    ,0 as error_sdcardrwstatus_cnt                --'sd卡读写故障次数'\\n    ,0 as error_alinkstatus_cnt                   --'A路接入故障次数'\\n    ,0 as error_blinkstatus_cnt                   --'B路接入故障次数'\\n    ,0 as error_oximeterlink_cnt                  --'血氧夹故障次数'\\n    ,error_base_null_error_longitude_cnt          --'历史数据FLASH操作故障次数'\\n    ,error_base_null_error_timing_cnt             --'历史数据FLASH满故障次数'\\n    ,error_base_null_error_deforst_cnt            --'MCU复位次数'\\n    ,error_base_null_error_notclosed_cnt          --'MCU看门狗复位次数'\\n    ,error_base_null_error_waterpresshigh_cnt     --'MCU命令复位次数'\\n    ,error_base_null_error_waterpresslow_cnt      --'WIFI无应答故障次数'\\n    ,error_base_null_error_wifitomcucomm_cnt      --'断网故障次数'\\n    ,error_base_null_error_poweroffmemory_cnt     --'时间故障次数'\\n    ,error_base_null_error_fccomm_cnt             --'原始数据FLASH操作故障次数'\\n    ,error_base_null_error_off_cnt                --'原始数据FLASH满故障次数'\\n    ,error_base_null_error_fake_cnt               --'绑定故障次数'\\n    ,error_base_null_error_comm_cnt               --'路由器断网故障次数'\\n    ,error_base_null_error_connect_cnt            --'服务器断网故障次数'\\n    ,error_base_null_error_humilow_cnt            --'WIFI信号弱次数'\\n    ,error_base_null_error_on_cnt                 --'ADC采样故障次数'\\n    ,'3代' as datasource                          --'数据来源'\\nfrom\\n(\\n   select\\n        deviceid            --'设备id'\\n       ,max(productid)   productid        --'产品id'\\n       ,max(device_type_id)  device_type_id           -- '设备大类'\\n       ,max(device_subtype_id) device_subtype_id         -- '设备小类'\\n       ,max(bind_user_id)   bind_user_id           -- '绑定用户'\\n       ,max(macaddress)     macaddress            -- 'macaddress 地址'\\n       ,max(mactype)        mactype            -- 'macaddress 地址类型'\\n       ,sum(case when error_longitude = 1      and last_error_longitude = 0      then 1 else 0 end) as error_base_null_error_longitude_cnt\\n       ,sum(case when error_timing = 1         and last_error_timing = 0         then 1 else 0 end) as error_base_null_error_timing_cnt\\n       ,sum(case when error_deforst = 1        and last_error_deforst = 0        then 1 else 0 end) as error_base_null_error_deforst_cnt\\n       ,sum(case when error_notclosed = 1      and last_error_notclosed = 0      then 1 else 0 end) as error_base_null_error_notclosed_cnt\\n       ,sum(case when error_waterpresshigh = 1 and last_error_waterpresshigh = 0 then 1 else 0 end) as error_base_null_error_waterpresshigh_cnt\\n       ,sum(case when error_waterpresslow = 1  and last_error_waterpresslow = 0  then 1 else 0 end) as error_base_null_error_waterpresslow_cnt\\n       ,sum(case when error_wifitomcucomm = 1  and last_error_wifitomcucomm = 0  then 1 else 0 end) as error_base_null_error_wifitomcucomm_cnt\\n       ,sum(case when error_poweroffmemory = 1 and last_error_poweroffmemory = 0 then 1 else 0 end) as error_base_null_error_poweroffmemory_cnt\\n       ,sum(case when error_fccomm = 1         and last_error_fccomm = 0         then 1 else 0 end) as error_base_null_error_fccomm_cnt\\n       ,sum(case when error_off = 1            and last_error_off = 0            then 1 else 0 end) as error_base_null_error_off_cnt\\n       ,sum(case when error_fake = 1           and last_error_fake = 0           then 1 else 0 end) as error_base_null_error_fake_cnt\\n       ,sum(case when error_comm = 1           and last_error_comm = 0           then 1 else 0 end) as error_base_null_error_comm_cnt\\n       ,sum(case when error_connect = 1        and last_error_connect = 0        then 1 else 0 end) as error_base_null_error_connect_cnt\\n       ,sum(case when error_humilow = 1        and last_error_humilow = 0        then 1 else 0 end) as error_base_null_error_humilow_cnt\\n       ,sum(case when error_on = 1             and last_error_on = 0             then 1 else 0 end) as error_base_null_error_on_cnt\\n       ,sum(case when last_error_longitude = 1      then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end)  as   error_base_null_error_longitude_time         --'历史数据FLASH操作故障时长'\\n       ,sum(case when last_error_timing = 1         then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end)  as   error_base_null_error_timing_time            --'历史数据FLASH满故障时长'\\n       ,sum(case when last_error_deforst = 1        then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end)  as   error_base_null_error_deforst_time           --'MCU复位时长'\\n       ,sum(case when last_error_notclosed = 1      then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end)  as   error_base_null_error_notclosed_time         --'MCU看门狗复位时长'\\n       ,sum(case when last_error_waterpresshigh = 1 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end)  as   error_base_null_error_waterpresshigh_time    --'MCU命令复位时长'\\n       ,sum(case when last_error_waterpresslow = 1  then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end)  as   error_base_null_error_waterpresslow_time     --'WIFI无应答故障时长'\\n       ,sum(case when last_error_wifitomcucomm = 1  then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end)  as   error_base_null_error_wifitomcucomm_time     --'断网故障时长'\\n       ,sum(case when last_error_poweroffmemory = 1 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end)  as   error_base_null_error_poweroffmemory_time    --'时间故障时长'\\n       ,sum(case when last_error_fccomm = 1         then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end)  as   error_base_null_error_fccomm_time            --'原始数据FLASH操作故障时长'\\n       ,sum(case when last_error_off = 1            then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end)  as   error_base_null_error_off_time               --'原始数据FLASH满故障时长'\\n       ,sum(case when last_error_fake = 1           then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end)  as   error_base_null_error_fake_time              --'绑定故障时长'\\n       ,sum(case when last_error_comm = 1           then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end)  as   error_base_null_error_comm_time              --'路由器断网故障时长'\\n       ,sum(case when last_error_connect = 1        then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end)  as   error_base_null_error_connect_time           --'服务器断网故障时长'\\n       ,sum(case when last_error_humilow = 1        then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end)  as   error_base_null_error_humilow_time           --'WIFI信号弱时长'\\n       ,sum(case when last_error_on = 1             then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end)  as   error_base_null_error_on_time                --'ADC采样故障时长'     \\n   from db_device_dw.clife_device_dws_error_data_tmp3\\n   group by deviceid\\n)t1\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"error_data_tmp4_create\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"error_data_tmp4_drop\"],\"id\":\"tasks-1-6z87dx\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"type\":\"HIVE\",\"datasource\":147,\"sql\":\"insert overwrite table db_device_dw.clife_device_dws_sleep_error_data partition(part_date)\\nselect \\n deviceid            --'设备id'\\n,productid           --'产品id'\\n,device_type_id             -- '设备大类'\\n,device_subtype_id          -- '设备小类'\\n,bind_user_id               -- '绑定用户'\\n,macaddress                 -- 'macaddress 地址'\\n,mactype                    -- 'macaddress 地址类型'\\n,sum_error_sdcardinsertstatus_time     -- 'sd卡插入故障时长，单位秒'\\n,sum_error_sdcardcapacitystatus_time   -- 'sd卡容量故障时长，单位秒'\\n,sum_error_sdcardrwstatus_time         -- 'sd卡读写故障时长，单位秒'\\n,sum_error_alinkstatus_time                  -- 'A路接入故障时长，单位秒'\\n,sum_error_blinkstatus_time                  -- 'B路接入故障时长，单位秒'\\n,sum_error_oximeterfault_time as sum_error_oximeterlink_time                 -- '血氧夹故障时长，单位秒'\\n,error_base_null_error_longitude_time  --       ' 历史数据FLASH操作故障时长'\\n,error_base_null_error_timing_time     --      ' 历史数据FLASH满故障时长'\\n,error_base_null_error_deforst_time    --      ' MCU复位时长'\\n,error_base_null_error_notclosed_time  --      ' MCU看门狗复位时长'\\n,error_base_null_error_waterpresshigh_time --  ' MCU命令复位时长'\\n,error_base_null_error_waterpresslow_time  --  ' WIFI无应答故障时长'\\n,error_base_null_error_wifitomcucomm_time  --  ' 断网故障时长'\\n,error_base_null_error_poweroffmemory_time --  ' 时间故障时长'\\n,error_base_null_error_fccomm_time   --        ' 原始数据FLASH操作故障时长'\\n,error_base_null_error_off_time      --        ' 原始数据FLASH满故障时长'\\n,error_base_null_error_fake_time     --        ' 绑定故障时长'\\n,error_base_null_error_comm_time     --       ' 路由器断网故障时长'\\n,error_base_null_error_connect_time  --        ' 服务器断网故障时长'\\n,error_base_null_error_humilow_time  --        ' WIFI信号弱时长'\\n,error_base_null_error_on_time       --        ' ADC采样故障时长'\\n,error_sdcardinsertstatus_cnt          -- 'sd卡插入故障次数'\\n,error_sdcardcapacitystatus_cnt          -- 'sd卡容量故障次数'\\n,error_sdcardrwstatus_cnt          -- 'sd卡读写故障次数'\\n,error_alinkstatus_cnt                  -- 'A路接入故障次数'\\n,error_blinkstatus_cnt                  -- 'B路接入故障次数'\\n,error_oximeterfault_cnt                 -- '血氧夹故障次数'\\n,error_base_null_error_longitude_cnt  --       ' 历史数据FLASH操作故障次数'\\n,error_base_null_error_timing_cnt     --      ' 历史数据FLASH满故障次数'\\n,error_base_null_error_deforst_cnt    --      ' MCU复位次数'\\n,error_base_null_error_notclosed_cnt  --      ' MCU看门狗复位次数'\\n,error_base_null_error_waterpresshigh_cnt --  ' MCU命令复位次数'\\n,error_base_null_error_waterpresslow_cnt  --  ' WIFI无应答故障次数'\\n,error_base_null_error_wifitomcucomm_cnt  --  ' 断网故障次数'\\n,error_base_null_error_poweroffmemory_cnt --  ' 时间故障次数'\\n,error_base_null_error_fccomm_cnt   --        ' 原始数据FLASH操作故障次数'\\n,error_base_null_error_off_cnt      --        ' 原始数据FLASH满故障次数'\\n,error_base_null_error_fake_cnt     --        ' 绑定故障次数'\\n,error_base_null_error_comm_cnt     --       ' 路由器断网故障次数'\\n,error_base_null_error_connect_cnt  --        ' 服务器断网故障次数'\\n,error_base_null_error_humilow_cnt  --        ' WIFI信号弱次数'\\n,error_base_null_error_on_cnt       --        ' ADC采样故障次数'\\n,datasource      --'数据来源'\\n,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom \\ndb_device_dw.clife_device_dws_error_data_tmp2\\nunion all\\nselect \\n     deviceid                                   --'设备id'\\n    ,productid                                  --'产品id'\\n    ,device_type_id                             --'设备大类'\\n    ,device_subtype_id                          --'设备小类'\\n    ,bind_user_id                               --'绑定用户'\\n    ,macaddress                                 --'macaddress 地址'\\n    ,mactype                                    --'macaddress 地址类型'\\n    ,sum_error_sdcardinsertstatus_time          --'sd卡插入故障时长，单位秒'\\n    ,sum_error_sdcardcapacitystatus_time        --'sd卡容量故障时长，单位秒'\\n    ,sum_error_sdcardrwstatus_time              --'sd卡读写故障时长，单位秒'\\n    ,sum_error_alinkstatus_time                 --'A路接入故障时长，单位秒'\\n    ,sum_error_blinkstatus_time                 --'B路接入故障时长，单位秒'\\n    ,sum_error_oximeterlink_time                --'血氧夹故障时长，单位秒'\\n    ,error_base_null_error_longitude_time       --'历史数据FLASH操作故障时长'\\n    ,error_base_null_error_timing_time          --'历史数据FLASH满故障时长'\\n    ,error_base_null_error_deforst_time         --'MCU复位时长'\\n    ,error_base_null_error_notclosed_time       --'MCU看门狗复位时长'\\n    ,error_base_null_error_waterpresshigh_time  --'MCU命令复位时长'\\n    ,error_base_null_error_waterpresslow_time   --'WIFI无应答故障时长'\\n    ,error_base_null_error_wifitomcucomm_time   --'断网故障时长'\\n    ,error_base_null_error_poweroffmemory_time  --'时间故障时长'\\n    ,error_base_null_error_fccomm_time          --'原始数据FLASH操作故障时长'\\n    ,error_base_null_error_off_time             --'原始数据FLASH满故障时长'\\n    ,error_base_null_error_fake_time            --'绑定故障时长'\\n    ,error_base_null_error_comm_time            --'路由器断网故障时长'\\n    ,error_base_null_error_connect_time         --'服务器断网故障时长'\\n    ,error_base_null_error_humilow_time         --'WIFI信号弱时长'\\n    ,error_base_null_error_on_time              --'ADC采样故障时长'\\n    ,error_sdcardinsertstatus_cnt               --'sd卡插入故障次数'\\n    ,error_sdcardcapacitystatus_cnt             --'sd卡容量故障次数'\\n    ,error_sdcardrwstatus_cnt                   --'sd卡读写故障次数'\\n    ,error_alinkstatus_cnt                      --'A路接入故障次数'\\n    ,error_blinkstatus_cnt                      --'B路接入故障次数'\\n    ,error_oximeterlink_cnt   as    error_oximeterfault_cnt               --'血氧夹故障次数'\\n    ,error_base_null_error_longitude_cnt        --'历史数据FLASH操作故障次数'\\n    ,error_base_null_error_timing_cnt           --'历史数据FLASH满故障次数'\\n    ,error_base_null_error_deforst_cnt          --'MCU复位次数'\\n    ,error_base_null_error_notclosed_cnt        --'MCU看门狗复位次数'\\n    ,error_base_null_error_waterpresshigh_cnt   --'MCU命令复位次数'\\n    ,error_base_null_error_waterpresslow_cnt    --'WIFI无应答故障次数'\\n    ,error_base_null_error_wifitomcucomm_cnt    --'断网故障次数'\\n    ,error_base_null_error_poweroffmemory_cnt   --'时间故障次数'\\n    ,error_base_null_error_fccomm_cnt           --'原始数据FLASH操作故障次数'\\n    ,error_base_null_error_off_cnt              --'原始数据FLASH满故障次数'\\n    ,error_base_null_error_fake_cnt             --'绑定故障次数'\\n    ,error_base_null_error_comm_cnt             --'路由器断网故障次数'\\n    ,error_base_null_error_connect_cnt          --'服务器断网故障次数'\\n    ,error_base_null_error_humilow_cnt          --'WIFI信号弱次数'\\n    ,error_base_null_error_on_cnt               --'ADC采样故障次数'\\n    ,datasource                                 --'数据来源'\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_device_dw.clife_device_dws_error_data_tmp4\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"enable\":false,\"strategy\":\"\",\"interval\":null},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_device_dws_sleep_error_data\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"error_data_tmp4_create\"],\"id\":\"tasks-9-6oq601\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"insert overwrite table db_device_dw.clife_device_dws_sleep_run_data partition(part_date)\\nselect\\n deviceid            --'设备id'\\n,productid           --'产品id'\\n,device_type_id             -- '设备大类'\\n,device_subtype_id          -- '设备小类'\\n,bind_user_id               -- '绑定用户'\\n,macaddress                 -- 'macaddress 地址'\\n,mactype                    -- 'macaddress 地址类型'\\n,on_cnt               -- '在线次数'\\n,off_cnt                -- '离线次数'\\n,sum_on_time                -- '在线时长'\\n,sum_off_time                -- '离线时长'\\n,sum_oximeterlink_time  --'血氧夹接入时长'\\n,sum_alinkstatus_time  --'A路接入时长'\\n,sum_blinkstatus_time  --'B路接入时长'\\n,sum_adjustbodymov   --'需要校准体动次数'\\n,datasource      --'数据来源'\\n,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_device_dw.clife_device_dws_run_data_tmp2\\nunion all\\nselect\\n     deviceid            --'设备id'\\n    ,productid           --'产品id'\\n    ,device_type_id             -- '设备大类'\\n    ,device_subtype_id          -- '设备小类'\\n    ,bind_user_id               -- '绑定用户'\\n    ,macaddress                 -- 'macaddress 地址'\\n    ,mactype                    -- 'macaddress 地址类型'\\n    ,on_cnt               -- '在线次数'\\n    ,off_cnt                -- '离线次数'\\n    ,sum_on_time                -- '在线时长'\\n    ,sum_off_time                -- '离线时长'\\n    ,sum_oximeterlink_time  --'血氧夹接入时长'\\n    ,sum_alinkstatus_time  --'A路接入时长'\\n    ,sum_blinkstatus_time  --'B路接入时长'\\n    ,sum_adjustbodymov   --'需要校准体动次数'\\n    ,datasource      --'数据来源'\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_device_dw.clife_device_dws_run_data_tmp4\\nunion all\\nselect\\n     deviceid            --'设备id'\\n    ,productid           --'产品id'\\n    ,device_type_id             -- '设备大类'\\n    ,device_subtype_id          -- '设备小类'\\n    ,bind_user_id               -- '绑定用户'\\n    ,macaddress                 -- 'macaddress 地址'\\n    ,mactype                    -- 'macaddress 地址类型'\\n    ,on_cnt               -- '在线次数'\\n    ,off_cnt                -- '离线次数'\\n    ,sum_on_time                -- '在线时长'\\n    ,sum_off_time                -- '离线时长'\\n    ,sum_oximeterlink_time  --'血氧夹接入时长'\\n    ,sum_alinkstatus_time  --'A路接入时长'\\n    ,sum_blinkstatus_time  --'B路接入时长'\\n    ,sum_adjustbodymov   --'需要校准体动次数'\\n    ,datasource      --'数据来源'\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_device_dw.clife_device_dws_run_data_tmp6\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_device_dws_sleep_run_data\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp6_create\"],\"id\":\"tasks-9-o6dh\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"drop table if exists db_device_dw.clife_device_dws_run_data_tmp5\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp5_drop\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp4_create\"],\"id\":\"tasks-2-dcml\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"create table if not exists db_device_dw.clife_device_dws_run_data_tmp5 stored as parquet as\\nselect \\n     deviceid            --'设备id'\\n    ,productid           --'产品id'\\n    ,device_type_id             -- '设备大类'\\n    ,device_subtype_id          -- '设备小类'\\n    ,bind_user_id               -- '绑定用户'\\n    ,macaddress                 -- 'macaddress 地址'\\n    ,mactype                    -- 'macaddress 地址类型'\\n    ,onoff    -- '在线离线'\\n    ,lag(onoff, 1, null) over (partition by deviceid order by fetchDateTime)  last_onoff  --'设备上一条开关机状态'\\n    ,datasource                 --  '数据来源' \\n    ,fetchDateTime              --  '采集时间'\\n    ,lag(fetchDateTime, 1, null) over (partition by deviceid order by fetchDateTime)  last_fetchDateTime  --'设备上一条采集时间' \\nfrom db_device_dw.clife_device_dwd_sleep_run_data \\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','') \\n  and datasource='儿童睡眠带'\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp5_create\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp5_drop\"],\"id\":\"tasks-4-7ii5c6\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"drop table if exists db_device_dw.clife_device_dws_run_data_tmp6\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp6_drop\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp5_create\"],\"id\":\"tasks-2-1d83o1\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"create table if not exists db_device_dw.clife_device_dws_run_data_tmp6 stored as parquet as\\nselect\\n     t1.deviceid            --'设备id'\\n    ,t1.productid           --'产品id'\\n    ,t1.device_type_id             -- '设备大类'\\n    ,t1.device_subtype_id          -- '设备小类'\\n    ,t1.bind_user_id               -- '绑定用户'\\n    ,t1.macaddress                 -- 'macaddress 地址'\\n    ,t1.mactype                    -- 'macaddress 地址类型'\\n    ,t1.on_cnt               -- '在线次数'\\n    ,t1.off_cnt                -- '离线次数'\\n    ,t1.sum_on_time                -- '在线时长'\\n    ,t1.sum_off_time                -- '离线时长'\\n    ,0 as sum_oximeterlink_time  --'血氧夹接入时长'\\n    ,0 as sum_alinkstatus_time  --'A路接入时长'\\n    ,0 as sum_blinkstatus_time  --'B路接入时长'\\n    ,0 as sum_adjustbodymov   --'需要校准体动次数'\\n    ,'3代' as datasource      --'数据来源'\\nfrom\\n(\\n select\\n     deviceid            --'设备id'\\n    ,max(productid)   productid        --'产品id'\\n    ,max(device_type_id)  device_type_id           -- '设备大类'\\n    ,max(device_subtype_id) device_subtype_id         -- '设备小类'\\n    ,max(bind_user_id)   bind_user_id           -- '绑定用户'\\n    ,max(macaddress)     macaddress            -- 'macaddress 地址'\\n    ,max(mactype)        mactype            -- 'macaddress 地址类型'\\n    ,sum(case when last_onoff=2 and onoff=1 then 1 else 0 end) as on_cnt  --'在线次数'   0-不上传|1-上传\\n    ,sum(case when last_onoff=1 and onoff=2 then 1 else 0 end) as off_cnt  --'离线次数'\\n    ,sum(case when last_onoff = 2 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_on_time --'在线时长'\\n    ,sum(case when last_onoff = 1 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_off_time --'离线时长'\\n from db_device_dw.clife_device_dws_run_data_tmp5\\n group by deviceid\\n)t1\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp6_create\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp6_drop\"],\"id\":\"tasks-4-30j2x6\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"drop table if exists db_device_dw.clife_device_dws_run_data_tmp14\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp14_drop\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_device_dws_sleep_run_data\"],\"id\":\"tasks-2-7es797\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"create table if not exists db_device_dw.clife_device_dws_run_data_tmp14 stored as parquet as\\nselect \\n     deviceid            --'设备id'\\n    ,productid           --'产品id'\\n    ,device_type_id             -- '设备大类'\\n    ,device_subtype_id          -- '设备小类'\\n    ,bind_user_id               -- '绑定用户'\\n    ,macaddress                 -- 'macaddress 地址'\\n    ,mactype                    -- 'macaddress 地址类型'\\n    ,onoffstatus    -- '在线离线'\\n    ,workmode       -- '工作模式'\\n    ,realfanspeed                    --实际风速\\n    ,ChildLockStatus                 --童锁状态\\n    ,LearningStatus                  --学习状态\\n    ,lag(onoffstatus, 1, null) over (partition by deviceid order by fetchdatetime)  last_onoff  --'设备上一条开关机状态'\\n    ,lag(workmode, 1, null) over (partition by deviceid order by fetchdatetime)  last_workmode  --'设备上一条工作模式状态'\\n    ,lag(realfanspeed, 1, null) over (partition by deviceid order by fetchdatetime)  last_realfanspeed  --'设备上一条实际风速'\\n    ,lag(ChildLockStatus, 1, null) over (partition by deviceid order by fetchdatetime)  last_ChildLock  --'设备上一条童锁状态'\\n    ,lag(LearningStatus, 1, null) over (partition by deviceid order by fetchdatetime)  last_Learning  --'设备上一条学习状态'\\n    ,datasource                 --  '数据来源' \\n    ,fetchDateTime              --  '采集时间'\\n    ,lag(fetchDateTime, 1, null) over (partition by deviceid order by fetchDateTime)  last_fetchDateTime  --'设备上一条采集时间' \\nfrom db_device_dw.clife_device_dwd_air_conditioning_run_data1\\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','') \\n  and datasource='科什'\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp14_create\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp14_drop\"],\"id\":\"tasks-4-1m43yo\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"drop table if exists db_device_dw.clife_device_dws_run_data_tmp15\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp15_drop\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp14_create\"],\"id\":\"tasks-2-6tl16l\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"set mapred.reduce.tasks=6;\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"create table if not exists db_device_dw.clife_device_dws_run_data_tmp15 stored as parquet as\\nselect\\n     deviceid                   --'设备id'\\n    ,productid                  --'产品id'\\n    ,device_type_id             --'设备大类'\\n    ,device_subtype_id          --'设备小类'\\n    ,bind_user_id               -- '绑定用户'\\n    ,macaddress                 --'macaddress 地址'\\n    ,mactype                    --'macaddress 地址类型'\\n    ,on_cnt                     --'在线次数'\\n    ,off_cnt                    --'离线次数'\\n    ,sum_on_time                --'在线时长'\\n    ,sum_off_time               --'离线时长'\\n    ,cool_cnt                   --'制冷次数'\\n    ,dehumidification_cnt       --'除湿次数'\\n    ,blast_cnt                  --'送风次数'\\n    ,heating_cnt                --'制热次数'\\n    ,auto_cnt                   --'自动次数'\\n    ,sleep_cnt                  --'睡眠次数'\\n    ,sum_cool_time              --'制冷时长'\\n    ,sum_dehumidification_time  --'除湿时长'\\n    ,sum_blast_time             --'送风时长'\\n    ,sum_heating_time           --'制热时长'\\n    ,sum_auto_time              --'自动时长'\\n    ,sum_sleep_time             --'睡眠时长'\\n    ,very_low_wind_speed_cnt    --'极低风速次数'\\n    ,low_wind_speed_cnt         --'低风速次数'\\n    ,medium_wind_speed_cnt      --'中风速次数'\\n    ,hight_wind_speed_cnt       --'高风速次数'\\n    ,ultrahigh_wind_speed_cnt   --'超高风速次数'\\n    ,very_low_wind_speed_time   --'极低风速时长'\\n    ,low_wind_speed_time        --'低风速时长'\\n    ,medium_wind_speed_time     --'中风速时长'\\n    ,hight_wind_speed_time      --'高风速时长'\\n    ,ultrahigh_wind_speed_time  --'超高风速时长'\\n    ,ChildLock_open_cnt         --'童锁开启次数'\\n    ,ChildLock_close_cnt        --'童锁关闭次数'\\n    ,ChildLock_open_time        --'童锁开启时长'\\n    ,ChildLock_close_time       --'童锁关闭时长'\\n    ,Learning_win_cnt           --'学习成功次数'\\n    ,Learning_no_cnt            --'待学习次数'\\n    ,Learning_lose_cnt          --'学习失败次数'\\n    ,Learning_win_time          --'学习成功时长'\\n    ,Learning_no_time           --'待学习时长'\\n    ,Learning_lose_time         --'学习失败时长'\\n    ,'科什' as  datasource  --'数据来源\\nfrom\\n(\\n   select\\n        deviceid                                       --'设备id'\\n       ,max(productid)         as productid            --'产品id'\\n       ,max(device_type_id)    as device_type_id       --'设备大类'\\n       ,max(device_subtype_id) as device_subtype_id    --'设备小类'\\n       ,max(bind_user_id)      as bind_user_id         -- '绑定用户'\\n       ,max(macaddress)        as macaddress           -- 'macaddress 地址'\\n       ,max(mactype)           as mactype              -- 'macaddress 地址类型'\\n       ,sum(case when last_onoff=2 and onoffstatus=1 then 1 else 0 end) as on_cnt   --'在线次数'\\n       ,sum(case when last_onoff=1 and onoffstatus=2 then 1 else 0 end) as off_cnt  --'离线次数'\\n       ,sum(case when last_onoff = 2 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_on_time  --'在线时长'\\n       ,sum(case when last_onoff = 1 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_off_time --'离线时长'\\n       ,sum(case when workmode = 1 and last_workmode != 1 then 1 else 0 end) as cool_cnt              --制冷次数\\n       ,sum(case when workmode = 2 and last_workmode != 2 then 1 else 0 end) as dehumidification_cnt  --除湿次数\\n       ,sum(case when workmode = 3 and last_workmode != 3 then 1 else 0 end) as blast_cnt             --送风次数\\n       ,sum(case when workmode = 4 and last_workmode != 4 then 1 else 0 end) as heating_cnt           --制热次数\\n       ,sum(case when workmode = 5 and last_workmode != 5 then 1 else 0 end) as auto_cnt              --自动次数\\n       ,sum(case when workmode = 7 and last_workmode != 7 then 1 else 0 end) as sleep_cnt             --睡眠次数\\n       ,sum(case when workmode = 1 and last_workmode != 1 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_cool_time             --'制冷时长'\\n       ,sum(case when workmode = 2 and last_workmode != 2 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_dehumidification_time --'除湿时长'\\n       ,sum(case when workmode = 3 and last_workmode != 3 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_blast_time            --'送风时长'\\n       ,sum(case when workmode = 4 and last_workmode != 4 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_heating_time          --'制热时长'\\n       ,sum(case when workmode = 5 and last_workmode != 5 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_auto_time             --'自动时长'\\n       ,sum(case when workmode = 7 and last_workmode != 7 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_sleep_time            --'睡眠时长'\\n       ,sum(case when RealFanSpeed = 0 and last_realfanspeed != 0 then 1 else 0 end) as  very_low_wind_speed_cnt  --极低风速次数\\n       ,sum(case when RealFanSpeed = 1 and last_realfanspeed != 1 then 1 else 0 end) as  low_wind_speed_cnt       --低风速次数\\n       ,sum(case when RealFanSpeed = 2 and last_realfanspeed != 2 then 1 else 0 end) as  medium_wind_speed_cnt    --中风速次数\\n       ,sum(case when RealFanSpeed = 3 and last_realfanspeed != 3 then 1 else 0 end) as  hight_wind_speed_cnt     --高风速次数\\n       ,sum(case when RealFanSpeed = 4 and last_realfanspeed != 4 then 1 else 0 end) as  ultrahigh_wind_speed_cnt --超高风速次数\\n       ,sum(case when RealFanSpeed = 0 and last_realfanspeed != 0 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as very_low_wind_speed_time   --'极低风速时长'\\n       ,sum(case when RealFanSpeed = 1 and last_realfanspeed != 1 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as low_wind_speed_time        --'低风速时长'\\n       ,sum(case when RealFanSpeed = 2 and last_realfanspeed != 2 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as medium_wind_speed_time     --'中风速时长'\\n       ,sum(case when RealFanSpeed = 3 and last_realfanspeed != 3 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as hight_wind_speed_time      --'高风速时长'\\n       ,sum(case when RealFanSpeed = 4 and last_realfanspeed != 4 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as ultrahigh_wind_speed_time  --'超高风速时长'\\n       ,sum(case when ChildLockStatus = 1 and last_ChildLock = 2 then 1 else 0 end ) as ChildLock_open_cnt  --童锁开启次数\\n       ,sum(case when ChildLockStatus = 2 and last_ChildLock = 1 then 1 else 0 end ) as ChildLock_close_cnt --童锁关闭次数\\n       ,sum(case when last_ChildLock = 2 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as ChildLock_open_time  --'童锁开启时长'\\n       ,sum(case when last_ChildLock = 1 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as ChildLock_close_time  --'童锁关闭时长'\\n       ,sum(case when LearningStatus = 1 and last_Learning != 1 then 1 else 0 end ) as Learning_win_cnt  --学习成功次数\\n       ,sum(case when LearningStatus = 2 and last_Learning != 2 then 1 else 0 end ) as Learning_no_cnt   --待学习次数\\n       ,sum(case when LearningStatus = 3 and last_Learning != 3 then 1 else 0 end ) as Learning_lose_cnt --学习失败次数\\n       ,sum(case when LearningStatus = 1 and last_Learning != 1 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as Learning_win_time  --'学习成功时长'\\n       ,sum(case when LearningStatus = 2 and last_Learning != 2 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as Learning_no_time  --'待学习时长'\\n       ,sum(case when LearningStatus = 3 and last_Learning != 3 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as Learning_lose_time  --'学习失败时长'\\n   from db_device_dw.clife_device_dws_run_data_tmp14\\n   group by deviceid\\n)t\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp15_create\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp15_drop\"],\"id\":\"tasks-4-6zo1z0\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"drop table if exists db_device_dw.clife_device_dws_run_data_tmp16\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp16_drop\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp15_create\"],\"id\":\"tasks-2-41p35z\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"create table if not exists db_device_dw.clife_device_dws_run_data_tmp16 stored as parquet as\\nselect \\n     deviceid            --'设备id'\\n    ,productid           --'产品id'\\n    ,device_type_id             -- '设备大类'\\n    ,device_subtype_id          -- '设备小类'\\n    ,bind_user_id               -- '绑定用户'\\n    ,macaddress                 -- 'macaddress 地址'\\n    ,mactype                    -- 'macaddress 地址类型'\\n    ,onoffstatus    --'在线离线'\\n    ,workmode       --'工作模式'\\n    ,realfanspeed   --'实际风速'\\n    ,lag(onoffstatus, 1, null) over (partition by deviceid order by fetchdatetime)  last_onoff  --'设备上一条开关机状态'\\n    ,lag(workmode, 1, null) over (partition by deviceid order by fetchdatetime)  last_workmode  --'设备上一条工作模式状态'\\n    ,lag(realfanspeed, 1, null) over (partition by deviceid order by fetchdatetime)  last_realfanspeed  --'设备上一条实际风速'\\n    ,datasource                 --  '数据来源' \\n    ,fetchDateTime              --  '采集时间'\\n    ,lag(fetchDateTime, 1, null) over (partition by deviceid order by fetchDateTime)  last_fetchDateTime  --'设备上一条采集时间' \\nfrom db_device_dw.clife_device_dwd_air_conditioning_run_data1\\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','') \\n  and datasource='松下'\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp16_create\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp16_drop\"],\"id\":\"tasks-4-4fe3lz\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"drop table if exists db_device_dw.clife_device_dws_run_data_tmp17\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp17_drop\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp16_create\"],\"id\":\"tasks-2-53v2g3\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"set mapred.reduce.tasks=6;\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"create table if not exists db_device_dw.clife_device_dws_run_data_tmp17 stored as parquet as\\nselect\\n     deviceid                   --'设备id'\\n    ,productid                  --'产品id'\\n    ,device_type_id             --'设备大类'\\n    ,device_subtype_id          --'设备小类'\\n    ,bind_user_id               -- '绑定用户'\\n    ,macaddress                 --'macaddress 地址'\\n    ,mactype                    --'macaddress 地址类型'\\n    ,on_cnt                     --'在线次数'\\n    ,off_cnt                    --'离线次数'\\n    ,sum_on_time                --'在线时长'\\n    ,sum_off_time               --'离线时长'\\n    ,cool_cnt                   --'制冷次数'\\n    ,dehumidification_cnt       --'除湿次数'\\n    ,blast_cnt                  --'送风次数'\\n    ,heating_cnt                --'制热次数'\\n    ,auto_cnt                   --'自动次数'\\n    ,sleep_cnt                  --'睡眠次数'\\n    ,sum_cool_time              --'制冷时长'\\n    ,sum_dehumidification_time  --'除湿时长'\\n    ,sum_blast_time             --'送风时长'\\n    ,sum_heating_time           --'制热时长'\\n    ,sum_auto_time              --'自动时长'\\n    ,sum_sleep_time             --'睡眠时长'\\n    ,very_low_wind_speed_cnt    --'极低风速次数'\\n    ,low_wind_speed_cnt         --'低风速次数'\\n    ,medium_wind_speed_cnt      --'中风速次数'\\n    ,hight_wind_speed_cnt       --'高风速次数'\\n    ,ultrahigh_wind_speed_cnt   --'超高风速次数'\\n    ,very_low_wind_speed_time   --'极低风速时长'\\n    ,low_wind_speed_time        --'低风速时长'\\n    ,medium_wind_speed_time     --'中风速时长'\\n    ,hight_wind_speed_time      --'高风速时长'\\n    ,ultrahigh_wind_speed_time  --'超高风速时长'\\n    ,cast(null as int ) as ChildLock_open_cnt         --'童锁开启次数'\\n    ,cast(null as int ) as ChildLock_close_cnt        --'童锁关闭次数'\\n    ,cast(null as bigint) as ChildLock_open_time        --'童锁开启时长'\\n    ,cast(null as bigint) as ChildLock_close_time       --'童锁关闭时长'\\n    ,cast(null as int) as Learning_win_cnt           --'学习成功次数'\\n    ,cast(null as int) as Learning_no_cnt            --'待学习次数'\\n    ,cast(null as int) as Learning_lose_cnt          --'学习失败次数'\\n    ,cast(null as bigint) as Learning_win_time          --'学习成功时长'\\n    ,cast(null as bigint) as Learning_no_time           --'待学习时长'\\n    ,cast(null as bigint) as Learning_lose_time         --'学习失败时长'\\n    ,'松下' as  datasource  --'数据来源\\nfrom\\n(\\n   select\\n        deviceid                                       --'设备id'\\n       ,max(productid)         as productid            --'产品id'\\n       ,max(device_type_id)    as device_type_id       --'设备大类'\\n       ,max(device_subtype_id) as device_subtype_id    --'设备小类'\\n       ,max(bind_user_id)      as bind_user_id         -- '绑定用户'\\n       ,max(macaddress)        as macaddress           -- 'macaddress 地址'\\n       ,max(mactype)           as mactype              -- 'macaddress 地址类型'\\n       ,sum(case when last_onoff=2 and onoffstatus=1 then 1 else 0 end) as on_cnt   --'在线次数'\\n       ,sum(case when last_onoff=1 and onoffstatus=2 then 1 else 0 end) as off_cnt  --'离线次数'\\n       ,sum(case when last_onoff = 2 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_on_time  --'在线时长'\\n       ,sum(case when last_onoff = 1 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_off_time --'离线时长'\\n       ,sum(case when workmode = 1 and last_workmode != 1 then 1 else 0 end) as cool_cnt              --制冷次数\\n       ,sum(case when workmode = 2 and last_workmode != 2 then 1 else 0 end) as dehumidification_cnt  --除湿次数\\n       ,sum(case when workmode = 3 and last_workmode != 3 then 1 else 0 end) as blast_cnt             --送风次数\\n       ,sum(case when workmode = 4 and last_workmode != 4 then 1 else 0 end) as heating_cnt           --制热次数\\n       ,sum(case when workmode = 5 and last_workmode != 5 then 1 else 0 end) as auto_cnt              --自动次数\\n       ,sum(case when workmode = 7 and last_workmode != 7 then 1 else 0 end) as sleep_cnt             --睡眠次数\\n       ,sum(case when workmode = 1 and last_workmode != 1 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_cool_time             --'制冷时长'\\n       ,sum(case when workmode = 2 and last_workmode != 2 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_dehumidification_time --'除湿时长'\\n       ,sum(case when workmode = 3 and last_workmode != 3 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_blast_time            --'送风时长'\\n       ,sum(case when workmode = 4 and last_workmode != 4 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_heating_time          --'制热时长'\\n       ,sum(case when workmode = 5 and last_workmode != 5 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_auto_time             --'自动时长'\\n       ,sum(case when workmode = 7 and last_workmode != 7 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_sleep_time            --'睡眠时长'\\n       ,sum(case when RealFanSpeed = 0 and last_realfanspeed != 0 then 1 else 0 end) as  very_low_wind_speed_cnt  --极低风速次数\\n       ,sum(case when RealFanSpeed = 1 and last_realfanspeed != 1 then 1 else 0 end) as  low_wind_speed_cnt       --低风速次数\\n       ,sum(case when RealFanSpeed = 2 and last_realfanspeed != 2 then 1 else 0 end) as  medium_wind_speed_cnt    --中风速次数\\n       ,sum(case when RealFanSpeed = 3 and last_realfanspeed != 3 then 1 else 0 end) as  hight_wind_speed_cnt     --高风速次数\\n       ,sum(case when RealFanSpeed = 4 and last_realfanspeed != 4 then 1 else 0 end) as  ultrahigh_wind_speed_cnt --超高风速次数\\n       ,sum(case when RealFanSpeed = 0 and last_realfanspeed != 0 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as very_low_wind_speed_time   --'极低风速时长'\\n       ,sum(case when RealFanSpeed = 1 and last_realfanspeed != 1 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as low_wind_speed_time        --'低风速时长'\\n       ,sum(case when RealFanSpeed = 2 and last_realfanspeed != 2 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as medium_wind_speed_time     --'中风速时长'\\n       ,sum(case when RealFanSpeed = 3 and last_realfanspeed != 3 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as hight_wind_speed_time      --'高风速时长'\\n       ,sum(case when RealFanSpeed = 4 and last_realfanspeed != 4 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as ultrahigh_wind_speed_time  --'超高风速时长'\\n   from db_device_dw.clife_device_dws_run_data_tmp16\\n   group by deviceid\\n)t\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp17_create\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp17_drop\"],\"id\":\"tasks-4-4evps\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"drop table if exists db_device_dw.clife_device_dws_run_data_tmp20\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp20_drop\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp19_create\"],\"id\":\"tasks-2-3jc1nm\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"create table if not exists db_device_dw.clife_device_dws_run_data_tmp20 stored as parquet as\\nselect \\n     deviceid            --'设备id'\\n    ,productid           --'产品id'\\n    ,device_type_id             -- '设备大类'\\n    ,device_subtype_id          -- '设备小类'\\n    ,bind_user_id               -- '绑定用户'\\n    ,macaddress                 -- 'macaddress 地址'\\n    ,mactype                    -- 'macaddress 地址类型'\\n    ,onoffstatus    --'在线离线'\\n    ,workmode       --'工作模式'\\n    ,realfanspeed   --'实际风速'\\n    ,lag(onoffstatus, 1, null) over (partition by deviceid order by fetchdatetime)  last_onoff  --'设备上一条开关机状态'\\n    ,lag(workmode, 1, null) over (partition by deviceid order by fetchdatetime)  last_workmode  --'设备上一条工作模式状态'\\n    ,lag(realfanspeed, 1, null) over (partition by deviceid order by fetchdatetime)  last_realfanspeed  --'设备上一条实际风速'\\n    ,datasource                 --  '数据来源' \\n    ,fetchDateTime              --  '采集时间'\\n    ,lag(fetchDateTime, 1, null) over (partition by deviceid order by fetchDateTime)  last_fetchDateTime  --'设备上一条采集时间' \\nfrom db_device_dw.clife_device_dwd_air_conditioning_run_data1\\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','') \\n  and datasource='海尔空调挂机'\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp20_create\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp20_drop\"],\"id\":\"tasks-4-1is6kd\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"drop table if exists db_device_dw.clife_device_dws_run_data_tmp21\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp21_drop\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp20_create\"],\"id\":\"tasks-2-s15dz\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"set mapred.reduce.tasks=6;\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"create table if not exists db_device_dw.clife_device_dws_run_data_tmp21 stored as parquet as\\nselect\\n     deviceid                   --'设备id'\\n    ,productid                  --'产品id'\\n    ,device_type_id             --'设备大类'\\n    ,device_subtype_id          --'设备小类'\\n    ,bind_user_id               -- '绑定用户'\\n    ,macaddress                 --'macaddress 地址'\\n    ,mactype                    --'macaddress 地址类型'\\n    ,on_cnt                     --'在线次数'\\n    ,off_cnt                    --'离线次数'\\n    ,sum_on_time                --'在线时长'\\n    ,sum_off_time               --'离线时长'\\n    ,cool_cnt                   --'制冷次数'\\n    ,dehumidification_cnt       --'除湿次数'\\n    ,blast_cnt                  --'送风次数'\\n    ,heating_cnt                --'制热次数'\\n    ,auto_cnt                   --'自动次数'\\n    ,sleep_cnt                  --'睡眠次数'\\n    ,sum_cool_time              --'制冷时长'\\n    ,sum_dehumidification_time  --'除湿时长'\\n    ,sum_blast_time             --'送风时长'\\n    ,sum_heating_time           --'制热时长'\\n    ,sum_auto_time              --'自动时长'\\n    ,sum_sleep_time             --'睡眠时长'\\n    ,very_low_wind_speed_cnt    --'极低风速次数'\\n    ,low_wind_speed_cnt         --'低风速次数'\\n    ,medium_wind_speed_cnt      --'中风速次数'\\n    ,hight_wind_speed_cnt       --'高风速次数'\\n    ,ultrahigh_wind_speed_cnt   --'超高风速次数'\\n    ,very_low_wind_speed_time   --'极低风速时长'\\n    ,low_wind_speed_time        --'低风速时长'\\n    ,medium_wind_speed_time     --'中风速时长'\\n    ,hight_wind_speed_time      --'高风速时长'\\n    ,ultrahigh_wind_speed_time  --'超高风速时长'\\n    ,cast(null as int ) as ChildLock_open_cnt         --'童锁开启次数'\\n    ,cast(null as int ) as ChildLock_close_cnt        --'童锁关闭次数'\\n    ,cast(null as bigint) as ChildLock_open_time        --'童锁开启时长'\\n    ,cast(null as bigint) as ChildLock_close_time       --'童锁关闭时长'\\n    ,cast(null as int) as Learning_win_cnt           --'学习成功次数'\\n    ,cast(null as int) as Learning_no_cnt            --'待学习次数'\\n    ,cast(null as int) as Learning_lose_cnt          --'学习失败次数'\\n    ,cast(null as bigint) as Learning_win_time          --'学习成功时长'\\n    ,cast(null as bigint) as Learning_no_time           --'待学习时长'\\n    ,cast(null as bigint) as Learning_lose_time         --'学习失败时长'\\n    ,'海尔空调挂机' as  datasource  --'数据来源\\nfrom\\n(\\n   select\\n        deviceid                                       --'设备id'\\n       ,max(productid)         as productid            --'产品id'\\n       ,max(device_type_id)    as device_type_id       --'设备大类'\\n       ,max(device_subtype_id) as device_subtype_id    --'设备小类'\\n       ,max(bind_user_id)      as bind_user_id         -- '绑定用户'\\n       ,max(macaddress)        as macaddress           -- 'macaddress 地址'\\n       ,max(mactype)           as mactype              -- 'macaddress 地址类型'\\n       ,sum(case when last_onoff=2 and onoffstatus=1 then 1 else 0 end) as on_cnt   --'在线次数'\\n       ,sum(case when last_onoff=1 and onoffstatus=2 then 1 else 0 end) as off_cnt  --'离线次数'\\n       ,sum(case when last_onoff = 2 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_on_time  --'在线时长'\\n       ,sum(case when last_onoff = 1 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_off_time --'离线时长'\\n       ,sum(case when workmode = 1 and last_workmode != 1 then 1 else 0 end) as cool_cnt              --制冷次数\\n       ,sum(case when workmode = 2 and last_workmode != 2 then 1 else 0 end) as dehumidification_cnt  --除湿次数\\n       ,sum(case when workmode = 3 and last_workmode != 3 then 1 else 0 end) as blast_cnt             --送风次数\\n       ,sum(case when workmode = 4 and last_workmode != 4 then 1 else 0 end) as heating_cnt           --制热次数\\n       ,sum(case when workmode = 5 and last_workmode != 5 then 1 else 0 end) as auto_cnt              --自动次数\\n       ,sum(case when workmode = 7 and last_workmode != 7 then 1 else 0 end) as sleep_cnt             --睡眠次数\\n       ,sum(case when workmode = 1 and last_workmode != 1 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_cool_time             --'制冷时长'\\n       ,sum(case when workmode = 2 and last_workmode != 2 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_dehumidification_time --'除湿时长'\\n       ,sum(case when workmode = 3 and last_workmode != 3 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_blast_time            --'送风时长'\\n       ,sum(case when workmode = 4 and last_workmode != 4 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_heating_time          --'制热时长'\\n       ,sum(case when workmode = 5 and last_workmode != 5 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_auto_time             --'自动时长'\\n       ,sum(case when workmode = 7 and last_workmode != 7 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_sleep_time            --'睡眠时长'\\n       ,sum(case when RealFanSpeed = 0 and last_realfanspeed != 0 then 1 else 0 end) as  very_low_wind_speed_cnt  --极低风速次数\\n       ,sum(case when RealFanSpeed = 1 and last_realfanspeed != 1 then 1 else 0 end) as  low_wind_speed_cnt       --低风速次数\\n       ,sum(case when RealFanSpeed = 2 and last_realfanspeed != 2 then 1 else 0 end) as  medium_wind_speed_cnt    --中风速次数\\n       ,sum(case when RealFanSpeed = 3 and last_realfanspeed != 3 then 1 else 0 end) as  hight_wind_speed_cnt     --高风速次数\\n       ,sum(case when RealFanSpeed = 4 and last_realfanspeed != 4 then 1 else 0 end) as  ultrahigh_wind_speed_cnt --超高风速次数\\n       ,sum(case when RealFanSpeed = 0 and last_realfanspeed != 0 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as very_low_wind_speed_time   --'极低风速时长'\\n       ,sum(case when RealFanSpeed = 1 and last_realfanspeed != 1 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as low_wind_speed_time        --'低风速时长'\\n       ,sum(case when RealFanSpeed = 2 and last_realfanspeed != 2 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as medium_wind_speed_time     --'中风速时长'\\n       ,sum(case when RealFanSpeed = 3 and last_realfanspeed != 3 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as hight_wind_speed_time      --'高风速时长'\\n       ,sum(case when RealFanSpeed = 4 and last_realfanspeed != 4 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as ultrahigh_wind_speed_time  --'超高风速时长'\\n   from db_device_dw.clife_device_dws_run_data_tmp20\\n   group by deviceid\\n)t\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp21_create\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp21_drop\"],\"id\":\"tasks-4-6ie6kg\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"drop table if exists db_device_dw.clife_device_dws_run_data_tmp18\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp18_drop\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp17_create\"],\"id\":\"tasks-2-eg1o\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"create table if not exists db_device_dw.clife_device_dws_run_data_tmp18 stored as parquet as\\nselect \\n     deviceid            --'设备id'\\n    ,productid           --'产品id'\\n    ,device_type_id             -- '设备大类'\\n    ,device_subtype_id          -- '设备小类'\\n    ,bind_user_id               -- '绑定用户'\\n    ,macaddress                 -- 'macaddress 地址'\\n    ,mactype                    -- 'macaddress 地址类型'\\n    ,onoffstatus    --'在线离线'\\n    ,workmode       --'工作模式'\\n    ,realfanspeed   --'实际风速'\\n    ,lag(onoffstatus, 1, null) over (partition by deviceid order by fetchdatetime)  last_onoff  --'设备上一条开关机状态'\\n    ,lag(workmode, 1, null) over (partition by deviceid order by fetchdatetime)  last_workmode  --'设备上一条工作模式状态'\\n    ,lag(realfanspeed, 1, null) over (partition by deviceid order by fetchdatetime)  last_realfanspeed  --'设备上一条实际风速'\\n    ,datasource                 --  '数据来源' \\n    ,fetchDateTime              --  '采集时间'\\n    ,lag(fetchDateTime, 1, null) over (partition by deviceid order by fetchDateTime)  last_fetchDateTime  --'设备上一条采集时间' \\nfrom db_device_dw.clife_device_dwd_air_conditioning_run_data1\\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','') \\n  and datasource='空调'\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp18_create\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp18_drop\"],\"id\":\"tasks-4-xtno\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"drop table if exists db_device_dw.clife_device_dws_run_data_tmp19\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp19_drop\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp18_create\"],\"id\":\"tasks-2-5kp13i\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"set mapred.reduce.tasks=6;\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"create table if not exists db_device_dw.clife_device_dws_run_data_tmp19 stored as parquet as\\nselect\\n     deviceid                   --'设备id'\\n    ,productid                  --'产品id'\\n    ,device_type_id             --'设备大类'\\n    ,device_subtype_id          --'设备小类'\\n    ,bind_user_id               -- '绑定用户'\\n    ,macaddress                 --'macaddress 地址'\\n    ,mactype                    --'macaddress 地址类型'\\n    ,on_cnt                     --'在线次数'\\n    ,off_cnt                    --'离线次数'\\n    ,sum_on_time                --'在线时长'\\n    ,sum_off_time               --'离线时长'\\n    ,cool_cnt                   --'制冷次数'\\n    ,dehumidification_cnt       --'除湿次数'\\n    ,blast_cnt                  --'送风次数'\\n    ,heating_cnt                --'制热次数'\\n    ,auto_cnt                   --'自动次数'\\n    ,sleep_cnt                  --'睡眠次数'\\n    ,sum_cool_time              --'制冷时长'\\n    ,sum_dehumidification_time  --'除湿时长'\\n    ,sum_blast_time             --'送风时长'\\n    ,sum_heating_time           --'制热时长'\\n    ,sum_auto_time              --'自动时长'\\n    ,sum_sleep_time             --'睡眠时长'\\n    ,very_low_wind_speed_cnt    --'极低风速次数'\\n    ,low_wind_speed_cnt         --'低风速次数'\\n    ,medium_wind_speed_cnt      --'中风速次数'\\n    ,hight_wind_speed_cnt       --'高风速次数'\\n    ,ultrahigh_wind_speed_cnt   --'超高风速次数'\\n    ,very_low_wind_speed_time   --'极低风速时长'\\n    ,low_wind_speed_time        --'低风速时长'\\n    ,medium_wind_speed_time     --'中风速时长'\\n    ,hight_wind_speed_time      --'高风速时长'\\n    ,ultrahigh_wind_speed_time  --'超高风速时长'\\n    ,cast(null as int ) as ChildLock_open_cnt         --'童锁开启次数'\\n    ,cast(null as int ) as ChildLock_close_cnt        --'童锁关闭次数'\\n    ,cast(null as bigint) as ChildLock_open_time        --'童锁开启时长'\\n    ,cast(null as bigint) as ChildLock_close_time       --'童锁关闭时长'\\n    ,cast(null as int) as Learning_win_cnt           --'学习成功次数'\\n    ,cast(null as int) as Learning_no_cnt            --'待学习次数'\\n    ,cast(null as int) as Learning_lose_cnt          --'学习失败次数'\\n    ,cast(null as bigint) as Learning_win_time          --'学习成功时长'\\n    ,cast(null as bigint) as Learning_no_time           --'待学习时长'\\n    ,cast(null as bigint) as Learning_lose_time         --'学习失败时长'\\n    ,'空调' as  datasource  --'数据来源\\nfrom\\n(\\n   select\\n        deviceid                                       --'设备id'\\n       ,max(productid)         as productid            --'产品id'\\n       ,max(device_type_id)    as device_type_id       --'设备大类'\\n       ,max(device_subtype_id) as device_subtype_id    --'设备小类'\\n       ,max(bind_user_id)      as bind_user_id         -- '绑定用户'\\n       ,max(macaddress)        as macaddress           -- 'macaddress 地址'\\n       ,max(mactype)           as mactype              -- 'macaddress 地址类型'\\n       ,sum(case when last_onoff=2 and onoffstatus=1 then 1 else 0 end) as on_cnt   --'在线次数'\\n       ,sum(case when last_onoff=1 and onoffstatus=2 then 1 else 0 end) as off_cnt  --'离线次数'\\n       ,sum(case when last_onoff = 2 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_on_time  --'在线时长'\\n       ,sum(case when last_onoff = 1 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_off_time --'离线时长'\\n       ,sum(case when workmode = 1 and last_workmode != 1 then 1 else 0 end) as cool_cnt              --制冷次数\\n       ,sum(case when workmode = 2 and last_workmode != 2 then 1 else 0 end) as dehumidification_cnt  --除湿次数\\n       ,sum(case when workmode = 3 and last_workmode != 3 then 1 else 0 end) as blast_cnt             --送风次数\\n       ,sum(case when workmode = 4 and last_workmode != 4 then 1 else 0 end) as heating_cnt           --制热次数\\n       ,sum(case when workmode = 5 and last_workmode != 5 then 1 else 0 end) as auto_cnt              --自动次数\\n       ,sum(case when workmode = 7 and last_workmode != 7 then 1 else 0 end) as sleep_cnt             --睡眠次数\\n       ,sum(case when workmode = 1 and last_workmode != 1 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_cool_time             --'制冷时长'\\n       ,sum(case when workmode = 2 and last_workmode != 2 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_dehumidification_time --'除湿时长'\\n       ,sum(case when workmode = 3 and last_workmode != 3 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_blast_time            --'送风时长'\\n       ,sum(case when workmode = 4 and last_workmode != 4 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_heating_time          --'制热时长'\\n       ,sum(case when workmode = 5 and last_workmode != 5 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_auto_time             --'自动时长'\\n       ,sum(case when workmode = 7 and last_workmode != 7 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_sleep_time            --'睡眠时长'\\n       ,sum(case when RealFanSpeed = 0 and last_realfanspeed != 0 then 1 else 0 end) as  very_low_wind_speed_cnt  --极低风速次数\\n       ,sum(case when RealFanSpeed = 1 and last_realfanspeed != 1 then 1 else 0 end) as  low_wind_speed_cnt       --低风速次数\\n       ,sum(case when RealFanSpeed = 2 and last_realfanspeed != 2 then 1 else 0 end) as  medium_wind_speed_cnt    --中风速次数\\n       ,sum(case when RealFanSpeed = 3 and last_realfanspeed != 3 then 1 else 0 end) as  hight_wind_speed_cnt     --高风速次数\\n       ,sum(case when RealFanSpeed = 4 and last_realfanspeed != 4 then 1 else 0 end) as  ultrahigh_wind_speed_cnt --超高风速次数\\n       ,sum(case when RealFanSpeed = 0 and last_realfanspeed != 0 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as very_low_wind_speed_time   --'极低风速时长'\\n       ,sum(case when RealFanSpeed = 1 and last_realfanspeed != 1 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as low_wind_speed_time        --'低风速时长'\\n       ,sum(case when RealFanSpeed = 2 and last_realfanspeed != 2 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as medium_wind_speed_time     --'中风速时长'\\n       ,sum(case when RealFanSpeed = 3 and last_realfanspeed != 3 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as hight_wind_speed_time      --'高风速时长'\\n       ,sum(case when RealFanSpeed = 4 and last_realfanspeed != 4 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as ultrahigh_wind_speed_time  --'超高风速时长'\\n   from db_device_dw.clife_device_dws_run_data_tmp18\\n   group by deviceid\\n)t\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp19_create\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp19_drop\"],\"id\":\"tasks-4-6zy1g5\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"drop table if exists db_device_dw.clife_device_dws_run_data_tmp22\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp22_drop\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp21_create\"],\"id\":\"tasks-2-4e6d3\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"create table if not exists db_device_dw.clife_device_dws_run_data_tmp22 stored as parquet as\\nselect \\n     deviceid            --'设备id'\\n    ,productid           --'产品id'\\n    ,device_type_id             -- '设备大类'\\n    ,device_subtype_id          -- '设备小类'\\n    ,bind_user_id               -- '绑定用户'\\n    ,macaddress                 -- 'macaddress 地址'\\n    ,mactype                    -- 'macaddress 地址类型'\\n    ,onoffstatus    --'在线离线'\\n    ,workmode       --'工作模式'\\n    ,realfanspeed   --'实际风速'\\n    ,lag(onoffstatus, 1, null) over (partition by deviceid order by fetchdatetime)  last_onoff  --'设备上一条开关机状态'\\n    ,lag(workmode, 1, null) over (partition by deviceid order by fetchdatetime)  last_workmode  --'设备上一条工作模式状态'\\n    ,lag(realfanspeed, 1, null) over (partition by deviceid order by fetchdatetime)  last_realfanspeed  --'设备上一条实际风速'\\n    ,datasource                 --  '数据来源' \\n    ,fetchDateTime              --  '采集时间'\\n    ,lag(fetchDateTime, 1, null) over (partition by deviceid order by fetchDateTime)  last_fetchDateTime  --'设备上一条采集时间' \\nfrom db_device_dw.clife_device_dwd_air_conditioning_run_data1\\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','') \\n  and datasource='海信壁挂空调'\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp22_create\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp22_drop\"],\"id\":\"tasks-4-1gu40p\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"drop table if exists db_device_dw.clife_device_dws_run_data_tmp23\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp23_drop\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp22_create\"],\"id\":\"tasks-2-1n014g\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"set mapred.reduce.tasks=6;\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"create table if not exists db_device_dw.clife_device_dws_run_data_tmp23 stored as parquet as\\nselect\\n     deviceid                   --'设备id'\\n    ,productid                  --'产品id'\\n    ,device_type_id             --'设备大类'\\n    ,device_subtype_id          --'设备小类'\\n    ,bind_user_id               -- '绑定用户'\\n    ,macaddress                 --'macaddress 地址'\\n    ,mactype                    --'macaddress 地址类型'\\n    ,on_cnt                     --'在线次数'\\n    ,off_cnt                    --'离线次数'\\n    ,sum_on_time                --'在线时长'\\n    ,sum_off_time               --'离线时长'\\n    ,cool_cnt                   --'制冷次数'\\n    ,dehumidification_cnt       --'除湿次数'\\n    ,blast_cnt                  --'送风次数'\\n    ,heating_cnt                --'制热次数'\\n    ,auto_cnt                   --'自动次数'\\n    ,sleep_cnt                  --'睡眠次数'\\n    ,sum_cool_time              --'制冷时长'\\n    ,sum_dehumidification_time  --'除湿时长'\\n    ,sum_blast_time             --'送风时长'\\n    ,sum_heating_time           --'制热时长'\\n    ,sum_auto_time              --'自动时长'\\n    ,sum_sleep_time             --'睡眠时长'\\n    ,very_low_wind_speed_cnt    --'极低风速次数'\\n    ,low_wind_speed_cnt         --'低风速次数'\\n    ,medium_wind_speed_cnt      --'中风速次数'\\n    ,hight_wind_speed_cnt       --'高风速次数'\\n    ,ultrahigh_wind_speed_cnt   --'超高风速次数'\\n    ,very_low_wind_speed_time   --'极低风速时长'\\n    ,low_wind_speed_time        --'低风速时长'\\n    ,medium_wind_speed_time     --'中风速时长'\\n    ,hight_wind_speed_time      --'高风速时长'\\n    ,ultrahigh_wind_speed_time  --'超高风速时长'\\n    ,cast(null as int ) as ChildLock_open_cnt         --'童锁开启次数'\\n    ,cast(null as int ) as ChildLock_close_cnt        --'童锁关闭次数'\\n    ,cast(null as bigint) as ChildLock_open_time        --'童锁开启时长'\\n    ,cast(null as bigint) as ChildLock_close_time       --'童锁关闭时长'\\n    ,cast(null as int) as Learning_win_cnt           --'学习成功次数'\\n    ,cast(null as int) as Learning_no_cnt            --'待学习次数'\\n    ,cast(null as int) as Learning_lose_cnt          --'学习失败次数'\\n    ,cast(null as bigint) as Learning_win_time          --'学习成功时长'\\n    ,cast(null as bigint) as Learning_no_time           --'待学习时长'\\n    ,cast(null as bigint) as Learning_lose_time         --'学习失败时长'\\n    ,'海信壁挂空调' as  datasource  --'数据来源\\nfrom\\n(\\n   select\\n        deviceid                                       --'设备id'\\n       ,max(productid)         as productid            --'产品id'\\n       ,max(device_type_id)    as device_type_id       --'设备大类'\\n       ,max(device_subtype_id) as device_subtype_id    --'设备小类'\\n       ,max(bind_user_id)      as bind_user_id         -- '绑定用户'\\n       ,max(macaddress)        as macaddress           -- 'macaddress 地址'\\n       ,max(mactype)           as mactype              -- 'macaddress 地址类型'\\n       ,sum(case when last_onoff=2 and onoffstatus=1 then 1 else 0 end) as on_cnt   --'在线次数'\\n       ,sum(case when last_onoff=1 and onoffstatus=2 then 1 else 0 end) as off_cnt  --'离线次数'\\n       ,sum(case when last_onoff = 2 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_on_time  --'在线时长'\\n       ,sum(case when last_onoff = 1 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_off_time --'离线时长'\\n       ,sum(case when workmode = 1 and last_workmode != 1 then 1 else 0 end) as cool_cnt              --制冷次数\\n       ,sum(case when workmode = 2 and last_workmode != 2 then 1 else 0 end) as dehumidification_cnt  --除湿次数\\n       ,sum(case when workmode = 3 and last_workmode != 3 then 1 else 0 end) as blast_cnt             --送风次数\\n       ,sum(case when workmode = 4 and last_workmode != 4 then 1 else 0 end) as heating_cnt           --制热次数\\n       ,sum(case when workmode = 5 and last_workmode != 5 then 1 else 0 end) as auto_cnt              --自动次数\\n       ,sum(case when workmode = 7 and last_workmode != 7 then 1 else 0 end) as sleep_cnt             --睡眠次数\\n       ,sum(case when workmode = 1 and last_workmode != 1 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_cool_time             --'制冷时长'\\n       ,sum(case when workmode = 2 and last_workmode != 2 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_dehumidification_time --'除湿时长'\\n       ,sum(case when workmode = 3 and last_workmode != 3 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_blast_time            --'送风时长'\\n       ,sum(case when workmode = 4 and last_workmode != 4 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_heating_time          --'制热时长'\\n       ,sum(case when workmode = 5 and last_workmode != 5 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_auto_time             --'自动时长'\\n       ,sum(case when workmode = 7 and last_workmode != 7 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as sum_sleep_time            --'睡眠时长'\\n       ,sum(case when RealFanSpeed = 0 and last_realfanspeed != 0 then 1 else 0 end) as  very_low_wind_speed_cnt  --极低风速次数\\n       ,sum(case when RealFanSpeed = 1 and last_realfanspeed != 1 then 1 else 0 end) as  low_wind_speed_cnt       --低风速次数\\n       ,sum(case when RealFanSpeed = 2 and last_realfanspeed != 2 then 1 else 0 end) as  medium_wind_speed_cnt    --中风速次数\\n       ,sum(case when RealFanSpeed = 3 and last_realfanspeed != 3 then 1 else 0 end) as  hight_wind_speed_cnt     --高风速次数\\n       ,sum(case when RealFanSpeed = 4 and last_realfanspeed != 4 then 1 else 0 end) as  ultrahigh_wind_speed_cnt --超高风速次数\\n       ,sum(case when RealFanSpeed = 0 and last_realfanspeed != 0 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as very_low_wind_speed_time   --'极低风速时长'\\n       ,sum(case when RealFanSpeed = 1 and last_realfanspeed != 1 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as low_wind_speed_time        --'低风速时长'\\n       ,sum(case when RealFanSpeed = 2 and last_realfanspeed != 2 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as medium_wind_speed_time     --'中风速时长'\\n       ,sum(case when RealFanSpeed = 3 and last_realfanspeed != 3 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as hight_wind_speed_time      --'高风速时长'\\n       ,sum(case when RealFanSpeed = 4 and last_realfanspeed != 4 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end) as ultrahigh_wind_speed_time  --'超高风速时长'\\n   from db_device_dw.clife_device_dws_run_data_tmp22\\n   group by deviceid\\n)t\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp23_create\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp23_drop\"],\"id\":\"tasks-4-77j4tr\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"insert overwrite table db_device_dw.clife_device_dws_air_conditioning_run_data partition(part_date)\\nselect\\n     deviceid                   --'设备id'\\n    ,productid                  --'产品id'\\n    ,device_type_id             --'设备大类'\\n    ,device_subtype_id          --'设备小类'\\n    ,bind_user_id               -- '绑定用户'\\n    ,macaddress                 --'macaddress 地址'\\n    ,mactype                    --'macaddress 地址类型'\\n    ,on_cnt                     --'在线次数'\\n    ,off_cnt                    --'离线次数'\\n    ,sum_on_time                --'在线时长'\\n    ,sum_off_time               --'离线时长'\\n    ,cool_cnt                   --'制冷次数'\\n    ,dehumidification_cnt       --'除湿次数'\\n    ,blast_cnt                  --'送风次数'\\n    ,heating_cnt                --'制热次数'\\n    ,auto_cnt                   --'自动次数'\\n    ,sleep_cnt                  --'睡眠次数'\\n    ,sum_cool_time              --'制冷时长'\\n    ,sum_dehumidification_time  --'除湿时长'\\n    ,sum_blast_time             --'送风时长'\\n    ,sum_heating_time           --'制热时长'\\n    ,sum_auto_time              --'自动时长'\\n    ,sum_sleep_time             --'睡眠时长'\\n    ,very_low_wind_speed_cnt    --'极低风速次数'\\n    ,low_wind_speed_cnt         --'低风速次数'\\n    ,medium_wind_speed_cnt      --'中风速次数'\\n    ,hight_wind_speed_cnt       --'高风速次数'\\n    ,ultrahigh_wind_speed_cnt   --'超高风速次数'\\n    ,very_low_wind_speed_time   --'极低风速时长'\\n    ,low_wind_speed_time        --'低风速时长'\\n    ,medium_wind_speed_time     --'中风速时长'\\n    ,hight_wind_speed_time      --'高风速时长'\\n    ,ultrahigh_wind_speed_time  --'超高风速时长'\\n    ,ChildLock_open_cnt         --'童锁开启次数'\\n    ,ChildLock_close_cnt        --'童锁关闭次数'\\n    ,ChildLock_open_time        --'童锁开启时长'\\n    ,ChildLock_close_time       --'童锁关闭时长'\\n    ,Learning_win_cnt           --'学习成功次数'\\n    ,Learning_no_cnt            --'待学习次数'\\n    ,Learning_lose_cnt          --'学习失败次数'\\n    ,Learning_win_time          --'学习成功时长'\\n    ,Learning_no_time           --'待学习时长'\\n    ,Learning_lose_time         --'学习失败时长'\\n    ,datasource  --'数据来源\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_device_dw.clife_device_dws_run_data_tmp15\\nunion all\\nselect\\n     deviceid                   --'设备id'\\n    ,productid                  --'产品id'\\n    ,device_type_id             --'设备大类'\\n    ,device_subtype_id          --'设备小类'\\n    ,bind_user_id               -- '绑定用户'\\n    ,macaddress                 --'macaddress 地址'\\n    ,mactype                    --'macaddress 地址类型'\\n    ,on_cnt                     --'在线次数'\\n    ,off_cnt                    --'离线次数'\\n    ,sum_on_time                --'在线时长'\\n    ,sum_off_time               --'离线时长'\\n    ,cool_cnt                   --'制冷次数'\\n    ,dehumidification_cnt       --'除湿次数'\\n    ,blast_cnt                  --'送风次数'\\n    ,heating_cnt                --'制热次数'\\n    ,auto_cnt                   --'自动次数'\\n    ,sleep_cnt                  --'睡眠次数'\\n    ,sum_cool_time              --'制冷时长'\\n    ,sum_dehumidification_time  --'除湿时长'\\n    ,sum_blast_time             --'送风时长'\\n    ,sum_heating_time           --'制热时长'\\n    ,sum_auto_time              --'自动时长'\\n    ,sum_sleep_time             --'睡眠时长'\\n    ,very_low_wind_speed_cnt    --'极低风速次数'\\n    ,low_wind_speed_cnt         --'低风速次数'\\n    ,medium_wind_speed_cnt      --'中风速次数'\\n    ,hight_wind_speed_cnt       --'高风速次数'\\n    ,ultrahigh_wind_speed_cnt   --'超高风速次数'\\n    ,very_low_wind_speed_time   --'极低风速时长'\\n    ,low_wind_speed_time        --'低风速时长'\\n    ,medium_wind_speed_time     --'中风速时长'\\n    ,hight_wind_speed_time      --'高风速时长'\\n    ,ultrahigh_wind_speed_time  --'超高风速时长'\\n    ,ChildLock_open_cnt         --'童锁开启次数'\\n    ,ChildLock_close_cnt        --'童锁关闭次数'\\n    ,ChildLock_open_time        --'童锁开启时长'\\n    ,ChildLock_close_time       --'童锁关闭时长'\\n    ,Learning_win_cnt           --'学习成功次数'\\n    ,Learning_no_cnt            --'待学习次数'\\n    ,Learning_lose_cnt          --'学习失败次数'\\n    ,Learning_win_time          --'学习成功时长'\\n    ,Learning_no_time           --'待学习时长'\\n    ,Learning_lose_time         --'学习失败时长'\\n    ,datasource  --'数据来源\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_device_dw.clife_device_dws_run_data_tmp17\\nunion all\\nselect\\n     deviceid                   --'设备id'\\n    ,productid                  --'产品id'\\n    ,device_type_id             --'设备大类'\\n    ,device_subtype_id          --'设备小类'\\n    ,bind_user_id               -- '绑定用户'\\n    ,macaddress                 --'macaddress 地址'\\n    ,mactype                    --'macaddress 地址类型'\\n    ,on_cnt                     --'在线次数'\\n    ,off_cnt                    --'离线次数'\\n    ,sum_on_time                --'在线时长'\\n    ,sum_off_time               --'离线时长'\\n    ,cool_cnt                   --'制冷次数'\\n    ,dehumidification_cnt       --'除湿次数'\\n    ,blast_cnt                  --'送风次数'\\n    ,heating_cnt                --'制热次数'\\n    ,auto_cnt                   --'自动次数'\\n    ,sleep_cnt                  --'睡眠次数'\\n    ,sum_cool_time              --'制冷时长'\\n    ,sum_dehumidification_time  --'除湿时长'\\n    ,sum_blast_time             --'送风时长'\\n    ,sum_heating_time           --'制热时长'\\n    ,sum_auto_time              --'自动时长'\\n    ,sum_sleep_time             --'睡眠时长'\\n    ,very_low_wind_speed_cnt    --'极低风速次数'\\n    ,low_wind_speed_cnt         --'低风速次数'\\n    ,medium_wind_speed_cnt      --'中风速次数'\\n    ,hight_wind_speed_cnt       --'高风速次数'\\n    ,ultrahigh_wind_speed_cnt   --'超高风速次数'\\n    ,very_low_wind_speed_time   --'极低风速时长'\\n    ,low_wind_speed_time        --'低风速时长'\\n    ,medium_wind_speed_time     --'中风速时长'\\n    ,hight_wind_speed_time      --'高风速时长'\\n    ,ultrahigh_wind_speed_time  --'超高风速时长'\\n    ,ChildLock_open_cnt         --'童锁开启次数'\\n    ,ChildLock_close_cnt        --'童锁关闭次数'\\n    ,ChildLock_open_time        --'童锁开启时长'\\n    ,ChildLock_close_time       --'童锁关闭时长'\\n    ,Learning_win_cnt           --'学习成功次数'\\n    ,Learning_no_cnt            --'待学习次数'\\n    ,Learning_lose_cnt          --'学习失败次数'\\n    ,Learning_win_time          --'学习成功时长'\\n    ,Learning_no_time           --'待学习时长'\\n    ,Learning_lose_time         --'学习失败时长'\\n    ,datasource  --'数据来源\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_device_dw.clife_device_dws_run_data_tmp19\\nunion all\\nselect\\n     deviceid                   --'设备id'\\n    ,productid                  --'产品id'\\n    ,device_type_id             --'设备大类'\\n    ,device_subtype_id          --'设备小类'\\n    ,bind_user_id               -- '绑定用户'\\n    ,macaddress                 --'macaddress 地址'\\n    ,mactype                    --'macaddress 地址类型'\\n    ,on_cnt                     --'在线次数'\\n    ,off_cnt                    --'离线次数'\\n    ,sum_on_time                --'在线时长'\\n    ,sum_off_time               --'离线时长'\\n    ,cool_cnt                   --'制冷次数'\\n    ,dehumidification_cnt       --'除湿次数'\\n    ,blast_cnt                  --'送风次数'\\n    ,heating_cnt                --'制热次数'\\n    ,auto_cnt                   --'自动次数'\\n    ,sleep_cnt                  --'睡眠次数'\\n    ,sum_cool_time              --'制冷时长'\\n    ,sum_dehumidification_time  --'除湿时长'\\n    ,sum_blast_time             --'送风时长'\\n    ,sum_heating_time           --'制热时长'\\n    ,sum_auto_time              --'自动时长'\\n    ,sum_sleep_time             --'睡眠时长'\\n    ,very_low_wind_speed_cnt    --'极低风速次数'\\n    ,low_wind_speed_cnt         --'低风速次数'\\n    ,medium_wind_speed_cnt      --'中风速次数'\\n    ,hight_wind_speed_cnt       --'高风速次数'\\n    ,ultrahigh_wind_speed_cnt   --'超高风速次数'\\n    ,very_low_wind_speed_time   --'极低风速时长'\\n    ,low_wind_speed_time        --'低风速时长'\\n    ,medium_wind_speed_time     --'中风速时长'\\n    ,hight_wind_speed_time      --'高风速时长'\\n    ,ultrahigh_wind_speed_time  --'超高风速时长'\\n    ,ChildLock_open_cnt         --'童锁开启次数'\\n    ,ChildLock_close_cnt        --'童锁关闭次数'\\n    ,ChildLock_open_time        --'童锁开启时长'\\n    ,ChildLock_close_time       --'童锁关闭时长'\\n    ,Learning_win_cnt           --'学习成功次数'\\n    ,Learning_no_cnt            --'待学习次数'\\n    ,Learning_lose_cnt          --'学习失败次数'\\n    ,Learning_win_time          --'学习成功时长'\\n    ,Learning_no_time           --'待学习时长'\\n    ,Learning_lose_time         --'学习失败时长'\\n    ,datasource  --'数据来源\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_device_dw.clife_device_dws_run_data_tmp21\\nunion all\\nselect\\n     deviceid                   --'设备id'\\n    ,productid                  --'产品id'\\n    ,device_type_id             --'设备大类'\\n    ,device_subtype_id          --'设备小类'\\n    ,bind_user_id               -- '绑定用户'\\n    ,macaddress                 --'macaddress 地址'\\n    ,mactype                    --'macaddress 地址类型'\\n    ,on_cnt                     --'在线次数'\\n    ,off_cnt                    --'离线次数'\\n    ,sum_on_time                --'在线时长'\\n    ,sum_off_time               --'离线时长'\\n    ,cool_cnt                   --'制冷次数'\\n    ,dehumidification_cnt       --'除湿次数'\\n    ,blast_cnt                  --'送风次数'\\n    ,heating_cnt                --'制热次数'\\n    ,auto_cnt                   --'自动次数'\\n    ,sleep_cnt                  --'睡眠次数'\\n    ,sum_cool_time              --'制冷时长'\\n    ,sum_dehumidification_time  --'除湿时长'\\n    ,sum_blast_time             --'送风时长'\\n    ,sum_heating_time           --'制热时长'\\n    ,sum_auto_time              --'自动时长'\\n    ,sum_sleep_time             --'睡眠时长'\\n    ,very_low_wind_speed_cnt    --'极低风速次数'\\n    ,low_wind_speed_cnt         --'低风速次数'\\n    ,medium_wind_speed_cnt      --'中风速次数'\\n    ,hight_wind_speed_cnt       --'高风速次数'\\n    ,ultrahigh_wind_speed_cnt   --'超高风速次数'\\n    ,very_low_wind_speed_time   --'极低风速时长'\\n    ,low_wind_speed_time        --'低风速时长'\\n    ,medium_wind_speed_time     --'中风速时长'\\n    ,hight_wind_speed_time      --'高风速时长'\\n    ,ultrahigh_wind_speed_time  --'超高风速时长'\\n    ,ChildLock_open_cnt         --'童锁开启次数'\\n    ,ChildLock_close_cnt        --'童锁关闭次数'\\n    ,ChildLock_open_time        --'童锁开启时长'\\n    ,ChildLock_close_time       --'童锁关闭时长'\\n    ,Learning_win_cnt           --'学习成功次数'\\n    ,Learning_no_cnt            --'待学习次数'\\n    ,Learning_lose_cnt          --'学习失败次数'\\n    ,Learning_win_time          --'学习成功时长'\\n    ,Learning_no_time           --'待学习时长'\\n    ,Learning_lose_time         --'学习失败时长'\\n    ,datasource  --'数据来源\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_device_dw.clife_device_dws_run_data_tmp23\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_device_dws_air_conditioning_run_data\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp23_create\"],\"id\":\"tasks-9-yc67u\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"create table if not exists db_device_dw.clife_device_dws_run_data_tmp2 stored as parquet as\\nselect\\n t1.deviceid            --'设备id'\\n,t1.productid           --'产品id'\\n,t1.device_type_id             -- '设备大类'\\n,t1.device_subtype_id          -- '设备小类'\\n,t1.bind_user_id               -- '绑定用户'\\n,t1.macaddress                 -- 'macaddress 地址'\\n,t1.mactype                    -- 'macaddress 地址类型'\\n,t4.on_cnt               -- '在线次数'\\n,t5.off_cnt                -- '离线次数'\\n,t2.sum_on_time                -- '在线时长'\\n,t3.sum_off_time                -- '离线时长'\\n,t6.sum_oximeterlink_time  --'血氧夹接入时长'\\n,t7.sum_alinkstatus_time  --'A路接入时长'\\n,t8.sum_blinkstatus_time  --'B路接入时长'\\n,0 as sum_adjustbodymov   --'需要校准体动次数'\\n,'2代' as datasource      --'数据来源'\\nfrom\\n(select\\ndeviceid            --'设备id'\\n,max(productid)   productid        --'产品id'\\n,max(device_type_id)  device_type_id           -- '设备大类'\\n,max(device_subtype_id) device_subtype_id         -- '设备小类'\\n,max(bind_user_id)   bind_user_id           -- '绑定用户'\\n,max(macaddress)     macaddress            -- 'macaddress 地址'\\n,max(mactype)        mactype            -- 'macaddress 地址类型'\\nfrom db_device_dw.clife_device_dws_run_data_tmp1\\ngroup by deviceid\\n)\\nt1\\nleft join \\n(select\\ndeviceid            --'设备id'\\n,sum(on_time)     sum_on_time  --'在线时长'\\nfrom\\n(\\nselect \\ndeviceid            --'设备id'\\n,(unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) as on_time  --在线时长，单位秒\\nfrom db_device_dw.clife_device_dws_run_data_sleep_tmp1\\nwhere last_onoff=1\\n) a \\ngroup by a.deviceid)\\nt2\\non t1.deviceid=t2.deviceid\\nleft join \\n(select\\ndeviceid            --'设备id'\\n,sum(off_time)     sum_off_time  --'在线时长'\\nfrom\\n(\\nselect \\ndeviceid            --'设备id'\\n,(unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) as off_time  --在线时长，单位秒\\nfrom db_device_dw.clife_device_dws_run_data_sleep_tmp1\\nwhere last_onoff=0\\n) a \\ngroup by a.deviceid)\\nt3\\non t1.deviceid=t3.deviceid\\nleft join \\n(select\\ndeviceid            --'设备id'\\n,count(onoff)     on_cnt  --'在线次数'\\nfrom db_device_dw.clife_device_dws_run_data_sleep_tmp1\\nwhere last_onoff=1 and onoff=0 \\ngroup by deviceid)\\nt4\\non t1.deviceid=t4.deviceid\\nleft join \\n(select\\ndeviceid            --'设备id'\\n,count(onoff)     off_cnt  --'离线次数'\\nfrom db_device_dw.clife_device_dws_run_data_sleep_tmp1\\nwhere last_onoff=0 and onoff=1 \\ngroup by deviceid)\\nt5\\non t1.deviceid=t5.deviceid\\nleft join \\n(\\nselect\\ndeviceid            --'设备id'\\n,sum(oximeterlink_time)     sum_oximeterlink_time  --'血氧夹接入时长'\\nfrom\\n(\\nselect \\ndeviceid            --'设备id'\\n,(unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) as oximeterlink_time  --在线时长，单位秒\\nfrom db_device_dw.clife_device_dws_run_data_tmp1\\nwhere last_oximeterlink=1\\n) a \\ngroup by a.deviceid\\n)\\nt6\\non t1.deviceid=t6.deviceid\\nleft join \\n(\\nselect\\ndeviceid            --'设备id'\\n,sum(alinkstatus_time)     sum_alinkstatus_time  --'A路接入时长'\\nfrom\\n(\\nselect \\ndeviceid            --'设备id'\\n,(unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) as alinkstatus_time  --在线时长，单位秒\\nfrom db_device_dw.clife_device_dws_run_data_tmp1\\nwhere last_alinkstatus=1\\n) a \\ngroup by a.deviceid\\n)\\nt7\\non t1.deviceid=t7.deviceid\\nleft join \\n(\\nselect\\ndeviceid            --'设备id'\\n,sum(blinkstatus_time)     sum_blinkstatus_time  --'B路接入时长'\\nfrom\\n(\\nselect \\ndeviceid            --'设备id'\\n,(unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) as blinkstatus_time  --在线时长，单位秒\\nfrom db_device_dw.clife_device_dws_run_data_tmp1\\nwhere last_blinkstatus=1\\n) a \\ngroup by a.deviceid\\n)\\nt8\\non t1.deviceid=t8.deviceid\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp2_create\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_timp2_drop\"],\"id\":\"tasks-4-dx1yp\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"create table if not exists db_device_dw.clife_device_dws_run_data_tmp1 stored as parquet as\\nselect \\ndeviceid            --'设备id'\\n,productid           --'产品id'\\n,device_type_id             -- '设备大类'\\n,device_subtype_id          -- '设备小类'\\n,bind_user_id               -- '绑定用户'\\n,macaddress                 -- 'macaddress 地址'\\n,mactype                    -- 'macaddress 地址类型'\\n,oximeterlink               -- '血氧夹接入状态'  \\n,lag(oximeterlink, 1, null) over (partition by deviceid order by fetchDateTime)  last_oximeterlink  --'设备上一条血氧夹接入状态' \\n,alinkstatus                -- 'A路接入状态'\\n,lag(alinkstatus, 1, null) over (partition by deviceid order by fetchDateTime)  last_alinkstatus  --'设备上一条A路接入状态' \\n,blinkstatus                -- 'B路接入状态'\\n,lag(blinkstatus, 1, null) over (partition by deviceid order by fetchDateTime)  last_blinkstatus  --'设备上一条B路接入状态' \\n,datasource                 --  '数据来源' \\n,fetchDateTime              --  '采集时间'\\n,lag(fetchDateTime, 1, null) over (partition by deviceid order by fetchDateTime)  last_fetchDateTime  --'设备上一条采集时间' \\nfrom db_device_dw.clife_device_dwd_sleep_run_data \\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','') \\nand datasource='2代'\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_tmp1_create\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp1_drop\"],\"id\":\"tasks-1-3222vr\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"drop table if exists db_device_dw.clife_device_dws_run_data_sleep_tmp1\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_sleep_tmp1_drop\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_tmp1_create\"],\"id\":\"tasks-48371\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"create table if not exists db_device_dw.clife_device_dws_run_data_sleep_tmp1 stored as parquet as\\nselect \\ndeviceid            --'设备id'\\n,productid           --'产品id'\\n,device_type_id             -- '设备大类'\\n,device_subtype_id          -- '设备小类'\\n,bind_user_id               -- '绑定用户'\\n,macaddress                 -- 'macaddress 地址'\\n,mactype                    -- 'macaddress 地址类型'\\n,onoff                      -- '开关机'\\n,lag(onoff, 1, null) over (partition by deviceid order by fetchDateTime)  last_onoff  --'设备上一条开关机状态' \\n,datasource                 --  '数据来源' \\n,fetchDateTime              --  '采集时间'\\n,lag(fetchDateTime, 1, null) over (partition by deviceid order by fetchDateTime)  last_fetchDateTime  --'设备上一条采集时间' \\nfrom db_device_dw.clife_device_dwd_sleep_run_data where part_date=regexp_replace(date_sub(current_date(),1),'-','') and datasource='2代' and onoff is not null\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"run_data_sleep_tmp1_create\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"run_data_sleep_tmp1_drop\"],\"id\":\"tasks-93578\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"drop table if exists db_device_dw.clife_device_dws_error_data_tmp5\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"error_data_tmp5_drop\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_device_dws_sleep_error_data\"],\"id\":\"tasks-2-1s43bb\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"create table if not exists db_device_dw.clife_device_dws_error_data_tmp5 stored as parquet as \\nselect\\n     deviceid                                --设备id\\n    ,productid                               --产品id\\n    ,device_type_id                          --设备大类\\n    ,device_subtype_id                       --设备小类\\n    ,bind_user_id                            --绑定用户\\n    ,macaddress                              --macaddress 地址\\n    ,mactype                                 --macaddress 地址类型\\n    ,error_inambienttemperr    --室内环境温度故障\\n    ,lag(error_inambienttemperr,1,null) over(partition by deviceid order by fetchDateTime) last_error_inambienttemperr   -- 上一条室内环境温度故障\\n    ,error_incoiltemperr       --室内盘管温度故障\\n    ,lag(error_incoiltemperr,1,null) over(partition by deviceid order by fetchDateTime) last_error_incoiltemperr   -- 上一条室内盘管温度故障\\n    ,error_outambienttemperr   --室外环境温度故障\\n    ,lag(error_outambienttemperr,1,null) over(partition by deviceid order by fetchDateTime) last_error_outambienttemperr   -- 上一条室外环境温度故障\\n    ,error_outcoiltemperr      --室外盘管温度故障\\n    ,lag(error_outcoiltemperr,1,null) over(partition by deviceid order by fetchDateTime) last_error_outcoiltemperr   -- 上一条室外盘管温度故障\\n    ,error_overtemperr         --过热保护故障\\n    ,lag(error_overtemperr,1,null) over(partition by deviceid order by fetchDateTime) last_error_overtemperr   -- 上一条过热保护故障\\n    ,error_lesscryogenerr      --冷媒不足故障\\n    ,lag(error_lesscryogenerr,1,null) over(partition by deviceid order by fetchDateTime) last_error_lesscryogenerr   -- 上一条冷媒不足故障\\n    ,error_pgmotorerr          --PG电机故障\\n    ,lag(error_pgmotorerr,1,null) over(partition by deviceid order by fetchDateTime) last_error_pgmotorerr   -- 上一条PG电机故障\\n    ,error_passzeroerr         --过零故障\\n    ,lag(error_passzeroerr,1,null) over(partition by deviceid order by fetchDateTime) last_error_passzeroerr   -- 上一条过零故障\\n    ,datasource                -- 数据来源\\n    ,fetchDateTime             -- 采集时间\\n    ,lag(fetchDateTime,1,null) over(partition by deviceid order by fetchDateTime) last_fetchDateTime   -- 上一条采集时间\\nfrom db_device_dw.clife_device_dwd_air_conditioning_error_data \\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','') \\n  and datasource='空调'\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"error_data_tmp5_create\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"error_data_tmp5_drop\"],\"id\":\"tasks-1-528kj\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"drop table if exists db_device_dw.clife_device_dws_error_data_tmp6\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"error_data_tmp6_drop\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"error_data_tmp5_create\"],\"id\":\"tasks-2-2nz4i6\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"create table if not exists db_device_dw.clife_device_dws_error_data_tmp6 stored as parquet as\\nselect\\n     deviceid                                  --'设备id'\\n    ,productid                                 --'产品id'\\n    ,device_type_id                            --'设备大类'\\n    ,device_subtype_id                         --'设备小类'\\n    ,bind_user_id                              --'绑定用户'\\n    ,macaddress                                --'macaddress 地址'\\n    ,mactype                                   --'macaddress 地址类型'\\n    ,error_inambienttemperr_cnt                --室内环境温度故障次数\\n    ,error_incoiltemperr_cnt                   --室内盘管温度故障次数\\n    ,error_outambienttemperr_cnt               --室外环境温度故障次数\\n    ,error_outcoiltemperr_cnt                  --室外盘管温度故障次数\\n    ,error_overtemperr_cnt                     --过热保护故障次数\\n    ,error_lesscryogenerr_cnt                  --冷媒不足故障次数\\n    ,error_pgmotorerr_cnt                      --PG电机故障次数\\n    ,error_passzeroerr_cnt                     --过零故障次数\\n    ,error_refrigerantFault_cnt                --读取冷媒故障次数 \\n    ,error_pgMachineFault_cnt                  --读取PG电机反馈故障次数\\n    ,error_inambienttemperr_time               --室内环境温度故障时长\\n    ,error_incoiltemperr_time                  --室内盘管温度故障时长\\n    ,error_outambienttemperr_time              --室外环境温度故障时长\\n    ,error_outcoiltemperr_time                 --室外盘管温度故障时长\\n    ,error_overtemperr_time                    --过热保护故障时长\\n    ,error_lesscryogenerr_time                 --冷媒不足故障时长\\n    ,error_pgmotorerr_time                     --PG电机故障时长\\n    ,error_passzeroerr_time                    --过零故障时长\\n    ,error_refrigerantFault_time               --读取冷媒故障时长\\n    ,error_pgMachineFault_time                 --读取PG电机反馈故障时长\\n    ,'空调' as datasource                       --'数据来源'\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom\\n(\\n   select\\n        deviceid\\n       ,max(productid)         as productid\\n       ,max(device_type_id)    as device_type_id\\n       ,max(device_subtype_id) as device_subtype_id\\n       ,max(bind_user_id)      as bind_user_id\\n       ,max(macaddress)        as macaddress\\n       ,max(mactype)           as mactype\\n       ,sum(case when error_inambienttemperr= 1   and last_error_inambienttemperr  = 0  then 1 else 0 end) as error_inambienttemperr_cnt\\n       ,sum(case when error_incoiltemperr= 1      and last_error_incoiltemperr     = 0  then 1 else 0 end) as error_incoiltemperr_cnt\\n       ,sum(case when error_outambienttemperr= 1  and last_error_outambienttemperr = 0  then 1 else 0 end) as error_outambienttemperr_cnt\\n       ,sum(case when error_outcoiltemperr= 1     and last_error_outcoiltemperr    = 0  then 1 else 0 end) as error_outcoiltemperr_cnt\\n       ,sum(case when error_overtemperr= 1        and last_error_overtemperr       = 0  then 1 else 0 end) as error_overtemperr_cnt\\n       ,sum(case when error_lesscryogenerr= 1     and last_error_lesscryogenerr    = 0  then 1 else 0 end) as error_lesscryogenerr_cnt\\n       ,sum(case when error_pgmotorerr= 1         and last_error_pgmotorerr        = 0  then 1 else 0 end) as error_pgmotorerr_cnt\\n       ,sum(case when error_passzeroerr= 1        and last_error_passzeroerr       = 0  then 1 else 0 end) as error_passzeroerr_cnt\\n       ,cast(0 as int) as error_refrigerantFault_cnt\\n       ,cast(0 as int) as error_pgMachineFault_cnt\\n       ,sum(case when last_error_inambienttemperr= 1  then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end)  as   error_inambienttemperr_time\\n       ,sum(case when last_error_incoiltemperr= 1     then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end)  as   error_incoiltemperr_time\\n       ,sum(case when last_error_outambienttemperr= 1 then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end)  as   error_outambienttemperr_time\\n       ,sum(case when last_error_outcoiltemperr= 1    then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end)  as   error_outcoiltemperr_time\\n       ,sum(case when last_error_overtemperr= 1       then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end)  as   error_overtemperr_time\\n       ,sum(case when last_error_lesscryogenerr= 1    then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end)  as   error_lesscryogenerr_time\\n       ,sum(case when last_error_pgmotorerr= 1        then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end)  as   error_pgmotorerr_time\\n       ,sum(case when last_error_passzeroerr= 1       then (unix_timestamp(fetchDateTime)-unix_timestamp(last_fetchDateTime)) else 0 end)  as   error_passzeroerr_time\\n       ,cast(0 as bigint) as error_refrigerantFault_time\\n       ,cast(0 as bigint) as error_pgMachineFault_time\\n   from db_device_dw.clife_device_dws_error_data_tmp5\\n   group by deviceid\\n)t1\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"error_data_tmp6_create\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"error_data_tmp6_drop\"],\"id\":\"tasks-1-50b157\",\"workerGroup\":1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"insert overwrite table db_device_dw.clife_device_dws_air_conditioning_error_data partition(part_date)\\nselect\\n     deviceid                                  --'设备id'\\n    ,productid                                 --'产品id'\\n    ,device_type_id                            --'设备大类'\\n    ,device_subtype_id                         --'设备小类'\\n    ,bind_user_id                              --'绑定用户'\\n    ,macaddress                                --'macaddress 地址'\\n    ,mactype                                   --'macaddress 地址类型'\\n    ,error_inambienttemperr_cnt                --室内环境温度故障次数\\n    ,error_incoiltemperr_cnt                   --室内盘管温度故障次数\\n    ,error_outambienttemperr_cnt               --室外环境温度故障次数\\n    ,error_outcoiltemperr_cnt                  --室外盘管温度故障次数\\n    ,error_overtemperr_cnt                     --过热保护故障次数\\n    ,error_lesscryogenerr_cnt                  --冷媒不足故障次数\\n    ,error_pgmotorerr_cnt                      --PG电机故障次数\\n    ,error_passzeroerr_cnt                     --过零故障次数\\n    ,error_refrigerantFault_cnt                --读取冷媒故障次数 \\n    ,error_pgMachineFault_cnt                  --读取PG电机反馈故障次数\\n    ,error_inambienttemperr_time               --室内环境温度故障时长\\n    ,error_incoiltemperr_time                  --室内盘管温度故障时长\\n    ,error_outambienttemperr_time              --室外环境温度故障时长\\n    ,error_outcoiltemperr_time                 --室外盘管温度故障时长\\n    ,error_overtemperr_time                    --过热保护故障时长\\n    ,error_lesscryogenerr_time                 --冷媒不足故障时长\\n    ,error_pgmotorerr_time                     --PG电机故障时长\\n    ,error_passzeroerr_time                    --过零故障时长\\n    ,error_refrigerantFault_time               --读取冷媒故障时长\\n    ,error_pgMachineFault_time                 --读取PG电机反馈故障时长\\n    ,'空调' as datasource                      --'数据来源'\\n    ,part_date                                 --分区日期\\nfrom db_device_dw.clife_device_dws_error_data_tmp6\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":147,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_device_dw\"},\"timeout\":{},\"maxRetryTimes\":3,\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_device_dws_air_conditioning_error_data\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"error_data_tmp6_create\"],\"id\":\"tasks-9-4na715\",\"workerGroup\":1}],\"tenantId\":-1,\"timeout\":0}","description":"","globalParams":"[]","globalParamList":[],"globalParamMap":{},"createTime":"2021-10-28T02:51:07.000+0000","updateTime":"2021-11-10T02:21:40.000+0000","flag":"YES","userId":160,"userName":"data_warehouse","projectName":null,"locations":"{\"tasks-22568\":{\"name\":\"run_data_tmp1_drop\",\"targetarr\":\"\",\"nodenumber\":\"0\",\"x\":170,\"y\":480},\"tasks-2-cq7bl\":{\"name\":\"run_data_timp2_drop\",\"targetarr\":\"tasks-93578\",\"nodenumber\":\"0\",\"x\":850,\"y\":480},\"tasks-2-2y02g5\":{\"name\":\"run_data_tmp3_drop\",\"targetarr\":\"tasks-4-dx1yp\",\"nodenumber\":\"0\",\"x\":1190,\"y\":480},\"tasks-4-de5po\":{\"name\":\"run_data_tmp3_create\",\"targetarr\":\"tasks-2-2y02g5\",\"nodenumber\":\"0\",\"x\":1360,\"y\":480},\"tasks-2-7ji5uy\":{\"name\":\"run_data_tmp4_drop\",\"targetarr\":\"tasks-4-de5po\",\"nodenumber\":\"0\",\"x\":1530,\"y\":480},\"tasks-4-3443br\":{\"name\":\"run_data_tmp4_create\",\"targetarr\":\"tasks-2-7ji5uy\",\"nodenumber\":\"0\",\"x\":1700,\"y\":480},\"tasks-2-1e64q2\":{\"name\":\"error_data_tmp1_drop\",\"targetarr\":\"\",\"nodenumber\":\"0\",\"x\":165,\"y\":124},\"tasks-1-6602fd\":{\"name\":\"error_data_tmp1_create\",\"targetarr\":\"tasks-2-1e64q2\",\"nodenumber\":\"0\",\"x\":340,\"y\":120},\"tasks-2-55k39y\":{\"name\":\"error_data_tmp2_drop\",\"targetarr\":\"tasks-1-6602fd\",\"nodenumber\":\"0\",\"x\":510,\"y\":120},\"tasks-1-3oo6k0\":{\"name\":\"error_data_tmp2_create\",\"targetarr\":\"tasks-2-55k39y\",\"nodenumber\":\"0\",\"x\":680,\"y\":120},\"tasks-2-6xa6k1\":{\"name\":\"error_data_tmp3_drop\",\"targetarr\":\"tasks-1-3oo6k0\",\"nodenumber\":\"0\",\"x\":850,\"y\":120},\"tasks-1-34z536\":{\"name\":\"error_data_tmp3_create\",\"targetarr\":\"tasks-2-6xa6k1\",\"nodenumber\":\"0\",\"x\":1020,\"y\":120},\"tasks-2-4am43\":{\"name\":\"error_data_tmp4_drop\",\"targetarr\":\"tasks-1-34z536\",\"nodenumber\":\"0\",\"x\":1190,\"y\":120},\"tasks-1-6z87dx\":{\"name\":\"error_data_tmp4_create\",\"targetarr\":\"tasks-2-4am43\",\"nodenumber\":\"0\",\"x\":1360,\"y\":120},\"tasks-9-6oq601\":{\"name\":\"clife_device_dws_sleep_error_data\",\"targetarr\":\"tasks-1-6z87dx\",\"nodenumber\":\"1\",\"x\":1551,\"y\":119},\"tasks-9-o6dh\":{\"name\":\"clife_device_dws_sleep_run_data\",\"targetarr\":\"tasks-4-30j2x6\",\"nodenumber\":\"0\",\"x\":2525,\"y\":475},\"tasks-2-dcml\":{\"name\":\"run_data_tmp5_drop\",\"targetarr\":\"tasks-4-3443br\",\"nodenumber\":\"0\",\"x\":1870,\"y\":480},\"tasks-4-7ii5c6\":{\"name\":\"run_data_tmp5_create\",\"targetarr\":\"tasks-2-dcml\",\"nodenumber\":\"0\",\"x\":2040,\"y\":480},\"tasks-2-1d83o1\":{\"name\":\"run_data_tmp6_drop\",\"targetarr\":\"tasks-4-7ii5c6\",\"nodenumber\":\"0\",\"x\":2210,\"y\":480},\"tasks-4-30j2x6\":{\"name\":\"run_data_tmp6_create\",\"targetarr\":\"tasks-2-1d83o1\",\"nodenumber\":\"0\",\"x\":2353,\"y\":475},\"tasks-2-7es797\":{\"name\":\"run_data_tmp14_drop\",\"targetarr\":\"tasks-9-o6dh\",\"nodenumber\":\"0\",\"x\":2719,\"y\":474},\"tasks-4-1m43yo\":{\"name\":\"run_data_tmp14_create\",\"targetarr\":\"tasks-2-7es797\",\"nodenumber\":\"0\",\"x\":2891,\"y\":477},\"tasks-2-6tl16l\":{\"name\":\"run_data_tmp15_drop\",\"targetarr\":\"tasks-4-1m43yo\",\"nodenumber\":\"0\",\"x\":3060,\"y\":480},\"tasks-4-6zo1z0\":{\"name\":\"run_data_tmp15_create\",\"targetarr\":\"tasks-2-6tl16l\",\"nodenumber\":\"0\",\"x\":3230,\"y\":480},\"tasks-2-41p35z\":{\"name\":\"run_data_tmp16_drop\",\"targetarr\":\"tasks-4-6zo1z0\",\"nodenumber\":\"0\",\"x\":3400,\"y\":480},\"tasks-4-4fe3lz\":{\"name\":\"run_data_tmp16_create\",\"targetarr\":\"tasks-2-41p35z\",\"nodenumber\":\"0\",\"x\":3570,\"y\":480},\"tasks-2-53v2g3\":{\"name\":\"run_data_tmp17_drop\",\"targetarr\":\"tasks-4-4fe3lz\",\"nodenumber\":\"0\",\"x\":3740,\"y\":480},\"tasks-4-4evps\":{\"name\":\"run_data_tmp17_create\",\"targetarr\":\"tasks-2-53v2g3\",\"nodenumber\":\"0\",\"x\":3912,\"y\":482},\"tasks-2-3jc1nm\":{\"name\":\"run_data_tmp20_drop\",\"targetarr\":\"tasks-4-6zy1g5\",\"nodenumber\":\"0\",\"x\":4760,\"y\":480},\"tasks-4-1is6kd\":{\"name\":\"run_data_tmp20_create\",\"targetarr\":\"tasks-2-3jc1nm\",\"nodenumber\":\"0\",\"x\":4930,\"y\":480},\"tasks-2-s15dz\":{\"name\":\"run_data_tmp21_drop\",\"targetarr\":\"tasks-4-1is6kd\",\"nodenumber\":\"0\",\"x\":5100,\"y\":480},\"tasks-4-6ie6kg\":{\"name\":\"run_data_tmp21_create\",\"targetarr\":\"tasks-2-s15dz\",\"nodenumber\":\"0\",\"x\":5270,\"y\":480},\"tasks-2-eg1o\":{\"name\":\"run_data_tmp18_drop\",\"targetarr\":\"tasks-4-4evps\",\"nodenumber\":\"0\",\"x\":4080,\"y\":480},\"tasks-4-xtno\":{\"name\":\"run_data_tmp18_create\",\"targetarr\":\"tasks-2-eg1o\",\"nodenumber\":\"0\",\"x\":4250,\"y\":480},\"tasks-2-5kp13i\":{\"name\":\"run_data_tmp19_drop\",\"targetarr\":\"tasks-4-xtno\",\"nodenumber\":\"0\",\"x\":4420,\"y\":480},\"tasks-4-6zy1g5\":{\"name\":\"run_data_tmp19_create\",\"targetarr\":\"tasks-2-5kp13i\",\"nodenumber\":\"0\",\"x\":4590,\"y\":480},\"tasks-2-4e6d3\":{\"name\":\"run_data_tmp22_drop\",\"targetarr\":\"tasks-4-6ie6kg\",\"nodenumber\":\"0\",\"x\":5440,\"y\":480},\"tasks-4-1gu40p\":{\"name\":\"run_data_tmp22_create\",\"targetarr\":\"tasks-2-4e6d3\",\"nodenumber\":\"0\",\"x\":5610,\"y\":480},\"tasks-2-1n014g\":{\"name\":\"run_data_tmp23_drop\",\"targetarr\":\"tasks-4-1gu40p\",\"nodenumber\":\"0\",\"x\":5780,\"y\":480},\"tasks-4-77j4tr\":{\"name\":\"run_data_tmp23_create\",\"targetarr\":\"tasks-2-1n014g\",\"nodenumber\":\"0\",\"x\":5950,\"y\":480},\"tasks-9-yc67u\":{\"name\":\"clife_device_dws_air_conditioning_run_data\",\"targetarr\":\"tasks-4-77j4tr\",\"nodenumber\":\"0\",\"x\":6119,\"y\":480},\"tasks-4-dx1yp\":{\"name\":\"run_data_tmp2_create\",\"targetarr\":\"tasks-2-cq7bl\",\"nodenumber\":\"0\",\"x\":1020,\"y\":480},\"tasks-1-3222vr\":{\"name\":\"run_data_tmp1_create\",\"targetarr\":\"tasks-22568\",\"nodenumber\":\"0\",\"x\":340,\"y\":480},\"tasks-48371\":{\"name\":\"run_data_sleep_tmp1_drop\",\"targetarr\":\"tasks-1-3222vr\",\"nodenumber\":\"0\",\"x\":510,\"y\":480},\"tasks-93578\":{\"name\":\"run_data_sleep_tmp1_create\",\"targetarr\":\"tasks-48371\",\"nodenumber\":\"0\",\"x\":679,\"y\":479},\"tasks-2-1s43bb\":{\"name\":\"error_data_tmp5_drop\",\"targetarr\":\"tasks-9-6oq601\",\"nodenumber\":\"1\",\"x\":1746,\"y\":118},\"tasks-1-528kj\":{\"name\":\"error_data_tmp5_create\",\"targetarr\":\"tasks-2-1s43bb\",\"nodenumber\":\"1\",\"x\":1904,\"y\":117},\"tasks-2-2nz4i6\":{\"name\":\"error_data_tmp6_drop\",\"targetarr\":\"tasks-1-528kj\",\"nodenumber\":\"1\",\"x\":2078,\"y\":119},\"tasks-1-50b157\":{\"name\":\"error_data_tmp6_create\",\"targetarr\":\"tasks-2-2nz4i6\",\"nodenumber\":\"1\",\"x\":2255,\"y\":120},\"tasks-9-4na715\":{\"name\":\"clife_device_dws_air_conditioning_error_data\",\"targetarr\":\"tasks-1-50b157\",\"nodenumber\":\"0\",\"x\":2458,\"y\":113}}","connects":"[{\"endPointSourceId\":\"tasks-2-2y02g5\",\"endPointTargetId\":\"tasks-4-de5po\"},{\"endPointSourceId\":\"tasks-4-de5po\",\"endPointTargetId\":\"tasks-2-7ji5uy\"},{\"endPointSourceId\":\"tasks-2-7ji5uy\",\"endPointTargetId\":\"tasks-4-3443br\"},{\"endPointSourceId\":\"tasks-2-1e64q2\",\"endPointTargetId\":\"tasks-1-6602fd\"},{\"endPointSourceId\":\"tasks-1-6602fd\",\"endPointTargetId\":\"tasks-2-55k39y\"},{\"endPointSourceId\":\"tasks-2-55k39y\",\"endPointTargetId\":\"tasks-1-3oo6k0\"},{\"endPointSourceId\":\"tasks-1-3oo6k0\",\"endPointTargetId\":\"tasks-2-6xa6k1\"},{\"endPointSourceId\":\"tasks-2-6xa6k1\",\"endPointTargetId\":\"tasks-1-34z536\"},{\"endPointSourceId\":\"tasks-1-34z536\",\"endPointTargetId\":\"tasks-2-4am43\"},{\"endPointSourceId\":\"tasks-2-4am43\",\"endPointTargetId\":\"tasks-1-6z87dx\"},{\"endPointSourceId\":\"tasks-1-6z87dx\",\"endPointTargetId\":\"tasks-9-6oq601\"},{\"endPointSourceId\":\"tasks-4-3443br\",\"endPointTargetId\":\"tasks-2-dcml\"},{\"endPointSourceId\":\"tasks-2-dcml\",\"endPointTargetId\":\"tasks-4-7ii5c6\"},{\"endPointSourceId\":\"tasks-4-7ii5c6\",\"endPointTargetId\":\"tasks-2-1d83o1\"},{\"endPointSourceId\":\"tasks-2-1d83o1\",\"endPointTargetId\":\"tasks-4-30j2x6\"},{\"endPointSourceId\":\"tasks-4-30j2x6\",\"endPointTargetId\":\"tasks-9-o6dh\"},{\"endPointSourceId\":\"tasks-9-o6dh\",\"endPointTargetId\":\"tasks-2-7es797\"},{\"endPointSourceId\":\"tasks-2-7es797\",\"endPointTargetId\":\"tasks-4-1m43yo\"},{\"endPointSourceId\":\"tasks-4-1m43yo\",\"endPointTargetId\":\"tasks-2-6tl16l\"},{\"endPointSourceId\":\"tasks-2-6tl16l\",\"endPointTargetId\":\"tasks-4-6zo1z0\"},{\"endPointSourceId\":\"tasks-2-41p35z\",\"endPointTargetId\":\"tasks-4-4fe3lz\"},{\"endPointSourceId\":\"tasks-4-4fe3lz\",\"endPointTargetId\":\"tasks-2-53v2g3\"},{\"endPointSourceId\":\"tasks-2-53v2g3\",\"endPointTargetId\":\"tasks-4-4evps\"},{\"endPointSourceId\":\"tasks-2-3jc1nm\",\"endPointTargetId\":\"tasks-4-1is6kd\"},{\"endPointSourceId\":\"tasks-4-1is6kd\",\"endPointTargetId\":\"tasks-2-s15dz\"},{\"endPointSourceId\":\"tasks-2-s15dz\",\"endPointTargetId\":\"tasks-4-6ie6kg\"},{\"endPointSourceId\":\"tasks-4-6zo1z0\",\"endPointTargetId\":\"tasks-2-41p35z\"},{\"endPointSourceId\":\"tasks-4-4evps\",\"endPointTargetId\":\"tasks-2-eg1o\"},{\"endPointSourceId\":\"tasks-2-eg1o\",\"endPointTargetId\":\"tasks-4-xtno\"},{\"endPointSourceId\":\"tasks-4-xtno\",\"endPointTargetId\":\"tasks-2-5kp13i\"},{\"endPointSourceId\":\"tasks-2-5kp13i\",\"endPointTargetId\":\"tasks-4-6zy1g5\"},{\"endPointSourceId\":\"tasks-4-6zy1g5\",\"endPointTargetId\":\"tasks-2-3jc1nm\"},{\"endPointSourceId\":\"tasks-4-6ie6kg\",\"endPointTargetId\":\"tasks-2-4e6d3\"},{\"endPointSourceId\":\"tasks-2-4e6d3\",\"endPointTargetId\":\"tasks-4-1gu40p\"},{\"endPointSourceId\":\"tasks-4-1gu40p\",\"endPointTargetId\":\"tasks-2-1n014g\"},{\"endPointSourceId\":\"tasks-2-1n014g\",\"endPointTargetId\":\"tasks-4-77j4tr\"},{\"endPointSourceId\":\"tasks-4-77j4tr\",\"endPointTargetId\":\"tasks-9-yc67u\"},{\"endPointSourceId\":\"tasks-2-cq7bl\",\"endPointTargetId\":\"tasks-4-dx1yp\"},{\"endPointSourceId\":\"tasks-4-dx1yp\",\"endPointTargetId\":\"tasks-2-2y02g5\"},{\"endPointSourceId\":\"tasks-22568\",\"endPointTargetId\":\"tasks-1-3222vr\"},{\"endPointSourceId\":\"tasks-1-3222vr\",\"endPointTargetId\":\"tasks-48371\"},{\"endPointSourceId\":\"tasks-48371\",\"endPointTargetId\":\"tasks-93578\"},{\"endPointSourceId\":\"tasks-93578\",\"endPointTargetId\":\"tasks-2-cq7bl\"},{\"endPointSourceId\":\"tasks-9-6oq601\",\"endPointTargetId\":\"tasks-2-1s43bb\"},{\"endPointSourceId\":\"tasks-2-1s43bb\",\"endPointTargetId\":\"tasks-1-528kj\"},{\"endPointSourceId\":\"tasks-1-528kj\",\"endPointTargetId\":\"tasks-2-2nz4i6\"},{\"endPointSourceId\":\"tasks-2-2nz4i6\",\"endPointTargetId\":\"tasks-1-50b157\"},{\"endPointSourceId\":\"tasks-1-50b157\",\"endPointTargetId\":\"tasks-9-4na715\"}]","receivers":"","receiversCc":"","leadMobile":"","ddAlarmId":0,"scheduleReleaseState":null,"timeout":0,"tenantId":-1,"taskType":"SHELL"}],"total":12,"currentPage":1,"totalPage":2}}
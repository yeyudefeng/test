{
	"code": 0,
	"msg": "成功",
	"data": {
		"totalList": [{
			"id": 340,
			"name": "big_date_task_workflow_hr",
			"version": 0,
			"releaseState": "ONLINE",
			"projectId": 1,
			"processDefinitionJson": "{\"globalParams\":[],\"tasks\":[{\"type\":\"SUB_PROCESS\",\"id\":\"tasks-50862\",\"name\":\"db_ods_hr\",\"params\":{\"processDefinitionId\":334},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"timeout\":{},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[]},{\"type\":\"SUB_PROCESS\",\"id\":\"tasks-80353\",\"name\":\"db_dim_hr\",\"params\":{\"processDefinitionId\":335},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"db_ods_hr\"]},{\"type\":\"SUB_PROCESS\",\"id\":\"tasks-60390\",\"name\":\"db_dwd_hr\",\"params\":{\"processDefinitionId\":339},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"db_dim_hr\"]},{\"type\":\"SUB_PROCESS\",\"id\":\"tasks-74361\",\"name\":\"db_dwm_hr\",\"params\":{\"processDefinitionId\":337},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"db_dwd_hr\"]},{\"type\":\"SUB_PROCESS\",\"id\":\"tasks-14080\",\"name\":\"db_dws_hr\",\"params\":{\"processDefinitionId\":338},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"db_dwm_hr\"]}],\"tenantId\":-1,\"timeout\":0}",
			"description": "华润数仓",
			"globalParams": "[]",
			"globalParamList": [],
			"globalParamMap": {},
			"createTime": "2021-07-28T02:04:14.000+0000",
			"updateTime": "2021-07-29T09:32:30.000+0000",
			"flag": "YES",
			"userId": 143,
			"userName": "shucang0907",
			"projectName": null,
			"locations": "{\"tasks-50862\":{\"name\":\"db_ods_hr\",\"targetarr\":\"\",\"nodenumber\":\"1\",\"x\":359,\"y\":279},\"tasks-80353\":{\"name\":\"db_dim_hr\",\"targetarr\":\"tasks-50862\",\"nodenumber\":\"1\",\"x\":578,\"y\":276},\"tasks-60390\":{\"name\":\"db_dwd_hr\",\"targetarr\":\"tasks-80353\",\"nodenumber\":\"2\",\"x\":796,\"y\":278},\"tasks-74361\":{\"name\":\"db_dwm_hr\",\"targetarr\":\"tasks-60390\",\"nodenumber\":\"1\",\"x\":1105,\"y\":283},\"tasks-14080\":{\"name\":\"db_dws_hr\",\"targetarr\":\"tasks-74361\",\"nodenumber\":\"0\",\"x\":1481,\"y\":278}}",
			"connects": "[{\"endPointSourceId\":\"tasks-50862\",\"endPointTargetId\":\"tasks-80353\"},{\"endPointSourceId\":\"tasks-80353\",\"endPointTargetId\":\"tasks-60390\"},{\"endPointSourceId\":\"tasks-74361\",\"endPointTargetId\":\"tasks-14080\"},{\"endPointSourceId\":\"tasks-60390\",\"endPointTargetId\":\"tasks-74361\"}]",
			"receivers": "",
			"receiversCc": "",
			"leadMobile": "",
			"ddAlarmId": 0,
			"scheduleReleaseState": "ONLINE",
			"timeout": 0,
			"tenantId": -1,
			"taskType": "SHELL"
		}, {
			"id": 336,
			"name": "db_dwd_hr_market",
			"version": 0,
			"releaseState": "ONLINE",
			"projectId": 1,
			"processDefinitionJson": "{\"globalParams\":[],\"tasks\":[{\"type\":\"SQL\",\"id\":\"tasks-62214\",\"name\":\"clife_hr_customer_pension_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"create table if not exists db_dw_hr.clife_hr_customer_pension_tmp stored as parquet as \\nselect \\n a.advisory_customer_id       as advisory_customer_id    --咨询客户id\\n,b.intention_customer_id      as intention_customer_id   --意向客户id\\n,b.old_man_id                 as old_man_id              --老人id\\n,if(b.customer_name is null,a.customer_name,b.customer_name)  as name   --客户姓名\\n,if(b.sex is null,a.sex,b.sex) as sex    --客户性别\\n,if(b.sales_consultant_id is null,a.sales_consultant_id,b.sales_consultant_id) as membership_adviser_id  --会籍顾问id\\n,if(b.sales_consultant_name is null,a.sales_consultant_name,b.sales_consultant_name) as membership_adviser_name  --会籍顾问姓名\\n,if(b.sub_org_id is null,a.sub_org_id,b.sub_org_id) sub_org_id   --机构id\\n,if(b.org_id is null,a.org_id,b.org_id) org_id   --集团id\\n,b.intentional_type  as intentional_type     --当前意向类型\\n,a.create_time       as adviser_time         --咨询时间\\n,b.assess_status    as assess_status       --评估状态\\n,b.create_time      as regist_time       -- 意向客户录入时间\\nfrom \\n(select \\n advisory_customer_id    --咨询客户id\\n,customer_name           --客户姓名\\n,sex                     --客户性别\\n,sales_consultant_id     --会籍顾问id\\n,sales_consultant_name   --会籍顾问姓名\\n,sub_org_id              --机构id\\n,org_id                  --集团id\\n,create_time             --咨询时间\\nfrom db_ods_hr.clife_hr_ods_advisory_customer where part_date=regexp_replace(date_sub(current_date(),1),'-','') and status=1\\n) a \\nfull join \\n(\\nselect \\nintention_customer_id           --意向客户id\\n,old_man_id                     --老人id\\n,customer_name                  --客户姓名\\n,sex                            --性别\\n,sales_consultant_id            --会籍顾问id\\n,sales_consultant_name          --会籍顾问姓名\\n,intentional_type               --当前意向类型\\n,linked_advisory_customer_id    --关联咨询客户id\\n,sub_org_id                     --机构id\\n,org_id                         --集团id\\n,assess_status           --评估状态\\n,create_time             -- 意向客户录入时间\\nfrom \\ndb_ods_hr.clife_hr_ods_intention_customer where part_date=regexp_replace(date_sub(current_date(),1),'-','') and status=1\\n) b \\non a.advisory_customer_id=b.linked_advisory_customer_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_customer_pension_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-61334\",\"name\":\"drop_clife_hr_customer_pension_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists  db_dw_hr.clife_hr_customer_pension_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[]},{\"type\":\"SQL\",\"id\":\"tasks-51518\",\"name\":\"clife_hr_customer_pension_his_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":95,\"sql\":\"-- 2.初次意向、评估时间、发起入住通知时间从历史表拿\\ncreate table if not exists db_dw_hr.clife_hr_customer_pension_his_tmp stored as parquet as \\nselect\\nt.intention_customer_id \\n,t.intentional_type   as first_intention_type\\n,t1.assess_time\\n,t2.ask_check_in_time\\nfrom \\n(\\nselect \\na1.intention_customer_id\\n,a1.intentional_type\\nfrom \\n(\\nselect \\nintention_customer_id\\n,intentional_type\\n,row_number() over(partition by intention_customer_id order by op_time) as rank\\nfrom db_zip_campus.clife_hr_ods_intention_customer_his a \\nwhere part_date<=regexp_replace(date_sub(current_date(),1),'-','')\\n) a1 where a1.rank=1) t\\nleft join (\\nselect \\nintention_customer_id\\n,concat_ws(',',collect_list(op_time)) as assess_time\\nfrom db_zip_campus.clife_hr_ods_intention_customer_his a \\nwhere part_date<=regexp_replace(date_sub(current_date(),1),'-','') and assess_status=1\\ngroup by a.intention_customer_id\\n) t1\\non t.intention_customer_id=t1.intention_customer_id\\nleft join \\n(\\nselect \\na1.intention_customer_id\\n,unix_timestamp(a1.op_time)   as ask_check_in_time\\nfrom \\n(\\nselect \\nintention_customer_id\\n,op_time\\n,row_number() over(partition by intention_customer_id order by op_time) as rank\\nfrom db_zip_campus.clife_hr_ods_intention_customer_his a \\nwhere part_date<=regexp_replace(date_sub(current_date(),1),'-','') and assess_status=4\\n) a1 where a1.rank=1\\n) t2\\non t.intention_customer_id=t2.intention_customer_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_customer_pension_his_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-84882\",\"name\":\"drop_clife_hr_customer_pension_his_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_customer_pension_his_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_customer_pension_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-60334\",\"name\":\"clife_hr_customer_pension_assess_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"create table if not exists db_dw_hr.clife_hr_customer_pension_assess_tmp stored as parquet as \\nselect \\n old_man_id     --老人id\\n,concat_ws(',',collect_list(cast(assess_report_id as string))) as assess_report_ids \\n,count(assess_report_id) as assess_cnt\\nfrom db_ods_hr.clife_hr_ods_assess_report where part_date=regexp_replace(date_sub(current_date(),1),'-','') and state=1\\ngroup by old_man_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_customer_pension_assess_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-8322\",\"name\":\"drop_clife_hr_customer_pension_assess_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_customer_pension_assess_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_customer_pension_his_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-29394\",\"name\":\"clife_hr_customer_pension_remind_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"create table if not exists db_dw_hr.clife_hr_customer_pension_remind_tmp stored as parquet as \\nselect \\n a.customer_id\\n,a.return_visit_remind_time as remind_visit_time\\nfrom \\n(select \\n customer_id     --客户id\\n,return_visit_remind_time    --回访提醒时间\\n,row_number() over(partition by customer_id order by return_visit_remind_time desc) as rank \\nfrom db_ods_hr.clife_hr_ods_customer_visit_record where part_date=regexp_replace(date_sub(current_date(),1),'-','') and status=1) a\\nwhere rank=1 \",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_customer_pension_remind_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-55579\",\"name\":\"drop_clife_hr_customer_pension_remind_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_customer_pension_remind_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_customer_pension_assess_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-66149\",\"name\":\"clife_hr_customer_pension_visit_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"create table if not exists db_dw_hr.clife_hr_customer_pension_visit_tmp stored as parquet as  \\nselect \\n a.customer_id     --客户id\\n,concat_ws(',',collect_list(a.visit_date)) as visit_time\\n,count(a.visit_id)  as visit_cnt\\nfrom \\n(\\nselect \\ncustomer_id\\n,from_unixtime(cast(visit_date as int),'yyyy-MM-dd HH:mm:ss')  as visit_date\\n,visit_id\\nfrom \\ndb_ods_hr.clife_hr_ods_customer_visit_record where part_date=regexp_replace(date_sub(current_date(),1),'-','') and status=1\\n) a \\ngroup by a.customer_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_customer_pension_visit_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-78649\",\"name\":\"drop_clife_hr_customer_pension_visit_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_customer_pension_visit_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_customer_pension_remind_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-35971\",\"name\":\"clife_hr_customer_pension_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"create table if not exists db_dw_hr.clife_hr_customer_pension_info_tmp stored as parquet as\\nselect\\n a.advisory_customer_id  as advisory_customer_id               --  '咨询客户id'\\n,a.intention_customer_id  as intention_customer_id              --  '意向客户id'\\n,a.old_man_id  as old_man_id                         --  '老人id'\\n,a.name  as name                               --  '客户姓名'\\n,a.sex as sex                                --  '性别'\\n,cast(null as bigint) as room_id                            --  '房间id'\\n,cast(null as int) as pre_membership_id                  --  '预申请会籍id'\\n,cast(null as int) as membership_id                      --  '会籍id'\\n,c.assess_report_ids as assess_report_ids                  --  '评估报告id'\\n,cast(null as bigint)  as deposit_id                         --  '定金合同id'\\n,cast(null as bigint)  as sign_id                            --  '签约合同id'\\n,cast(null as string) as membership_owner_ids               --  '权益人id'\\n,cast(null as string) as transfor_to_ids                    --  '转让人id'\\n,cast(null as string) as transfor_from_ids                  --  '继承人id'\\n,cast(null as string) as trade_channel_ids                  --  '渠道id'\\n,cast(null as int) as product_id                         --  '会籍卡产品id'\\n,cast(null as int) as card_id                            --  '会籍卡id'\\n,cast(null as bigint) as nursing_homes_id                   --  '养老院id'\\n,cast(null as string) as nursing_homes_name                 --  '养老院名称'\\n,a.sub_org_id as sub_org_id                         --  '养老机构id'\\n,d.sub_org_name as sub_org_name                       --  '养老机构名称'\\n,a.org_id as org_id                             --  '集团id'\\n,d.org_name as org_name                           --  '集团名称'\\n,d.area_id as  area_id                            --  '区域id'\\n,a.membership_adviser_id as membership_adviser_id              --  '会籍顾问id'\\n,a.membership_adviser_name as membership_adviser_name            --  '会籍顾问姓名'\\n,a.adviser_time  as  adviser_time                       --  '咨询时间'\\n,a.regist_time as regist_time                       -- '意向客户录入时间'\\n,f.visit_time as visit_time                         --  '回访时间'\\n,b.assess_time as assess_time                        --  '评估时间'\\n,b.ask_check_in_time as ask_check_in_time                  --  '发起入住通知时间'\\n,cast(null as timestamp) as apply_time                         --  '申请签约时间'\\n,cast(null as timestamp) as deposit_time                       --  '下定时间'\\n,cast(null as timestamp) as sign_time                          --  '签约时间'\\n,cast(null as timestamp) as transfor_to_time                   --  '转让时间'\\n,cast(null as timestamp) as transfor_from_time                 --  '继承时间'\\n,cast(null as timestamp) as withdraw_time                      --  '退会时间'\\n,b.first_intention_type as first_intention_type               --  '首次意向'\\n,a.intentional_type as intention_type                     --  '当前意向'\\n,cast(null as int) as room_type                          --  '关注房型'\\n,a.assess_status as assess_status                      --  '评估状态'\\n,0 as customer_type                      --  '客户类型'\\n,cast(null as int) as pay_type_id                        --  '支付方式'\\n,f.visit_cnt  as visit_cnt                         --  '回访次数'\\n,e.remind_visit_time as remind_visit_time                  --  '回访提醒时间'\\n,c.assess_cnt as assess_cnt                         --  '评估次数'\\n,0 as deposit_amount                     --  '定金金额'\\n,0 as receivable_amount                  --  '应收金额'\\n,0 as received_amount                    --  '已收金额'\\n,0 as received_installment_amount        --  '已收分期金额'\\n,0 as received_occupancy_amount          --  '已收占用费'\\n,cast(null as int) as card_valid                         --  '卡有效期(年)'\\n,0 as membership_amount                  --  '会籍费'\\n,0 as overdue_amount                     --  '滞纳金'\\n,0 as received_overdue_amount            --  '已收滞纳金'\\n,0 as other_amount                       --  '其他费用'\\n,0 as manager_amount                     --  '管理费'\\n,cast(null as int) as living_limit                       --  '居住期限（月）'\\n,0 as trust_amount                       --  '托管费' \\n,0 as membership_discount_amount         --  '会籍优惠价' \\n,cast(null as int) as free_visit_day                     --  '免费探访天数' \\n,0 as card_amount                        --  '卡费'\\n,0 as card_manager_amount                --  '卡管理费' \\n,0 as other_transfor_to_amount           --  '其他转让费' \\n,0 as transfor_to_amount                 --  '转让费' \\n,cast(null as int) as transfor_to_type                   --  '转让类型' \\n,0 as other_transfor_from_amount         --  '其他继承费' \\n,0 as transfor_from_amount               --  '继承费'\\n,cast(null as int) as transfor_from_type                 --  '继承类型' \\n,0 as remain_day                         --  '退会剩余天数' \\n,0 as cancle_fee_status                  --  '是否退会费' \\n,cast(null as int) as premium_type                       --  '退会类型' \\n,0 as withdraw_amount                    --  '退会金额' \\n,cast(null as bigint) as floor_id                            --  '楼层id'\\n,cast(null as bigint) as building_id                            --  '楼栋id'\\n,cast(null as int) as card_type                           --  '卡类型'\\n,cast(null as string) as card_name                           --  '卡名称'\\n,g.area_name as area_name                           --  '区域名称'\\nfrom \\ndb_dw_hr.clife_hr_customer_pension_tmp a \\nleft join \\ndb_dw_hr.clife_hr_customer_pension_his_tmp b \\non a.intention_customer_id=b.intention_customer_id \\nleft join \\ndb_dw_hr.clife_hr_customer_pension_assess_tmp c\\non a.old_man_id=c.old_man_id\\nleft join \\t\\ndb_dw_hr.clife_hr_dim_admin_sub_org d\\non a.sub_org_id=d.sub_org_id  and d.part_date=regexp_replace(date_sub(current_date(),1),'-','') and d.status=1\\nleft join \\ndb_dw_hr.clife_hr_customer_pension_remind_tmp e \\non a.intention_customer_id=e.customer_id\\nleft join \\ndb_dw_hr.clife_hr_customer_pension_visit_tmp  f\\non a.intention_customer_id=f.customer_id\\nleft join db_dw_hr.clife_hr_dim_geographic_info  g\\non d.area_id = g.area_id and g.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.strict.checks.cartesian.product=false;hive.mapred.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_customer_pension_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-20452\",\"name\":\"drop_clife_hr_customer_pension_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_customer_pension_info_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_customer_pension_visit_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-67184\",\"name\":\"clife_hr_customer_crm_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"create table if not exists db_dw_hr.clife_hr_customer_crm_tmp stored as parquet as \\nselect \\n a.customer_id as intention_customer_id    --意向客户id\\n,a.name        as name                     --客户姓名\\n,case when a.sex_option=40054 then 0 when a.sex_option=40055 then 1 else null end as sex   --性别\\n,a.intentional_type  as  intentional_type  --当前意向类型\\n,a.membership_adviser_id  as membership_adviser_id   --会籍顾问id\\n,b.worker_name  as membership_adviser_name     --会籍顾问名称\\n,c.trade_channel_ids  as trade_channel_ids     --渠道id\\n,a.sub_org_id     as  sub_org_id               --机构id\\n,d.sub_org_name   as  sub_org_name             --机构名称\\n,a.org_id         as  org_id                   --集团名称\\n,d.org_name       as  org_name                 --集团名称\\n,d.area_id\\n,d.area           as area_name\\n,a.create_time    as  regist_time              --意向客户录入时间\\nfrom db_ods_hr.clife_hr_ods_intentional_customer a\\nleft join \\ndb_ods_hr.clife_hr_ods_worker_new b\\non a.membership_adviser_id=b.nurse_worker_id and  b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\n(\\nselect \\n customer_id     --意向客户id\\n,concat_ws(',',collect_set(cast(channel_id as string))) as trade_channel_ids   --渠道ids\\nfrom \\ndb_ods_hr.clife_hr_ods_intentional_customer_channel\\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','')\\ngroup by customer_id\\n) c \\non a.customer_id=c.customer_id\\nleft join \\ndb_dw_hr.clife_hr_dim_admin_sub_org d\\non a.sub_org_id=d.sub_org_id  and d.part_date=regexp_replace(date_sub(current_date(),1),'-','') and d.status=1\\nwhere a.part_date=regexp_replace(date_sub(current_date(),1),'-','') and a.del_flag=0\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_customer_crm_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-39666\",\"name\":\"drop_clife_hr_customer_crm_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_customer_crm_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_customer_pension_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-31710\",\"name\":\"clife_hr_customer_crm_his_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":95,\"sql\":\"create table if not exists db_dw_hr.clife_hr_customer_crm_his_tmp stored as parquet as \\nselect \\na1.intention_customer_id\\n,a1.intentional_type  as first_intention_type\\nfrom \\n(\\nselect \\ncustomer_id as intention_customer_id\\n,intentional_type\\n,row_number() over(partition by customer_id order by op_time) as rank\\nfrom db_zip_campus.clife_hr_ods_intentional_customer_his a \\nwhere part_date<=regexp_replace(date_sub(current_date(),1),'-','')\\n) a1 where a1.rank=1\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_customer_crm_his_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-844\",\"name\":\"drop_clife_hr_customer_crm_his_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_customer_crm_his_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_customer_crm_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-72162\",\"name\":\"clife_hr_customer_crm_visit_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"create table if not exists db_dw_hr.clife_hr_customer_crm_visit_tmp stored as parquet as  \\nselect \\n customer_id     --客户id\\n,concat_ws(',',collect_list(from_unixtime( cast(visit_date as int),'yyyy-MM-dd HH:mm:ss'))) as visit_time\\n,count(visit_id)  as visit_cnt\\nfrom db_ods_hr.clife_hr_ods_intentional_customer_visit where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\ngroup by customer_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_customer_crm_visit_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-76206\",\"name\":\"drop_clife_hr_customer_crm_visit_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_customer_crm_visit_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_customer_crm_his_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-47563\",\"name\":\"clife_hr_customer_crm_remind_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"create table if not exists db_dw_hr.clife_hr_customer_crm_remind_tmp stored as parquet as \\nselect \\n a.customer_id\\n,a.return_visit_remind_time as remind_visit_time\\nfrom \\n(select \\n customer_id     --客户id\\n,return_visit_remind_time    --回访提醒时间\\n,row_number() over(partition by customer_id order by return_visit_remind_time desc) as rank \\nfrom db_ods_hr.clife_hr_ods_intentional_customer_visit where part_date=regexp_replace(date_sub(current_date(),1),'-','') ) a\\nwhere rank=1\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_customer_crm_remind_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-42713\",\"name\":\"drop_clife_hr_customer_crm_remind_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_customer_crm_remind_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_customer_crm_visit_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-83189\",\"name\":\"clife_hr_customer_crm_deposit_sign_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"create table if not exists db_dw_hr.clife_hr_customer_crm_deposit_sign_tmp stored as parquet as\\nselect\\n     tmp.intention_customer_id              --  '意向客户id'\\n    ,tmp.room_id                            --  '房间id'\\n    ,tmp.membership_id                      --  '会籍id'\\n    ,tmp.deposit_id                         --  '定金合同id'\\n    ,tmp.sign_id                            --  '签约合同id'\\n    ,e.membership_owner_ids as membership_owner_ids    -- '权益人id'\\n    ,case when c.type =1 then c.pre_transfer_owners else null end as transfor_to_ids                    --  '转让人id'\\n    ,case when c.type =2 then c.pre_transfer_owners else null end as transfor_from_ids                  --  '继承人id'\\n    ,tmp.product_id                         --  '会籍卡产品id'\\n    ,f.card_id as card_id                            --  '会籍卡id'\\n    ,g.nursing_homes_id as nursing_homes_id                   --  '养老院id'\\n    ,j.nursing_homes_name as nursing_homes_name                 --  '养老院名称'\\n    ,j.sub_org_id as sub_org_id                         --  '养老机构id'\\n    ,j.sub_org_name as sub_org_name                       --  '养老机构名称'\\n    ,j.org_id as org_id                             --  '集团id'\\n    ,j.org_name as org_name                           --  '集团名称'\\n    ,j.area_id as  area_id                            --  '区域id'\\n    ,tmp.apply_id      --'预申请id'\\n    ,tmp.deposit_time                       --  '下定时间'\\n    ,tmp.sign_time                          --  '签约时间'\\n    ,case when c.type =1 then c.create_time else null end   as transfor_to_time                   --  '转让时间'\\n    ,case when c.type =2 then c.create_time else null end  as transfor_from_time                 --  '继承时间'\\n    ,unix_timestamp(d.create_time) as withdraw_time                      --  '退会时间'\\n    ,tmp.room_type                          --  '关注房型'  0单人间，1双人间，2小两房一厅 3一房一厅 4大两房一厅  5VIP单人间  6套间  7VIP套间   8两房一厅\\n    ,1 as customer_type                      --  '客户类型'\\n    ,tmp.deposit_amount                     --  '定金金额'\\n    ,tmp.card_valid                         --  '卡有效期(年)'\\n    ,tmp.membership_amount                  --  '会籍费'\\n    ,tmp.other_amount                       --  '其他费用'\\n    ,tmp.manager_amount                     --  '管理费'\\n    ,tmp.living_limit                       --  '居住期限（月）'\\n    ,tmp.trust_amount                       --  '托管费' \\n    ,tmp.membership_discount_amount         --  '会籍优惠价' \\n    ,tmp.free_visit_day                     --  '免费探访天数' \\n    ,f.card_fee as card_amount                        --  '卡费'\\n    ,f.manager_fee as card_manager_amount                --  '卡管理费'\\n    ,case when c.type =1 then c.other_amount else null end  as other_transfor_to_amount           --  '其他转让费' \\n    ,case when c.type =1 then c.transfer_fee else null end  as transfor_to_amount                 --  '转让费' \\n    ,case when c.type =1 then c.transfer_nature else null end  as transfor_to_type                   --  '转让类型' \\n    ,case when c.type =2 then c.other_amount else null end as other_transfor_from_amount         --  '其他继承费' \\n    ,case when c.type =2 then c.transfer_fee else null end as transfor_from_amount               --  '继承费'\\n    ,case when c.type =2 then c.transfer_nature else null end as transfor_from_type                 --  '继承类型' \\n    ,d.remain_day as remain_day                         --  '退会剩余天数' \\n    ,d.cancle_fee_status as cancle_fee_status                  --  '是否退会费' \\n    ,d.premium_type as premium_type                       --  '退会类型'  \\n    ,tmp.user_id   --'账户id'\\n    ,g.floor_id\\n    ,g.building_id\\n    ,h.type  as card_type\\n    ,h.card_name\\n    ,i.area_name\\n    ,tmp.contract_status\\nfrom (\\n    select \\n         if(b.intent_user_id is null,a.intent_user_id,b.intent_user_id)  as intention_customer_id             \\n        ,if(b.room_id is null,a.room_id,b.room_id) as room_id                            \\n        ,if(b.membership_id is null,a.membership_id,b.membership_id) as membership_id \\n        ,a.deposit_id  as deposit_id \\n        ,b.sign_id\\n        ,b.product_id\\n        ,if(b.apply_id is null,a.apply_id,b.apply_id) as apply_id \\n        ,a.create_time as deposit_time \\n        ,b.create_time as sign_time       \\n        ,case when b.house_type=40066 then 0\\n              when b.house_type=40067 then 1\\n              when b.house_type=40068 then 2\\n              when b.house_type=40069 then 3\\n              when b.house_type=40095 then 4\\n              when b.house_type=40096 then 5\\n              when b.house_type=40097 then 6\\n              when b.house_type=40098 then 7\\n              when b.house_type=40277 then 8\\n              else null end as room_type  \\n        ,a.deposit_amount as deposit_amount \\n        ,b.card_valid as card_valid                          \\n        ,b.membership_amount as membership_amount            \\n        ,b.other_amount as other_amount                      \\n        ,b.manager_fee as manager_amount                     \\n        ,b.living_limit as living_limit                      \\n        ,b.trust_fee as trust_amount                         \\n        ,b.membership_discount as membership_discount_amount \\n        ,b.free_visit_day as free_visit_day   \\n        ,if(b.user_id is null,a.user_id,b.user_id)  as user_id   --'账户id'\\n        ,b.contract_status\\n    from (\\n        select \\n             intent_user_id\\n            ,room_id\\n            ,membership_id\\n            ,deposit_id\\n            ,apply_id\\n            ,create_time\\n            ,deposit_amount\\n            ,deposit_num\\n            ,user_id\\n        from db_ods_hr.clife_hr_ods_contract_deposit t\\n        where t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and t.deposit_status=1\\n    ) a \\n    full join \\n    (\\n        select \\n             intent_user_id\\n            ,room_id\\n            ,membership_id\\n            ,sign_id\\n            ,product_id\\n            ,apply_id\\n            ,create_time\\n            ,house_type\\n            ,card_valid\\n            ,membership_amount\\n            ,other_amount\\n            ,manager_fee\\n            ,living_limit\\n            ,trust_fee\\n            ,membership_discount\\n            ,free_visit_day\\n            ,user_id\\n            ,contract_status\\n            ,deposit_num\\n            ,deposit_amount\\n        from db_ods_hr.clife_hr_ods_contract_sign t1\\n        where part_date=regexp_replace(date_sub(current_date(),1),'-','') and contract_status=1\\n    ) b\\n    on a.intent_user_id=b.intent_user_id and a.deposit_num=b.deposit_num and a.deposit_amount=b.deposit_amount\\n) tmp\\nleft join \\n(\\nselect * from \\ndb_ods_hr.clife_hr_ods_membership_transfer\\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','') and del_flag=0\\n) c \\non tmp.sign_id=c.pre_contract_id\\nleft join \\n(\\nselect * from \\ndb_ods_hr.clife_hr_ods_membership_withdraw\\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','') and del_flag=0\\n) d\\non tmp.sign_id=d.contract_id\\nleft join\\n(select contract_id,concat_ws(',',collect_set(cast(id as string))) as membership_owner_ids  from \\ndb_ods_hr.clife_hr_ods_membership_owner\\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','')\\ngroup by contract_id\\n) e \\non tmp.sign_id=e.contract_id\\nleft join \\n(\\nselect * from \\ndb_ods_hr.clife_hr_ods_card_product  \\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','') and del_flag=0\\n) f\\non tmp.product_id=f.product_id\\nleft join \\n(select * from \\ndb_dw_hr.clife_hr_dim_location_room  \\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n) g on \\ntmp.room_id=g.room_id\\nleft join \\n(select * from \\ndb_dw_hr.clife_hr_dim_card  \\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','') and del_flag=0) h\\non f.card_id=h.card_id\\nleft join \\ndb_dw_hr.clife_hr_dim_nursing_home  j\\non g.nursing_homes_id=j.nursing_homes_id and j.status=1 and j.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_dw_hr.clife_hr_dim_geographic_info i\\non j.area_id=i.area_id and i.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"spark.shuffle.partitions=100;spark.executor.memory=5G;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_customer_crm_deposit_sign_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-12272\",\"name\":\"clife_hr_customer_crm_apply_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"create table if not exists db_dw_hr.clife_hr_customer_crm_apply_tmp stored as parquet as\\nselect \\na.intention_customer_id              --  '意向客户id'\\n,a.room_id                            --  '房间id'\\n,b.membership_id as pre_membership_id                  --  '预申请会籍id'\\n,a.membership_id                      --  '会籍id'\\n,a.deposit_id                         --  '定金合同id'\\n,a.sign_id                            --  '签约合同id'\\n,a.membership_owner_ids               --  '权益人id'\\n,a.transfor_to_ids                    --  '转让人id'\\n,a.transfor_from_ids                  --  '继承人id'\\n,a.product_id                         --  '会籍卡产品id'\\n,a.card_id                            --  '会籍卡id'\\n,a.nursing_homes_id                   --  '养老院id'\\n,a.nursing_homes_name                 --  '养老院名称'\\n,a.sub_org_id                         --  '养老机构id'\\n,a.sub_org_name                       --  '养老机构名称'\\n,a.org_id                             --  '集团id'\\n,a.org_name                           --  '集团名称'\\n,a.area_id                            --  '区域id'\\n,b.create_time as apply_time                         --  '申请签约时间'\\n,a.deposit_time                       --  '下定时间'\\n,a.sign_time                          --  '签约时间'\\n,a.transfor_to_time                   --  '转让时间'\\n,a.transfor_from_time                 --  '继承时间'\\n,a.withdraw_time                      --  '退会时间'\\n,a.room_type                          --  '关注房型'\\n,a.customer_type                      --  '客户类型'\\n,a.deposit_amount                     --  '定金金额'\\n,a.card_valid                         --  '卡有效期(年)'\\n,a.membership_amount                  --  '会籍费'\\n,a.other_amount                       --  '其他费用'\\n,a.manager_amount                     --  '管理费'\\n,a.living_limit                       --  '居住期限（月）'\\n,a.trust_amount                       --  '托管费' \\n,a.membership_discount_amount         --  '会籍优惠价' \\n,a.free_visit_day                     --  '免费探访天数'\\n,a.card_amount                        --  '卡费'\\n,a.card_manager_amount                --  '卡管理费' \\n,a.other_transfor_to_amount           --  '其他转让费' \\n,a.transfor_to_amount                 --  '转让费' \\n,a.transfor_to_type                   --  '转让类型' \\n,a.other_transfor_from_amount         --  '其他继承费' \\n,a.transfor_from_amount               --  '继承费'\\n,a.transfor_from_type                 --  '继承类型' \\n,a.remain_day                         --  '退会剩余天数' \\n,a.cancle_fee_status                  --  '是否退会费' \\n,a.premium_type                       --  '退会类型' \\n,a.user_id                            --  '账户id'\\n,a.floor_id\\n,a.building_id\\n,a.card_type\\n,a.card_name\\n,a.area_name\\n,a.contract_status\\nfrom  \\ndb_dw_hr.clife_hr_customer_crm_deposit_sign_tmp a \\nleft join \\ndb_ods_hr.clife_hr_ods_membership_apply b \\non a.apply_id=b.apply_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','') and b.del_flag=0\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_customer_crm_apply_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-70271\",\"name\":\"drop_clife_hr_customer_crm_apply_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_customer_crm_apply_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_customer_crm_deposit_sign_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-12405\",\"name\":\"clife_hr_customer_crm_fee_detail_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"create table if not exists db_dw_hr.clife_hr_customer_crm_fee_detail_tmp stored as parquet as\\nselect \\n t.sign_id   -- 合同编号\\n,sum(t.receivable_amount) as receivable_amount  --  '应收金额'\\n,sum(t.received_amount) as  received_amount  --  '已收金额'\\n,sum(t.received_installment_amount) as received_installment_amount    --  '已收分期金额'\\n,sum(t.received_occupancy_amount) as received_occupancy_amount  --  '已收占用费'\\n,sum(t.overdue_amount)  as overdue_amount   --'滞纳金'\\n,sum(t.received_overdue_amount) as received_overdue_amount    --  '已收滞纳金'\\n,sum(t.withdraw_amount) as withdraw_amount  --  '退会金额' \\nfrom \\n(\\nselect \\n relation_id as sign_id   -- 合同编号\\n,b.confirm_amount as receivable_amount  --  '应收金额'\\n,case when b.status=1 then b.confirm_amount else 0 end as received_amount  --  '已收金额'\\n,b.stage_sum  as received_installment_amount    --  '已收分期金额'\\n,b.occupation_sum  as received_occupancy_amount  --  '已收占用费'\\n,b.overdue_fine as overdue_amount      --'滞纳金'\\n,b.overdue_sum as received_overdue_amount    --  '已收滞纳金'\\n,case when a.type=4 then b.confirm_amount else 0 end as withdraw_amount  --  '退会金额' \\nfrom \\ndb_ods_hr.clife_hr_ods_fee a \\nleft join \\ndb_ods_hr.clife_hr_ods_fee_detail b\\non a.fee_id=b.fee_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','') \\nwhere a.part_date=regexp_replace(date_sub(current_date(),1),'-','') and a.del_flag=0\\n) t\\ngroup by t.sign_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_customer_crm_fee_detail_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-93820\",\"name\":\"drop_clife_hr_customer_crm_fee_detail_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_customer_crm_fee_detail_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_customer_crm_apply_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-41819\",\"name\":\"clife_hr_customer_crm_fee_type_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"create table if not exists db_dw_hr.clife_hr_customer_crm_fee_type_tmp stored as parquet as\\nselect \\n t.sign_id   -- 合同编号\\n,max(pay_type_id) as pay_type_id  --支付方式  0刷卡，1现金，2微信，3支付宝，4其他\\nfrom \\n(\\nselect \\n a.relation_id as sign_id   -- 合同编号\\n,case when a.receive_type_option=40090 then 0 \\n      when a.receive_type_option=40091 then 1 \\n\\t  when a.receive_type_option=40092 then 2 \\n\\t  when a.receive_type_option=40093 then 3 \\n\\t  when a.receive_type_option=40094 then 4\\n      else null end pay_type_id\\t  \\nfrom \\ndb_ods_hr.clife_hr_ods_fee a \\nwhere a.part_date=regexp_replace(date_sub(current_date(),1),'-','') and a.del_flag=0\\n) t\\ngroup by t.sign_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_customer_crm_fee_type_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-66130\",\"name\":\"drop_clife_hr_customer_crm_fee_type_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_customer_crm_fee_type_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_customer_crm_fee_detail_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-21788\",\"name\":\"clife_hr_customer_crm_sign_fee_detail_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"create table if not exists db_dw_hr.clife_hr_customer_crm_sign_fee_detail_tmp stored as parquet as\\nselect \\na.intention_customer_id              --  '意向客户id'\\n,a.room_id                            --  '房间id'\\n,a.pre_membership_id                  --  '预申请会籍id'\\n,a.membership_id                      --  '会籍id'\\n,a.deposit_id                         --  '定金合同id'\\n,a.sign_id                            --  '签约合同id'\\n,a.membership_owner_ids               --  '权益人id'\\n,a.transfor_to_ids                    --  '转让人id'\\n,a.transfor_from_ids                  --  '继承人id'\\n,a.product_id                         --  '会籍卡产品id'\\n,a.card_id                            --  '会籍卡id'\\n,a.nursing_homes_id                   --  '养老院id'\\n,a.nursing_homes_name                 --  '养老院名称'\\n,a.sub_org_id                         --  '养老机构id'\\n,a.sub_org_name                       --  '养老机构名称'\\n,a.org_id                             --  '集团id'\\n,a.org_name                           --  '集团名称'\\n,a.area_id                            --  '区域id'\\n,a.apply_time                         --  '申请签约时间'\\n,a.deposit_time                       --  '下定时间'\\n,a.sign_time                          --  '签约时间'\\n,a.transfor_to_time                   --  '转让时间'\\n,a.transfor_from_time                 --  '继承时间'\\n,a.withdraw_time                      --  '退会时间'\\n,a.room_type                          --  '关注房型'\\n,a.customer_type                      --  '客户类型'\\n,a.deposit_amount                     --  '定金金额'\\n,b.receivable_amount  --  '应收金额'\\n,b.received_amount  --  '已收金额'\\n,b.received_installment_amount    --  '已收分期金额'\\n,b.received_occupancy_amount  --  '已收占用费'\\n,a.card_valid                         --  '卡有效期(年)'\\n,a.membership_amount                  --  '会籍费'\\n,b.overdue_amount   --'滞纳金'\\n,b.received_overdue_amount    --  '已收滞纳金'\\n,a.other_amount                       --  '其他费用'\\n,a.manager_amount                     --  '管理费'\\n,a.living_limit                       --  '居住期限（月）'\\n,a.trust_amount                       --  '托管费' \\n,a.membership_discount_amount         --  '会籍优惠价' \\n,a.free_visit_day                     --  '免费探访天数'\\n,a.card_amount                        --  '卡费'\\n,a.card_manager_amount                --  '卡管理费' \\n,a.other_transfor_to_amount           --  '其他转让费' \\n,a.transfor_to_amount                 --  '转让费' \\n,a.transfor_to_type                   --  '转让类型' \\n,a.other_transfor_from_amount         --  '其他继承费' \\n,a.transfor_from_amount               --  '继承费'\\n,a.transfor_from_type                 --  '继承类型' \\n,a.remain_day                         --  '退会剩余天数' \\n,a.cancle_fee_status                  --  '是否退会费' \\n,a.premium_type                       --  '退会类型' \\n,b.withdraw_amount  --  '退会金额' \\n,a.user_id                            --  '账户id'\\n,a.floor_id\\n,a.building_id\\n,a.card_type\\n,a.card_name\\n,a.area_name\\n,c.pay_type_id                        --  '支付方式id'\\n,a.contract_status\\nfrom \\ndb_dw_hr.clife_hr_customer_crm_apply_tmp a \\nleft join \\ndb_dw_hr.clife_hr_customer_crm_fee_detail_tmp b \\non a.sign_id=b.sign_id\\nleft join \\ndb_dw_hr.clife_hr_customer_crm_fee_type_tmp c \\non a.sign_id=c.sign_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_customer_crm_sign_fee_detail_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-50087\",\"name\":\"drop_clife_hr_customer_crm_sign_fee_detail_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_customer_crm_sign_fee_detail_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_customer_crm_fee_type_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-48575\",\"name\":\"clife_hr_customer_crm_old_man_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"create table if not exists db_dw_hr.clife_hr_customer_crm_old_man_tmp stored as parquet as\\nselect\\na.*,\\nc.old_man_id      -- '老人id'\\n,d.assess_report_ids   --'评估报告id'\\n,d.assess_cnt          -- '评估次数'\\nfrom \\ndb_dw_hr.clife_hr_customer_crm_sign_fee_detail_tmp  a \\nleft join db_ods_hr.clife_hr_ods_account_account  b \\non a.user_id = b.account_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','') and b.status=1\\nleft join db_ods_hr.clife_hr_ods_old_man_extend  c \\non b.phone=c.linkman_phone and c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_dw_hr.clife_hr_customer_pension_assess_tmp d \\non c.old_man_id=d.old_man_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_customer_crm_old_man_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-33130\",\"name\":\"drop_clife_hr_customer_crm_old_man_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_customer_crm_old_man_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_customer_crm_sign_fee_detail_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-69030\",\"name\":\"clife_hr_customer_crm_base_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"create table if not exists db_dw_hr.clife_hr_customer_crm_base_info_tmp stored as parquet as\\nselect \\n a.intention_customer_id --意向客户id\\n,a.name        as name                     --客户姓名\\n,a.sex   --性别\\n,a.intentional_type  as  intentional_type  --当前意向类型\\n,a.membership_adviser_id  as membership_adviser_id   --会籍顾问id\\n,a.membership_adviser_name     --会籍顾问名称\\n,a.trade_channel_ids     --渠道id\\n,b.first_intention_type    -- 首次意向\\n,a.regist_time             --意向客户录入时间\\n,c.visit_time              --回访时间\\n,c.visit_cnt               --回访次数\\n,d.remind_visit_time       --提醒回访时间\\n,a.sub_org_id               --机构id\\n,a.sub_org_name             --机构名称\\n,a.org_id                   --集团名称\\n,a.org_name                 --集团名称\\n,a.area_id\\n,a.area_name\\nfrom\\ndb_dw_hr.clife_hr_customer_crm_tmp a \\nleft join \\ndb_dw_hr.clife_hr_customer_crm_his_tmp b \\non a.intention_customer_id=b.intention_customer_id\\nleft join \\ndb_dw_hr.clife_hr_customer_crm_visit_tmp c \\non a.intention_customer_id=c.customer_id\\nleft join \\ndb_dw_hr.clife_hr_customer_crm_remind_tmp  d \\non a.intention_customer_id=d.customer_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_customer_crm_base_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-79353\",\"name\":\"drop_clife_hr_customer_crm_base_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_customer_crm_base_info_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_customer_crm_old_man_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-70557\",\"name\":\"clife_hr_customer_crm_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"create table if not exists db_dw_hr.clife_hr_customer_crm_info_tmp stored as parquet as\\nselect \\na.*\\n,b.room_id                            --  '房间id'\\n,b.pre_membership_id                  --  '预申请会籍id'\\n,b.membership_id                      --  '会籍id'\\n,b.deposit_id                         --  '定金合同id'\\n,b.sign_id                            --  '签约合同id'\\n,b.membership_owner_ids               --  '权益人id'\\n,b.transfor_to_ids                    --  '转让人id'\\n,b.transfor_from_ids                  --  '继承人id'\\n,b.product_id                         --  '会籍卡产品id'\\n,b.card_id                            --  '会籍卡id'\\n,b.nursing_homes_id                   --  '养老院id'\\n,b.nursing_homes_name                 --  '养老院名称'\\n,b.apply_time                         --  '申请签约时间'\\n,b.deposit_time                       --  '下定时间'\\n,b.sign_time                          --  '签约时间'\\n,b.transfor_to_time                   --  '转让时间'\\n,b.transfor_from_time                 --  '继承时间'\\n,b.withdraw_time                      --  '退会时间'\\n,b.room_type                          --  '关注房型'\\n,b.customer_type                      --  '客户类型'\\n,b.deposit_amount                     --  '定金金额'\\n,b.receivable_amount  --  '应收金额'\\n,b.received_amount  --  '已收金额'\\n,b.received_installment_amount    --  '已收分期金额'\\n,b.received_occupancy_amount  --  '已收占用费'\\n,b.card_valid                         --  '卡有效期(年)'\\n,b.membership_amount                  --  '会籍费'\\n,b.overdue_amount   --'滞纳金'\\n,b.received_overdue_amount    --  '已收滞纳金'\\n,b.other_amount                       --  '其他费用'\\n,b.manager_amount                     --  '管理费'\\n,b.living_limit                       --  '居住期限（月）'\\n,b.trust_amount                       --  '托管费' \\n,b.membership_discount_amount         --  '会籍优惠价' \\n,b.free_visit_day                     --  '免费探访天数'\\n,b.card_amount                        --  '卡费'\\n,b.card_manager_amount                --  '卡管理费' \\n,b.other_transfor_to_amount           --  '其他转让费' \\n,b.transfor_to_amount                 --  '转让费' \\n,b.transfor_to_type                   --  '转让类型' \\n,b.other_transfor_from_amount         --  '其他继承费' \\n,b.transfor_from_amount               --  '继承费'\\n,b.transfor_from_type                 --  '继承类型' \\n,b.remain_day                         --  '退会剩余天数' \\n,b.cancle_fee_status                  --  '是否退会费' \\n,b.withdraw_amount  --  '退会金额' \\n,b.premium_type\\n,b.floor_id\\n,b.building_id\\n,b.card_type\\n,b.card_name\\n,b.pay_type_id                        --  '支付方式id'\\n,b.old_man_id\\n,b.assess_report_ids   --'评估报告id'\\n,b.assess_cnt          -- '评估次数'\\n,b.contract_status\\nfrom db_dw_hr.clife_hr_customer_crm_base_info_tmp  a \\nleft join \\ndb_dw_hr.clife_hr_customer_crm_old_man_tmp b\\non a.intention_customer_id=b.intention_customer_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_customer_crm_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-50302\",\"name\":\"drop_clife_hr_customer_crm_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_customer_crm_info_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_customer_crm_base_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-22381\",\"name\":\"clife_hr_dwd_market\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dwd_market partition(part_date) \\nselect\\nadvisory_customer_id               --  '咨询客户id'\\n,intention_customer_id              --  '意向客户id'\\n,old_man_id                         --  '老人id'\\n,name                               --  '客户姓名'\\n,sex                                --  '性别'\\n,room_id                            --  '房间id'\\n,pre_membership_id                  --  '预申请会籍id'\\n,membership_id                      --  '会籍id'\\n,assess_report_ids                  --  '评估报告id'\\n,deposit_id                         --  '定金合同id'\\n,sign_id                            --  '签约合同id'\\n,membership_owner_ids               --  '权益人id'\\n,transfor_to_ids                    --  '转让人id'\\n,transfor_from_ids                  --  '继承人id'\\n,trade_channel_ids                  --  '渠道id'\\n,product_id                         --  '会籍卡产品id'\\n,card_id                            --  '会籍卡id'\\n,nursing_homes_id                   --  '养老院id'\\n,nursing_homes_name                 --  '养老院名称'\\n,sub_org_id                         --  '养老机构id'\\n,sub_org_name                       --  '养老机构名称'\\n,org_id                             --  '集团id'\\n,org_name                           --  '集团名称'\\n,area_id                            --  '区域id'\\n,membership_adviser_id              --  '会籍顾问id'\\n,membership_adviser_name            --  '会籍顾问姓名'\\n,adviser_time                       --  '咨询时间'\\n,visit_time                         --  '回访时间'\\n,regist_time                        --  '意向客户录入时间'\\n,assess_time                        --  '评估时间'\\n,cast(ask_check_in_time as timestamp) as  ask_check_in_time                   --  '发起入住通知时间'\\n,apply_time                         --  '申请签约时间'\\n,deposit_time                       --  '下定时间'\\n,sign_time                          --  '签约时间'\\n,transfor_to_time                   --  '转让时间'\\n,transfor_from_time                 --  '继承时间'\\n,withdraw_time                      --  '退会时间'\\n,first_intention_type               --  '首次意向'\\n,intention_type                     --  '当前意向'\\n,room_type                          --  '关注房型'\\n,assess_status                      --  '评估状态'\\n,customer_type                      --  '客户类型'\\n,pay_type_id                        --  '支付方式'\\n,visit_cnt                          --  '回访次数'\\n,remind_visit_time                  --  '回访提醒时间'\\n,assess_cnt                         --  '评估次数'\\n,deposit_amount                     --  '定金金额'\\n,receivable_amount                  --  '应收金额'\\n,received_amount                    --  '已收金额'\\n,received_installment_amount        --  '已收分期金额'\\n,received_occupancy_amount          --  '已收占用费'\\n,card_valid                         --  '卡有效期(年)'\\n,membership_amount                  --  '会籍费'\\n,overdue_amount                     --  '滞纳金'\\n,received_overdue_amount            --  '已收滞纳金'\\n,other_amount                       --  '其他费用'\\n,manager_amount                     --  '管理费'\\n,living_limit                       --  '居住期限（月）'\\n,trust_amount                       --  '托管费' \\n,membership_discount_amount         --  '会籍优惠价' \\n,free_visit_day                     --  '免费探访天数' \\n,card_amount                        --  '卡费'\\n,card_manager_amount                --  '卡管理费' \\n,other_transfor_to_amount           --  '其他转让费' \\n,transfor_to_amount                 --  '转让费' \\n,transfor_to_type                   --  '转让类型' \\n,other_transfor_from_amount         --  '其他继承费' \\n,transfor_from_amount               --  '继承费'\\n,transfor_from_type                 --  '继承类型' \\n,remain_day                         --  '退会剩余天数' \\n,cancle_fee_status                  --  '是否退会费' \\n,premium_type                       --  '退会类型' \\n,withdraw_amount                    --  '退会金额' \\n,floor_id\\n,building_id\\n,card_type\\n,card_name\\n,area_name\\n,cast(null as int) as contract_status\\n,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_dw_hr.clife_hr_customer_pension_info_tmp \\nunion all \\nselect\\n cast(null as bigint) as advisory_customer_id               --  '咨询客户id'\\n,intention_customer_id              --  '意向客户id'\\n,old_man_id                         --  '老人id'\\n,name                               --  '客户姓名'\\n,sex                                --  '性别'\\n,room_id                            --  '房间id'\\n,pre_membership_id                  --  '预申请会籍id'\\n,membership_id                      --  '会籍id'\\n,assess_report_ids                  --  '评估报告id'\\n,deposit_id                         --  '定金合同id'\\n,sign_id                            --  '签约合同id'\\n,membership_owner_ids               --  '权益人id'\\n,transfor_to_ids                    --  '转让人id'\\n,transfor_from_ids                  --  '继承人id'\\n,trade_channel_ids                  --  '渠道id'\\n,product_id                         --  '会籍卡产品id'\\n,card_id                            --  '会籍卡id'\\n,nursing_homes_id                   --  '养老院id'\\n,nursing_homes_name                 --  '养老院名称'\\n,sub_org_id                         --  '养老机构id'\\n,sub_org_name                       --  '养老机构名称'\\n,org_id                             --  '集团id'\\n,org_name                           --  '集团名称'\\n,area_id                            --  '区域id'\\n,membership_adviser_id              --  '会籍顾问id'\\n,membership_adviser_name            --  '会籍顾问姓名'\\n,cast(null as timestamp) as adviser_time                       --  '咨询时间'\\n,visit_time                         --  '回访时间'\\n,regist_time                        --  '意向客户录入时间'\\n,cast(null as string) as assess_time                        --  '评估时间'\\n,cast(null as timestamp) as ask_check_in_time                  --  '发起入住通知时间'\\n,apply_time                         --  '申请签约时间'\\n,deposit_time                       --  '下定时间'\\n,sign_time                          --  '签约时间'\\n,transfor_to_time                   --  '转让时间'\\n,transfor_from_time                 --  '继承时间'\\n,cast(withdraw_time as timestamp) as  withdraw_time                        --  '退会时间'\\n,first_intention_type               --  '首次意向'\\n,intentional_type as intention_type                     --  '当前意向'\\n,room_type                          --  '关注房型'\\n,cast(null as int) asassess_status                      --  '评估状态'\\n,customer_type                      --  '客户类型'\\n,pay_type_id                        --  '支付方式'\\n,visit_cnt                          --  '回访次数'\\n,remind_visit_time                  --  '回访提醒时间'\\n,assess_cnt                         --  '评估次数'\\n,deposit_amount                     --  '定金金额'\\n,receivable_amount                  --  '应收金额'\\n,received_amount                    --  '已收金额'\\n,received_installment_amount        --  '已收分期金额'\\n,received_occupancy_amount          --  '已收占用费'\\n,card_valid                         --  '卡有效期(年)'\\n,membership_amount                  --  '会籍费'\\n,overdue_amount                     --  '滞纳金'\\n,received_overdue_amount            --  '已收滞纳金'\\n,other_amount                       --  '其他费用'\\n,manager_amount                     --  '管理费'\\n,living_limit                       --  '居住期限（月）'\\n,trust_amount                       --  '托管费' \\n,membership_discount_amount         --  '会籍优惠价' \\n,free_visit_day                     --  '免费探访天数' \\n,card_amount                        --  '卡费'\\n,card_manager_amount                --  '卡管理费' \\n,other_transfor_to_amount           --  '其他转让费' \\n,transfor_to_amount                 --  '转让费' \\n,transfor_to_type                   --  '转让类型' \\n,other_transfor_from_amount         --  '其他继承费' \\n,transfor_from_amount               --  '继承费'\\n,transfor_from_type                 --  '继承类型' \\n,remain_day                         --  '退会剩余天数' \\n,cancle_fee_status                  --  '是否退会费' \\n,premium_type                       --  '退会类型' \\n,withdraw_amount                    --  '退会金额' \\n,floor_id\\n,building_id\\n,card_type\\n,card_name\\n,area_name\\n,contract_status\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom db_dw_hr.clife_hr_customer_crm_info_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_customer_crm_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-7-2uh3bu\",\"name\":\"drop_clife_hr_customer_crm_deposit_sign_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_customer_crm_deposit_sign_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_customer_crm_remind_tmp\"]}],\"tenantId\":-1,\"timeout\":0}",
			"description": "华润养老明细层",
			"globalParams": "[]",
			"globalParamList": [],
			"globalParamMap": {},
			"createTime": "2021-07-20T05:45:50.000+0000",
			"updateTime": "2021-09-14T08:32:49.000+0000",
			"flag": "YES",
			"userId": 143,
			"userName": "shucang0907",
			"projectName": null,
			"locations": "{\"tasks-62214\":{\"name\":\"clife_hr_customer_pension_tmp\",\"targetarr\":\"tasks-61334\",\"nodenumber\":\"0\",\"x\":340,\"y\":120},\"tasks-61334\":{\"name\":\"drop_clife_hr_customer_pension_tmp\",\"targetarr\":\"\",\"nodenumber\":\"0\",\"x\":170,\"y\":120},\"tasks-51518\":{\"name\":\"clife_hr_customer_pension_his_tmp\",\"targetarr\":\"tasks-84882\",\"nodenumber\":\"0\",\"x\":680,\"y\":120},\"tasks-84882\":{\"name\":\"drop_clife_hr_customer_pension_his_tmp\",\"targetarr\":\"tasks-62214\",\"nodenumber\":\"0\",\"x\":510,\"y\":120},\"tasks-60334\":{\"name\":\"clife_hr_customer_pension_assess_tmp\",\"targetarr\":\"tasks-8322\",\"nodenumber\":\"0\",\"x\":1020,\"y\":120},\"tasks-8322\":{\"name\":\"drop_clife_hr_customer_pension_assess_tmp\",\"targetarr\":\"tasks-51518\",\"nodenumber\":\"0\",\"x\":850,\"y\":120},\"tasks-29394\":{\"name\":\"clife_hr_customer_pension_remind_tmp\",\"targetarr\":\"tasks-55579\",\"nodenumber\":\"0\",\"x\":1360,\"y\":120},\"tasks-55579\":{\"name\":\"drop_clife_hr_customer_pension_remind_tmp\",\"targetarr\":\"tasks-60334\",\"nodenumber\":\"0\",\"x\":1190,\"y\":120},\"tasks-66149\":{\"name\":\"clife_hr_customer_pension_visit_tmp\",\"targetarr\":\"tasks-78649\",\"nodenumber\":\"0\",\"x\":1700,\"y\":120},\"tasks-78649\":{\"name\":\"drop_clife_hr_customer_pension_visit_tmp\",\"targetarr\":\"tasks-29394\",\"nodenumber\":\"0\",\"x\":1530,\"y\":120},\"tasks-35971\":{\"name\":\"clife_hr_customer_pension_info_tmp\",\"targetarr\":\"tasks-20452\",\"nodenumber\":\"0\",\"x\":2041,\"y\":122},\"tasks-20452\":{\"name\":\"drop_clife_hr_customer_pension_info_tmp\",\"targetarr\":\"tasks-66149\",\"nodenumber\":\"0\",\"x\":1870,\"y\":120},\"tasks-67184\":{\"name\":\"clife_hr_customer_crm_tmp\",\"targetarr\":\"tasks-39666\",\"nodenumber\":\"0\",\"x\":2380,\"y\":120},\"tasks-39666\":{\"name\":\"drop_clife_hr_customer_crm_tmp\",\"targetarr\":\"tasks-35971\",\"nodenumber\":\"0\",\"x\":2210,\"y\":120},\"tasks-31710\":{\"name\":\"clife_hr_customer_crm_his_tmp\",\"targetarr\":\"tasks-844\",\"nodenumber\":\"0\",\"x\":2720,\"y\":120},\"tasks-844\":{\"name\":\"drop_clife_hr_customer_crm_his_tmp\",\"targetarr\":\"tasks-67184\",\"nodenumber\":\"0\",\"x\":2550,\"y\":120},\"tasks-72162\":{\"name\":\"clife_hr_customer_crm_visit_tmp\",\"targetarr\":\"tasks-76206\",\"nodenumber\":\"0\",\"x\":3060,\"y\":120},\"tasks-76206\":{\"name\":\"drop_clife_hr_customer_crm_visit_tmp\",\"targetarr\":\"tasks-31710\",\"nodenumber\":\"0\",\"x\":2890,\"y\":120},\"tasks-47563\":{\"name\":\"clife_hr_customer_crm_remind_tmp\",\"targetarr\":\"tasks-42713\",\"nodenumber\":\"3\",\"x\":3400,\"y\":120},\"tasks-42713\":{\"name\":\"drop_clife_hr_customer_crm_remind_tmp\",\"targetarr\":\"tasks-72162\",\"nodenumber\":\"0\",\"x\":3230,\"y\":120},\"tasks-83189\":{\"name\":\"clife_hr_customer_crm_deposit_sign_tmp\",\"targetarr\":\"tasks-7-2uh3bu\",\"nodenumber\":\"0\",\"x\":3740,\"y\":120},\"tasks-12272\":{\"name\":\"clife_hr_customer_crm_apply_tmp\",\"targetarr\":\"tasks-70271\",\"nodenumber\":\"0\",\"x\":4079,\"y\":120},\"tasks-70271\":{\"name\":\"drop_clife_hr_customer_crm_apply_tmp\",\"targetarr\":\"tasks-83189\",\"nodenumber\":\"0\",\"x\":3910,\"y\":120},\"tasks-12405\":{\"name\":\"clife_hr_customer_crm_fee_detail_tmp\",\"targetarr\":\"tasks-93820\",\"nodenumber\":\"0\",\"x\":4420,\"y\":120},\"tasks-93820\":{\"name\":\"drop_clife_hr_customer_crm_fee_detail_tmp\",\"targetarr\":\"tasks-12272\",\"nodenumber\":\"0\",\"x\":4250,\"y\":120},\"tasks-41819\":{\"name\":\"clife_hr_customer_crm_fee_type_tmp\",\"targetarr\":\"tasks-66130\",\"nodenumber\":\"0\",\"x\":4760,\"y\":120},\"tasks-66130\":{\"name\":\"drop_clife_hr_customer_crm_fee_type_tmp\",\"targetarr\":\"tasks-12405\",\"nodenumber\":\"0\",\"x\":4590,\"y\":120},\"tasks-21788\":{\"name\":\"clife_hr_customer_crm_sign_fee_detail_tmp\",\"targetarr\":\"tasks-50087\",\"nodenumber\":\"0\",\"x\":5100,\"y\":120},\"tasks-50087\":{\"name\":\"drop_clife_hr_customer_crm_sign_fee_detail_tmp\",\"targetarr\":\"tasks-41819\",\"nodenumber\":\"0\",\"x\":4930,\"y\":120},\"tasks-48575\":{\"name\":\"clife_hr_customer_crm_old_man_tmp\",\"targetarr\":\"tasks-33130\",\"nodenumber\":\"0\",\"x\":5440,\"y\":120},\"tasks-33130\":{\"name\":\"drop_clife_hr_customer_crm_old_man_tmp\",\"targetarr\":\"tasks-21788\",\"nodenumber\":\"0\",\"x\":5270,\"y\":120},\"tasks-69030\":{\"name\":\"clife_hr_customer_crm_base_info_tmp\",\"targetarr\":\"tasks-79353\",\"nodenumber\":\"0\",\"x\":5779,\"y\":120},\"tasks-79353\":{\"name\":\"drop_clife_hr_customer_crm_base_info_tmp\",\"targetarr\":\"tasks-48575\",\"nodenumber\":\"0\",\"x\":5610,\"y\":120},\"tasks-70557\":{\"name\":\"clife_hr_customer_crm_info_tmp\",\"targetarr\":\"tasks-50302\",\"nodenumber\":\"0\",\"x\":6120,\"y\":120},\"tasks-50302\":{\"name\":\"drop_clife_hr_customer_crm_info_tmp\",\"targetarr\":\"tasks-69030\",\"nodenumber\":\"0\",\"x\":5950,\"y\":120},\"tasks-22381\":{\"name\":\"clife_hr_dwd_market\",\"targetarr\":\"tasks-70557\",\"nodenumber\":\"0\",\"x\":6289,\"y\":121},\"tasks-7-2uh3bu\":{\"name\":\"drop_clife_hr_customer_crm_deposit_sign_tmp\",\"targetarr\":\"tasks-47563\",\"nodenumber\":\"1\",\"x\":3581,\"y\":114}}",
			"connects": "[{\"endPointSourceId\":\"tasks-61334\",\"endPointTargetId\":\"tasks-62214\"},{\"endPointSourceId\":\"tasks-62214\",\"endPointTargetId\":\"tasks-84882\"},{\"endPointSourceId\":\"tasks-84882\",\"endPointTargetId\":\"tasks-51518\"},{\"endPointSourceId\":\"tasks-51518\",\"endPointTargetId\":\"tasks-8322\"},{\"endPointSourceId\":\"tasks-8322\",\"endPointTargetId\":\"tasks-60334\"},{\"endPointSourceId\":\"tasks-60334\",\"endPointTargetId\":\"tasks-55579\"},{\"endPointSourceId\":\"tasks-55579\",\"endPointTargetId\":\"tasks-29394\"},{\"endPointSourceId\":\"tasks-29394\",\"endPointTargetId\":\"tasks-78649\"},{\"endPointSourceId\":\"tasks-78649\",\"endPointTargetId\":\"tasks-66149\"},{\"endPointSourceId\":\"tasks-66149\",\"endPointTargetId\":\"tasks-20452\"},{\"endPointSourceId\":\"tasks-20452\",\"endPointTargetId\":\"tasks-35971\"},{\"endPointSourceId\":\"tasks-39666\",\"endPointTargetId\":\"tasks-67184\"},{\"endPointSourceId\":\"tasks-67184\",\"endPointTargetId\":\"tasks-844\"},{\"endPointSourceId\":\"tasks-844\",\"endPointTargetId\":\"tasks-31710\"},{\"endPointSourceId\":\"tasks-31710\",\"endPointTargetId\":\"tasks-76206\"},{\"endPointSourceId\":\"tasks-76206\",\"endPointTargetId\":\"tasks-72162\"},{\"endPointSourceId\":\"tasks-72162\",\"endPointTargetId\":\"tasks-42713\"},{\"endPointSourceId\":\"tasks-42713\",\"endPointTargetId\":\"tasks-47563\"},{\"endPointSourceId\":\"tasks-83189\",\"endPointTargetId\":\"tasks-70271\"},{\"endPointSourceId\":\"tasks-70271\",\"endPointTargetId\":\"tasks-12272\"},{\"endPointSourceId\":\"tasks-12272\",\"endPointTargetId\":\"tasks-93820\"},{\"endPointSourceId\":\"tasks-93820\",\"endPointTargetId\":\"tasks-12405\"},{\"endPointSourceId\":\"tasks-12405\",\"endPointTargetId\":\"tasks-66130\"},{\"endPointSourceId\":\"tasks-66130\",\"endPointTargetId\":\"tasks-41819\"},{\"endPointSourceId\":\"tasks-41819\",\"endPointTargetId\":\"tasks-50087\"},{\"endPointSourceId\":\"tasks-50087\",\"endPointTargetId\":\"tasks-21788\"},{\"endPointSourceId\":\"tasks-21788\",\"endPointTargetId\":\"tasks-33130\"},{\"endPointSourceId\":\"tasks-33130\",\"endPointTargetId\":\"tasks-48575\"},{\"endPointSourceId\":\"tasks-48575\",\"endPointTargetId\":\"tasks-79353\"},{\"endPointSourceId\":\"tasks-79353\",\"endPointTargetId\":\"tasks-69030\"},{\"endPointSourceId\":\"tasks-69030\",\"endPointTargetId\":\"tasks-50302\"},{\"endPointSourceId\":\"tasks-50302\",\"endPointTargetId\":\"tasks-70557\"},{\"endPointSourceId\":\"tasks-35971\",\"endPointTargetId\":\"tasks-39666\"},{\"endPointSourceId\":\"tasks-70557\",\"endPointTargetId\":\"tasks-22381\"},{\"endPointSourceId\":\"tasks-7-2uh3bu\",\"endPointTargetId\":\"tasks-83189\"},{\"endPointSourceId\":\"tasks-47563\",\"endPointTargetId\":\"tasks-7-2uh3bu\"}]",
			"receivers": "",
			"receiversCc": "",
			"leadMobile": "",
			"ddAlarmId": 0,
			"scheduleReleaseState": null,
			"timeout": 0,
			"tenantId": -1,
			"taskType": "SHELL"
		}, {
			"id": 339,
			"name": "db_dwd_hr",
			"version": 0,
			"releaseState": "ONLINE",
			"projectId": 1,
			"processDefinitionJson": "{\"globalParams\":[],\"tasks\":[{\"type\":\"SQL\",\"id\":\"tasks-7028\",\"name\":\"clife_hr_dwd_reside_manage_info\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dwd_reside_manage_info partition(part_date)\\nselect\\n     a.old_man_check_in_id     --老人入住id\\n    ,a.old_man_id              --老人id\\n    ,a.old_man_name            --姓名\\n    ,a.sex                     --性别\\n    ,if(datediff(CURRENT_DATE,CONCAT(substr(CURRENT_DATE,0,4),substr(a.birthday,5,7)))>=0,\\n(substr(CURRENT_DATE,0,4) - substr(a.birthday,0,4)),\\n(substr(CURRENT_DATE,0,4) - substr(a.birthday,0,4)-1)) as age --年龄\\n    ,a.agent_id                            --入住经办员工id\\n    ,j.create_user_ids                     --请假办理人id\\n    ,d.agent_id as countermand_agent_id    --退住经办人id\\n    ,p.id as membership_id                 --会籍id\\n    ,a.room_id                             --房间id\\n    ,a.bed_id                              --床位id\\n    ,a.membership_owner_id                 --权益人id\\n    ,a.contract_id                         --入住合同id\\n    ,k.relatives_names                     --探访人姓名\\n    ,a.nursin_homes_id                     --养老院id\\n    ,c.nursing_homes_name                  --养老院名称\\n    ,c.sub_org_id                          --机构id\\n    ,c.sub_org_name                        --机构名称\\n    ,c.org_id                              --集团id\\n    ,c.org_name                            --集团名称\\n    ,c.area_id                             --区域id\\n    ,a.reside_time                         --入住时间\\n    ,b.create_time as  contract_entry_time  --合同录入时间\\n    ,j.leave_create_times                  --请假时间（多值维度）\\n    ,k.visit_times                        --探访时间（多值维度）\\n    ,d.countermand_time                   --退住时间\\n    ,a.reside_status                      --入住状态\\n    ,a.estimated                          --是否评估（0-否 1-是）\\n    ,a.nursing_level_id                   --护理等级id\\n    ,a.nursing_level                      --护理等级名字\\n    ,a.deposited                          --是否缴纳定金\\n    ,a.charge_type                        --收费模式\\n    ,a.check_in_type                      --入住类型\\n    ,a.check_in_name                      --入住类型名称\\n    ,j.leave_times                        --请假时长（天为单位）\\n    ,j.accompany_names                    --陪同人姓名\\n    ,j.accompany_phones                   --陪同人电话\\n    ,j.leave_statuss                      --是否返回\\n    ,j.overtime_statuss                   --请假是否超时\\n    ,j.reality_times                      --实际请假天数\\n    ,j.leave_types                        --请假类型\\n    ,j.time_stages                        --外出0上午 1下午\\n    ,j.time_stage_returns                 --返回 0上午 1下午\\n    ,e.leave_day_cnt                      --当天请假次数\\n    ,f.refund_types                       --当天请假退费类型\\n    ,f.refund_amount                      --当天请假退费金额\\n    ,g.leave_reducation_fee               --当天请假减免费用\\n    ,h.visit_day_cnt                      --当天探访人数\\n    ,h.visit_time                         --当天探访时长 \\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_ods_hr.clife_hr_ods_check_in a\\nleft join db_ods_hr.clife_hr_ods_old_man_contract b on a.old_man_check_in_id = b.old_man_check_in_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_dw_hr.clife_hr_dim_nursing_home c on a.nursin_homes_id = c.nursing_homes_id and c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_ods_hr.clife_hr_ods_old_man_countermand d on a.old_man_check_in_id = d.old_man_check_in_id and d.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\n(--请假表\\n  select  \\n       old_man_check_in_id\\n      ,count(1) as leave_day_cnt --当天请假次数\\n  from db_ods_hr.clife_hr_ods_old_leave\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','') \\n  and status = 1\\n  and substr(start_time,1,10) = regexp_replace(date_sub(current_date(),1),'-','')\\n  group by old_man_check_in_id\\n)e on a.old_man_check_in_id = e.old_man_check_in_id\\nleft join \\n(--请假集合\\n  select  \\n       old_man_check_in_id\\n      ,concat_ws(',',collect_list(cast(leave_time        as string))) as leave_times\\n      ,concat_ws(',',collect_list(cast(accompany_name    as string))) as accompany_names\\n      ,concat_ws(',',collect_list(cast(accompany_phone   as string))) as accompany_phones\\n      ,concat_ws(',',collect_list(cast(leave_status      as string))) as leave_statuss\\n      ,concat_ws(',',collect_list(cast(overtime_status   as string))) as overtime_statuss\\n      ,concat_ws(',',collect_list(cast(reality_time      as string))) as reality_times\\n      ,concat_ws(',',collect_list(cast(leave_type        as string))) as leave_types\\n      ,concat_ws(',',collect_list(cast(time_stage        as string))) as time_stages\\n      ,concat_ws(',',collect_list(cast(time_stage_return as string))) as time_stage_returns\\n      ,concat_ws(',',collect_list(cast(create_user_id as string))) as create_user_ids\\n      ,concat_ws(',',collect_list(cast(create_time as string))) as    leave_create_times\\n  from db_ods_hr.clife_hr_ods_old_leave  --请假\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','') and status = 1\\n  group by old_man_check_in_id\\n)j on a.old_man_check_in_id=j.old_man_check_in_id\\nleft join \\n(--请假退费表\\n  select \\n       old_man_check_in_id\\n      ,concat_ws(',',collect_list(cast(refund_type as string))) as refund_types  --当天请假退费类型\\n      ,sum(refund_amount) as refund_amount  --当天请假退费金额\\n  from db_ods_hr.clife_hr_ods_leave_refund  --bl请假退费表\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    and state=1\\n    and substr(create_time,1,10)=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by old_man_check_in_id\\n)f on a.old_man_check_in_id = f.old_man_check_in_id\\nleft join \\n(--请假减免记录表\\n   select\\n        a.old_man_check_in_id\\n       ,sum(b.leave_reducation_fee) as leave_reducation_fee  --当天请假减免费用\\n   from db_ods_hr.clife_hr_ods_old_leave a\\n   left join\\n   (\\n     select\\n          old_leave_id\\n         ,sum(leave_reducation_fee) as leave_reducation_fee  --当天请假减免费用\\n     from db_ods_hr.clife_hr_ods_leave_reduction   --请假减免记录表\\n     where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n       and status=1\\n       and substr(create_time,1,10)=regexp_replace(date_sub(current_date(),1),'-','')\\n     group by old_leave_id\\n   )b on a.old_leave_id = b.old_leave_id\\n   where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n   group by  a.old_man_check_in_id\\n)g on a.old_man_check_in_id = g.old_man_check_in_id\\nleft join\\n(--探访表\\n    select  \\n         old_man_id\\n        ,count(1) as visit_day_cnt --每天探访人数\\n        ,substr(visit_start_time,1,10) as visit_date --探访日期\\n        ,sum(CAST((if(visit_end_time is null,unix_timestamp(),unix_timestamp(visit_end_time)) - unix_timestamp(visit_start_time)) / 60 AS int) % 60) as visit_time --当天探访时长\\n    from db_ods_hr.clife_hr_ods_relatives_visit\\n    where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n\\t and state = 1\\n     and substr(visit_start_time,1,10)=regexp_replace(date_sub(current_date(),1),'-','')\\n    group by old_man_id \\n            ,substr(visit_start_time,1,10) \\n)h on a.old_man_id = h.old_man_id\\nleft join \\n(--探访表集合\\n  select  \\n       old_man_id\\n      ,concat_ws(';',collect_list(cast(relatives_name as string)))   as relatives_names --探访人姓名\\n      ,concat_ws(',',collect_list(cast(concat(visit_start_time,'-',visit_end_time) as string))) as visit_times --探访时间\\n  from db_ods_hr.clife_hr_ods_relatives_visit\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','') and state = 1\\n  group by old_man_id\\n)k on a.old_man_id = k.old_man_id\\nleft join db_ods_hr.clife_hr_ods_membership p on a.relation_id = p.id and p.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"db_dwd_hr_market\"]},{\"type\":\"SQL\",\"id\":\"tasks-7-5bu67c\",\"name\":\"clife_hr_dwd_activity_manage_info\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dwd_activity_manage_info partition(part_date)\\nselect\\n     a.activity_id          --'活动id'\\n    ,a.create_user_id       --'经办人id'\\n    ,b.reserve_ids          --'预定活动室id'\\n    ,a.activity_room_id     --活动室id\\n    ,a.template_id          --活动模板id\\n    ,a.activity_type        --活动类型\\n    ,a.nurse_home_id        --养老院id\\n    ,j.nursing_homes_name   --养老院名称\\n    ,a.sub_org_id           --机构id\\n    ,j.sub_org_name         --机构名称\\n    ,a.org_id               --集团id\\n    ,j.org_name             --集团名称\\n    ,j.area_id              --区域id\\n    ,a.create_time as activity_create_time   --活动创建时间\\n    ,b.reserve_times         --预定活动室时间\\n    ,b.reserve_user_ids      --预约人\\n    ,b.reserve_users         --预约人姓名\\n    ,b.reserve_uses          --预定用途\\n    ,b.reserve_user_types    --预定人类型\\n    ,a.activity_time         --活动举办时间\\n    ,a.apply_start_time      --活动开始报名时间\\n    ,a.apply_time            --活动结束报名时间\\n    ,a.activity_start        --活动开始时间\\n    ,a.activity_end          --活动结束时间\\n    ,e.old_man_ids           --邀请老人（多值）\\n    ,e.old_man_cnt           --邀请老人数\\n    ,f.apply_old_mans         --报名老人\\n    ,f.apply_old_man_cnt  --报名老人数\\n    ,f.sign_old_mans      --签到老人\\n    ,f.sign_old_man_cnt   --签到人数\\n    ,f.confirm_old_mans   --到场老人\\n    ,f.confirm_old_man_cnt --到场人数\\n    ,a.activity_fee        --活动费用\\n    ,g.good_evaluation_num    --活动评价好评数\\n    ,g.middle_evaluation_num  --活动评价中评数\\n    ,g.bad_evaluation_num     --活动评价差评数\\n    ,h.good_feedback_num    --反馈非常好数\\n    ,h.middle_feedback_num  --反馈较好数\\n    ,h.general_feedback_num --反馈一般数\\n    ,h.bad_feedback_num     --反馈不理想数\\n    ,f.sign_times           --签到时间\\n    ,f.confirm_times        --到场时间\\n    ,e.apply_times          --报名时间\\n    ,g.evaluation_times --评价时间\\n    ,h.feedback_times --反馈时间\\n    ,g.evaluation_types --评价状态\\n\\t,h.feedback_types --反馈的状态\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom db_ods_hr.clife_hr_ods_org_activity a\\nleft join \\n(--预定活动室\\n   select\\n        activity_id\\n       ,concat_ws(';',collect_list(cast(reserve_time      as string))) as reserve_times     \\n       ,concat_ws(';',collect_list(cast(reserve_user_id    as string)))as reserve_user_ids  \\n       ,concat_ws(';',collect_list(cast(reserve_user   as string))) as reserve_users     \\n       ,concat_ws(';',collect_list(cast(reserve_use      as string))) as reserve_uses      \\n       ,concat_ws(';',collect_list(cast(reserve_user_type   as string))) as reserve_user_types\\n       ,concat_ws(';',collect_list(cast(id   as string))) as reserve_ids\\n   from db_ods_hr.clife_hr_ods_org_activity_room_reserve \\n   where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n     and type=1\\n   group by activity_id\\n)b on a.activity_id = b.activity_id\\nleft join \\n(--邀请表\\n  select \\n       activity_id\\n      ,concat_ws(';',collect_list(cast(case when apply_type = 1 then old_man_id else null end as string))) as old_man_ids\\n      ,count(distinct old_man_id) as old_man_cnt\\n      ,concat_ws(';',collect_list(cast(case when apply_type = 2 then create_time else null end as string)))  as apply_times\\n  from db_ods_hr.clife_hr_ods_org_activity_apply\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','') \\n  group by activity_id\\n)e on a.activity_id = e.activity_id\\nleft join \\n(--参与人表\\n  select \\n       activity_id\\n      ,sum(case when apply_flag = 1 then attach_num else 0 end) as apply_old_man_cnt\\n      ,sum(case when sign_status = 2 then 1 else 0 end) as sign_old_man_cnt\\n      ,sum(case when sign_time is not null then 1 else 0 end) as confirm_old_man_cnt\\n      ,concat_ws(';',collect_list(cast(case when apply_flag = 1 then old_man_id else null end as string)))  as apply_old_mans\\n      ,concat_ws(';',collect_list(cast(case when sign_status = 2 then old_man_id else null end as string))) as sign_old_mans\\n      ,concat_ws(';',collect_list(cast(case when sign_status = 2 then sign_time else null end as string)))  as sign_times\\n      ,concat_ws(';',collect_list(cast(old_man_id as string))) as confirm_old_mans\\n      ,concat_ws(';',collect_list(cast(join_time as string)))  as confirm_times --参加时间\\n  from db_ods_hr.clife_hr_ods_org_activity_participant\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    and del_flag=1\\n  group by activity_id\\n)f on a.activity_id = f.activity_id\\nleft join \\n(--评价表\\n  select\\n       activity_id\\n      ,sum(case when evaluation_type=1 then 1 else 0 end ) as good_evaluation_num    --活动评价好评数\\n      ,sum(case when evaluation_type=2 then 1 else 0 end ) as middle_evaluation_num  --活动评价中评数\\n      ,sum(case when evaluation_type=3 then 1 else 0 end ) as bad_evaluation_num     --活动评价差评数\\n      ,concat_ws(';',collect_list(cast(evaluation_type as string)))  as evaluation_types --评价状态\\n      ,concat_ws(';',collect_list(cast(create_time as string)))  as evaluation_times --评价时间\\n  from db_ods_hr.clife_hr_ods_org_activity_evaluation\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by activity_id\\n)g on a.activity_id = g.activity_id\\nleft join \\n(\\n  select\\n       activity_id\\n      ,sum(case when feedback_type=1 then 1 else 0 end ) as good_feedback_num    --反馈非常好数\\n      ,sum(case when feedback_type=2 then 1 else 0 end ) as middle_feedback_num  --反馈较好数\\n      ,sum(case when feedback_type=3 then 1 else 0 end ) as general_feedback_num --反馈一般数\\n      ,sum(case when feedback_type=4 then 1 else 0 end ) as bad_feedback_num     --反馈不理想数\\n      ,concat_ws(';',collect_list(cast(feedback_type as string))) as feedback_types --反馈的状态\\n      ,concat_ws(';',collect_list(cast(create_time as string)))  as feedback_times --反馈时间\\n  from db_ods_hr.clife_hr_ods_org_activity_feedback\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by activity_id\\n)h on a.activity_id = h.activity_id\\nleft join db_dw_hr.clife_hr_dim_nursing_home j on a.nurse_home_id = j.nursing_homes_id and j.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nwhere a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dwd_reside_manage_info\"]},{\"type\":\"SQL\",\"id\":\"tasks-7-3xy3r7\",\"name\":\"clife_hr_dwd_coupon_manage_info\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dwd_coupon_manage_info partition(part_date)\\nselect\\n     a.id as coupon_id     --优惠券id\\n    ,a.coupon_name         --优惠券名称\\n    ,a.type                --优惠券类型\\n    ,a.attributes          --公寓属性\\n    ,a.apartment_name      --公寓名称\\n    ,a.coupon_amount       --优惠券额度\\n    ,a.period                     --期数\\n    ,a.preferential_plan        --优惠方案\\n    ,a.status                   --优惠券状态\\n    ,a.valid_period_start    --有效期开始时间\\n    ,a.valid_period_end      --有效期结束时间\\n    ,c.create_user_id        --经办人id\\n    ,a.user_id               --领取人id\\n    ,a.use_name              --使用人姓名\\n    ,a.nurse_home_id         --养老院id\\n    ,d.nursing_homes_name    --养老院名称\\n    ,a.sub_org_id            --机构id\\n    ,a.sub_org_name          --机构名称\\n    ,a.org_id                --集团id\\n    ,a.org_name              --集团名称\\n    ,d.area_id               --区域id\\n    ,b.coupon_issue_times    --发放时间\\n    ,a.use_date              --使用时间\\n    ,a.use_frequency        --使用次数\\n    ,a.balance              --余额\\n    ,a.last_balance         --上次余额\\n    ,a.balance - a.last_balance as cost  --花费\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom \\n(\\n  select\\n       t1.*\\n      ,t4.nurse_home_id --养老院id\\n      ,t2.sub_org_name  --机构名称\\n      ,t2.org_name      --集团名称\\n      ,lag(t1.balance, 1, null) over(partition by t1.id order by t1.use_date) as last_balance --上次余额\\n  from db_ods_hr.clife_hr_ods_coupon t1\\n  left join db_dw_hr.clife_hr_dim_admin_sub_org t2 on t1.sub_org_id = t2.sub_org_id  and t2.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n  left join db_ods_hr.clife_hr_ods_org_nurse t4 on t1.sub_org_id=t4.sub_org_id and t1.org_id=t4.org_id and t4.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n  where t1.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    and t1.status = 1\\n)a\\nleft join db_ods_hr.clife_hr_ods_coupon_setting c on a.coupon_setting_id = c.id and c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\n(\\n  select \\n       coupon_setting_id\\n      ,concat_ws(';',collect_list(cast(create_time as string))) as coupon_issue_times\\n  from db_ods_hr.clife_hr_ods_coupon_issue\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    and status=1\\n  group by coupon_setting_id\\n)b on a.coupon_setting_id = b.coupon_setting_id\\nleft join db_ods_hr.clife_hr_ods_nursing_homes_baseinfo d on a.nurse_home_id = d.nursing_homes_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dwd_activity_manage_info\"]},{\"type\":\"SQL\",\"id\":\"tasks-7-5nu5kb\",\"name\":\"clife_hr_dwd_plan_snapshot_info\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dwd_plan_snapshot_info partition(part_date)\\nselect\\na.snap_item_id        --计划ID\\n,a.user_id             --老人id\\n,c.nursing_homes_id    --养老院id\\n,c.area_id             --养老院区域id\\n,a.sub_org_id          --机构id\\n,c.sub_org_name        --机构名称\\n,c.org_id              --集团id\\n,c.org_name            --集团名称\\n,a.project_id          --项目id\\n,a.project_name        --项目名称\\n,a.project_type_id     --项目类型id\\n,a.project_type_name   --项目类型名称\\n,a.frequency_type      --频次类型\\n,a.frequency_num       --频次数\\n,a.count               --完成计数\\n,a.exec_date           --执行日\\n,a.complete_stase      --完成状态\\n,b.create_time as plan_create_time  --计划创建时间\\n,regexp_replace(date_sub(current_date(),1),'-','') as part_date --分区日期\\nfrom db_ods_hr.clife_hr_ods_nurse_plan_snapshot a\\nleft join db_ods_hr.clife_hr_ods_basic_service_plan b on a.plan_id=b.plan_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_dw_hr.clife_hr_dim_nursing_home c on a.sub_org_id=c.sub_org_id and c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nwhere a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dwd_coupon_manage_info\"]},{\"type\":\"SQL\",\"id\":\"tasks-7-14k595\",\"name\":\"clife_hr_dwd_recharge_consumption_info\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dwd_recharge_consumption_info partition(part_date)\\nselect\\n     p.id                        --记录id\\n    ,p.old_man_id                --老人id\\n    ,p.member_id                 --会员id\\n    ,n.old_man_name            --姓名\\n    ,n.sex                     --性别\\n    ,n.age                     --年龄\\n    ,m.nursing_homes_id        --养老机构id\\n    ,m.nursing_homes_name      --养老院名称\\n    ,p.sub_org_id              --机构id\\n    ,m.sub_org_name            --机构名称\\n    ,p.org_id                  --集团id\\n    ,m.org_name                --集团名称\\n    ,m.area_id                 --区域id\\n    ,p.account_id                --账户id\\n    ,p.remark                    --备注\\n    ,p.amount                   --账户充值的金额\\n    ,p.recharge_consumption_time --充值时间   \\n    ,p.behavior_type             --行为类型\\n    ,p.consumption_type          --消费类型\\n    ,p.fee_type_id               --费用类型ID\\n    ,p.fee_type_name             --费用类型名称\\n    ,p.fee_iteam_id              --费用项目id\\n    ,p.fee_iteam_name            --费用项目名称\\n    ,p.bill_child_id             --账单子表ID\\n    ,p.bill_id                   --账单id\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom\\n(\\n--充值\\nselect\\n     a.id                 --记录id\\n    ,null as old_man_id --老人id\\n    ,a.member_id          --会员id\\n    ,a.sub_org_id         --机构id\\n    ,a.org_id             --集团id\\n    ,b.id as account_id   --账户id\\n    ,a.remark             --备注\\n    ,a.recharge_amount as amount   --账户充值的金额\\n    ,a.pay_time       as recharge_consumption_time    --充值时间   \\n    ,'会员充值' as behavior_type  --行为类型\\n    ,1 as consumption_type        --消费类型\\n    ,null as fee_type_id    --费用类型ID(充值null,账务退住为null)\\n    ,null as fee_type_name  --费用类型名称(充值null,账务退住为null)\\n    ,null as fee_iteam_id   --费用项目id(充值null,账务退住为null)\\n    ,null as fee_iteam_name --费用项目名称(充值null,账务退住为null)\\n    ,null as bill_child_id  --账单子表ID(充值null,账务退住为null)\\n    ,null as bill_id        --账单id(充值null,账务退住为null) \\nfrom db_ods_hr.clife_hr_ods_member_recharge_record a\\nleft join db_ods_hr.clife_hr_ods_member_account b on a.member_id = b.member_id and b.id<>b.member_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','') \\nwhere a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  and a.state = 1\\nunion all\\nselect\\n     id              --记录id\\n    ,old_man_id      --老人id\\n    ,null as member_id --会员id\\n    ,sub_org_id      --机构id\\n    ,org_id          --集团id\\n    ,account_id      --账户id\\n    ,remark          --备注\\n    ,fee_amount  as amount    --账户充值的金额\\n    ,pay_time      as recharge_consumption_time  --充值时间\\n    ,'账户充值' as behavior_type  --行为类型\\n    ,1 as consumption_type        --消费类型\\n    ,null as fee_type_id          --费用类型ID(充值null,账务退住为null)\\n    ,null as fee_type_name        --费用类型名称(充值null,账务退住为null)\\n    ,null as fee_iteam_id   --费用项目id(充值null,账务退住为null)\\n    ,null as fee_iteam_name --费用项目名称(充值null,账务退住为null)\\n    ,null as bill_child_id  --账单子表ID(充值null,账务退住为null)\\n    ,null as bill_id        --账单id(充值null,账务退住为null)\\nfrom db_ods_hr.clife_hr_ods_recharge_record\\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  and state = 1\\nunion all\\n--消费\\nselect \\n     a.fee_detail_record_id as id  --消费流水id\\n    ,a.old_man_id           --老人ID\\n    ,null as member_id      --会员id\\n    ,a.sub_org_id           --机构id\\n    ,a.org_id               --集团id\\n    ,e.account_id           --账户id\\n    ,a.remark               --备注\\n    ,a.fee_amount        as amount   --金额\\n    ,a.consumption_time   as recharge_consumption_time  --消费时间\\n    ,'账户消费' as behavior_type  --行为类型\\n    ,0 as consumption_type        --消费类型\\n    ,a.fee_type_id          --费用类型ID(充值null,账务退住为null)\\n    ,a.fee_type_name        --费用类型名称(充值null,账务退住为null)\\n    ,a.fee_iteam_id         --费用项目id(充值null,账务退住为null)\\n    ,a.fee_iteam_name       --费用项目名称(充值null,账务退住为null)\\n    ,a.child_id as bill_child_id --账单子表ID(充值null,账务退住为null)\\n    ,c.id as bill_id             --账单ID(充值null,账务退住为null)\\nfrom db_ods_hr.clife_hr_ods_detail_record a\\nleft join db_ods_hr.clife_hr_ods_month_bill_child b on a.child_id = b.id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_ods_hr.clife_hr_ods_month_bill c on b.month_bill_id = c.id and c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\n(\\n  select\\n       old_man_check_in_id\\n      ,old_man_id\\n      ,room_attribute\\n      ,case when check_in_type=0 then 1\\n            when check_in_type=1 then 1\\n            when check_in_type=2 then 2\\n            when check_in_type=3 then 2\\n            when check_in_type=4 then 2\\n       else check_in_type end as check_in_type\\n  from db_ods_hr.clife_hr_ods_check_in\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    and status =1\\n)d on c.old_man_check_in_id = d.old_man_check_in_id\\nleft join db_ods_hr.clife_hr_ods_account e on d.old_man_id=e.old_man_id and e.symbol=1 and e.attributes=d.check_in_type and e.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nwhere a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  and a.state = 1\\nunion all\\nselect\\n     a.fee_detail_record_id as id --记录id\\n    ,null as old_man_id    --老人id\\n    ,a.member_id             --会员id\\n    ,a.sub_org_id            --机构ID\\n    ,a.org_id                --集团ID\\n    ,b.id as account_id   --账户id\\n    ,null as remark   --备注\\n    ,a.fee_amount as amount--金额\\n    ,a.create_time as recharge_consumption_time  --消费时间\\n    ,'会员消费' as behavior_type  --行为类型\\n    ,0 as consumption_type        --消费类型\\n    ,a.fee_type_id          --费用类型ID(充值null,账务退住为null)\\n    ,a.fee_type_name        --费用类型名称(充值null,账务退住为null)\\n    ,a.fee_iteam_id         --费用项目id(充值null,账务退住为null)\\n    ,a.fee_iteam_name       --费用项目名称(充值null,账务退住为null)\\n    ,null as bill_child_id  --账单子表ID(充值null,账务退住为null)\\n    ,null as bill_id        --账单ID(充值null,账务退住为null)\\nfrom db_ods_hr.clife_hr_ods_member_detail_record a\\nleft join db_ods_hr.clife_hr_ods_member_account b on a.member_id = b.member_id and b.id<>b.member_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','') \\nwhere a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  and a.state = 1\\nunion all\\n--入住缴费\\nselect\\n     a.id  --消费流水id\\n    ,a.old_man_id           --老人ID\\n    ,null as member_id      --会员id\\n    ,a.sub_org_id           --机构id\\n    ,a.org_id               --集团id\\n    ,e.account_id           --账户id\\n    ,null as remark         --备注\\n    ,a.fee_amount   as amount     --金额\\n    ,a.pay_time     as recharge_consumption_time  --入住缴费时间\\n    ,'入住缴费'     as behavior_type  --行为类型\\n    ,0 as consumption_type        --消费类型\\n    ,f.fee_type_id          --费用类型ID(充值null,账务退住为null)\\n    ,g.fee_type as fee_type_name        --费用类型名称(充值null,账务退住为null)\\n    ,a.fee_item_id as  fee_iteam_id       --费用项目id(充值null,账务退住为null)\\n    ,a.fee_text as fee_iteam_name --费用项目名称(充值null,账务退住为null)\\n    ,null as bill_child_id --账单子表ID(充值null,账务退住为null)\\n    ,null as bill_id             --账单ID(充值null,账务退住为null)\\nfrom db_ods_hr.clife_hr_ods_checkin_pay_record a \\nleft join db_ods_hr.clife_hr_ods_account e on a.old_man_id=e.old_man_id and e.symbol=1 and e.attributes=a.reside_type and e.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_ods_hr.clife_hr_ods_fee_item f on a.fee_item_id=f.fee_item_id and f.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_ods_hr.clife_hr_ods_fee_type g on f.fee_type_id=g.fee_type_id and g.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nwhere a.state=1 and a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nunion all\\n--退住缴费\\nselect\\n     a.hr_inform_id as id  --消费流水id\\n    ,a.old_man_id           --老人ID\\n    ,null as member_id      --会员id\\n    ,a.sub_org_id           --机构id\\n    ,a.org_id               --集团id\\n    ,e.account_id           --账户id\\n    ,a.handle_content as remark  --备注\\n    ,a.sum_cost_money       as amount    --金额\\n    ,a.handle_time   as recharge_consumption_time  --消费时间\\n    ,'退住缴费' as behavior_type  --行为类型\\n    ,0 as consumption_type        --消费类型\\n    ,null as fee_type_id          --费用类型ID(充值null,账务退住为null)\\n    ,null as fee_type_name        --费用类型名称(充值null,账务退住为null)\\n    ,null as fee_iteam_id         --费用项目id(充值null,账务退住为null)\\n    ,null as fee_iteam_name       --费用项目名称(充值null,账务退住为null)\\n    ,null as bill_child_id        --账单子表ID(充值null,账务退住为null)\\n    ,null as bill_id              --账单ID(充值null,账务退住为null)\\nfrom db_ods_hr.clife_hr_ods_inform a\\nleft join \\n(\\n  select\\n       old_man_check_in_id\\n      ,old_man_id\\n      ,room_attribute\\n      ,case when check_in_type=0 then 1\\n            when check_in_type=1 then 1\\n            when check_in_type=2 then 2\\n            when check_in_type=3 then 2\\n            when check_in_type=4 then 2\\n       else check_in_type end as check_in_type\\n  from db_ods_hr.clife_hr_ods_check_in\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    and status =1\\n)b on a.old_man_check_in_id = b.old_man_check_in_id\\nleft join db_ods_hr.clife_hr_ods_account e on b.old_man_id=e.old_man_id and e.symbol=1 and e.attributes=b.check_in_type and e.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nwhere a.state=1 \\n  and a.hr_inform_type_id=2 \\n  and a.handle_type_id=2 \\n  and a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n)p \\nleft join db_dw_hr.clife_hr_dim_nursing_home m on p.sub_org_id=m.sub_org_id and m.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_dw_hr.clife_hr_dim_old_man n on p.old_man_id=n.old_man_id and n.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dwd_plan_snapshot_info\"]},{\"type\":\"SQL\",\"id\":\"tasks-7-63m63r\",\"name\":\"clife_hr_dwd_service_record_info\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dwd_service_record_info partition(part_date)\\nselect\\n a.increment_service_id     --服务主键\\n,a.old_man_id             --服务老人ID\\n,a.old_man_name           --长者姓名\\n,a.service_type_id        --服务类型id\\n,a.service_type_name      --服务类型id名\\n,a.service_project_id     --服务项目id\\n,a.service_project_name   --服务项目名称\\n,a.service_type           --服务类型\\n,a.cost                   --费用\\n,a.company                --单位\\n,a.remarks                --备注\\n,a.total_cost             --合计费用\\n,a.settlement_status      --结算状态\\n,a.service_status         --完成状态\\n,a.service_time           --服务时间\\n,a.suplier_id             --供应商id\\n,a.suplier_name           --供应商\\n,a.third_flag             --是否需要第三方\\n,a.old_man_check_in_id    --长者入住id\\n,a.pic_url                --服务图片\\n,a.service_object         --服务对象\\n,a.service_finish_time    --服务完成时间\\n,a.evaluation_status      --评价状态\\n,e.evaluate_time           --评价时间                \\n,a.valid_status           --订单有效性\\n,a.time_stage             --服务时间段\\n,a.is_accurate            --是否精确时间\\n,a.plan_id                --基础服务计划ID\\n,a.ignore_status          --忽略状态\\n,a.bed_id                 --床位id\\n,a.bed_name               --床位名称\\n,a.room_id                --房间id\\n,a.room_name              --房间名称\\n,a.floor_id               --楼层id\\n,a.floor_name             --楼层名称\\n,a.building_id            --楼栋id\\n,a.building_name          --楼栋名称\\n,a.service_housekeeper_ids    --服务管家ids\\n,b.service_keeper_names     --服务管家名称s\\n,a.create_time                --服务生成时间\\n,a.create_user_id             --创建人id\\n,a.create_user_name           --创建人名称\\n,a.update_time                --更新时间\\n,a.update_user_id             --更新人id\\n,a.update_user_name           --更新人名称\\n,c.nursin_homes_id       --养老院id（老人或者房间所属养老院）\\n,d.nursing_homes_name     --'养老院名称 '\\n,d.sub_org_id             --'养老机构id'\\n,d.sub_org_name           --'养老集团名称'\\n,d.org_id                 --'养老集团id'\\n,d.org_name               --'养老机构名称'     \\n,d.area_id                --'区id'        \\n,regexp_replace(date_sub(current_date(),1),'-','') as part_date --分区日期\\nfrom db_ods_hr.clife_hr_ods_service_record a\\nleft join db_ods_hr.clife_hr_ods_basic_service_plan b on a.plan_id=b.plan_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_dw_hr.clife_hr_dim_old_man c on a.old_man_id = c.old_man_id and c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_dw_hr.clife_hr_dim_nursing_home d on c.nursin_homes_id = d.nursing_homes_id and d.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\n(\\n   select *\\n   from\\n   (\\n     select\\n          increment_service_id\\n         ,create_time as evaluate_time\\n         ,row_number()over(partition by increment_service_id order by create_time desc) as rank\\n     from db_ods_hr.clife_hr_ods_increment_evaluate \\n     where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n       and state=1 and evaluate_status=1\\n   )t\\n   where t.rank=1\\n)e on a.increment_service_id=e.increment_service_id\\nwhere a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dwd_recharge_consumption_info\"]},{\"type\":\"SUB_PROCESS\",\"id\":\"tasks-80482\",\"name\":\"db_dwd_hr_market\",\"params\":{\"processDefinitionId\":336},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[]}],\"tenantId\":-1,\"timeout\":0}",
			"description": "",
			"globalParams": "[]",
			"globalParamList": [],
			"globalParamMap": {},
			"createTime": "2021-07-26T01:23:35.000+0000",
			"updateTime": "2021-08-18T10:39:15.000+0000",
			"flag": "YES",
			"userId": 143,
			"userName": "shucang0907",
			"projectName": null,
			"locations": "{\"tasks-7028\":{\"name\":\"clife_hr_dwd_reside_manage_info\",\"targetarr\":\"tasks-80482\",\"nodenumber\":\"1\",\"x\":357,\"y\":203},\"tasks-7-5bu67c\":{\"name\":\"clife_hr_dwd_activity_manage_info\",\"targetarr\":\"tasks-7028\",\"nodenumber\":\"1\",\"x\":602,\"y\":203},\"tasks-7-3xy3r7\":{\"name\":\"clife_hr_dwd_coupon_manage_info\",\"targetarr\":\"tasks-7-5bu67c\",\"nodenumber\":\"1\",\"x\":851,\"y\":213},\"tasks-7-5nu5kb\":{\"name\":\"clife_hr_dwd_plan_snapshot_info\",\"targetarr\":\"tasks-7-3xy3r7\",\"nodenumber\":\"1\",\"x\":1078,\"y\":211},\"tasks-7-14k595\":{\"name\":\"clife_hr_dwd_recharge_consumption_info\",\"targetarr\":\"tasks-7-5nu5kb\",\"nodenumber\":\"1\",\"x\":1306,\"y\":214},\"tasks-7-63m63r\":{\"name\":\"clife_hr_dwd_service_record_info\",\"targetarr\":\"tasks-7-14k595\",\"nodenumber\":\"0\",\"x\":1538,\"y\":211},\"tasks-80482\":{\"name\":\"db_dwd_hr_market\",\"targetarr\":\"\",\"nodenumber\":\"1\",\"x\":162,\"y\":206}}",
			"connects": "[{\"endPointSourceId\":\"tasks-7028\",\"endPointTargetId\":\"tasks-7-5bu67c\"},{\"endPointSourceId\":\"tasks-7-5bu67c\",\"endPointTargetId\":\"tasks-7-3xy3r7\"},{\"endPointSourceId\":\"tasks-7-3xy3r7\",\"endPointTargetId\":\"tasks-7-5nu5kb\"},{\"endPointSourceId\":\"tasks-7-5nu5kb\",\"endPointTargetId\":\"tasks-7-14k595\"},{\"endPointSourceId\":\"tasks-7-14k595\",\"endPointTargetId\":\"tasks-7-63m63r\"},{\"endPointSourceId\":\"tasks-80482\",\"endPointTargetId\":\"tasks-7028\"}]",
			"receivers": "",
			"receiversCc": "",
			"leadMobile": "",
			"ddAlarmId": 0,
			"scheduleReleaseState": null,
			"timeout": 0,
			"tenantId": -1,
			"taskType": "SHELL"
		}, {
			"id": 334,
			"name": "db_ods_hr",
			"version": 0,
			"releaseState": "ONLINE",
			"projectId": 1,
			"processDefinitionJson": "{\"globalParams\":[],\"tasks\":[{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"意向客户\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_intentional_customer\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select \\n     customer_id             \\n    ,create_time             \\n    ,create_user_id          \\n    ,group_id                \\n    ,org_id                  \\n    ,sub_org_id              \\n    ,name                    \\n    ,sex_option              \\n    ,birthday                \\n    ,phone                   \\n    ,age_option              \\n    ,credent_type            \\n    ,id_card_no              \\n    ,province                \\n    ,city                    \\n    ,area                    \\n    ,town                    \\n    ,address                 \\n    ,trade_channel_types     \\n    ,trade_channel_ids       \\n    ,intentional_type        \\n    ,membership_adviser_id   \\n    ,visit_count             \\n    ,return_visit_remind_time\\n    ,communication_content   \\n    ,remark                  \\n    ,visit_type              \\n    ,filling_time            \\n    ,questionnaire_id        \\n    ,del_flag                \\n    ,membership_id           \\n    ,membership_name         \\n    ,status                  \\n    ,phone_visit             \\n    ,receive_status          \\n    ,apartment_type          \\n    ,room_type               \\n    ,vitality_intention      \\n    ,customer_lv             \\n    ,consult_time            \\n    ,possible_customer       \\n    ,cost_type               \\n    ,age                     \\n    ,retire_worker           \\n    ,hobbies                 \\n    ,about_org               \\n    ,resistance \\nfrom db_nursing_crm.tb_intentional_customer \\nwhere str_to_date(create_time,'%Y-%m-%d') <str_to_date(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":72,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_intentional_customer\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[],\"id\":\"tasks-63876\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"咨询客户\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_advisory_customer\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select \\n     advisory_customer_id  \\n    ,customer_name         \\n    ,phone_number          \\n    ,intentional_type      \\n    ,sex                   \\n    ,reception_date        \\n    ,sales_consultant_id   \\n    ,sales_consultant_name \\n    ,visit_count           \\n    ,linked_customer_num   \\n    ,create_time           \\n    ,update_time           \\n    ,create_user_id        \\n    ,org_id                \\n    ,sub_org_id            \\n    ,status\\nfrom db_pension_organization.tb_advisory_customer\\nwhere DATE_FORMAT(if(update_time is null ,create_time,update_time),'%Y-%m-%d') <DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_advisory_customer\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_intentional_customer\"],\"id\":\"tasks-17215\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"客户回访表\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_intentional_customer_visit\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select \\n     visit_id                 \\n    ,create_time              \\n    ,create_user_id           \\n    ,create_user_name         \\n    ,org_id                   \\n    ,sub_org_id               \\n    ,customer_id              \\n    ,membership_id            \\n    ,membership_name          \\n    ,intentional_type         \\n    ,return_visit_remind_time \\n    ,visit_date               \\n    ,visit_type               \\n    ,content                  \\n    ,remark\\nfrom db_nursing_crm.tb_intentional_customer_visit\\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') <DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":72,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_intentional_customer_visit\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_advisory_customer\"],\"id\":\"tasks-95026\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_account\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n account_id\\n,account_serial_number\\n,account_template_id\\n,old_man_id\\n,balance\\n,org_id\\n,sub_org_id\\n,create_time\\n,update_time\\n,state\\n,account_name\\n,attributes\\n,symbol\\nfrom db_pension_organization.tb_hr_account \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_account\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[],\"id\":\"tasks-32408\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_account_fee_setting\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n account_fee_setting_id\\n,account_template_id\\n,fee_item_id\\n,org_id\\n,sub_org_id\\n,create_time\\n,update_time\\n,state\\nfrom db_pension_organization.tb_hr_account_fee_setting \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_account_fee_setting\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_account\"],\"id\":\"tasks-98721\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_account_serial_number\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n id\\n,account_serial_number\\n,old_man_id\\n,org_id\\n,sub_org_id\\n,create_time\\n,status\\nfrom db_pension_organization.tb_hr_account_serial_number \\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_account_serial_number\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_account_fee_setting\"],\"id\":\"tasks-58586\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_account_template\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n account_template_id\\n,account_name\\n,attributes\\n,symbol\\n,description\\n,org_id\\n,sub_org_id\\n,state\\n,create_time\\n,update_time\\n,default_recharge_amount\\n,default_notice_amount\\nfrom db_pension_organization.tb_hr_account_template \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_account_template\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_account_serial_number\"],\"id\":\"tasks-22403\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_assess_item\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n     assess_id   \\n    ,parent_id   \\n    ,score       \\n    ,type        \\n    ,name        \\n    ,des         \\n    ,level       \\n    ,single      \\n    ,create_time\\nfrom db_nursing_home.tb_assess_item \\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":60,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_assess_item\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_account_template\"],\"id\":\"tasks-62792\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_assess_item_score\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n     score_id   \\n    ,score      \\n    ,assess_id  \\n    ,old_man_id \\n    ,sub_org_id \\n    ,org_id     \\n    ,id_card_no \\n    ,admin_id   \\n    ,level      \\n    ,create_time\\n    ,state\\nfrom db_nursing_home.tb_assess_item_score \\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":60,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_assess_item_score\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_assess_item\"],\"id\":\"tasks-104\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_assess_item_selected\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n     select_id  \\n    ,assess_id  \\n    ,score_id   \\n    ,old_man_id \\n    ,selected   \\n    ,org_id     \\n    ,admin_id   \\n    ,create_time\\n    ,others\\nfrom db_nursing_home.tb_assess_item_selected \\nwhere date_format(create_time,'%Y-%m-%d') < date_format(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":60,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_assess_item_selected\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_assess_item_score\"],\"id\":\"tasks-87104\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_assess_report\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n assess_report_id\\n,assess_report_no\\n,old_man_id\\n,assess_report_status\\n,assess_report_level\\n,illness_level\\n,old_man_level\\n,nursing_level\\n,social_support_level\\n,illness_level_score_id\\n,old_man_level_score_id\\n,nursing_level_score_id\\n,social_support_level_score_id\\n,create_time\\n,update_time\\n,org_id\\n,sub_org_id\\n,state\\n,syndrome_number\\n,syndrome_score_id\\nfrom db_nursing_home.tb_assess_report \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":60,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_assess_report\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_assess_item_selected\"],\"id\":\"tasks-88549\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_basic_service_plan\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n plan_id\\n,service_project_id\\n,service_type_id\\n,service_frequency_status\\n,service_frequency\\n,service_object\\n,service_object_desc\\n,room_ids\\n,old_man_ids\\n,implementation_time\\n,every_flag\\n,service_keeper_ids\\n,supplier_id\\n,remark\\n,create_time\\n,update_time\\n,state\\n,org_id\\n,sub_org_id\\n,service_project_name\\n,service_type_name\\n,service_keeper_names\\n,create_user_id\\n,create_user_name\\n,old_man_check_in_id\\n,accurate_flag\\nfrom db_pension_organization.tb_basic_service_plan \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_basic_service_plan\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_assess_report\"],\"id\":\"tasks-23902\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_company_account\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n company_account_id\\n,bank_name\\n,bank_card_id\\n,description\\n,create_time\\n,update_time\\n,org_id\\n,sub_org_id\\n,create_user_id\\n,status\\nfrom db_pension_organization.tb_hr_company_account \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_company_account\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_basic_service_plan\"],\"id\":\"tasks-58211\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_contract\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n contract_id\\n,contract_num\\n,type\\n,old_man_id\\n,start_date\\n,end_date\\n,create_time\\n,update_time\\n,state\\n,user_id\\n,sub_org_id\\n,org_id\\n,manager_id\\n,old_man_check_in_id\\n,renew_day\\nfrom db_pension_organization.tb_contract \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_contract\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_company_account\"],\"id\":\"tasks-44103\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_contract_deposit\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n     deposit_id    \\n    ,deposit_num   \\n    ,intent_user_id\\n    ,payee_name    \\n    ,payee_phone   \\n    ,membership_id \\n    ,membership_name\\n    ,deposit_amount \\n    ,membership_adviser_id\\n    ,house_type_id\\n    ,pay_amount   \\n    ,refund_amount\\n    ,deposit_status\\n    ,user_id    \\n    ,sub_org_id \\n    ,org_id     \\n    ,remark     \\n    ,create_time\\n    ,update_time\\n    ,building_id\\n    ,floor_id\\n    ,room_id \\n    ,bed_id \\n    ,apply_id\\n    ,receipt_number\\nfrom db_nursing_crm.tb_contract_deposit \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') <DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":72,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_contract_deposit\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_contract\"],\"id\":\"tasks-62876\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_contract_files\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n     file_id\\n    ,file_name\\n    ,file_path\\n    ,contract_id\\n    ,update_time\\n    ,create_time\\nfrom db_nursing_crm.tb_contract_files\\nwhere DATE_FORMAT(if(update_time is null ,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":72,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_contract_files\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_contract_deposit\"],\"id\":\"tasks-43113\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_contract_sign\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n     sign_id          \\n    ,intent_user_id   \\n    ,contract_num     \\n    ,contract_status  \\n    ,membership_type  \\n    ,membership_name  \\n    ,membership_num   \\n    ,membership_amount\\n    ,chip_num         \\n    ,building_id      \\n    ,floor_id         \\n    ,room_id          \\n    ,bed_id           \\n    ,sign_house       \\n    ,originator_type  \\n    ,reason           \\n    ,is_pay_deposit   \\n    ,deposit_amount   \\n    ,deposit_num      \\n    ,received_fee     \\n    ,pay_state        \\n    ,sign_date        \\n    ,card_valid       \\n    ,house_type       \\n    ,other_amount     \\n    ,other_amount_explain\\n    ,is_divided          \\n    ,membership_effective_time \\n    ,membership_id    \\n    ,product_id       \\n    ,user_id          \\n    ,sub_org_id       \\n    ,org_id           \\n    ,update_time      \\n    ,create_time      \\n    ,cancle_time      \\n    ,manager_fee      \\n    ,living_limit     \\n    ,discount         \\n    ,total_deduction \\n    ,daily_deduction_limit     \\n    ,description   \\n    ,card_type     \\n    ,is_agency     \\n    ,agency_id     \\n    ,payment_type_id   \\n    ,payment_type_name \\n    ,service_fee_id    \\n    ,del_flag          \\n    ,service_fee_amount\\n    ,service_fee_name  \\n    ,is_trust    \\n    ,trust_limit \\n    ,trust_fee   \\n    ,trust_id    \\n    ,membership_discount\\n    ,apply_id       \\n    ,show_status    \\n    ,free_visit_day \\nfrom db_nursing_crm.tb_contract_sign \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') <DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":72,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_contract_sign\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_contract_files\"],\"id\":\"tasks-3668\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_countermand_pay_record\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n id\\n,old_man_id\\n,fee_amount\\n,account_id\\n,account_name\\n,balance\\n,create_time\\n,state\\n,org_id\\n,sub_org_id\\n,update_time\\n,old_man_check_in_id\\n,countermand_pay_id\\n,attributes\\nfrom db_pension_organization.tb_hr_countermand_pay_record \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_countermand_pay_record\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_contract_sign\"],\"id\":\"tasks-93490\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_coupon\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n id\\n,coupon_num\\n,user_type\\n,user_id\\n,user_name\\n,room_name\\n,coupon_setting_id\\n,type\\n,attributes\\n,apartment_name\\n,coupon_name\\n,coupon_amount\\n,period\\n,preferential_plan\\n,discount_fee_type\\n,discount_fee_id\\n,discount_fee_name\\n,valid_period_start\\n,valid_period_end\\n,create_time\\n,update_time\\n,org_id\\n,sub_org_id\\n,use_frequency\\n,balance\\n,use_name\\n,use_date\\n,use_status\\n,status\\nfrom db_pension_organization.tb_hr_coupon \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_coupon\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_countermand_pay_record\"],\"id\":\"tasks-42393\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_coupon_issue\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n id\\n,coupon_setting_id\\n,issue_type\\n,issue_id_list\\n,issue_name_list\\n,issue_coupon_id_list\\n,type\\n,attributes\\n,apartment_name\\n,coupon_name\\n,coupon_amount\\n,period\\n,preferential_plan\\n,discount_fee_type\\n,discount_fee_id\\n,discount_fee_name\\n,valid_period_start\\n,valid_period_end\\n,issue_user_id\\n,issue_user_name\\n,create_time\\n,update_time\\n,org_id\\n,sub_org_id\\n,status\\nfrom db_pension_organization.tb_hr_coupon_issue \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_coupon_issue\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_coupon\"],\"id\":\"tasks-77726\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_coupon_setting\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n id\\n,type\\n,attributes\\n,apartment_name\\n,coupon_name\\n,coupon_amount\\n,period\\n,preferential_plan\\n,discount_fee_type\\n,discount_fee_id\\n,discount_fee_name\\n,valid_period_start\\n,valid_period_end\\n,create_user_id\\n,create_user_name\\n,create_time\\n,update_time\\n,org_id\\n,sub_org_id\\n,status\\nfrom db_pension_organization.tb_hr_coupon_setting \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_coupon_setting\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_coupon_issue\"],\"id\":\"tasks-4219\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_customer_visit_record\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n visit_id\\n,create_time\\n,update_time\\n,create_user_id\\n,create_user_name\\n,org_id\\n,sub_org_id\\n,customer_id\\n,intentional_type\\n,return_visit_remind_time\\n,visit_date\\n,visit_type\\n,content\\n,remark\\n,status\\nfrom db_pension_organization.tb_customer_visit_record\\nwhere DATE_FORMAT(if(update_time is null ,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_customer_visit_record\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_coupon_setting\"],\"id\":\"tasks-88447\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_detail_record\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n fee_detail_record_id\\n,old_man_id\\n,fee_type_id\\n,fee_type_name\\n,fee_iteam_id\\n,fee_iteam_name\\n,fee_amount\\n,create_time\\n,state\\n,remark\\n,org_id\\n,sub_org_id\\n,update_time\\n,old_man_check_in_id\\n,visitor_id\\n,`type`\\n,sn\\n,child_id\\n,consumption_time\\nfrom db_pension_organization.tb_hr_fee_detail_record \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_detail_record\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[],\"id\":\"tasks-66369\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_discount_detail\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n     discount_id\\n    ,sign_id\\n    ,discount_name\\n    ,discount_code\\n    ,type\\n    ,value\\n    ,update_time\\n    ,create_time\\n    ,is_show\\n    ,recharge_amount\\n    ,discount_amount\\nfrom db_nursing_crm.tb_discount_detail\\nwhere DATE_FORMAT(if(update_time is null ,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":72,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_discount_detail\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_detail_record\"],\"id\":\"tasks-16929\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_execute_detail\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n execute_detail_id\\n,snap_item_id\\n,user_id\\n,state\\n,sub_org_id\\n,create_time\\n,update_time\\n,plan_id\\nfrom db_pension_organization.tb_sy_nurse_execute_detail \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_execute_detail\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_discount_detail\"],\"id\":\"tasks-13600\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_fee\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n     fee_id\\n    ,org_id\\n    ,sub_org_id\\n    ,number\\n    ,create_time\\n    ,update_time\\n    ,create_user_id\\n    ,fee_type\\n    ,type\\n    ,relation_id\\n    ,membership_name\\n    ,amount\\n    ,confirm_amount\\n    ,confirm_time\\n    ,confirm_user_id\\n    ,receive_type_option\\n    ,status\\n    ,del_flag\\n    ,source\\n    ,is_installment\\n    ,overdue_type\\n    ,overdue_amount\\n    ,model_status\\nfrom db_nursing_crm.tb_fee\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') <DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":72,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_fee\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_execute_detail\"],\"id\":\"tasks-35344\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_fee_detail\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n     detail_id\\n    ,fee_id\\n    ,create_time\\n    ,create_user_id\\n    ,name\\n    ,pre_receive_time\\n    ,confirm_time\\n    ,confirm_user_id\\n    ,amount\\n    ,receive_type_option\\n    ,status\\n    ,payment_detail_id\\n    ,overdue_fine\\n    ,confirm_amount\\n    ,deposits_amount\\n    ,stage_sum\\n    ,occupation_sum\\n    ,overdue_sum\\n    ,other_money_amount\\nfrom db_nursing_crm.tb_fee_detail\\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":72,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_fee_detail\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_fee\"],\"id\":\"tasks-58467\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_fee_item \",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n fee_item_id\\n,fee_type_id\\n,fee_item_name\\n,property\\n,cost\\n,meal\\n,description\\n,org_id\\n,sub_org_id\\n,create_time\\n,update_time\\n,state\\nfrom db_pension_organization.tb_hr_fee_item \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_fee_item \",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_fee_detail\"],\"id\":\"tasks-9441\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_fee_type\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n fee_type_id\\n,fee_type\\n,create_time\\n,update_time\\n,create_user_id\\n,org_id\\n,sub_org_id\\n,description\\n,status\\nfrom db_pension_organization.tb_hr_fee_type \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_fee_type\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_fee_item \"],\"id\":\"tasks-58120\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_food\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n food_id\\n,food_name\\n,food_type_id\\n,food_type_name\\n,food_price\\n,disease_taboo\\n,food_picture\\n,restaurant_id\\n,restaurant_name\\n,serving_time_id\\n,state\\n,org_id\\n,sub_org_id\\n,create_time\\n,update_time\\n,remark\\nfrom db_pension_organization.tb_hr_food \\nwhere DATE_FORMAT(if(update_time is null ,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_food\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_fee_type\"],\"id\":\"tasks-38051\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_food_order\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n order_id\\n,user_id\\n,order_date\\n,old_man_name\\n,bed_name\\n,bed_id\\n,room_id\\n,order_food\\n,amount\\n,delivery_state\\n,settlement_state\\n,deliveries_id\\n,deliveries\\n,delivery_time\\n,state\\n,org_id\\n,sub_org_id\\n,create_time\\n,update_time\\n,old_man_id\\n,old_man_check_in_id\\n,restaurant_id\\n,serving_time_id\\nfrom db_pension_organization.tb_hr_food_order \\nwhere DATE_FORMAT(if(update_time is null ,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_food_order\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_food\"],\"id\":\"tasks-25143\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_food_type\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n food_type_id\\n,food_type_name\\n,remark\\n,org_id\\n,sub_org_id\\n,create_time\\n,update_time\\n,status\\nfrom db_pension_organization.tb_hr_food_type \\nwhere DATE_FORMAT(if(update_time is null ,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\\n\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_food_type\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_food_order\"],\"id\":\"tasks-16841\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_increase_service\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n increase_service_id\\n,service_item_id\\n,service_item_name\\n,service_type_id\\n,service_type_name\\n,status\\n,attributes\\n,money\\n,apartment_money\\n,nursing_money\\n,units\\n,pic_url\\n,service_housekeeper_ids\\n,service_housekeeper\\n,suplier_id\\n,suplier_name\\n,sub_org_id\\n,org_id\\n,create_time\\n,update_time\\n,create_user_id\\n,update_user_id\\n,remark\\nfrom db_pension_organization.tb_increase_service \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_increase_service\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_food_type\"],\"id\":\"tasks-17782\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_inform\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n hr_inform_id\\n,hr_inform_type_id\\n,old_man_id\\n,agent_id\\n,sum_cost_money\\n,handle_type_id\\n,handle_content\\n,handle_time\\n,org_id\\n,sub_org_id\\n,state\\n,create_time\\n,update_time\\n,old_man_check_in_id\\n,agent_name\\n,source_code\\n,ignores\\nfrom db_pension_organization.tb_hr_inform \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_inform\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_increase_service\"],\"id\":\"tasks-11662\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_intention_customer\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n intention_customer_id\\n,old_man_id\\n,customer_name\\n,sex\\n,phone_num\\n,credent_type\\n,id_card_num\\n,birthday\\n,reception_date\\n,intentional_type\\n,sales_consultant_id\\n,sales_consultant_name\\n,linked_advisory_customer_id\\n,visit_count\\n,guardian_name\\n,guardian_sex\\n,relationship\\n,guardian_phone_num\\n,guardian_credent_type\\n,guardian_id_card_num\\n,remark\\n,care_level\\n,assess_status\\n,create_time\\n,create_user_id\\n,update_time\\n,sub_org_id\\n,org_id\\n,status\\nfrom db_pension_organization.tb_intention_customer\\nwhere DATE_FORMAT(if(update_time is null ,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_intention_customer\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_inform\"],\"id\":\"tasks-38907\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_member_account\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n id\\n,member_name\\n,card_type\\n,card_number\\n,phone\\n,amount\\n,member_type\\n,member_id\\n,org_id\\n,sub_org_id\\n,state\\n,create_time\\n,update_time\\n,remark\\n,member_status\\n,member_time\\nfrom db_pension_organization.tb_hr_member_account \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_member_account\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_intention_customer\"],\"id\":\"tasks-3-3g87fp\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_member_debit_record\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n debit_record_id\\n,member_id\\n,payee_id\\n,old_man_check_in_id\\n,real_pay_amount\\n,coupon_pay_amount\\n,state\\n,org_id\\n,sub_org_id\\n,type\\n,create_time\\n,update_time\\n,membership_num\\n,coupon_id\\nfrom db_pension_organization.tb_hr_member_debit_record \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_member_debit_record\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_member_account\"],\"id\":\"tasks-3-6fa50l\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_member_month_bill\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\nid\\n,member_id\\n,total_amount\\n,bill_time\\n,bill_status\\n,state\\n,org_id\\n,sub_org_id\\n,create_time\\n,update_time\\nfrom db_pension_organization.tb_hr_member_month_bill \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_member_month_bill\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_member_debit_record\"],\"id\":\"tasks-3-5wk4fq\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_member_month_bill_child\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\nid\\n,member_id\\n,old_man_id\\n,old_man_check_in_id\\n,fee_amount\\n,state\\n,remark\\n,org_id\\n,sub_org_id\\n,fee_status\\n,month_bill_id\\n,create_time\\n,update_time\\n,membership_num\\nfrom db_pension_organization.tb_hr_member_month_bill_child \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_member_month_bill_child\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_member_month_bill\"],\"id\":\"tasks-3-5h84sn\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_member_setting_cost\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n id\\n,membership_num\\n,man_id\\n,fee_relation_id\\n,cost\\n,state\\n,org_id\\n,sub_org_id\\n,type\\n,people_type\\n,create_time\\n,update_time\\nfrom db_pension_organization.tb_hr_member_setting_cost \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_member_setting_cost\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_member_month_bill_child\"],\"id\":\"tasks-3-2uq2rb\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_membership_owner\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n     id\\n    ,contract_id\\n    ,name\\n    ,sex\\n    ,birthday\\n    ,phone\\n    ,id_card\\n    ,card_type\\n    ,age\\n    ,census_register\\n    ,census_province_id\\n    ,census_province_name\\n    ,census_city_id\\n    ,census_city_name\\n    ,census_area_id\\n    ,census_area_name\\n    ,residence\\n    ,residence_province_id\\n    ,residence_province_name\\n    ,residence_city_id\\n    ,residence_city_name\\n    ,residence_area_id\\n    ,residence_area_name\\n    ,unit\\n    ,title\\n    ,hobbies\\n    ,physical_condition\\n    ,disease_history\\n    ,create_time\\n    ,type\\n    ,user_id\\n    ,org_id\\n    ,sub_org_id\\n    ,status\\n    ,audit_user_id\\nfrom db_nursing_crm.tb_membership_owner\\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":72,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_membership_owner\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_membership_apply\"],\"id\":\"tasks-3-69t5y3\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_metro_card\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n card_id\\n,card_no\\n,status\\n,nursin_homes_id\\n,sub_org_id\\n,org_id\\n,create_time\\n,update_time\\n,create_user_id\\n,create_user_name\\n,update_user_id\\n,update_user_name\\nfrom db_pension_organization.tb_metro_card \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_metro_card\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_membership_owner\"],\"id\":\"tasks-3-11b5xw\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_metro_card_cashier\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n id\\n,uid\\n,jobNumber\\n,name\\n,tel\\n,enable\\n,create_time\\n,sub_org_id\\nfrom db_pension_organization.tb_metro_card_cashier \\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\\n\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_metro_card_cashier\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_metro_card\"],\"id\":\"tasks-3-3185fr\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_metro_card_consumer\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n card_consumer_id\\n,card_no\\n,customer_user_id\\n,operate_type\\n,consumer_money\\n,consumer_time\\n,create_time\\n,nusring_home_id\\n,sub_org_id\\n,org_id\\n,cashier_uid\\n,sn\\n,user_id\\nfrom db_pension_organization.tb_metro_card_consumer \\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_metro_card_consumer\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_metro_card_cashier\"],\"id\":\"tasks-3-6hl4f7\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_metro_card_product\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n id\\n,uid\\n,parentUid\\n,sub_org_id\\n,create_time\\n,name\\nfrom db_pension_organization.tb_metro_card_product_category \\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_metro_card_product\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_metro_card_consumer\"],\"id\":\"tasks-3-1u45m8\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_metro_card_recharge\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n card_recharge_id\\n,card_no\\n,customer_user_id\\n,card_user_name\\n,user_type\\n,recharge_money\\n,gift_money\\n,recharge_time\\n,create_time\\n,nursing_home_id\\n,sub_org_id\\n,org_id\\n,balance\\n,user_id\\nfrom db_pension_organization.tb_metro_card_recharge \\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\\n\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_metro_card_recharge\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_metro_card_product\"],\"id\":\"tasks-3-2yl492\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_metro_card_statement\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n card_consumer_statement_id\\n,card_no\\n,sn\\n,customer_user_id\\n,name\\n,quantity\\n,total_amount\\n,create_time\\n,nusring_home_id\\n,sub_org_id\\n,org_id\\n,product_uid\\n,category_uid\\n,cashier_uid\\n,user_id\\n,operate_type\\nfrom db_pension_organization.tb_metro_card_consumer_statement \\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_metro_card_statement\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_metro_card_recharge\"],\"id\":\"tasks-3-5916il\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_metro_card_user\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n card_user_id\\n,card_no\\n,user_id\\n,user_name\\n,card_user_no\\n,birth_date\\n,customer_uid\\n,user_type\\n,door_permission\\n,consumer_permission\\n,contact_number\\n,room_name\\n,sex\\n,balance\\n,recharge_money\\n,gift_money\\n,status\\n,nursin_homes_id\\n,sub_org_id\\n,org_id\\n,create_time\\n,update_time\\n,create_user_id\\n,create_user_name\\n,update_user_id\\n,update_user_name\\n,old_man_check_in_id\\n,enables\\n,is_binding\\nfrom db_pension_organization.tb_metro_card_user \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_metro_card_user\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_metro_card_statement\"],\"id\":\"tasks-3-26i7gc\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_nurse_plan_snapshot\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n snap_item_id\\n,user_id\\n,sub_org_id\\n,project_id\\n,project_name\\n,project_type_id\\n,project_type_name\\n,frequency_type\\n,frequency_num\\n,count\\n,create_time\\n,update_time\\n,exec_date\\n,plan_id\\n,complete_stase\\nfrom db_pension_organization.tb_sy_nurse_plan_snapshot \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_nurse_plan_snapshot\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_customer_visit_record\"],\"id\":\"tasks-8-3x973e\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_nurse_project_type\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n project_type_id\\n,project_type_name\\n,state\\n,sub_org_id\\n,create_time\\n,update_time\\nfrom db_pension_organization.tb_sy_nurse_project_type \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_nurse_project_type\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_nurse_plan_snapshot\"],\"id\":\"tasks-8-xf2tp\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_old_man_reside\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n old_man_reside_id\\n,old_man_id\\n,membership_owner_id\\n,old_man_name\\n,old_man_type\\n,relation_id\\n,house_type\\n,house_type_name\\n,room_name\\n,room_area\\n,room_attribute\\n,building_id\\n,floor_id\\n,room_id\\n,bed_id\\n,nursin_homes_id\\n,membership_num\\n,card_type\\n,card_num\\n,sex\\n,birthday\\n,phone\\n,contact_information\\n,native_place\\n,reside_status\\n,reside_type\\n,reside_type_name\\n,estimated\\n,nursing_level_id\\n,nursing_level\\n,deposited\\n,deposit_amount\\n,reside_time\\n,reside_over_time\\n,create_user_id\\n,create_user_name\\n,update_user_id\\n,update_user_name\\n,org_id\\n,sub_org_id\\n,status\\n,create_time\\n,update_time\\n,charge_type\\nfrom db_pension_organization.tb_old_man_reside \\nwhere DATE_FORMAT(if(update_time is null ,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_old_man_reside\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_nurse_project_type\"],\"id\":\"tasks-8-65s3dc\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_pay_type\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n id\\n,pay_type_name\\n,state\\n,org_id\\n,sub_org_id\\n,create_time\\n,remark\\nfrom db_pension_organization.tb_hr_pay_type \\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_pay_type\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_old_man_reside\"],\"id\":\"tasks-8-1tm1ep\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_payment_detail\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n     payment_detail_id\\n    ,sign_id\\n    ,pay_amount\\n    ,occupancy_amount\\n    ,dead_line\\n    ,`sort`\\n    ,pay_rate\\n    ,pay_days\\n    ,is_occupancy\\n    ,occupancy_rate\\n    ,occupancy_days\\n    ,del_flag\\n    ,org_id\\n    ,sub_org_id\\n    ,create_time\\n    ,update_time\\n    ,default_scale\\n    ,overdue\\nfrom db_nursing_crm.tb_payment_detail\\nwhere DATE_FORMAT(if(update_time is null ,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":72,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_payment_detail\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_pay_type\"],\"id\":\"tasks-8-4od71t\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_recharge_record\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n id\\n,old_man_id\\n,fee_amount\\n,pay_type_id\\n,org_id\\n,sub_org_id\\n,create_time\\n,state\\n,remark\\n,payee\\n,payee_id\\n,update_time\\n,old_man_check_in_id\\n,account_id\\n,child_fee\\n,company_account_id\\n,recharge_number\\n,receipt_number\\n,pay_time\\nfrom db_pension_organization.tb_hr_recharge_record \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_recharge_record\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_metro_card_user\"],\"id\":\"tasks-3-56a77k\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_relatives_visit\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n     id\\n    ,old_man_id\\n    ,old_man_name\\n    ,old_man_room_name\\n    ,membership_number\\n    ,relatives_name\\n    ,sex\\n    ,phone\\n    ,card_type\\n    ,card_number\\n    ,visit_start_time\\n    ,visit_end_time\\n    ,visit_status\\n    ,visit_relation\\n    ,create_worker_id\\n    ,create_worker_name\\n    ,remark\\n    ,org_id\\n    ,sub_org_id\\n    ,state\\n    ,create_time\\n    ,update_time\\n    ,ex_id\\nfrom db_pension_organization.tb_relatives_visit \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_relatives_visit\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_recharge_record\"],\"id\":\"tasks-3-1uu2ud\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_reside_fee_setting\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n reside_fee_setting_id\\n,fee_item_id\\n,reside_type\\n,org_id\\n,sub_org_id\\n,create_time\\n,update_time\\n,state\\nfrom db_pension_organization.tb_hr_reside_fee_setting \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_reside_fee_setting\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_relatives_visit\"],\"id\":\"tasks-3-5wz6ll\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_service_item\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n service_item_id\\n,service_item_name\\n,service_type_id\\n,service_type_name\\n,service_status\\n,money\\n,units\\n,nursin_homes_id\\n,sub_org_id\\n,org_id\\n,status\\n,remark\\n,create_time\\n,update_time\\n,create_user_id\\n,create_user_name\\n,update_user_id\\n,update_user_name\\n,apartment_money\\n,nursing_money\\n,attributes\\nfrom db_pension_organization.tb_organization_service_item \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_service_item\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_reside_fee_setting\"],\"id\":\"tasks-3-ac3mw\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_service_record\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n increment_service_id\\n,old_man_name\\n,old_man_id\\n,service_type_name\\n,service_type_id\\n,service_project_id\\n,service_project_name\\n,service_type\\n,cost\\n,company\\n,number\\n,remarks\\n,total_cost\\n,settlement_status\\n,service_status\\n,service_time\\n,suplier_id\\n,suplier_name\\n,create_time\\n,update_time\\n,state\\n,org_id\\n,sub_org_id\\n,create_user_id\\n,create_user_name\\n,update_user_id\\n,update_user_name\\n,bed_id\\n,bed_name\\n,room_id\\n,room_name\\n,building_id\\n,building_name\\n,service_housekeeper_ids\\n,service_housekeeper\\n,third_flag\\n,old_man_check_in_id\\n,pic_url\\n,service_object\\n,floor_id\\n,floor_name\\n,service_finish_time\\n,evaluation_status\\n,valid_status\\n,time_stage\\n,is_accurate\\n,plan_id\\n,ignore_status\\nfrom db_pension_organization.tb_increment_service_record \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_service_record\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_payment_detail\"],\"id\":\"tasks-8-2v26qt\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_service_type\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n service_type_id\\n,service_type_name\\n,service_status\\n,nursin_homes_id\\n,sub_org_id\\n,org_id\\n,status\\n,remark\\n,create_time\\n,update_time\\n,create_user_id\\n,create_user_name\\n,update_user_id\\n,update_user_name\\nfrom db_pension_organization.tb_organization_service_item \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_service_type\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_service_record\"],\"id\":\"tasks-8-3r26w6\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_sy_nurse_plan\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n     item_id\\n    ,user_id\\n    ,sub_org_id\\n    ,project_id\\n    ,project_name\\n    ,project_type_id\\n    ,project_type_name\\n    ,frequency_type\\n    ,frequency_num\\n    ,create_time\\nfrom db_pension_organization.tb_sy_nurse_plan \\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_sy_nurse_plan\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_service_type\"],\"id\":\"tasks-8-6w942i\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_sy_nurse_programme\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n programme_id\\n,nurse_grade_id\\n,frequency_type\\n,frequency_num\\n,state\\n,sub_org_id\\n,create_time\\n,update_time\\n,project_id\\n,project_type_id\\n,project_name\\n,project_type_name\\nfrom db_pension_organization.tb_sy_nurse_programme \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_sy_nurse_programme\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_sy_nurse_plan\"],\"id\":\"tasks-8-5ax3k0\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_sy_nurse_project\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n project_id\\n,project_type_id\\n,project_name\\n,state\\n,sub_org_id\\n,create_time\\n,update_time\\nfrom db_pension_organization.tb_sy_nurse_project \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_sy_nurse_project\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_sy_nurse_programme\"],\"id\":\"tasks-8-2ps3ov\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_water_electricity_price\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\nid\\n,water_unit_price\\n,electricity_unit_price\\n,org_id\\n,sub_org_id\\n,create_time\\n,update_time\\n,status\\nfrom db_pension_organization.tb_hr_water_electricity_unit_price \\nwhere DATE_FORMAT(if(update_time is null ,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\\n\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_water_electricity_price\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_service_item\"],\"id\":\"tasks-3-1be2my\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_water_electricity_record\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n record_id\\n,user_id\\n,room_id\\n,room_name\\n,old_man_ids\\n,old_man_names\\n,cost_item\\n,this_date\\n,last_date\\n,this_value\\n,last_value\\n,price\\n,update_user_id\\n,settle_status\\n,state\\n,create_time\\n,org_id\\n,sub_org_id\\n,update_time\\n,remark\\nfrom db_pension_organization.tb_water_electricity_record \\nwhere DATE_FORMAT(if(update_time is null ,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\\n\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_water_electricity_record\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_water_electricity_price\"],\"id\":\"tasks-3-45a25n\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_old_man\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n old_man_id\\n,old_man_name\\n,id_card_no\\n,sex\\n,birthday\\n,lunar_birthday\\n,solar_birthday\\n,nurse_man_id\\n,need_nurse\\n,illness_case_ids\\n,location_id\\n,portrait_url\\n,phone\\n,contact_information\\n,old_man_startus\\n,nursin_homes_id\\n,create_time\\n,bed_id\\n,nurse_point_ids\\n,user_id\\n,admission_date\\n,checkin_date\\n,center_id\\n,nursing_level_id\\n,nursing_level\\n,service_scheme_id\\n,service_scheme_name\\nfrom db_nursing_home.tb_old_man\\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":60,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_old_man\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_org_nurse\"],\"id\":\"tasks-3-a56cv\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_old_man_extend\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n old_man_id\\n,linkman\\n,linkman_phone\\n,nation\\n,social_security_card\\n,card_place\\n,card_hospital\\n,education_degree\\n,religion\\n,marital_status\\n,living_status\\n,medical_costs\\n,finance_source\\n,dementia\\n,mental_disease\\n,sickness_history\\n,credent_type\\n,native_address\\n,guardian\\n,guardian_contactInfo\\n,guardian_phone\\n,guardian_relationship\\n,guardian_email\\n,native_place\\n,live_address\\n,live_city\\n,nursing_level\\n,ability_level\\n,politic_countenance\\n,blood_type\\n,is_local_household_registration\\n,retirement_career\\n,birthday_type\\n,nursing_grade_id\\n,emergency_name\\n,emergency_relationship\\n,emergency_contactInfo\\n,province\\n,city\\n,area\\n,address\\nfrom db_nursing_home.tb_old_man_extend\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":60,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_old_man_extend\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_old_man\"],\"id\":\"tasks-3-s778v\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_contract_files\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n     file_id\\n    ,file_name\\n    ,file_path\\n    ,contract_id\\n    ,update_time\\n    ,create_time\\nfrom db_nursing_crm.tb_contract_files\\nwhere DATE_FORMAT(if(update_time is null ,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":72,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_contract_files\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_old_man_extend\"],\"id\":\"tasks-3-937m\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_worker_new\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n     worker_id\\n    ,worker_name\\n    ,nurse_worker_id\\n    ,worker_role_id\\n    ,credent_type\\n    ,credent_number\\n    ,sex\\n    ,birthday\\n    ,natives_province\\n    ,natives_city\\n    ,native_address\\n    ,worker_type\\n    ,portrait_url\\n    ,phone\\n    ,org_id\\n    ,sub_org_id\\n    ,user_id\\n    ,worker_status\\n    ,nurse_home_id\\n    ,create_time\\n    ,update_time\\n    ,job_title\\n    ,center_id\\n    ,has_supplier\\n    ,personnel_type\\n    ,occupation_type\\n    ,position\\n    ,department_name\\n    ,department_id\\n    ,live_address\\nfrom db_csleep_account.tb_worker_new\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":67,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_worker_new\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_contract_files\"],\"id\":\"tasks-3-i32n0\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_check_in\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n old_man_check_in_id\\n,old_man_reside_id\\n,old_man_id\\n,contract_id\\n,membership_owner_id\\n,old_man_name\\n,old_man_type\\n,relation_id\\n,house_type\\n,house_type_name\\n,room_name\\n,room_area\\n,room_attribute\\n,building_id\\n,floor_id\\n,room_id\\n,bed_id\\n,nursin_homes_id\\n,membership_num\\n,card_type\\n,card_num\\n,sex\\n,birthday\\n,phone\\n,reside_status\\n,reside_type\\n,reside_type_name\\n,estimated\\n,nursing_level_id\\n,nursing_level\\n,deposited\\n,deposit_amount\\n,reside_time\\n,reside_over_time\\n,create_user_id\\n,create_user_name\\n,update_user_id\\n,update_user_name\\n,org_id\\n,sub_org_id\\n,status\\n,create_time\\n,update_time\\n,charge_type\\n,check_in_type\\n,check_in_name\\n,agent_id\\n,agent_name\\n,guardian\\n,guardian_phone\\n,guardian_relationship\\nfrom db_pension_organization.tb_old_man_check_in\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_check_in\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_worker_new\"],\"id\":\"tasks-3-59o6na\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_old_man_contract\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n contract_id\\n,pre_contract_id\\n,org_id\\n,sub_org_id\\n,create_time\\n,update_time\\n,state\\n,old_man_check_in_id\\nfrom db_pension_organization.tb_hr_old_man_contract\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_old_man_contract\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_check_in\"],\"id\":\"tasks-3-3vx3aq\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_membership\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n id\\n,contract_id\\n,membership_status\\n,return_status\\n,return_amount\\n,return_amount_status\\n,return_date\\n,transfer_status\\n,user_id\\n,sub_org_id\\n,org_id\\n,update_time\\n,create_time\\n,overdue_type\\n,overdue_amount\\nfrom db_nursing_crm.tb_membership\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":72,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_membership\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_old_man_contract\"],\"id\":\"tasks-3-5tv12q\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_location_room\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n room_id\\n,floor_id\\n,room_name\\n,create_time\\n,inside_room_types\\n,nursing_homes_id\\n,room_type\\n,house_type_id\\n,house_type_name\\n,orientation\\n,orientation_name\\n,room_attribute\\n,room_area\\n,sales_status\\nfrom db_nursing_home.tb_location_room\\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":60,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_location_room\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_membership\"],\"id\":\"tasks-3-7121f1\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_location_floor\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n floor_id\\n,building_id\\n,floor_name\\n,create_time\\n,nursing_homes_id\\nfrom db_nursing_home.tb_location_floor\\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":60,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_location_floor\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_location_room\"],\"id\":\"tasks-3-6wp2pb\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_location_bed\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n bed_id\\n,room_id\\n,bed_name\\n,create_time\\n,nursing_homes_id\\n,day_cost\\n,month_cost\\n,sales_status\\nfrom db_nursing_home.tb_location_bed\\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":60,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_location_bed\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_location_floor\"],\"id\":\"tasks-3-237p1\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_location_building\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n building_id\\n,nursing_homes_id\\n,building_name\\n,create_time\\n,type\\n,floor_amount\\n,floor_room_amount\\n,room_sacreage\\n,building_sacreage\\n,total_sacreage\\n,location_describe\\n,use_describe\\n,inside_room_types\\n,house_type_id\\n,orientation\\n,room_attribute\\nfrom db_nursing_home.tb_location_building\\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":60,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_location_building\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_location_bed\"],\"id\":\"tasks-3-73w57z\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_integral_goods\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\nid\\n,integral_goods_id\\n,integral_goods_name\\n,use_integral\\n,create_time\\n,update_time\\n,create_user_id\\n,update_user_id\\n,status\\n,org_id\\n,sub_org_id\\nfrom db_pension_organization.tb_integral_goods\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_integral_goods\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_location_building\"],\"id\":\"tasks-3-2bb63q\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_product\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n product_id       \\n,dev_sub_key_id         \\n,device_subtype_id  \\n,device_type_id     \\n,developer_id     \\n,product_version  \\n,product_icon     \\n,bind_type        \\n,bind_type_version\\n,module_id        \\n,product_name     \\n,product_code     \\n,device_key       \\n,`mode`           \\n,brand_id         \\n,status           \\n,radiocast_name   \\n,remark           \\n,qrcode           \\n,create_time      \\n,modify_time      \\n,bar_code         \\n,ssid             \\n,ssid_password    \\n,program_burning_file     \\n,functional_schematic_diagram_file as functional_schematic_file\\n,bill_of_material_file    \\n,is_auto_config            \\n,port_number              \\n,gateway_type             \\n,third_category_id\\nfrom db_device.tb_product\\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":69,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_product\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_integral_goods\"],\"id\":\"tasks-3-7b759e\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_device_subtype\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n dev_sub_key_id\\n,device_subtype_id\\n,device_type_id\\n,device_subtype_name\\n,device_subtype_icon\\n,status\\n,remark\\n,create_time\\n,modify_time\\n,is_show\\n,control_class\\nfrom db_device.tb_device_subtype\\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":69,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_device_subtype\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_device_category\"],\"id\":\"tasks-3-1sp3lc\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_device_type\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n device_type_id\\n,device_type_name\\n,device_icon\\n,status\\n,remark\\n,create_time\\n,modify_time\\n,is_show\\n,sub_category_id\\n,default_device_subtype_id\\n,all_category_name \\nfrom db_device.tb_device_type\\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":69,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_device_type\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_device_subtype\"],\"id\":\"tasks-3-3hcbe\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_trade_channel\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\nid\\n,trade_channel_name\\n,channel_type\\n,remark\\n,create_time\\n,user_id\\n,org_id\\n,sub_org_id\\nfrom db_nursing_crm.tb_trade_channel\\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":72,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_trade_channel\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_device_type\"],\"id\":\"tasks-3-1n2671\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_trade_channel_type\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n id\\n,channel_type_name\\n,remark\\n,create_time\\n,user_id\\n,org_id\\n,sub_org_id\\nfrom db_nursing_crm.tb_trade_channel_type\\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":72,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_trade_channel_type\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_trade_channel\"],\"id\":\"tasks-3-5fs33x\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_card_product\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n product_id\\n,create_time\\n,create_user_id\\n,org_id\\n,sub_org_id\\n,card_id\\n,batch\\n,card_fee\\n,manager_fee\\n,living_limit\\n,card_valid\\n,status\\n,del_flag\\n,room_type_option\\n,discount\\n,total_deduction\\n,daily_deduction_limit\\n,description\\n,product_num\\nfrom db_nursing_crm.tb_card_product\\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":72,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_card_product\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_trade_channel_type\"],\"id\":\"tasks-3-2h5bz\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_card\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n card_id\\n,create_time\\n,create_user_id\\n,create_user_name\\n,card_name\\n,type_option\\n,type\\n,org_id\\n,use_type\\n,sub_orgs\\n,inherit_status\\n,inherit_fee\\n,transfer_status\\n,transfer_fee\\n,return_status\\n,return_fee\\n,borrow_status\\n,borrow_fee\\n,renewal_status\\n,renewal_fee\\n,check_in_status\\n,max_check_in\\n,sojourn_status\\n,max_sojourn\\n,room_status\\n,room_count\\n,discount_status\\n,discount_des\\n,health_check_status\\n,health_check_des\\n,exclusive_status\\n,exclusive_des\\n,priority_residence_status\\n,priority_residence_des\\n,travel_status\\n,travel_des\\n,age_limit_status\\n,woman_min_age_limit\\n,woman_max_age_limit\\n,man_max_age_limit\\n,man_min_age_limit\\n,time_limit_status\\n,min_time_limit\\n,max_time_limit\\n,min_time_unit\\n,constitution_name\\n,constitution_url\\n,description\\n,del_flag\\nfrom db_nursing_crm.tb_card\\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":72,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_card\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_card_product\"],\"id\":\"tasks-3-5v64c\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_activity_room\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\nid\\n,room_name\\n,status\\n,location\\n,nursing_homes_id\\n,create_time\\n,start\\n,end\\n,available_time_range\\n,work_id\\n,update_time\\n,max_time\\nfrom db_nursing_home.tb_activity_room\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":60,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_activity_room\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_card\"],\"id\":\"tasks-3-475728\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_org_nurse\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n id  \\n,org_id\\n,sub_org_id\\n,orgname as org_name\\n,suborgname as sub_org_name\\n,nurse_home_id\\n,nurse_admin_id\\n,create_time\\n,update_time\\nfrom db_nursing_home.tb_org_nurse \\nwhere str_to_date(if(update_time is null ,create_time,update_time),'%Y-%m-%d') < str_to_date(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":60,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_org_nurse\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_water_electricity_record\"],\"id\":\"tasks-3-5jb3nn\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":94,\"dtType\":\"HIVE\",\"dataTarget\":103,\"sql\":\"select\\n city_id           \\n,area_id           \\n,area_name         \\n,area_english_name \\n,weather_code      \\nfrom db_acquire_data.tb_area\",\"targetTable\":\"clife_hr_ods_area\",\"partition\":\"\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_area\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_activity_room\"],\"id\":\"tasks-87794\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":94,\"dtType\":\"HIVE\",\"dataTarget\":103,\"sql\":\"select\\n province_id      \\n,city_id          \\n,baidu_city_code  \\n,city_name        \\n,city_english_name\\n,longitude        \\n,latitude         \\n,is_capital       \\nfrom db_acquire_data.tb_city\",\"targetTable\":\"clife_hr_ods_city\",\"partition\":\"\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_city\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_area\"],\"id\":\"tasks-8-45c79c\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":94,\"dtType\":\"HIVE\",\"dataTarget\":103,\"sql\":\"select\\n partition_id          \\n,province_id           \\n,province_name         \\n,province_english_name \\n,longitude             \\n,latitude              \\n,baidu_code            \\nfrom db_acquire_data.tb_province\",\"targetTable\":\"clife_hr_ods_province\",\"partition\":\"\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_province\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_city\"],\"id\":\"tasks-8-1ds46j\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":94,\"dtType\":\"HIVE\",\"dataTarget\":103,\"sql\":\"select\\n country_id     \\n,partition_id   \\n,partition_name \\nfrom db_acquire_data.tb_partition\",\"targetTable\":\"clife_hr_ods_partition\",\"partition\":\"\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_partition\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_province\"],\"id\":\"tasks-8-59fbk\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":94,\"dtType\":\"HIVE\",\"dataTarget\":103,\"sql\":\"select\\n country_id        \\n,country_name      \\n,country_en_name   \\nfrom db_acquire_data.tb_country\",\"targetTable\":\"clife_hr_ods_country\",\"partition\":\"\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_country\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_partition\"],\"id\":\"tasks-8-5zd7f1\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"customConfig\":4,\"json\":{\"mode\":\"2\",\"targetTable\":\"clife_hr_dim_date\",\"resourceId\":57,\"targetDatasourceId\":104,\"fields\":[{\"dataType\":\"string\",\"columnName\":\"dt_code\"},{\"dataType\":\"string\",\"columnName\":\"date_s\"},{\"dataType\":\"string\",\"columnName\":\"date_w\"},{\"dataType\":\"string\",\"columnName\":\"date_cn\"},{\"dataType\":\"string\",\"columnName\":\"y_code\"},{\"dataType\":\"string\",\"columnName\":\"q_code\"},{\"dataType\":\"string\",\"columnName\":\"q_code_cn\"},{\"dataType\":\"string\",\"columnName\":\"m_code\"},{\"dataType\":\"string\",\"columnName\":\"m_code_cn\"},{\"dataType\":\"string\",\"columnName\":\"week_of_month_cn\"},{\"dataType\":\"string\",\"columnName\":\"week_of_year_cn\"},{\"dataType\":\"string\",\"columnName\":\"d_code\"},{\"dataType\":\"string\",\"columnName\":\"day_of_year_cn\"},{\"dataType\":\"string\",\"columnName\":\"week_cn\"}],\"separator\":\"1\"}},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_dim_data\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_country\"],\"id\":\"tasks-80573\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_month_bill\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n id                  \\n,total_amount       \\n,bill_time          \\n,bill_status        \\n,state              \\n,org_id             \\n,sub_org_id         \\n,create_time        \\n,update_time        \\n,old_man_id         \\n,old_man_check_in_id\\nfrom db_pension_organization.tb_hr_month_bill\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_month_bill\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_dim_data\"],\"id\":\"tasks-15612\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_month_bill_child\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n id        \\n,old_man_id\\n,UNIX_TIMESTAMP(consumption_time)as consumption_time\\n,fee_type_id        \\n,fee_type_name      \\n,fee_iteam_id       \\n,fee_iteam_name     \\n,fee_amount         \\n,create_time        \\n,state              \\n,remark             \\n,org_id             \\n,sub_org_id         \\n,fee_status         \\n,month_bill_id      \\n,update_time        \\n,old_man_check_in_id\\n,sn                 \\n,refund_amount      \\nfrom db_pension_organization.tb_hr_month_bill_child\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_month_bill_child\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_month_bill\"],\"id\":\"tasks-1-23y68q\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_org_activity_room_reserve\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\nid\\n,reserve_time\\n,activity_room_id\\n,type\\n,start_time\\n,end_time\\n,nurse_home_id\\n,create_time\\n,activity_id\\n,org_id\\n,sub_org_id\\n,reserve_user_id\\n,reserve_user\\n,reserve_use\\n,reserve_user_type\\n,reserve_source\\n,reserve_status\\n,remark\\n,activity_room_name\\n,make_time\\nfrom db_pension_organization.tb_organization_activity_room_reserve\\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_org_activity_room_reserve\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_month_bill_child\"],\"id\":\"tasks-1-54762z\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_org_activity_room\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\nid\\n,room_name\\n,room_status\\n,location\\n,nursing_homes_id\\n,create_time\\n,start\\n,end\\n,available_time_range\\n,work_id\\n,update_time\\n,max_time\\n,org_id\\n,sub_org_id\\n,max_num\\nfrom db_pension_organization.tb_organization_activity_room\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_org_activity_room\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_org_activity_room_reserve\"],\"id\":\"tasks-1-6v74l4\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_org_activity_template\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\ntemplate_id\\n,activity_name\\n,address\\n,activity_start\\n,activity_end\\n,organizer\\n,activity_desc\\n,state\\n,create_time\\n,update_time\\n,activity_type\\n,apply_time\\n,sign_time\\n,activity_room_id\\n,create_user_id\\n,org_id\\n,sub_org_id\\n,source\\n,activity_img\\n,apply_max\\n,app_max\\n,remind_time\\n,activity_fee\\n,activity_object\\nfrom db_pension_organization.tb_organization_activity_template\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_org_activity_template\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_org_activity_room\"],\"id\":\"tasks-1-56o6dg\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_org_activity\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\nactivity_id\\n,nurse_home_id\\n,activity_name\\n,address\\n,activity_start\\n,activity_end\\n,organizer\\n,activity_desc\\n,state\\n,create_time\\n,update_time\\n,activity_type\\n,apply_time\\n,sign_time\\n,activity_room_id\\n,activity_status\\n,activity_time\\n,create_user_id\\n,org_id\\n,sub_org_id\\n,source\\n,activity_img\\n,apply_max\\n,template_id\\n,app_max\\n,remind_time\\n,remark\\n,activity_fee\\n,applyed_num\\n,activity_object\\n,apply_start_time\\n,activity_confirm\\n,activity_cancel\\n,need_apply\\nfrom db_pension_organization.tb_organization_activity\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_org_activity\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_org_activity_template\"],\"id\":\"tasks-1-3lkss\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":106,\"dtType\":\"HIVE\",\"dataTarget\":103,\"sql\":\"select\\nactivity_id\\n,old_man_id\\n,join_time\\n,sign_time\\n,sign_status\\n,apply_type\\n,apply_flag\\n,del_flag\\n,id\\n,attach_num\\n,source\\n,null as payment_status\\n,null as registration_status\\n,null as sign_up\\n,null as pay_cost\\n,null as activity_fee\\n,null as old_man_confirm\\n,remark\\nfrom db_pension_organization.tb_organization_activity_participant\",\"targetTable\":\"clife_hr_ods_org_activity_participant\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_org_activity_participant\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_org_activity\"],\"id\":\"tasks-1-5azoi\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_account_account\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n account_id\\n,phone\\n,email\\n,password\\n,source\\n,reg_time\\n,create_time\\n,status\\n,update_time\\n,invalid_appId\\n,create_user_id\\nfrom db_account.tb_account\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":57,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_account_account\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_org_activity_participant\"],\"id\":\"tasks-1-aa3hx\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_monitor_area\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n worker_id\\n,room_id\\n,create_time\\nfrom db_nursing_home.tb_monitor_area\\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":60,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_monitor_area\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_account_account\"],\"id\":\"tasks-1-5dv6nq\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_third_worker\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n tb_volunteer_id\\n,user_id\\n,work_id\\n,supplier_id\\n,tb_volunteer_name\\n,sex\\n,card_type\\n,id_card_no\\n,link_phone\\n,update_user_id\\n,create_user_name\\n,update_user_name\\n,clife_user_id\\n,org_id\\n,state\\n,create_time\\n,update_time\\n,remark\\nfrom db_pension_organization.tb_third_worker\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_third_worker\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_monitor_area\"],\"id\":\"tasks-1-2ub4n3\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_worker\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n worker_id\\n,worker_role_id\\n,worker_name\\n,sex\\n,phone\\n,user_id\\n,portrait_url\\n,nursing_homes_id\\n,worker_status\\n,job_title\\n,is_marketing_manager\\nfrom db_nursing_home.tb_worker\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":60,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_worker\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_third_worker\"],\"id\":\"tasks-1-4p45zd\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_old_man_model\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n old_man_id\\n,module_ids\\n,create_time\\n,module_id_sort\\nfrom db_nursing_home.tb_old_man_model\\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":60,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_old_man_model\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_worker\"],\"id\":\"tasks-1-3e51o\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_module\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n id\\n,module_id\\n,module_name\\n,modele_desc\\n,create_time\\n,modele_default\\nfrom db_nursing_home.tb_module\\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":60,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_module\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_old_man_model\"],\"id\":\"tasks-1-7j7y6\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_integral_record\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n integral_record_id\\n,old_man_id\\n,old_man_name\\n,integral\\n,integral_rule_id\\n,remark\\n,integral_type\\n,create_time\\n,update_time\\n,create_id\\n,update_id\\n,org_id\\n,sub_org_id\\n,status\\n,old_man_check_in_id\\nfrom db_pension_organization.tb_integral_record\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_integral_record\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_module\"],\"id\":\"tasks-1-6497nq\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_integral_issue_task\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n issue_sign_id\\n,task_sign_id\\n,old_man_ids\\n,issue_time\\n,deadline_time\\n,user_id\\n,org_id\\n,sub_org_id\\n,issue_status\\n,create_time\\nfrom db_pension_organization.tb_person_integral_issue_task\\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_integral_issue_task\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_integral_record\"],\"id\":\"tasks-1-5yn33k\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_settle_config\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n settle_config_id\\n,settle_day\\n,settle_plan\\n,org_id\\n,sub_org_id\\n,create_time\\n,update_time\\n,state\\nfrom db_pension_organization.tb_hr_settle_config\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_settle_config\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_integral_issue_task\"],\"id\":\"tasks-1-7jo3vl\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_member_recharge_record\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n id\\n,member_id\\n,recharge_amount\\n,pay_type\\n,payee\\n,payee_id\\n,company_account_id\\n,pay_time\\n,org_id\\n,sub_org_id\\n,state\\n,receipt_number\\n,create_time\\n,update_time\\n,remark\\nfrom db_pension_organization.tb_hr_member_recharge_record\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_member_recharge_record\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_settle_config\"],\"id\":\"tasks-1-1id64i\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_admin_sub_org\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n     sub_org_id       \\n    ,org_info_id      \\n    ,org_type         \\n    ,parent_org_id    \\n    ,org_id           \\n    ,org_name         \\n    ,org_account      \\n    ,org_account_id   \\n    ,org_password     \\n    ,valid_time       \\n    ,lose_time        \\n    ,org_desc         \\n    ,org_picture      \\n    ,status           \\n    ,app_id           \\n    ,org_code         \\n    ,org_group_id     \\n    ,handle_user      \\n    ,type             \\n    ,update_time      \\n    ,create_time      \\n    ,ubdertake_type   \\n    ,operation_model  \\n    ,org_lv           \\n    ,area             \\n    ,province         \\n    ,city             \\n    ,town             \\n    ,village          \\n    ,principal        \\n    ,link_phone       \\n    ,address          \\n    ,sub_org_type     \\n    ,area_id          \\n    ,service_province \\n    ,service_city     \\n    ,service_area     \\n    ,latitude         \\n    ,longitude\\nfrom db_csleep_account.tb_admin_sub_org \\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":67,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_admin_sub_org\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_admin_org\"],\"id\":\"tasks-1-7i657i\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_nurse_device\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n device_id         \\n,mac_address       \\n,device_type_id    \\n,bind_time         \\n,auth_user_id      \\n,device_sub_type_id\\n,product_id        \\n,device_num \\nfrom db_nursing_home.tb_nurse_device;\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":60,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_nurse_device\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_admin_sub_org\"],\"id\":\"tasks-1-tz2k0\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_nurse_third_device\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n     device_id            \\n    ,nurse_home_id        \\n    ,mac                  \\n    ,type                 \\n    ,sub_type             \\n    ,device_num           \\n    ,device_name          \\n    ,user_id              \\n    ,create_time          \\nfrom db_nursing_home.tb_nurse_third_device \\nwhere str_to_date(create_time,'%Y-%m-%d') < str_to_date(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":60,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_nurse_third_device\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_nurse_device\"],\"id\":\"tasks-1-6cbh7\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_intentional_customer_channel\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\ncustomer_id\\n,channel_id\\n,create_time\\nfrom db_nursing_crm.tb_intentional_customer_channel \\nwhere str_to_date(create_time,'%Y-%m-%d') < str_to_date(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":72,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_intentional_customer_channel\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_nurse_third_device\"],\"id\":\"tasks-1-5dmek\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_old_man_countermand\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n countermand_id\\n,old_man_id\\n,old_man_name\\n,card_type\\n,sex\\n,birthday\\n,nursing_level\\n,nursing_level_id\\n,card_num\\n,phone\\n,room_name\\n,buidlding_id\\n,floor_id\\n,room_id\\n,bed_id\\n,nursin_homes_id\\n,reside_time\\n,countermand_time\\n,countermand_reason\\n,file_url\\n,file_name\\n,countermand_type\\n,remark\\n,countermand_status\\n,create_user_id\\n,create_user_name\\n,update_user_id\\n,update_user_name\\n,org_id\\n,sub_org_id\\n,status\\n,create_time\\n,update_time\\n,old_man_check_in_id\\n,agent_id\\n,agent_name\\nfrom db_pension_organization.tb_old_man_countermand\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_old_man_countermand\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_intentional_customer_channel\"],\"id\":\"tasks-1-6z5lf\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_leave_reduction\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n leave_reduction_id\\n,old_leave_id\\n,status\\n,discounts_id\\n,leave_reducation_fee\\n,fee_name\\n,nursing_home_id\\n,org_id\\n,sub_org_id\\n,create_time\\n,update_time\\nfrom db_pension_organization.tb_leave_reduction\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_leave_reduction\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_old_man_countermand\"],\"id\":\"tasks-1-5y74yt\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_leave_refund\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n refund_id\\n,old_man_check_in_id\\n,elder_id\\n,elder_name\\n,room\\n,checkin_type\\n,old_leave_id\\n,charging_item_id\\n,item_number\\n,refund_type\\n,name\\n,day_time\\n,refund_amount\\n,create_time\\n,update_time\\n,state\\n,org_id\\n,sub_org_id\\nfrom db_pension_organization.tb_bl_leave_refund\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_leave_refund\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_leave_reduction\"],\"id\":\"tasks-1-6jn4cg\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_org_leave_discounts\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n leave_discounts_id\\n,discounts_type\\n,pay_day\\n,nursin_homes_id\\n,sub_org_id\\n,org_id\\n,status\\n,remark\\n,create_time\\n,update_time\\n,create_user_id\\n,create_user_name\\n,update_user_id\\n,update_user_name\\nfrom db_pension_organization.tb_organization_finance_leave_discounts\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_org_leave_discounts\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_leave_refund\"],\"id\":\"tasks-1-4n35ql\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_old_leave\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n old_leave_id\\n,old_man_name\\n,old_man_id\\n,start_time\\n,end_time\\n,leave_time\\n,accompany_name\\n,accompany_phone\\n,remarks\\n,appendix\\n,leave_status\\n,create_time\\n,update_time\\n,overtime_status\\n,return_time\\n,reality_time\\n,status\\n,sub_org_id\\n,org_id\\n,create_user_name\\n,create_user_id\\n,update_user_id\\n,update_user_name\\n,constant_id\\n,card_type\\n,card_num\\n,old_man_check_in_id\\n,leave_reason\\n,leave_type\\n,time_stage\\n,repatriation_name\\n,time_stage_return\\nfrom db_pension_organization.tb_old_leave\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_old_leave\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_org_leave_discounts\"],\"id\":\"tasks-1-6no28l\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_org_activity_evaluation\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n evaluation_id\\n,activity_id\\n,evaluation_type\\n,evaluation\\n,create_time\\n,old_man_id\\n,org_id\\n,sub_org_id\\nfrom db_pension_organization.tb_organization_activity_evaluation\\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_org_activity_evaluation\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_old_leave\"],\"id\":\"tasks-1-3sm1mw\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_org_activity_feedback\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n feedback_id\\n,activity_id\\n,feedback_type\\n,remark\\n,join_sum\\n,create_time\\n,user_id\\n,nurse_home_id\\n,org_id\\n,sub_org_id\\n,feedback_img\\nfrom db_pension_organization.tb_organization_activity_feedback\\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_org_activity_feedback\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_org_activity_evaluation\"],\"id\":\"tasks-1-4z8cl\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_nursing_homes_baseinfo\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n     nursing_homes_id\\n    ,nursing_homes_name\\n    ,partition_id\\n    ,province_id\\n    ,city_id\\n    ,area_id\\n    ,location_detail\\n    ,account_id\\n    ,manage_user_id\\n    ,status\\nfrom db_nursing_home.tb_nursing_homes_baseinfo;\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":60,\"dataTarget\":103},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_nursing_homes_baseinfo\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_org_activity_feedback\"],\"id\":\"tasks-1-48wlu\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_member_detail_record\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n fee_detail_record_id\\n,member_id\\n,fee_type_id\\n,fee_type_name\\n,fee_iteam_id\\n,fee_iteam_name\\n,fee_amount\\n,state\\n,org_id\\n,sub_org_id\\n,create_time\\n,update_time\\nfrom db_pension_organization.tb_hr_member_fee_detail_record\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_member_detail_record\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_nursing_homes_baseinfo\"],\"id\":\"tasks-1-7hn2f5\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_org_activity_apply\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n id\\n,activity_id\\n,old_man_id\\n,create_time\\n,apply_type\\n,org_id\\n,sub_org_id\\n,invite_type\\nfrom db_pension_organization.tb_organization_activity_apply\\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_org_activity_apply\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_member_detail_record\"],\"id\":\"tasks-1-5bh2a2\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"targetTable\":\"clife_hr_ods_increment_evaluate\",\"postStatements\":[],\"jobSpeedRecord\":1000,\"dtType\":\"HIVE\",\"dsType\":\"MYSQL\",\"jobSpeedByte\":0,\"sql\":\"select\\n old_man_id\\n,increment_service_id\\n,service_name\\n,service_time\\n,evaluate_grade\\n,evaluate_explain\\n,evaluate_photo\\n,evaluate_status\\n,service_status\\n,evaluate_id\\n,state\\n,create_time\\n,sub_org_id\\n,old_man_check_in_id\\nfrom db_pension_organization.tb_increment_evaluate\\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"preStatements\":[],\"partition\":\"'${system.biz.date}'\",\"customConfig\":0,\"splitPk\":\"\",\"dataSource\":106,\"dataTarget\":103},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_increment_evaluate\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_org_activity_apply\"],\"id\":\"tasks-1-1rr7l7\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":72,\"dtType\":\"HIVE\",\"dataTarget\":103,\"sql\":\"select \\n     apply_id            \\n    ,create_time         \\n    ,create_user_id      \\n    ,org_id              \\n    ,sub_org_id          \\n    ,customer_id         \\n    ,name                \\n    ,sex_option          \\n    ,birthday            \\n    ,phone               \\n    ,credent_type        \\n    ,id_card_no          \\n    ,nationality         \\n    ,native_province     \\n    ,native_city         \\n    ,native_area         \\n    ,native_address      \\n    ,live_province       \\n    ,live_city           \\n    ,live_area           \\n    ,live_address\\n    ,company             \\n    ,job\\n    ,hobbies\\n    ,physical_condition  \\n    ,disease_history     \\n    ,membership_id\\n    ,membership_name     \\n    ,room_type_option    \\n    ,checkin_time_option \\n    ,checkin_date\\n    ,checkin_count_option\\n    ,status\\n    ,del_flag\\nfrom db_nursing_crm.tb_membership_apply\\nwhere DATE_FORMAT(create_time,'%Y-%m-%d') <DATE_FORMAT(now(),'%Y-%m-%d');\",\"targetTable\":\"clife_hr_ods_membership_apply\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_membership_apply\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[],\"id\":\"tasks-3-60p137\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":69,\"dtType\":\"HIVE\",\"dataTarget\":103,\"sql\":\"select\\n sub_category_id\\n,category_id\\n,category_name\\n,sub_category_name\\n,status\\nfrom db_device.tb_device_category\",\"targetTable\":\"clife_hr_ods_device_category\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_device_category\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_intentional_customer_visit\"],\"id\":\"tasks-3-2oy356\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"DATAX\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":67,\"dtType\":\"HIVE\",\"dataTarget\":103,\"sql\":\"select\\n     org_id           \\n    ,org_info_id      \\n    ,org_type         \\n    ,org_name         \\n    ,org_account      \\n    ,org_account_id   \\n    ,org_password     \\n    ,valid_time       \\n    ,lose_time        \\n    ,org_desc         \\n    ,org_picture      \\n    ,status           \\n    ,app_id           \\n    ,org_code         \\n    ,org_group_id     \\n    ,handle_user      \\n    ,type             \\n    ,update_time      \\n    ,create_time      \\n    ,principal        \\n    ,link_phone       \\n    ,area             \\n    ,province         \\n    ,city             \\n    ,town             \\n    ,address          \\n    ,null as latitude         \\n    ,null as longitude        \\nfrom db_csleep_account.tb_admin_org\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"targetTable\":\"clife_hr_ods_admin_org\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_ods_admin_org\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_ods_member_setting_cost\"],\"id\":\"tasks-1-4e06wh\",\"workerGroup\":-1},{\"type\":\"DATAX\",\"id\":\"tasks-48470\",\"name\":\"clife_hr_ods_membership_transfer\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":72,\"dtType\":\"HIVE\",\"dataTarget\":103,\"sql\":\"select \\n id                            -- '主键id'\\n  ,membership_id                 -- '会籍id'\\n  ,contract_id                   -- '合同id'\\n  ,pre_transfer_owners           -- '原会籍的权益人，用“,”分割'\\n  ,pre_contract_id               -- '原合同id'\\n  ,transfer_date                 -- '转让/继承日期'\\n  ,state                         -- '会籍转让/继承状态 1-未确认 2-确认转让 3-审批中'\\n  ,other_amount                  --'其他费用'\\n  ,other_amount_explain          -- '其他费用说明'\\n  ,transfer_fee                  --'转让/继承费'\\n  ,transfer_fee_status           -- '转让/继承费状态 1-未收 2-已收'\\n  ,audit_user_id                 -- '审批人id'\\n  ,type                          -- '类型（1-会籍转让 2-会籍继承）'\\n  ,del_flag                      -- '删除标记（0-否 1-是）'\\n  ,remark                        --'备注'\\n  ,user_id                       --'创建账号id'\\n  ,org_id                        --'集团id'\\n  ,sub_org_id                    --'机构id'\\n  ,transfer_nature               --'转让性质(1-赠与，2-转让)'\\n  ,create_time                   -- '创建时间'\\n  ,update_time                   -- '更新时间'\\n  from\\n  db_nursing_crm.tb_membership_transfer\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"targetTable\":\"clife_hr_ods_membership_transfer\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_ods_sy_nurse_project\"]},{\"type\":\"DATAX\",\"id\":\"tasks-55372\",\"name\":\"clife_hr_ods_membership_withdraw\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":72,\"dtType\":\"HIVE\",\"dataTarget\":103,\"sql\":\"select \\n  id                   --'主键id'\\n  ,contract_id          --'合同id'\\n  ,remain_day           --'剩余天数'\\n  ,apply_date           --'申请日期'\\n  ,apply_person         --'申请人'\\n  ,audit_user_id        --'审批人id'\\n  ,handler_person       --'经手人'\\n  ,withdraw_reason      --'退会籍原因'\\n  ,cancle_fee_status    --'是否退会费 1-否 2-是'\\n  ,del_flag             --'删除标记（0-否 1-是）'\\n  ,org_id               --'集团id'\\n  ,sub_org_id           --'机构id'\\n  ,create_time          --'创建时间'\\n  ,update_time          --'更新时间'\\n  ,premium_type         --'退费类型 1：回购 2：身故退费 3:退会籍'\\n  from \\n   db_nursing_crm.tb_membership_withdraw\\nwhere DATE_FORMAT(if(update_time is null,create_time,update_time),'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"targetTable\":\"clife_hr_ods_membership_withdraw\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_ods_product\"]},{\"type\":\"DATAX\",\"id\":\"tasks-5-4ut280\",\"name\":\"clife_hr_ods_checkin_pay_record\",\"params\":{\"customConfig\":0,\"dsType\":\"MYSQL\",\"dataSource\":106,\"dtType\":\"HIVE\",\"dataTarget\":103,\"sql\":\"select\\n id\\n,old_man_id\\n,fee_amount\\n,fee_item_id\\n,fee_text\\n,create_time\\n,state\\n,org_id\\n,sub_org_id\\n,pay_status\\n,update_time\\n,old_man_check_in_id\\n,reside_type\\n,receipt_number\\n,pay_method_id\\t    \\n,pay_time\\n,refund_amount\\nfrom db_pension_organization.tb_hr_checkin_pay_record\\nwhere DATE_FORMAT(update_time,'%Y-%m-%d') < DATE_FORMAT(now(),'%Y-%m-%d');\",\"targetTable\":\"clife_hr_ods_checkin_pay_record\",\"partition\":\"'${system.biz.date}'\",\"splitPk\":\"\",\"jobSpeedByte\":0,\"jobSpeedRecord\":1000,\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_ods_membership_withdraw\"]}],\"tenantId\":-1,\"timeout\":0}",
			"description": "",
			"globalParams": "[]",
			"globalParamList": [],
			"globalParamMap": {},
			"createTime": "2021-07-20T01:46:38.000+0000",
			"updateTime": "2021-08-11T10:24:32.000+0000",
			"flag": "YES",
			"userId": 143,
			"userName": "shucang0907",
			"projectName": null,
			"locations": "{\"tasks-63876\":{\"name\":\"clife_hr_ods_intentional_customer\",\"targetarr\":\"\",\"nodenumber\":\"0\",\"x\":170,\"y\":360},\"tasks-17215\":{\"name\":\"clife_hr_ods_advisory_customer\",\"targetarr\":\"tasks-63876\",\"nodenumber\":\"0\",\"x\":340,\"y\":360},\"tasks-95026\":{\"name\":\"clife_hr_ods_intentional_customer_visit\",\"targetarr\":\"tasks-17215\",\"nodenumber\":\"0\",\"x\":510,\"y\":360},\"tasks-32408\":{\"name\":\"clife_hr_ods_account\",\"targetarr\":\"\",\"nodenumber\":\"0\",\"x\":170,\"y\":120},\"tasks-98721\":{\"name\":\"clife_hr_ods_account_fee_setting\",\"targetarr\":\"tasks-32408\",\"nodenumber\":\"0\",\"x\":340,\"y\":120},\"tasks-58586\":{\"name\":\"clife_hr_ods_account_serial_number\",\"targetarr\":\"tasks-98721\",\"nodenumber\":\"0\",\"x\":510,\"y\":120},\"tasks-22403\":{\"name\":\"clife_hr_ods_account_template\",\"targetarr\":\"tasks-58586\",\"nodenumber\":\"0\",\"x\":680,\"y\":120},\"tasks-62792\":{\"name\":\"clife_hr_ods_assess_item\",\"targetarr\":\"tasks-22403\",\"nodenumber\":\"0\",\"x\":850,\"y\":120},\"tasks-104\":{\"name\":\"clife_hr_ods_assess_item_score\",\"targetarr\":\"tasks-62792\",\"nodenumber\":\"0\",\"x\":1020,\"y\":120},\"tasks-87104\":{\"name\":\"clife_hr_ods_assess_item_selected\",\"targetarr\":\"tasks-104\",\"nodenumber\":\"0\",\"x\":1190,\"y\":120},\"tasks-88549\":{\"name\":\"clife_hr_ods_assess_report\",\"targetarr\":\"tasks-87104\",\"nodenumber\":\"0\",\"x\":1360,\"y\":120},\"tasks-23902\":{\"name\":\"clife_hr_ods_basic_service_plan\",\"targetarr\":\"tasks-88549\",\"nodenumber\":\"0\",\"x\":1530,\"y\":120},\"tasks-58211\":{\"name\":\"clife_hr_ods_company_account\",\"targetarr\":\"tasks-23902\",\"nodenumber\":\"0\",\"x\":1700,\"y\":120},\"tasks-44103\":{\"name\":\"clife_hr_ods_contract\",\"targetarr\":\"tasks-58211\",\"nodenumber\":\"0\",\"x\":1870,\"y\":120},\"tasks-62876\":{\"name\":\"clife_hr_ods_contract_deposit\",\"targetarr\":\"tasks-44103\",\"nodenumber\":\"0\",\"x\":2040,\"y\":120},\"tasks-43113\":{\"name\":\"clife_hr_ods_contract_files\",\"targetarr\":\"tasks-62876\",\"nodenumber\":\"0\",\"x\":2217,\"y\":125},\"tasks-3668\":{\"name\":\"clife_hr_ods_contract_sign\",\"targetarr\":\"tasks-43113\",\"nodenumber\":\"0\",\"x\":2380,\"y\":120},\"tasks-93490\":{\"name\":\"clife_hr_ods_countermand_pay_record\",\"targetarr\":\"tasks-3668\",\"nodenumber\":\"0\",\"x\":2550,\"y\":120},\"tasks-42393\":{\"name\":\"clife_hr_ods_coupon\",\"targetarr\":\"tasks-93490\",\"nodenumber\":\"0\",\"x\":2720,\"y\":120},\"tasks-77726\":{\"name\":\"clife_hr_ods_coupon_issue\",\"targetarr\":\"tasks-42393\",\"nodenumber\":\"0\",\"x\":2890,\"y\":120},\"tasks-4219\":{\"name\":\"clife_hr_ods_coupon_setting\",\"targetarr\":\"tasks-77726\",\"nodenumber\":\"0\",\"x\":3060,\"y\":120},\"tasks-88447\":{\"name\":\"clife_hr_ods_customer_visit_record\",\"targetarr\":\"tasks-4219\",\"nodenumber\":\"0\",\"x\":3230,\"y\":120},\"tasks-66369\":{\"name\":\"clife_hr_ods_detail_record\",\"targetarr\":\"\",\"nodenumber\":\"0\",\"x\":170,\"y\":480},\"tasks-16929\":{\"name\":\"clife_hr_ods_discount_detail\",\"targetarr\":\"tasks-66369\",\"nodenumber\":\"0\",\"x\":340,\"y\":480},\"tasks-13600\":{\"name\":\"clife_hr_ods_execute_detail\",\"targetarr\":\"tasks-16929\",\"nodenumber\":\"0\",\"x\":510,\"y\":480},\"tasks-35344\":{\"name\":\"clife_hr_ods_fee\",\"targetarr\":\"tasks-13600\",\"nodenumber\":\"0\",\"x\":680,\"y\":480},\"tasks-58467\":{\"name\":\"clife_hr_ods_fee_detail\",\"targetarr\":\"tasks-35344\",\"nodenumber\":\"0\",\"x\":850,\"y\":480},\"tasks-9441\":{\"name\":\"clife_hr_ods_fee_item \",\"targetarr\":\"tasks-58467\",\"nodenumber\":\"0\",\"x\":1020,\"y\":480},\"tasks-58120\":{\"name\":\"clife_hr_ods_fee_type\",\"targetarr\":\"tasks-9441\",\"nodenumber\":\"0\",\"x\":1190,\"y\":480},\"tasks-38051\":{\"name\":\"clife_hr_ods_food\",\"targetarr\":\"tasks-58120\",\"nodenumber\":\"0\",\"x\":1360,\"y\":480},\"tasks-25143\":{\"name\":\"clife_hr_ods_food_order\",\"targetarr\":\"tasks-38051\",\"nodenumber\":\"0\",\"x\":1530,\"y\":480},\"tasks-16841\":{\"name\":\"clife_hr_ods_food_type\",\"targetarr\":\"tasks-25143\",\"nodenumber\":\"0\",\"x\":1700,\"y\":480},\"tasks-17782\":{\"name\":\"clife_hr_ods_increase_service\",\"targetarr\":\"tasks-16841\",\"nodenumber\":\"0\",\"x\":1870,\"y\":480},\"tasks-11662\":{\"name\":\"clife_hr_ods_inform\",\"targetarr\":\"tasks-17782\",\"nodenumber\":\"0\",\"x\":2040,\"y\":480},\"tasks-38907\":{\"name\":\"clife_hr_ods_intention_customer\",\"targetarr\":\"tasks-11662\",\"nodenumber\":\"0\",\"x\":2210,\"y\":480},\"tasks-3-3g87fp\":{\"name\":\"clife_hr_ods_member_account\",\"targetarr\":\"tasks-38907\",\"nodenumber\":\"0\",\"x\":2380,\"y\":480},\"tasks-3-6fa50l\":{\"name\":\"clife_hr_ods_member_debit_record\",\"targetarr\":\"tasks-3-3g87fp\",\"nodenumber\":\"0\",\"x\":2550,\"y\":480},\"tasks-3-5wk4fq\":{\"name\":\"clife_hr_ods_member_month_bill\",\"targetarr\":\"tasks-3-6fa50l\",\"nodenumber\":\"0\",\"x\":2720,\"y\":480},\"tasks-3-5h84sn\":{\"name\":\"clife_hr_ods_member_month_bill_child\",\"targetarr\":\"tasks-3-5wk4fq\",\"nodenumber\":\"0\",\"x\":2890,\"y\":480},\"tasks-3-2uq2rb\":{\"name\":\"clife_hr_ods_member_setting_cost\",\"targetarr\":\"tasks-3-5h84sn\",\"nodenumber\":\"0\",\"x\":3060,\"y\":480},\"tasks-3-69t5y3\":{\"name\":\"clife_hr_ods_membership_owner\",\"targetarr\":\"tasks-3-60p137\",\"nodenumber\":\"0\",\"x\":340,\"y\":240},\"tasks-3-11b5xw\":{\"name\":\"clife_hr_ods_metro_card\",\"targetarr\":\"tasks-3-69t5y3\",\"nodenumber\":\"0\",\"x\":510,\"y\":240},\"tasks-3-3185fr\":{\"name\":\"clife_hr_ods_metro_card_cashier\",\"targetarr\":\"tasks-3-11b5xw\",\"nodenumber\":\"0\",\"x\":680,\"y\":240},\"tasks-3-6hl4f7\":{\"name\":\"clife_hr_ods_metro_card_consumer\",\"targetarr\":\"tasks-3-3185fr\",\"nodenumber\":\"0\",\"x\":850,\"y\":240},\"tasks-3-1u45m8\":{\"name\":\"clife_hr_ods_metro_card_product\",\"targetarr\":\"tasks-3-6hl4f7\",\"nodenumber\":\"0\",\"x\":1020,\"y\":240},\"tasks-3-2yl492\":{\"name\":\"clife_hr_ods_metro_card_recharge\",\"targetarr\":\"tasks-3-1u45m8\",\"nodenumber\":\"0\",\"x\":1190,\"y\":240},\"tasks-3-5916il\":{\"name\":\"clife_hr_ods_metro_card_statement\",\"targetarr\":\"tasks-3-2yl492\",\"nodenumber\":\"0\",\"x\":1360,\"y\":240},\"tasks-3-26i7gc\":{\"name\":\"clife_hr_ods_metro_card_user\",\"targetarr\":\"tasks-3-5916il\",\"nodenumber\":\"0\",\"x\":1530,\"y\":240},\"tasks-8-3x973e\":{\"name\":\"clife_hr_ods_nurse_plan_snapshot\",\"targetarr\":\"tasks-88447\",\"nodenumber\":\"0\",\"x\":3400,\"y\":120},\"tasks-8-xf2tp\":{\"name\":\"clife_hr_ods_nurse_project_type\",\"targetarr\":\"tasks-8-3x973e\",\"nodenumber\":\"0\",\"x\":3570,\"y\":120},\"tasks-8-65s3dc\":{\"name\":\"clife_hr_ods_old_man_reside\",\"targetarr\":\"tasks-8-xf2tp\",\"nodenumber\":\"0\",\"x\":3740,\"y\":120},\"tasks-8-1tm1ep\":{\"name\":\"clife_hr_ods_pay_type\",\"targetarr\":\"tasks-8-65s3dc\",\"nodenumber\":\"0\",\"x\":3910,\"y\":120},\"tasks-8-4od71t\":{\"name\":\"clife_hr_ods_payment_detail\",\"targetarr\":\"tasks-8-1tm1ep\",\"nodenumber\":\"0\",\"x\":4080,\"y\":120},\"tasks-3-56a77k\":{\"name\":\"clife_hr_ods_recharge_record\",\"targetarr\":\"tasks-3-26i7gc\",\"nodenumber\":\"0\",\"x\":1700,\"y\":240},\"tasks-3-1uu2ud\":{\"name\":\"clife_hr_ods_relatives_visit\",\"targetarr\":\"tasks-3-56a77k\",\"nodenumber\":\"0\",\"x\":1870,\"y\":240},\"tasks-3-5wz6ll\":{\"name\":\"clife_hr_ods_reside_fee_setting\",\"targetarr\":\"tasks-3-1uu2ud\",\"nodenumber\":\"0\",\"x\":2040,\"y\":240},\"tasks-3-ac3mw\":{\"name\":\"clife_hr_ods_service_item\",\"targetarr\":\"tasks-3-5wz6ll\",\"nodenumber\":\"0\",\"x\":2206,\"y\":241},\"tasks-8-2v26qt\":{\"name\":\"clife_hr_ods_service_record\",\"targetarr\":\"tasks-8-4od71t\",\"nodenumber\":\"0\",\"x\":4250,\"y\":120},\"tasks-8-3r26w6\":{\"name\":\"clife_hr_ods_service_type\",\"targetarr\":\"tasks-8-2v26qt\",\"nodenumber\":\"0\",\"x\":4420,\"y\":120},\"tasks-8-6w942i\":{\"name\":\"clife_hr_ods_sy_nurse_plan\",\"targetarr\":\"tasks-8-3r26w6\",\"nodenumber\":\"0\",\"x\":4590,\"y\":120},\"tasks-8-5ax3k0\":{\"name\":\"clife_hr_ods_sy_nurse_programme\",\"targetarr\":\"tasks-8-6w942i\",\"nodenumber\":\"0\",\"x\":4760,\"y\":120},\"tasks-8-2ps3ov\":{\"name\":\"clife_hr_ods_sy_nurse_project\",\"targetarr\":\"tasks-8-5ax3k0\",\"nodenumber\":\"1\",\"x\":4930,\"y\":120},\"tasks-3-1be2my\":{\"name\":\"clife_hr_ods_water_electricity_price\",\"targetarr\":\"tasks-3-ac3mw\",\"nodenumber\":\"0\",\"x\":2380,\"y\":240},\"tasks-3-45a25n\":{\"name\":\"clife_hr_ods_water_electricity_record\",\"targetarr\":\"tasks-3-1be2my\",\"nodenumber\":\"0\",\"x\":2550,\"y\":240},\"tasks-3-a56cv\":{\"name\":\"clife_hr_ods_old_man\",\"targetarr\":\"tasks-3-5jb3nn\",\"nodenumber\":\"0\",\"x\":2890,\"y\":240},\"tasks-3-s778v\":{\"name\":\"clife_hr_ods_old_man_extend\",\"targetarr\":\"tasks-3-a56cv\",\"nodenumber\":\"0\",\"x\":3060,\"y\":240},\"tasks-3-937m\":{\"name\":\"clife_hr_ods_contract_files\",\"targetarr\":\"tasks-3-s778v\",\"nodenumber\":\"0\",\"x\":3230,\"y\":240},\"tasks-3-i32n0\":{\"name\":\"clife_hr_ods_worker_new\",\"targetarr\":\"tasks-3-937m\",\"nodenumber\":\"0\",\"x\":3400,\"y\":240},\"tasks-3-59o6na\":{\"name\":\"clife_hr_ods_check_in\",\"targetarr\":\"tasks-3-i32n0\",\"nodenumber\":\"0\",\"x\":3570,\"y\":240},\"tasks-3-3vx3aq\":{\"name\":\"clife_hr_ods_old_man_contract\",\"targetarr\":\"tasks-3-59o6na\",\"nodenumber\":\"0\",\"x\":3740,\"y\":240},\"tasks-3-5tv12q\":{\"name\":\"clife_hr_ods_membership\",\"targetarr\":\"tasks-3-3vx3aq\",\"nodenumber\":\"0\",\"x\":3910,\"y\":240},\"tasks-3-7121f1\":{\"name\":\"clife_hr_ods_location_room\",\"targetarr\":\"tasks-3-5tv12q\",\"nodenumber\":\"0\",\"x\":4080,\"y\":240},\"tasks-3-6wp2pb\":{\"name\":\"clife_hr_ods_location_floor\",\"targetarr\":\"tasks-3-7121f1\",\"nodenumber\":\"0\",\"x\":4250,\"y\":240},\"tasks-3-237p1\":{\"name\":\"clife_hr_ods_location_bed\",\"targetarr\":\"tasks-3-6wp2pb\",\"nodenumber\":\"0\",\"x\":4420,\"y\":240},\"tasks-3-73w57z\":{\"name\":\"clife_hr_ods_location_building\",\"targetarr\":\"tasks-3-237p1\",\"nodenumber\":\"0\",\"x\":4590,\"y\":240},\"tasks-3-2bb63q\":{\"name\":\"clife_hr_ods_integral_goods\",\"targetarr\":\"tasks-3-73w57z\",\"nodenumber\":\"0\",\"x\":4760,\"y\":240},\"tasks-3-7b759e\":{\"name\":\"clife_hr_ods_product\",\"targetarr\":\"tasks-3-2bb63q\",\"nodenumber\":\"1\",\"x\":4930,\"y\":240},\"tasks-3-1sp3lc\":{\"name\":\"clife_hr_ods_device_subtype\",\"targetarr\":\"tasks-3-2oy356\",\"nodenumber\":\"0\",\"x\":850,\"y\":360},\"tasks-3-3hcbe\":{\"name\":\"clife_hr_ods_device_type\",\"targetarr\":\"tasks-3-1sp3lc\",\"nodenumber\":\"0\",\"x\":1020,\"y\":360},\"tasks-3-1n2671\":{\"name\":\"clife_hr_ods_trade_channel\",\"targetarr\":\"tasks-3-3hcbe\",\"nodenumber\":\"0\",\"x\":1190,\"y\":360},\"tasks-3-5fs33x\":{\"name\":\"clife_hr_ods_trade_channel_type\",\"targetarr\":\"tasks-3-1n2671\",\"nodenumber\":\"0\",\"x\":1360,\"y\":360},\"tasks-3-2h5bz\":{\"name\":\"clife_hr_ods_card_product\",\"targetarr\":\"tasks-3-5fs33x\",\"nodenumber\":\"0\",\"x\":1530,\"y\":360},\"tasks-3-5v64c\":{\"name\":\"clife_hr_ods_card\",\"targetarr\":\"tasks-3-2h5bz\",\"nodenumber\":\"0\",\"x\":1700,\"y\":360},\"tasks-3-475728\":{\"name\":\"clife_hr_ods_activity_room\",\"targetarr\":\"tasks-3-5v64c\",\"nodenumber\":\"0\",\"x\":1870,\"y\":360},\"tasks-3-5jb3nn\":{\"name\":\"clife_hr_ods_org_nurse\",\"targetarr\":\"tasks-3-45a25n\",\"nodenumber\":\"0\",\"x\":2720,\"y\":240},\"tasks-87794\":{\"name\":\"clife_hr_ods_area\",\"targetarr\":\"tasks-3-475728\",\"nodenumber\":\"0\",\"x\":2040,\"y\":360},\"tasks-8-45c79c\":{\"name\":\"clife_hr_ods_city\",\"targetarr\":\"tasks-87794\",\"nodenumber\":\"0\",\"x\":2205,\"y\":357},\"tasks-8-1ds46j\":{\"name\":\"clife_hr_ods_province\",\"targetarr\":\"tasks-8-45c79c\",\"nodenumber\":\"0\",\"x\":2336,\"y\":357},\"tasks-8-59fbk\":{\"name\":\"clife_hr_ods_partition\",\"targetarr\":\"tasks-8-1ds46j\",\"nodenumber\":\"0\",\"x\":2550,\"y\":360},\"tasks-8-5zd7f1\":{\"name\":\"clife_hr_ods_country\",\"targetarr\":\"tasks-8-59fbk\",\"nodenumber\":\"0\",\"x\":2720,\"y\":360},\"tasks-80573\":{\"name\":\"clife_hr_dim_data\",\"targetarr\":\"tasks-8-5zd7f1\",\"nodenumber\":\"0\",\"x\":2890,\"y\":360},\"tasks-15612\":{\"name\":\"clife_hr_ods_month_bill\",\"targetarr\":\"tasks-80573\",\"nodenumber\":\"0\",\"x\":3060,\"y\":360},\"tasks-1-23y68q\":{\"name\":\"clife_hr_ods_month_bill_child\",\"targetarr\":\"tasks-15612\",\"nodenumber\":\"0\",\"x\":3230,\"y\":360},\"tasks-1-54762z\":{\"name\":\"clife_hr_ods_org_activity_room_reserve\",\"targetarr\":\"tasks-1-23y68q\",\"nodenumber\":\"0\",\"x\":3400,\"y\":360},\"tasks-1-6v74l4\":{\"name\":\"clife_hr_ods_org_activity_room\",\"targetarr\":\"tasks-1-54762z\",\"nodenumber\":\"0\",\"x\":3570,\"y\":360},\"tasks-1-56o6dg\":{\"name\":\"clife_hr_ods_org_activity_template\",\"targetarr\":\"tasks-1-6v74l4\",\"nodenumber\":\"0\",\"x\":3740,\"y\":360},\"tasks-1-3lkss\":{\"name\":\"clife_hr_ods_org_activity\",\"targetarr\":\"tasks-1-56o6dg\",\"nodenumber\":\"0\",\"x\":3910,\"y\":360},\"tasks-1-5azoi\":{\"name\":\"clife_hr_ods_org_activity_participant\",\"targetarr\":\"tasks-1-3lkss\",\"nodenumber\":\"0\",\"x\":4080,\"y\":360},\"tasks-1-aa3hx\":{\"name\":\"clife_hr_ods_account_account\",\"targetarr\":\"tasks-1-5azoi\",\"nodenumber\":\"0\",\"x\":4250,\"y\":360},\"tasks-1-5dv6nq\":{\"name\":\"clife_hr_ods_monitor_area\",\"targetarr\":\"tasks-1-aa3hx\",\"nodenumber\":\"0\",\"x\":4420,\"y\":360},\"tasks-1-2ub4n3\":{\"name\":\"clife_hr_ods_third_worker\",\"targetarr\":\"tasks-1-5dv6nq\",\"nodenumber\":\"0\",\"x\":4590,\"y\":360},\"tasks-1-4p45zd\":{\"name\":\"clife_hr_ods_worker\",\"targetarr\":\"tasks-1-2ub4n3\",\"nodenumber\":\"0\",\"x\":4760,\"y\":360},\"tasks-1-3e51o\":{\"name\":\"clife_hr_ods_old_man_model\",\"targetarr\":\"tasks-1-4p45zd\",\"nodenumber\":\"0\",\"x\":4930,\"y\":360},\"tasks-1-7j7y6\":{\"name\":\"clife_hr_ods_module\",\"targetarr\":\"tasks-1-3e51o\",\"nodenumber\":\"0\",\"x\":5100,\"y\":360},\"tasks-1-6497nq\":{\"name\":\"clife_hr_ods_integral_record\",\"targetarr\":\"tasks-1-7j7y6\",\"nodenumber\":\"0\",\"x\":5270,\"y\":360},\"tasks-1-5yn33k\":{\"name\":\"clife_hr_ods_integral_issue_task\",\"targetarr\":\"tasks-1-6497nq\",\"nodenumber\":\"0\",\"x\":5440,\"y\":360},\"tasks-1-7jo3vl\":{\"name\":\"clife_hr_ods_settle_config\",\"targetarr\":\"tasks-1-5yn33k\",\"nodenumber\":\"0\",\"x\":5610,\"y\":360},\"tasks-1-1id64i\":{\"name\":\"clife_hr_ods_member_recharge_record\",\"targetarr\":\"tasks-1-7jo3vl\",\"nodenumber\":\"0\",\"x\":5780,\"y\":360},\"tasks-1-7i657i\":{\"name\":\"clife_hr_ods_admin_sub_org\",\"targetarr\":\"tasks-1-4e06wh\",\"nodenumber\":\"0\",\"x\":3400,\"y\":480},\"tasks-1-tz2k0\":{\"name\":\"clife_hr_ods_nurse_device\",\"targetarr\":\"tasks-1-7i657i\",\"nodenumber\":\"0\",\"x\":3570,\"y\":480},\"tasks-1-6cbh7\":{\"name\":\"clife_hr_ods_nurse_third_device\",\"targetarr\":\"tasks-1-tz2k0\",\"nodenumber\":\"0\",\"x\":3740,\"y\":480},\"tasks-1-5dmek\":{\"name\":\"clife_hr_ods_intentional_customer_channel\",\"targetarr\":\"tasks-1-6cbh7\",\"nodenumber\":\"0\",\"x\":3910,\"y\":480},\"tasks-1-6z5lf\":{\"name\":\"clife_hr_ods_old_man_countermand\",\"targetarr\":\"tasks-1-5dmek\",\"nodenumber\":\"0\",\"x\":4080,\"y\":480},\"tasks-1-5y74yt\":{\"name\":\"clife_hr_ods_leave_reduction\",\"targetarr\":\"tasks-1-6z5lf\",\"nodenumber\":\"0\",\"x\":4250,\"y\":480},\"tasks-1-6jn4cg\":{\"name\":\"clife_hr_ods_leave_refund\",\"targetarr\":\"tasks-1-5y74yt\",\"nodenumber\":\"0\",\"x\":4420,\"y\":480},\"tasks-1-4n35ql\":{\"name\":\"clife_hr_ods_org_leave_discounts\",\"targetarr\":\"tasks-1-6jn4cg\",\"nodenumber\":\"0\",\"x\":4590,\"y\":480},\"tasks-1-6no28l\":{\"name\":\"clife_hr_ods_old_leave\",\"targetarr\":\"tasks-1-4n35ql\",\"nodenumber\":\"0\",\"x\":4760,\"y\":480},\"tasks-1-3sm1mw\":{\"name\":\"clife_hr_ods_org_activity_evaluation\",\"targetarr\":\"tasks-1-6no28l\",\"nodenumber\":\"0\",\"x\":4930,\"y\":480},\"tasks-1-4z8cl\":{\"name\":\"clife_hr_ods_org_activity_feedback\",\"targetarr\":\"tasks-1-3sm1mw\",\"nodenumber\":\"0\",\"x\":5100,\"y\":480},\"tasks-1-48wlu\":{\"name\":\"clife_hr_ods_nursing_homes_baseinfo\",\"targetarr\":\"tasks-1-4z8cl\",\"nodenumber\":\"0\",\"x\":5270,\"y\":480},\"tasks-1-7hn2f5\":{\"name\":\"clife_hr_ods_member_detail_record\",\"targetarr\":\"tasks-1-48wlu\",\"nodenumber\":\"0\",\"x\":5440,\"y\":480},\"tasks-1-5bh2a2\":{\"name\":\"clife_hr_ods_org_activity_apply\",\"targetarr\":\"tasks-1-7hn2f5\",\"nodenumber\":\"0\",\"x\":5610,\"y\":480},\"tasks-1-1rr7l7\":{\"name\":\"clife_hr_ods_increment_evaluate\",\"targetarr\":\"tasks-1-5bh2a2\",\"nodenumber\":\"0\",\"x\":5780,\"y\":480},\"tasks-3-60p137\":{\"name\":\"clife_hr_ods_membership_apply\",\"targetarr\":\"\",\"nodenumber\":\"0\",\"x\":170,\"y\":240},\"tasks-3-2oy356\":{\"name\":\"clife_hr_ods_device_category\",\"targetarr\":\"tasks-95026\",\"nodenumber\":\"0\",\"x\":680,\"y\":360},\"tasks-1-4e06wh\":{\"name\":\"clife_hr_ods_admin_org\",\"targetarr\":\"tasks-3-2uq2rb\",\"nodenumber\":\"0\",\"x\":3230,\"y\":480},\"tasks-48470\":{\"name\":\"clife_hr_ods_membership_transfer\",\"targetarr\":\"tasks-8-2ps3ov\",\"nodenumber\":\"0\",\"x\":5166,\"y\":120},\"tasks-55372\":{\"name\":\"clife_hr_ods_membership_withdraw\",\"targetarr\":\"tasks-3-7b759e\",\"nodenumber\":\"1\",\"x\":5152,\"y\":236},\"tasks-5-4ut280\":{\"name\":\"clife_hr_ods_checkin_pay_record\",\"targetarr\":\"tasks-55372\",\"nodenumber\":\"0\",\"x\":5391,\"y\":240}}",
			"connects": "[{\"endPointSourceId\":\"tasks-63876\",\"endPointTargetId\":\"tasks-17215\"},{\"endPointSourceId\":\"tasks-17215\",\"endPointTargetId\":\"tasks-95026\"},{\"endPointSourceId\":\"tasks-32408\",\"endPointTargetId\":\"tasks-98721\"},{\"endPointSourceId\":\"tasks-98721\",\"endPointTargetId\":\"tasks-58586\"},{\"endPointSourceId\":\"tasks-58586\",\"endPointTargetId\":\"tasks-22403\"},{\"endPointSourceId\":\"tasks-22403\",\"endPointTargetId\":\"tasks-62792\"},{\"endPointSourceId\":\"tasks-62792\",\"endPointTargetId\":\"tasks-104\"},{\"endPointSourceId\":\"tasks-104\",\"endPointTargetId\":\"tasks-87104\"},{\"endPointSourceId\":\"tasks-87104\",\"endPointTargetId\":\"tasks-88549\"},{\"endPointSourceId\":\"tasks-88549\",\"endPointTargetId\":\"tasks-23902\"},{\"endPointSourceId\":\"tasks-23902\",\"endPointTargetId\":\"tasks-58211\"},{\"endPointSourceId\":\"tasks-58211\",\"endPointTargetId\":\"tasks-44103\"},{\"endPointSourceId\":\"tasks-44103\",\"endPointTargetId\":\"tasks-62876\"},{\"endPointSourceId\":\"tasks-62876\",\"endPointTargetId\":\"tasks-43113\"},{\"endPointSourceId\":\"tasks-43113\",\"endPointTargetId\":\"tasks-3668\"},{\"endPointSourceId\":\"tasks-3668\",\"endPointTargetId\":\"tasks-93490\"},{\"endPointSourceId\":\"tasks-93490\",\"endPointTargetId\":\"tasks-42393\"},{\"endPointSourceId\":\"tasks-42393\",\"endPointTargetId\":\"tasks-77726\"},{\"endPointSourceId\":\"tasks-77726\",\"endPointTargetId\":\"tasks-4219\"},{\"endPointSourceId\":\"tasks-4219\",\"endPointTargetId\":\"tasks-88447\"},{\"endPointSourceId\":\"tasks-66369\",\"endPointTargetId\":\"tasks-16929\"},{\"endPointSourceId\":\"tasks-16929\",\"endPointTargetId\":\"tasks-13600\"},{\"endPointSourceId\":\"tasks-13600\",\"endPointTargetId\":\"tasks-35344\"},{\"endPointSourceId\":\"tasks-35344\",\"endPointTargetId\":\"tasks-58467\"},{\"endPointSourceId\":\"tasks-58467\",\"endPointTargetId\":\"tasks-9441\"},{\"endPointSourceId\":\"tasks-9441\",\"endPointTargetId\":\"tasks-58120\"},{\"endPointSourceId\":\"tasks-58120\",\"endPointTargetId\":\"tasks-38051\"},{\"endPointSourceId\":\"tasks-38051\",\"endPointTargetId\":\"tasks-25143\"},{\"endPointSourceId\":\"tasks-25143\",\"endPointTargetId\":\"tasks-16841\"},{\"endPointSourceId\":\"tasks-16841\",\"endPointTargetId\":\"tasks-17782\"},{\"endPointSourceId\":\"tasks-17782\",\"endPointTargetId\":\"tasks-11662\"},{\"endPointSourceId\":\"tasks-11662\",\"endPointTargetId\":\"tasks-38907\"},{\"endPointSourceId\":\"tasks-38907\",\"endPointTargetId\":\"tasks-3-3g87fp\"},{\"endPointSourceId\":\"tasks-3-3g87fp\",\"endPointTargetId\":\"tasks-3-6fa50l\"},{\"endPointSourceId\":\"tasks-3-6fa50l\",\"endPointTargetId\":\"tasks-3-5wk4fq\"},{\"endPointSourceId\":\"tasks-3-5wk4fq\",\"endPointTargetId\":\"tasks-3-5h84sn\"},{\"endPointSourceId\":\"tasks-3-5h84sn\",\"endPointTargetId\":\"tasks-3-2uq2rb\"},{\"endPointSourceId\":\"tasks-3-69t5y3\",\"endPointTargetId\":\"tasks-3-11b5xw\"},{\"endPointSourceId\":\"tasks-3-11b5xw\",\"endPointTargetId\":\"tasks-3-3185fr\"},{\"endPointSourceId\":\"tasks-3-3185fr\",\"endPointTargetId\":\"tasks-3-6hl4f7\"},{\"endPointSourceId\":\"tasks-3-6hl4f7\",\"endPointTargetId\":\"tasks-3-1u45m8\"},{\"endPointSourceId\":\"tasks-3-1u45m8\",\"endPointTargetId\":\"tasks-3-2yl492\"},{\"endPointSourceId\":\"tasks-3-2yl492\",\"endPointTargetId\":\"tasks-3-5916il\"},{\"endPointSourceId\":\"tasks-3-5916il\",\"endPointTargetId\":\"tasks-3-26i7gc\"},{\"endPointSourceId\":\"tasks-88447\",\"endPointTargetId\":\"tasks-8-3x973e\"},{\"endPointSourceId\":\"tasks-8-3x973e\",\"endPointTargetId\":\"tasks-8-xf2tp\"},{\"endPointSourceId\":\"tasks-8-xf2tp\",\"endPointTargetId\":\"tasks-8-65s3dc\"},{\"endPointSourceId\":\"tasks-8-65s3dc\",\"endPointTargetId\":\"tasks-8-1tm1ep\"},{\"endPointSourceId\":\"tasks-8-1tm1ep\",\"endPointTargetId\":\"tasks-8-4od71t\"},{\"endPointSourceId\":\"tasks-3-26i7gc\",\"endPointTargetId\":\"tasks-3-56a77k\"},{\"endPointSourceId\":\"tasks-3-56a77k\",\"endPointTargetId\":\"tasks-3-1uu2ud\"},{\"endPointSourceId\":\"tasks-3-1uu2ud\",\"endPointTargetId\":\"tasks-3-5wz6ll\"},{\"endPointSourceId\":\"tasks-3-5wz6ll\",\"endPointTargetId\":\"tasks-3-ac3mw\"},{\"endPointSourceId\":\"tasks-8-4od71t\",\"endPointTargetId\":\"tasks-8-2v26qt\"},{\"endPointSourceId\":\"tasks-8-2v26qt\",\"endPointTargetId\":\"tasks-8-3r26w6\"},{\"endPointSourceId\":\"tasks-8-3r26w6\",\"endPointTargetId\":\"tasks-8-6w942i\"},{\"endPointSourceId\":\"tasks-8-6w942i\",\"endPointTargetId\":\"tasks-8-5ax3k0\"},{\"endPointSourceId\":\"tasks-8-5ax3k0\",\"endPointTargetId\":\"tasks-8-2ps3ov\"},{\"endPointSourceId\":\"tasks-3-ac3mw\",\"endPointTargetId\":\"tasks-3-1be2my\"},{\"endPointSourceId\":\"tasks-3-1be2my\",\"endPointTargetId\":\"tasks-3-45a25n\"},{\"endPointSourceId\":\"tasks-3-45a25n\",\"endPointTargetId\":\"tasks-3-5jb3nn\"},{\"endPointSourceId\":\"tasks-3-a56cv\",\"endPointTargetId\":\"tasks-3-s778v\"},{\"endPointSourceId\":\"tasks-3-s778v\",\"endPointTargetId\":\"tasks-3-937m\"},{\"endPointSourceId\":\"tasks-3-937m\",\"endPointTargetId\":\"tasks-3-i32n0\"},{\"endPointSourceId\":\"tasks-3-i32n0\",\"endPointTargetId\":\"tasks-3-59o6na\"},{\"endPointSourceId\":\"tasks-3-59o6na\",\"endPointTargetId\":\"tasks-3-3vx3aq\"},{\"endPointSourceId\":\"tasks-3-3vx3aq\",\"endPointTargetId\":\"tasks-3-5tv12q\"},{\"endPointSourceId\":\"tasks-3-5tv12q\",\"endPointTargetId\":\"tasks-3-7121f1\"},{\"endPointSourceId\":\"tasks-3-7121f1\",\"endPointTargetId\":\"tasks-3-6wp2pb\"},{\"endPointSourceId\":\"tasks-3-6wp2pb\",\"endPointTargetId\":\"tasks-3-237p1\"},{\"endPointSourceId\":\"tasks-3-237p1\",\"endPointTargetId\":\"tasks-3-73w57z\"},{\"endPointSourceId\":\"tasks-3-73w57z\",\"endPointTargetId\":\"tasks-3-2bb63q\"},{\"endPointSourceId\":\"tasks-3-2bb63q\",\"endPointTargetId\":\"tasks-3-7b759e\"},{\"endPointSourceId\":\"tasks-3-1sp3lc\",\"endPointTargetId\":\"tasks-3-3hcbe\"},{\"endPointSourceId\":\"tasks-3-3hcbe\",\"endPointTargetId\":\"tasks-3-1n2671\"},{\"endPointSourceId\":\"tasks-3-1n2671\",\"endPointTargetId\":\"tasks-3-5fs33x\"},{\"endPointSourceId\":\"tasks-3-5fs33x\",\"endPointTargetId\":\"tasks-3-2h5bz\"},{\"endPointSourceId\":\"tasks-3-2h5bz\",\"endPointTargetId\":\"tasks-3-5v64c\"},{\"endPointSourceId\":\"tasks-3-5v64c\",\"endPointTargetId\":\"tasks-3-475728\"},{\"endPointSourceId\":\"tasks-3-5jb3nn\",\"endPointTargetId\":\"tasks-3-a56cv\"},{\"endPointSourceId\":\"tasks-87794\",\"endPointTargetId\":\"tasks-8-45c79c\"},{\"endPointSourceId\":\"tasks-8-45c79c\",\"endPointTargetId\":\"tasks-8-1ds46j\"},{\"endPointSourceId\":\"tasks-8-1ds46j\",\"endPointTargetId\":\"tasks-8-59fbk\"},{\"endPointSourceId\":\"tasks-8-59fbk\",\"endPointTargetId\":\"tasks-8-5zd7f1\"},{\"endPointSourceId\":\"tasks-8-5zd7f1\",\"endPointTargetId\":\"tasks-80573\"},{\"endPointSourceId\":\"tasks-3-475728\",\"endPointTargetId\":\"tasks-87794\"},{\"endPointSourceId\":\"tasks-80573\",\"endPointTargetId\":\"tasks-15612\"},{\"endPointSourceId\":\"tasks-15612\",\"endPointTargetId\":\"tasks-1-23y68q\"},{\"endPointSourceId\":\"tasks-1-23y68q\",\"endPointTargetId\":\"tasks-1-54762z\"},{\"endPointSourceId\":\"tasks-1-54762z\",\"endPointTargetId\":\"tasks-1-6v74l4\"},{\"endPointSourceId\":\"tasks-1-6v74l4\",\"endPointTargetId\":\"tasks-1-56o6dg\"},{\"endPointSourceId\":\"tasks-1-56o6dg\",\"endPointTargetId\":\"tasks-1-3lkss\"},{\"endPointSourceId\":\"tasks-1-3lkss\",\"endPointTargetId\":\"tasks-1-5azoi\"},{\"endPointSourceId\":\"tasks-1-5azoi\",\"endPointTargetId\":\"tasks-1-aa3hx\"},{\"endPointSourceId\":\"tasks-1-aa3hx\",\"endPointTargetId\":\"tasks-1-5dv6nq\"},{\"endPointSourceId\":\"tasks-1-5dv6nq\",\"endPointTargetId\":\"tasks-1-2ub4n3\"},{\"endPointSourceId\":\"tasks-1-2ub4n3\",\"endPointTargetId\":\"tasks-1-4p45zd\"},{\"endPointSourceId\":\"tasks-1-4p45zd\",\"endPointTargetId\":\"tasks-1-3e51o\"},{\"endPointSourceId\":\"tasks-1-3e51o\",\"endPointTargetId\":\"tasks-1-7j7y6\"},{\"endPointSourceId\":\"tasks-1-7j7y6\",\"endPointTargetId\":\"tasks-1-6497nq\"},{\"endPointSourceId\":\"tasks-1-6497nq\",\"endPointTargetId\":\"tasks-1-5yn33k\"},{\"endPointSourceId\":\"tasks-1-5yn33k\",\"endPointTargetId\":\"tasks-1-7jo3vl\"},{\"endPointSourceId\":\"tasks-1-7jo3vl\",\"endPointTargetId\":\"tasks-1-1id64i\"},{\"endPointSourceId\":\"tasks-1-7i657i\",\"endPointTargetId\":\"tasks-1-tz2k0\"},{\"endPointSourceId\":\"tasks-1-tz2k0\",\"endPointTargetId\":\"tasks-1-6cbh7\"},{\"endPointSourceId\":\"tasks-1-6cbh7\",\"endPointTargetId\":\"tasks-1-5dmek\"},{\"endPointSourceId\":\"tasks-1-5dmek\",\"endPointTargetId\":\"tasks-1-6z5lf\"},{\"endPointSourceId\":\"tasks-1-6z5lf\",\"endPointTargetId\":\"tasks-1-5y74yt\"},{\"endPointSourceId\":\"tasks-1-5y74yt\",\"endPointTargetId\":\"tasks-1-6jn4cg\"},{\"endPointSourceId\":\"tasks-1-6jn4cg\",\"endPointTargetId\":\"tasks-1-4n35ql\"},{\"endPointSourceId\":\"tasks-1-4n35ql\",\"endPointTargetId\":\"tasks-1-6no28l\"},{\"endPointSourceId\":\"tasks-1-6no28l\",\"endPointTargetId\":\"tasks-1-3sm1mw\"},{\"endPointSourceId\":\"tasks-1-3sm1mw\",\"endPointTargetId\":\"tasks-1-4z8cl\"},{\"endPointSourceId\":\"tasks-1-4z8cl\",\"endPointTargetId\":\"tasks-1-48wlu\"},{\"endPointSourceId\":\"tasks-1-48wlu\",\"endPointTargetId\":\"tasks-1-7hn2f5\"},{\"endPointSourceId\":\"tasks-1-7hn2f5\",\"endPointTargetId\":\"tasks-1-5bh2a2\"},{\"endPointSourceId\":\"tasks-1-5bh2a2\",\"endPointTargetId\":\"tasks-1-1rr7l7\"},{\"endPointSourceId\":\"tasks-3-60p137\",\"endPointTargetId\":\"tasks-3-69t5y3\"},{\"endPointSourceId\":\"tasks-3-2oy356\",\"endPointTargetId\":\"tasks-3-1sp3lc\"},{\"endPointSourceId\":\"tasks-95026\",\"endPointTargetId\":\"tasks-3-2oy356\"},{\"endPointSourceId\":\"tasks-1-4e06wh\",\"endPointTargetId\":\"tasks-1-7i657i\"},{\"endPointSourceId\":\"tasks-3-2uq2rb\",\"endPointTargetId\":\"tasks-1-4e06wh\"},{\"endPointSourceId\":\"tasks-8-2ps3ov\",\"endPointTargetId\":\"tasks-48470\"},{\"endPointSourceId\":\"tasks-3-7b759e\",\"endPointTargetId\":\"tasks-55372\"},{\"endPointSourceId\":\"tasks-55372\",\"endPointTargetId\":\"tasks-5-4ut280\"}]",
			"receivers": "",
			"receiversCc": "",
			"leadMobile": "",
			"ddAlarmId": 0,
			"scheduleReleaseState": null,
			"timeout": 0,
			"tenantId": -1,
			"taskType": "SHELL"
		}, {
			"id": 337,
			"name": "db_dwm_hr",
			"version": 0,
			"releaseState": "ONLINE",
			"projectId": 1,
			"processDefinitionJson": "{\"globalParams\":[],\"tasks\":[{\"type\":\"SQL\",\"id\":\"tasks-31836\",\"name\":\"clife_hr_dwm_market\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dwm_market partition(part_date)\\nselect \\n a.building_id                --   '养老院楼栋ID'  \\n,a.membership_adviser_id      --    '会籍顾问id'\\n,a.room_type                  --    '关注房型'\\n,a.product_id                 --    '产品id'\\n,a.sub_org_id                 --    '机构id'\\n,max(a.sub_org_name)  sub_org_name              --    '机构名称'\\n,max(a.org_id)        org_id             --    '集团id'\\n,max(a.org_name)      org_name             --    '集团名称'\\n,max(a.area_id)       area_id             --    '区域id'\\n,max(a.area_name)     area_name             --    '区域名称'\\n,max(a.card_id)       card_id             --     '卡id'\\n,max(a.card_name)     card_name             --     '卡名称'\\n,sum(a.deposit_amount)    deposit_amount         --     '下定额'\\n,sum(a.card_pay_amount)   card_pay_amount         --\\t    '刷卡金额'\\n,sum(a.cash_pay_amount)   cash_pay_amount         --     '现金金额'\\n,sum(a.weixin_pay_amount) weixin_pay_amount         --     '微信支付金额'\\n,sum(a.alipay_amount)     alipay_amount         --     '阿里支付金额'\\t\\n,sum(a.other_pay_amount)  other_pay_amount         --     '其他方式支付金额'\\n,sum(a.receivable_amount) receivable_amount            --  '应收金额'\\n,sum(a.received_amount)   received_amount            --  '已收金额'\\n,sum(a.received_installment_amount) received_installment_amount    --  '已收分期金额'\\n,sum(a.received_occupancy_amount)   received_occupancy_amount    --  '已收占用费'\\n,sum(a.membership_amount)           membership_amount     --  '会籍费'\\n,sum(a.overdue_amount)              overdue_amount    --  '滞纳金'\\n,sum(a.received_overdue_amount)     received_overdue_amount    --  '已收滞纳金'\\n,sum(a.other_amount)                other_amount     --  '其他费用'\\n,sum(a.manager_amount)              manager_amount       --  '管理费'\\n,sum(a.trust_amount)                trust_amount      --  '托管费'\\n,sum(a.membership_discount_amount)  membership_discount_amount      --  '会籍优惠价'  \\n,sum(a.card_amount)                 card_amount        --  '卡费'\\n,sum(a.card_manager_amount)         card_manager_amount     --  '卡管理费'\\n,sum(a.other_transfor_to_amount)    other_transfor_to_amount     --  '其他转让费' \\n,sum(a.transfor_to_amount)          transfor_to_amount      --  '转让费'\\n,sum(a.other_transfor_from_amount)  other_transfor_from_amount    --  '其他继承费'\\n,sum(a.transfor_from_amount)        transfor_from_amount       --  '继承费'\\n,sum(a.withdraw_amount)             withdraw_amount        --  '退会金额' \\n,sum(a.today_deposit_amount)        today_deposit_amount       --  '今日下定额'\\n,sum(a.today_card_pay_amount)       today_card_pay_amount        --   '今日刷卡金额'\\n,sum(a.today_cash_pay_amount)       today_cash_pay_amount       --   '今日现金金额'\\n,sum(a.today_weixin_pay_amount)     today_weixin_pay_amount       --   '今日微信支付金额'\\n,sum(a.today_alipay_amount)         today_alipay_amount       --   '今日阿里支付金额'\\t\\n,sum(a.today_other_pay_amount)      today_other_pay_amount        --   '今日其他方式支付金额'\\n,sum(a.today_receivable_amount)     today_receivable_amount         --  '今日应收金额'\\n,sum(a.today_received_amount)       today_received_amount        --  '今日已收金额'\\n,regexp_replace(date_sub(current_date(),1),'-','') as part_date \\nfrom \\n(\\nselect \\n t.building_id                --   '养老院楼栋ID'  \\n,t.membership_adviser_id      --    '会籍顾问id'\\n,t.room_type                  --    '关注房型'\\n,t.product_id                 --    '产品id'\\n,t.sub_org_id                 --    '机构id'\\n,t.sub_org_name               --    '机构名称'\\n,t.org_id                     --    '集团id'\\n,t.org_name                   --    '集团名称'\\n,t.area_id                    --    '区域id'\\n,t.area_name                  --    '区域名称'\\n,t.card_id                    --     '卡id'\\n,t.card_name                  --     '卡名称'\\n,t.deposit_amount             --     '下定额'\\n,case when t.pay_type_id=0 then t.received_amount else null end as  card_pay_amount            --\\t    '刷卡金额'\\n,case when t.pay_type_id=1 then t.received_amount else null end as  cash_pay_amount            --     '现金金额'\\n,case when t.pay_type_id=2 then t.received_amount else null end as  weixin_pay_amount          --     '微信支付金额'\\n,case when t.pay_type_id=3 then t.received_amount else null end as  alipay_amount              --     '阿里支付金额'\\t\\n,case when t.pay_type_id=4 then t.received_amount else null end as  other_pay_amount           --     '其他方式支付金额'\\n,t.receivable_amount             --  '应收金额'\\n,t.received_amount               --  '已收金额'\\n,t.received_installment_amount   --  '已收分期金额'\\n,t.received_occupancy_amount     --  '已收占用费'\\n,t.membership_amount             --  '会籍费'\\n,t.overdue_amount                --  '滞纳金'\\n,t.received_overdue_amount       --  '已收滞纳金'\\n,t.other_amount                  --  '其他费用'\\n,t.manager_amount                --  '管理费'\\n,t.trust_amount                  --  '托管费'\\n,t.membership_discount_amount    --  '会籍优惠价'  \\n,t.card_amount                   --  '卡费'\\n,t.card_manager_amount           --  '卡管理费'\\n,t.other_transfor_to_amount      --  '其他转让费' \\n,t.transfor_to_amount            --  '转让费'\\n,t.other_transfor_from_amount    --  '其他继承费'\\n,t.transfor_from_amount          --  '继承费'\\n,t.withdraw_amount               --  '退会金额' \\n,case when  from_unixtime( cast(t.deposit_time as int),'yyyy-MM-dd')=date_sub(current_date(),1) then t.deposit_amount \\nelse null end as  today_deposit_amount             --  '今日下定额'\\n,case when  from_unixtime( cast(t.sign_time as int),'yyyy-MM-dd')=date_sub(current_date(),1) and t.pay_type_id=0 then t.received_amount  else null end as today_card_pay_amount            --   '今日刷卡金额'\\n,case when  from_unixtime( cast(t.sign_time as int),'yyyy-MM-dd')=date_sub(current_date(),1) and t.pay_type_id=1 then t.received_amount  else null end as today_cash_pay_amount            --   '今日现金金额'\\n,case when  from_unixtime( cast(t.sign_time as int),'yyyy-MM-dd')=date_sub(current_date(),1) and t.pay_type_id=2 then t.received_amount  else null end as today_weixin_pay_amount          --   '今日微信支付金额'\\n,case when  from_unixtime( cast(t.sign_time as int),'yyyy-MM-dd')=date_sub(current_date(),1) and t.pay_type_id=3 then t.received_amount  else null end as today_alipay_amount              --   '今日阿里支付金额'\\t\\n,case when  from_unixtime( cast(t.sign_time as int),'yyyy-MM-dd')=date_sub(current_date(),1) and t.pay_type_id=4 then t.received_amount  else null end as today_other_pay_amount           --   '今日其他方式支付金额'\\n,case when  from_unixtime( cast(t.sign_time as int),'yyyy-MM-dd')=date_sub(current_date(),1) then t.receivable_amount else null end  as today_receivable_amount          --  '今日应收金额'\\n,case when  from_unixtime( cast(t.sign_time as int),'yyyy-MM-dd')=date_sub(current_date(),1) then t.received_amount  else null end as today_received_amount            --  '今日已收金额'\\nfrom db_dw_hr.clife_hr_dwd_market t\\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n) a \\ngroup by a.building_id,a.membership_adviser_id,a.room_type,a.product_id,a.sub_org_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[]},{\"type\":\"SQL\",\"id\":\"tasks-3-2f06kr\",\"name\":\"clife_hr_dwm_activity_manage_aggregation\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dwm_activity_manage_aggregation partition(part_date)\\nselect\\n     t.activity_type        --活动类型\\n    ,t.nurse_home_id        --养老院id\\n    ,t.nursing_homes_name  --养老院名称\\n    ,t.sub_org_id         --机构id\\n    ,t.sub_org_name       --机构名称\\n    ,t.org_id              --集团id\\n    ,t.org_name            --集团名称\\n    ,t.area_id             --区域id\\n    ,t.reserve_num --预定活动室次数\\n    ,t8.reserve_num_day --当日活动室预定次数\\n    ,t.template_cnt  --使用活动模板数量\\n    ,t1.template_num_day --当日使用活动模板数量\\t\\n    ,t.activity_num --已创建活动数\\n    ,t.apply_activity_cnt --已报名活动数\\n    ,t.host_activity_cnt --已举办活动数\\n    ,t1.activity_num_day --当日创建活动数\\t\\n    ,t1.apply_activity_num_day --当日报名活动数\\n    ,t2.host_activity_num_day --当日举办活动数\\n    ,t.apply_old_man_cnt --报名人次\\n    ,t.sign_old_man_cnt --签到人次\\n    ,t.confirm_old_man_cnt --到场人次\\n    ,t4.apply_old_man_num_day --当日报名人次\\t\\n    ,t6.sign_old_man_num_day --当日签到人次\\t\\n    ,t7.present_num_day --当日到场人次\\t\\n    ,t.activity_fee --活动费用\\n    ,t1.activity_fee_day  --当日活动费用\\n    ,t.good_evaluation_num     --活动评价好评数\\n    ,t.middle_evaluation_num   --活动评价中评数\\n    ,t.bad_evaluation_num      --活动评价差评数\\n    ,t.good_feedback_num       --反馈非常好数\\n    ,t.middle_feedback_num     --反馈较好数\\n    ,t.general_feedback_num    --反馈一般数\\n    ,t.bad_feedback_num        --反馈不理想数\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom\\n(\\n  select\\n       activity_type        --活动类型\\n      ,nurse_home_id        --养老院id\\n      ,max(nursing_homes_name) as nursing_homes_name    --养老院名称\\n      ,max(sub_org_id)         as sub_org_id       --机构id\\n      ,max(sub_org_name)       as sub_org_name     --机构名称\\n      ,max(org_id)             as org_id           --集团id\\n      ,max(org_name)           as org_name         --集团名称\\n      ,max(area_id)            as area_id          --区域id\\n      ,count(template_id)      as template_cnt     --使用活动模板数量\\n      ,count(activity_id)      as activity_num--已创建活动数\\n      ,sum(length(reserve_ids)) as reserve_num --预定活动室次数\\n      ,sum(case when apply_old_man_cnt is not null then 1 else 0 end) as apply_activity_cnt --已报名活动数\\n      ,count(activity_time) as host_activity_cnt --已举办活动数\\n      ,sum(apply_old_man_cnt) as apply_old_man_cnt --报名人次\\n      ,sum(sign_old_man_cnt)  as sign_old_man_cnt --签到人次\\n      ,sum(confirm_old_man_cnt)  as confirm_old_man_cnt --到场人次\\n      ,sum(activity_fee) as activity_fee --活动费用\\n      ,sum(good_evaluation_num)   as good_evaluation_num     --活动评价好评数\\n      ,sum(middle_evaluation_num) as middle_evaluation_num   --活动评价中评数\\n      ,sum(bad_evaluation_num)    as bad_evaluation_num      --活动评价差评数\\n      ,sum(good_feedback_num)     as good_feedback_num       --反馈非常好数\\n      ,sum(middle_feedback_num)   as middle_feedback_num     --反馈较好数\\n      ,sum(general_feedback_num)  as general_feedback_num    --反馈一般数\\n      ,sum(bad_feedback_num)      as bad_feedback_num        --反馈不理想数\\n  from db_dw_hr.clife_hr_dwd_activity_manage_info\\n  where part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n  group by activity_type\\n          ,nurse_home_id \\n)t\\nleft join\\n(\\n  select\\n      vl.activity_type\\n     ,vl.nurse_home_id\\n     ,vl.activity_create_time\\n     ,vs.template_num_day --当日使用活动模板数量\\n     ,vs.activity_num_day --当日创建活动数\\n     ,vs.apply_activity_num_day --当日报名活动数\\n     ,vs.activity_fee_day  --当日活动费用\\n  from\\n  (\\n    select\\n         activity_type\\n        ,nurse_home_id\\n        ,activity_create_time\\n        ,row_number() over(partition by activity_type,nurse_home_id order by activity_create_time desc) as rank\\n    from db_dw_hr.clife_hr_dwd_activity_manage_info a\\n    where part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n  )vl\\n  left join\\n  (--（根据养老院id，活动类型分区，activity_create_time排序，取最新一条）\\n    select\\n         activity_type\\n        ,nurse_home_id \\n        ,substr(activity_create_time,1,10) as activity_create_time\\n        ,sum(template_id) as template_num_day --当日使用活动模板数量\\n        ,sum(activity_id) as activity_num_day --当日创建活动数\\n        ,sum(case when apply_old_man_cnt is not null then 1 else 0 end) as apply_activity_num_day --当日报名活动数\\n        ,sum(activity_fee) as activity_fee_day  --当日活动费用\\n    from db_dw_hr.clife_hr_dwd_activity_manage_info a\\n    where part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n    group by activity_type\\n            ,nurse_home_id \\n            ,substr(activity_create_time,1,10)\\n  )vs on vl.activity_type = vs.activity_type and vl.nurse_home_id = vs.nurse_home_id and substr(vl.activity_create_time,1,10) = vs.activity_create_time\\n  where vl.rank=1\\n)t1 on t.activity_type = t1.activity_type and t.nurse_home_id = t1.nurse_home_id\\nleft join\\n(\\n select\\n      vl.activity_type\\n     ,vl.nurse_home_id\\n     ,vl.activity_time\\n     ,vs.host_activity_num_day --当日举办活动数\\n  from\\n  (\\n    select\\n         activity_type,nurse_home_id,activity_time\\n        ,row_number() over(partition by activity_type,nurse_home_id order by activity_time desc) as rank\\n    from db_dw_hr.clife_hr_dwd_activity_manage_info a\\n    where part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n  )vl\\n  left join\\n  (--（根据养老院id，活动类型分区，activity_time 排序，取最新一条）\\n    select\\n         activity_type\\n        ,nurse_home_id \\n        ,substr(activity_time,1,10) as activity_time\\n        ,count(activity_id) as host_activity_num_day --当日举办活动数\\n    from db_dw_hr.clife_hr_dwd_activity_manage_info a\\n    where part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n    group by activity_type\\n            ,nurse_home_id \\n            ,substr(activity_time,1,10)\\n  )vs on vl.activity_type = vs.activity_type and vl.nurse_home_id = vs.nurse_home_id and substr(vl.activity_time,1,10) = vs.activity_time\\n  where vl.rank=1\\n)t2 on t.activity_type = t2.activity_type and t.nurse_home_id = t2.nurse_home_id\\nleft join\\n(--根据养老院id，活动类型分区，apply_times 排序，取最新一条\\n  select\\n       vl.activity_type\\n      ,vl.nurse_home_id\\n      ,vl.apply_time\\n      ,vs.apply_old_man_num_day --当日报名人次\\n  from\\n  (\\n     select\\n          activity_type\\n         ,nurse_home_id\\n         ,ats.apply_time\\n         ,row_number()over(partition by activity_type,nurse_home_id order by ats.apply_time desc) as rank_apply\\n     from\\n     (\\n       select \\n            activity_type\\n           ,nurse_home_id\\n           ,apply_times\\n       from db_dw_hr.clife_hr_dwd_activity_manage_info a\\n       where part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n     )d lateral view explode(split(d.apply_times,';'))ats as apply_time\\n  )vl\\n  left join\\n  (\\n     select\\n          activity_type\\n         ,nurse_home_id\\n         ,substr(apply_time,1,10) as apply_time\\n         ,count(1) as apply_old_man_num_day --当日报名人次\\n     from\\n     ( \\n       select \\n            activity_type\\n           ,nurse_home_id\\n           ,apply_times\\n       from db_dw_hr.clife_hr_dwd_activity_manage_info a\\n       where part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n     )d lateral view explode(split(d.apply_times,';'))ats as apply_time\\n     group by activity_type\\n             ,nurse_home_id\\n             ,substr(apply_time,1,10)\\n   )vs on vl.activity_type = vs.activity_type and vl.nurse_home_id = vs.nurse_home_id and substr(vl.apply_time,1,10) = vs.apply_time\\n   where vl.rank_apply = 1\\n)t4 on t.activity_type = t4.activity_type and t.nurse_home_id = t4.nurse_home_id\\nleft join\\n(--根据养老院id，活动类型分区，reserve_times 排序，取最新一条\\n  select\\n       vl.activity_type\\n      ,vl.nurse_home_id\\n      ,vl.reserve_time\\n      ,vs.reserve_num_day --当日活动室预定次数\\n  from\\n  (\\n     select\\n          activity_type\\n         ,nurse_home_id\\n         ,reserve_time\\n         ,reserve_id\\n         ,row_number()over(partition by activity_type,nurse_home_id order by reserve_time desc) as rank_reserve\\n     from\\n     (\\n       select \\n            a.activity_type\\n           ,a.nurse_home_id\\n           ,temp.reserve_time\\n           ,temp.reserve_id\\n       from db_dw_hr.clife_hr_dwd_activity_manage_info a\\n       lateral view explodemulti(if(a.reserve_times is null,'',a.reserve_times),if(a.reserve_ids is null,'',a.reserve_ids)) temp as reserve_time,reserve_id\\n       where part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n     )d\\n  )vl\\n  left join\\n  (\\n     select\\n          d.activity_type\\n         ,d.nurse_home_id\\n         ,substr(d.reserve_time,1,10) as reserve_time\\n         ,count(d.reserve_id) as reserve_num_day --当日活动室预定次数\\n     from\\n     (\\n       select \\n            a.activity_type\\n           ,a.nurse_home_id\\n           ,temp.reserve_time\\n           ,temp.reserve_id\\n       from db_dw_hr.clife_hr_dwd_activity_manage_info a\\n       lateral view explodemulti(if(a.reserve_times is null,'',a.reserve_times),if(a.reserve_ids is null,'',a.reserve_ids)) temp as reserve_time,reserve_id\\n       where part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n     )d\\n     group by activity_type\\n             ,nurse_home_id\\n             ,substr(d.reserve_time,1,10)\\n   )vs on vl.activity_type = vs.activity_type and vl.nurse_home_id = vs.nurse_home_id and substr(vl.reserve_time,1,10) = vs.reserve_time\\n   where vl.rank_reserve = 1\\n)t8 on t.activity_type = t8.activity_type and t.nurse_home_id = t8.nurse_home_id\\nleft join\\n(--根据养老院id，活动类型分区，reserve_times 排序，取最新一条\\n  select\\n       vl.activity_type\\n      ,vl.nurse_home_id\\n      ,vl.sign_time\\n      ,vs.sign_old_man_num_day --当日签到人次\\n  from\\n  (\\n     select\\n          activity_type\\n         ,nurse_home_id\\n         ,sign_time\\n         ,row_number()over(partition by activity_type,nurse_home_id order by sign_time desc) as rank_sign\\n     from\\n     (\\n       select \\n            a.activity_type\\n           ,a.nurse_home_id\\n           ,temp.sign_time\\n       from db_dw_hr.clife_hr_dwd_activity_manage_info a\\n       lateral view explodemulti(if(a.sign_times is null,'',a.sign_times)) temp as sign_time\\n       where part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n     )d\\n  )vl\\n  left join\\n  (\\n     select\\n          activity_type\\n         ,nurse_home_id\\n         ,substr(d.sign_time,1,10) as sign_time\\n         ,count(1) as sign_old_man_num_day --当日签到人次\\n     from\\n     (\\n       select \\n            a.activity_type\\n           ,a.nurse_home_id\\n           ,temp.sign_time\\n       from db_dw_hr.clife_hr_dwd_activity_manage_info a\\n       lateral view explodemulti(if(a.sign_times is null,'',a.sign_times)) temp as sign_time\\n       where part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n     )d\\n     group by activity_type\\n             ,nurse_home_id\\n             ,substr(d.sign_time,1,10)\\n   )vs on vl.activity_type = vs.activity_type and vl.nurse_home_id = vs.nurse_home_id and substr(vl.sign_time,1,10) = vs.sign_time\\n   where vl.rank_sign = 1\\n)t6 on t.activity_type = t6.activity_type and t.nurse_home_id = t6.nurse_home_id\\nleft join\\n(--根据养老院id，活动类型分区，confirm_times 排序，取最新一条\\n  select\\n       vl.activity_type\\n      ,vl.nurse_home_id\\n      ,vl.confirm_time\\n      ,vs.present_num_day --当日到场人次\\n  from\\n  (\\n     select\\n          activity_type\\n         ,nurse_home_id\\n         ,d.confirm_time\\n         ,row_number()over(partition by activity_type,nurse_home_id order by d.confirm_time desc) as rank_confirm\\n     from\\n     (\\n       select \\n            a.activity_type\\n           ,a.nurse_home_id\\n           ,temp.confirm_time\\n       from db_dw_hr.clife_hr_dwd_activity_manage_info a\\n       lateral view explodemulti(if(a.confirm_times is null,'',a.confirm_times)) temp as confirm_time\\n       where part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n     )d\\n  )vl\\n  left join\\n  (\\n     select\\n          activity_type\\n         ,nurse_home_id\\n         ,substr(d.confirm_time,1,10) as confirm_time\\n         ,count(1) as present_num_day --当日到场人次\\n     from\\n     (\\n       select \\n            a.activity_type\\n           ,a.nurse_home_id\\n           ,temp.confirm_time\\n       from db_dw_hr.clife_hr_dwd_activity_manage_info a\\n       lateral view explodemulti(if(a.confirm_times is null,'',a.confirm_times)) temp as confirm_time\\n       where part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n     )d\\n     group by activity_type\\n             ,nurse_home_id\\n             ,substr(d.confirm_time,1,10)\\n   )vs on vl.activity_type = vs.activity_type and vl.nurse_home_id = vs.nurse_home_id and substr(vl.confirm_time,1,10) = vs.confirm_time\\n   where vl.rank_confirm = 1\\n)t7 on t.activity_type = t7.activity_type and t.nurse_home_id = t7.nurse_home_id\",\"udfs\":\"13\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dwm_market\"]},{\"type\":\"SQL\",\"id\":\"tasks-3-2ykax\",\"name\":\"clife_hr_dwm_recharge_consumption_aggregation\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dwm_recharge_consumption_aggregation partition(part_date)\\nselect\\n     t.account_id          --账户id\\n    ,t.fee_iteam_id        --费用项目id\\n    ,t.account_name        --账户名称\\n    ,t.attributes          --账户属性\\n    ,t.fee_iteam_name      --费用项目名称\\n    ,t.fee_type_id         --费用类型id\\n    ,t.fee_type_name       --费用类型名称\\n    ,t.old_man_id          --老人id(普通账户)\\n    ,t.member_id           --权益人id(会员账户)\\n    ,t.old_man_name        --姓名\\n    ,t.sex                 --性别\\n    ,t.age                 --年龄\\n    ,t.nursing_homes_id    --养老院id\\n    ,t.nursing_homes_name  --养老院名称\\n    ,t.sub_org_id          --养老机构id\\n    ,t.sub_org_name        --机构名称\\n    ,t.org_id              --集团id\\n    ,t.org_name            --集团名称\\n    ,t.area_id             --区域id\\n    ,t.check_in_payment_num      --入住缴费次数\\n    ,t.check_in_payment_amount   --入住缴费金额\\n    ,t.recharge_num              --账户充值次数\\n    ,t.recharge_amount           --账户充值金额\\n    ,t.member_recharge_num       --会员充值次数\\n    ,t.member_recharge_amount    --会员充值金额\\n    ,t.consume_num               --账户消费次数\\n    ,t.consume_amount            --账户消费金额\\n    ,t.member_consume_num        --会员消费次数\\n    ,t.member_consume_amount     --会员消费金额\\n    ,t.countermand_amount        --退住退费金额\\n    ,t2.check_in_payment_cnt_day    --当日入住缴费次数\\n    ,t2.check_in_payment_amount_day --当日入住缴费金额\\n    ,t3.recharge_cnt_day            --当日账户充值次数\\n    ,t3.recharge_amount_day         --当日账户充值金额\\n    ,t4.member_recharge_cnt_day     --当日会员充值次数\\n    ,t4.member_recharge_amount_day  --当日会员充值金额\\n    ,t5.consume_cnt_day             --当日账户消费次数\\n    ,t5.consume_amount_day          --当日账户消费金额\\n    ,t6.member_consume_cnt_day      --当日会员消费金额\\n    ,t6.member_consume_amount_day   --当日会员消费次数\\n    ,t7.countermand_amount_day      --当日退住退费金额    \\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom\\n(\\n  select\\n       a.account_id               --账户id\\n      ,a.fee_iteam_id             --费用项目id\\n      ,max(b.account_name)        as account_name      --账户名称\\n      ,max(b.attributes)          as attributes        --账户属性\\n      ,max(a.fee_iteam_name)      as fee_iteam_name    --费用项目名称\\n      ,max(a.fee_type_id)         as fee_type_id       --费用类型id\\n      ,max(a.fee_type_name)       as fee_type_name     --费用类型名称\\n      ,max(a.old_man_id)          as old_man_id        --老人id(普通账户)\\n      ,max(a.member_id)           as member_id         --权益人id(会员账户)\\n      ,max(a.old_man_name)        as old_man_name      --姓名\\n      ,max(a.sex)                 as sex               --性别\\n      ,max(a.age)                 as age               --年龄\\n      ,max(a.nursing_homes_id)    as nursing_homes_id  --养老院id\\n      ,max(a.nursing_homes_name)  as nursing_homes_name--养老院名称\\n      ,max(a.sub_org_id)          as sub_org_id        --养老机构id\\n      ,max(a.sub_org_name)        as sub_org_name      --机构名称\\n      ,max(a.org_id)              as org_id            --集团id\\n      ,max(a.org_name)            as org_name          --集团名称\\n      ,max(a.area_id)             as area_id           --区域id\\n      ,sum(case when behavior_type='入住缴费' then 1 else 0 end)      as check_in_payment_num      --入住缴费次数\\n      ,sum(case when behavior_type='入住缴费' then amount else 0 end) as check_in_payment_amount   --入住缴费金额\\n      ,sum(case when behavior_type='账户充值' then 1 else 0 end)      as recharge_num              --账户充值次数\\n      ,sum(case when behavior_type='账户充值' then amount else 0 end) as recharge_amount           --账户充值金额\\n      ,sum(case when behavior_type='会员充值' then 1 else 0 end)      as member_recharge_num       --会员充值次数\\n      ,sum(case when behavior_type='会员充值' then amount else 0 end) as member_recharge_amount    --会员充值金额\\n      ,sum(case when behavior_type='账户消费' then 1 else 0 end)      as consume_num               --账户消费次数\\n      ,sum(case when behavior_type='账户消费' then amount else 0 end) as consume_amount            --账户消费金额\\n      ,sum(case when behavior_type='会员消费' then 1 else 0 end)      as member_consume_num        --会员消费金额\\n      ,sum(case when behavior_type='会员消费' then amount else 0 end) as member_consume_amount     --会员消费次数\\n      ,sum(case when behavior_type='退住退费' then amount else 0 end) as countermand_amount        --退住退费金额\\n  from db_dw_hr.clife_hr_dwd_recharge_consumption_info a\\n  left join db_dw_hr.clife_hr_dim_account b on a.account_id = b.account_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by a.account_id\\n          ,a.fee_iteam_id\\n)t\\nleft join\\n(\\n  select\\n       vl.account_id\\n      ,vl.fee_iteam_id\\n      ,vl.recharge_consumption_time\\n      ,vs.check_in_payment_time\\n      ,vs.check_in_payment_cnt_day    --当日入住缴费次数\\n      ,vs.check_in_payment_amount_day --当日入住缴费金额\\n  from\\n  (\\n    select\\n         account_id\\n        ,fee_iteam_id\\n        ,recharge_consumption_time\\n        ,row_number()over(partition by d.account_id,d.fee_iteam_id order by d.recharge_consumption_time desc) as rank \\n\\tfrom\\n    (\\n      select *\\n      from db_dw_hr.clife_hr_dwd_recharge_consumption_info a\\n      where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n        and a.behavior_type='入住缴费'\\n   )d\\n  )vl\\n   left join\\n  (\\n   select\\n        account_id\\n       ,fee_iteam_id\\n       ,count(1)    as check_in_payment_cnt_day    --当日入住缴费次数\\n       ,sum(amount) as check_in_payment_amount_day --当日入住缴费金额\\n       ,substr(d.recharge_consumption_time,1,10) as check_in_payment_time\\n   from\\n   (\\n     select *\\n     from db_dw_hr.clife_hr_dwd_recharge_consumption_info a\\n     where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n       and a.behavior_type='入住缴费'\\n   )d\\n   group by account_id\\n           ,fee_iteam_id\\n           ,substr(d.recharge_consumption_time,1,10)\\n   ) vs on vl.account_id = vs.account_id and vl.fee_iteam_id = vs.fee_iteam_id and substr(vl.recharge_consumption_time,1,10) = vs.check_in_payment_time\\n   where vl.rank = 1\\n)t2 on t.account_id = t2.account_id and t.fee_iteam_id = t2.fee_iteam_id\\nleft join\\n(\\n  select\\n       vl.account_id\\n      ,vl.fee_iteam_id\\n      ,vl.recharge_consumption_time\\n      ,vs.check_in_payment_time\\n      ,vs.recharge_cnt_day    --当日账户充值次数\\n      ,vs.recharge_amount_day --当日账户充值金额\\n  from\\n  (\\n    select\\n         account_id\\n        ,fee_iteam_id\\n        ,recharge_consumption_time\\n        ,row_number()over(partition by d.account_id,d.fee_iteam_id order by d.recharge_consumption_time desc) as rank \\n\\tfrom\\n    (\\n      select *\\n      from db_dw_hr.clife_hr_dwd_recharge_consumption_info a\\n      where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n        and a.behavior_type='账户充值'\\n   )d\\n  )vl\\n   left join\\n  (\\n   select\\n        account_id\\n       ,fee_iteam_id\\n       ,count(1)    as recharge_cnt_day    --当日账户充值次数\\n       ,sum(amount) as recharge_amount_day --当日账户充值金额\\n       ,substr(d.recharge_consumption_time,1,10) as check_in_payment_time\\n   from\\n   (\\n     select *\\n     from db_dw_hr.clife_hr_dwd_recharge_consumption_info a\\n     where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n       and a.behavior_type='账户充值'\\n   )d\\n   group by account_id\\n           ,fee_iteam_id\\n           ,substr(d.recharge_consumption_time,1,10)\\n   ) vs on vl.account_id = vs.account_id and vl.fee_iteam_id = vs.fee_iteam_id and substr(vl.recharge_consumption_time,1,10) = vs.check_in_payment_time\\n   where vl.rank = 1\\n)t3 on t.account_id = t3.account_id and t.fee_iteam_id = t3.fee_iteam_id\\nleft join\\n(\\n  select\\n       vl.account_id\\n      ,vl.fee_iteam_id\\n      ,vl.recharge_consumption_time\\n      ,vs.check_in_payment_time\\n      ,vs.member_recharge_cnt_day    --当日会员充值次数\\n      ,vs.member_recharge_amount_day --当日会员充值金额\\n  from\\n  (\\n    select\\n         account_id\\n        ,fee_iteam_id\\n        ,recharge_consumption_time\\n        ,row_number()over(partition by d.account_id,d.fee_iteam_id order by d.recharge_consumption_time desc) as rank \\n\\tfrom\\n    (\\n      select *\\n      from db_dw_hr.clife_hr_dwd_recharge_consumption_info a\\n      where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n        and a.behavior_type='会员充值'\\n   )d\\n  )vl\\n   left join\\n  (\\n   select\\n        account_id\\n       ,fee_iteam_id\\n       ,count(1)    as  member_recharge_cnt_day    --当日会员充值次数\\n       ,sum(amount) as  member_recharge_amount_day --当日会员充值金额\\n       ,substr(d.recharge_consumption_time,1,10) as check_in_payment_time\\n   from\\n   (\\n     select *\\n     from db_dw_hr.clife_hr_dwd_recharge_consumption_info a\\n     where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n       and a.behavior_type='会员充值'\\n   )d\\n   group by account_id\\n           ,fee_iteam_id\\n           ,substr(d.recharge_consumption_time,1,10)\\n   ) vs on vl.account_id = vs.account_id and vl.fee_iteam_id = vs.fee_iteam_id and substr(vl.recharge_consumption_time,1,10) = vs.check_in_payment_time\\n   where vl.rank = 1\\n)t4 on t.account_id = t4.account_id and t.fee_iteam_id = t4.fee_iteam_id\\nleft join\\n(\\n  select\\n       vl.account_id\\n      ,vl.fee_iteam_id\\n      ,vl.recharge_consumption_time\\n      ,vs.check_in_payment_time\\n      ,vs.consume_cnt_day    --当日账户消费次数\\n      ,vs.consume_amount_day --当日账户消费金额\\n  from\\n  (\\n    select\\n         account_id\\n        ,fee_iteam_id\\n        ,recharge_consumption_time\\n        ,row_number()over(partition by d.account_id,d.fee_iteam_id order by d.recharge_consumption_time desc) as rank \\n\\tfrom\\n    (\\n      select *\\n      from db_dw_hr.clife_hr_dwd_recharge_consumption_info a\\n      where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n        and a.behavior_type='账户消费'\\n   )d\\n  )vl\\n   left join\\n  (\\n   select\\n        account_id\\n       ,fee_iteam_id\\n       ,count(1)    as  consume_cnt_day    --当日账户消费次数\\n       ,sum(amount) as  consume_amount_day --当日账户消费金额\\n       ,substr(d.recharge_consumption_time,1,10) as check_in_payment_time\\n   from\\n   (\\n     select *\\n     from db_dw_hr.clife_hr_dwd_recharge_consumption_info a\\n     where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n       and a.behavior_type='账户消费'\\n   )d\\n   group by account_id\\n           ,fee_iteam_id\\n           ,substr(d.recharge_consumption_time,1,10)\\n   ) vs on vl.account_id = vs.account_id and vl.fee_iteam_id = vs.fee_iteam_id and substr(vl.recharge_consumption_time,1,10) = vs.check_in_payment_time\\n   where vl.rank = 1\\n)t5 on t.account_id = t5.account_id and t.fee_iteam_id = t5.fee_iteam_id\\nleft join\\n(\\n  select \\n       vl.account_id\\n      ,vl.fee_iteam_id\\n      ,vl.recharge_consumption_time\\n      ,vs.check_in_payment_time\\n      ,vs.member_consume_cnt_day    --当日账户消费次数\\n      ,vs.member_consume_amount_day --当日账户消费金额\\n  from\\n  (\\n    select\\n         account_id\\n        ,fee_iteam_id\\n        ,recharge_consumption_time\\n        ,row_number()over(partition by d.account_id,d.fee_iteam_id order by d.recharge_consumption_time desc) as rank \\n\\tfrom\\n    (\\n      select *\\n      from db_dw_hr.clife_hr_dwd_recharge_consumption_info a\\n      where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n        and a.behavior_type='会员消费'\\n   )d\\n  )vl\\n   left join\\n  (\\n   select\\n        account_id\\n       ,fee_iteam_id\\n       ,count(1)    as  member_consume_cnt_day    --当日账户消费次数\\n       ,sum(amount) as  member_consume_amount_day --当日账户消费金额\\n       ,substr(d.recharge_consumption_time,1,10) as check_in_payment_time\\n   from\\n   (\\n     select *\\n     from db_dw_hr.clife_hr_dwd_recharge_consumption_info a\\n     where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n       and a.behavior_type='会员消费'\\n   )d\\n   group by account_id\\n           ,fee_iteam_id\\n           ,substr(d.recharge_consumption_time,1,10)\\n   ) vs on vl.account_id = vs.account_id and vl.fee_iteam_id = vs.fee_iteam_id and substr(vl.recharge_consumption_time,1,10) = vs.check_in_payment_time\\n   where vl.rank = 1\\n)t6 on t.account_id = t6.account_id and t.fee_iteam_id = t6.fee_iteam_id\\nleft join\\n(\\n  select\\n       vl.account_id\\n      ,vl.fee_iteam_id\\n      ,vl.recharge_consumption_time\\n      ,vs.countermand_amount_day\\n      ,vs.check_in_payment_time\\n  from\\n  (\\n    select\\n         account_id\\n        ,fee_iteam_id\\n        ,recharge_consumption_time\\n        ,row_number()over(partition by d.account_id,d.fee_iteam_id order by d.recharge_consumption_time desc) as rank \\n\\tfrom\\n    (\\n      select *\\n      from db_dw_hr.clife_hr_dwd_recharge_consumption_info a\\n      where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n        and a.behavior_type='退住退费'\\n   )d\\n  )vl\\n   left join\\n  (\\n   select\\n        account_id\\n       ,fee_iteam_id\\n       ,sum(amount) as  countermand_amount_day --当日退住退费金额\\n       ,substr(d.recharge_consumption_time,1,10) as check_in_payment_time\\n   from\\n   (\\n     select *\\n     from db_dw_hr.clife_hr_dwd_recharge_consumption_info a\\n     where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n       and a.behavior_type='退住退费'\\n   )d\\n   group by account_id\\n           ,fee_iteam_id\\n           ,substr(d.recharge_consumption_time,1,10)\\n   ) vs on vl.account_id = vs.account_id and vl.fee_iteam_id = vs.fee_iteam_id and substr(vl.recharge_consumption_time,1,10) = vs.check_in_payment_time\\n   where vl.rank = 1\\n)t7 on t.account_id = t7.account_id and t.fee_iteam_id = t7.fee_iteam_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dwm_activity_manage_aggregation\"]},{\"type\":\"SQL\",\"id\":\"tasks-3-7802r9\",\"name\":\"clife_hr_dwm_reside_manage_aggregation\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dwm_reside_manage_aggregation partition(part_date)\\nselect\\n     t.old_man_id           --老人id\\n    ,t.floor_id             --楼层id\\n    ,t.building_id          --楼栋id\\n    ,t.nursin_homes_id      --养老院id\\n    ,t.nursing_homes_name   --养老院名称\\n    ,t.sub_org_id           --机构id\\n    ,t.sub_org_name         --机构名称\\n    ,t.org_id               --集团id\\n    ,t.org_name             --集团名称\\n    ,t.area_id              --区域id\\n    ,t.old_man_name         --老人姓名\\n    ,t.sex                  --老人性别\\n    ,t.age                  --老人年龄\\n    ,t.check_in_num         --老人入住次数\\n    ,t.countermand_num      --老人退住次数\\n    ,t.bed_amount           --楼层床位数\\n    ,t.room_amount          --楼层房间数\\n    ,t.relatives_names      --探访人姓名\\n    ,t.visit_times          --探访时间\\t\\n    ,t.refund_amount        --当天请假退费金额\\n    ,t.leave_reducation_fee --当天请假减免费用\\n    ,t.leave_day_cnt        --当日请假次数\\n    ,length(t.relatives_names) as relatives_num --探访人数\\n    ,t1.leave_time           --请假时长\\n    ,t1.sick_leave_num       --病假次数\\n    ,t1.casual_leave_num     --事假次数\\n    ,t1.other_leave_num      --其他假次数\\n    ,t1.leave_num            --请假次数\\n    ,up.reside_status        --老人居住状态（在住或者退住）\\n    ,up.room_id              --在住房间id\\n    ,up.bed_id               --在住床位id\\n    ,t3.leave_time_day       --当日请假时长\\n    ,t3.sick_leave_num_day   --当日病假次数\\n    ,t3.casual_leave_num_day --当日事假次数\\n    ,t3.other_leave_num_day  --当日其他假次数\\n    ,t6.visit_day_cnt        --当日探访人数\\n    ,t6.visit_time           --当日探访时长\\n    ,t2.countermand_cnt_day  --当日退住次数\\n    ,t5.reside_cnt_day       --当日入住次数\\n    ,null as contract_time_1_num        --录入合同数量（1年期）  \\n    ,null as contract_time_2_num        --录入合同数量（2年期）  \\n    ,null as contract_time_3_num        --录入合同数量（3年期）  \\n    ,null as contract_time_4_num        --录入合同数量（4年期）  \\n    ,null as contract_time_5_num        --录入合同数量（5年期）  \\n    ,null as contract_time_surpass_5_num--录入合同数量（5年以上）\\n    ,null as contract_time_1_num_day        --当日录入合同数量（1年期）  \\n    ,null as contract_time_2_num_day        --当日录入合同数量（2年期）  \\n    ,null as contract_time_3_num_day        --当日录入合同数量（3年期）  \\n    ,null as contract_time_4_num_day        --当日录入合同数量（4年期）  \\n    ,null as contract_time_5_num_day        --当日录入合同数量（5年期）  \\n    ,null as contract_time_surpass_5_num_day--当日录入合同数量（5年以上）\\n    ,reside_status_list\\n    ,room_id_list\\n    ,bed_id_list\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom\\n(\\n  select\\n       a.old_man_id         --老人id\\n      ,b.floor_id           --楼层id\\n      ,max(b.building_id)        as building_id          --楼栋id\\n      ,max(a.nursin_homes_id)    as nursin_homes_id      --养老院id\\n      ,max(a.nursing_homes_name) as nursing_homes_name   --养老院名称\\n      ,max(a.sub_org_id)         as sub_org_id           --机构id\\n      ,max(a.sub_org_name)       as sub_org_name         --机构名称\\n      ,max(a.org_id)             as org_id               --集团id\\n      ,max(a.org_name)           as org_name             --集团名称\\n      ,max(a.area_id)            as area_id              --区域id\\n      ,max(a.old_man_name)       as old_man_name         --老人姓名\\n      ,max(a.sex)                as sex                  --老人性别\\n      ,max(a.age)                as age                  --老人年龄\\n      ,sum(case when reside_status = 3 then 1 else 0 end )as check_in_num        --老人入住次数\\n      ,sum(case when reside_status = 4 then 1 else 0 end) as countermand_num  --老人退住次数\\n      ,count(b.bed_amount)       as bed_amount      --楼层床位数\\n      ,count(a.room_id)          as room_amount     --楼层房间数\\n      ,max(relatives_names)      as relatives_names --探访人姓名\\n      ,max(visit_times)          as visit_times   --探访时间\\n      ,concat_ws(';',collect_list(cast(a.reside_status as string))) as reside_status_list\\n      ,concat_ws(';',collect_list(cast(a.room_id as string)))       as room_id_list\\n      ,concat_ws(';',collect_list(cast(a.bed_id  as string)))       as bed_id_list\\n      --,sum(case when (合同到期时间-开始时间) then 1 else 0 end ) as contract_time_1_num          --录入合同数量（1年期）  \\n      --,sum(case when (合同到期时间-开始时间) then 1 else 0 end ) as contract_time_2_num          --录入合同数量（2年期）  \\n      --,sum(case when (合同到期时间-开始时间) then 1 else 0 end ) as contract_time_3_num          --录入合同数量（3年期）  \\n      --,sum(case when (合同到期时间-开始时间) then 1 else 0 end ) as contract_time_4_num          --录入合同数量（4年期）  \\n      --,sum(case when (合同到期时间-开始时间) then 1 else 0 end ) as contract_time_5_num          --录入合同数量（5年期）  \\n      --,sum(case when (合同到期时间-开始时间) then 1 else 0 end ) as contract_time_surpass_5_num  --录入合同数量（5年以上）\\n      ,sum(refund_amount)        as refund_amount        --当天请假退费金额\\n      ,sum(leave_reducation_fee) as leave_reducation_fee --当天请假减免费用\\n      ,sum(leave_day_cnt)        as leave_day_cnt         --当日请假次数\\n  from db_dw_hr.clife_hr_dwd_reside_manage_info a\\n  left join db_dw_hr.clife_hr_dim_location_room b on a.room_id = b.room_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by a.old_man_id\\n            ,b.floor_id \\n)t\\nleft join\\n(\\n  select *\\n  from\\n  (\\n    select a.old_man_id,b.floor_id,a.reside_status,a.room_id,a.bed_id\\n        ,row_number()over(partition by a.old_man_id,b.floor_id order by a.contract_entry_time desc) as rank\\n    from db_dw_hr.clife_hr_dwd_reside_manage_info a\\n    left join db_dw_hr.clife_hr_dim_location_room b on a.room_id = b.room_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  )c where c.rank=1\\n)up on t.old_man_id = up.old_man_id and t.floor_id = up.floor_id\\nleft join\\n(\\n    select\\n       tmp.old_man_id\\n      ,b.floor_id\\n      ,sum(tmp.leave_time) as leave_time  --请假时长\\n      ,sum(case when tmp.leave_type = 0 then 1 else 0 end) as sick_leave_num   --病假次数\\n      ,sum(case when tmp.leave_type = 1 then 1 else 0 end) as casual_leave_num --事假次数\\n      ,sum(case when tmp.leave_type = 2 then 1 else 0 end) as other_leave_num  --其他假次数\\n      ,count(1) as leave_num --请假次数\\n  from\\n  (\\n    select\\n         a.old_man_check_in_id\\n        ,a.old_man_id\\n        ,a.room_id\\n        ,ip.leave_time\\n        ,ip.leave_type\\n    from db_dw_hr.clife_hr_dwd_reside_manage_info a\\n    lateral view explodemulti(if(a.leave_times is null,'',a.leave_times),if(a.leave_types is null,'',a.leave_types)) ip as leave_time,leave_type \\n    where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  )tmp\\n  left join db_dw_hr.clife_hr_dim_location_room b on tmp.room_id = b.room_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by tmp.old_man_id\\n          ,b.floor_id\\n)t1 on t.old_man_id = t1.old_man_id and t.floor_id = t1.floor_id\\nleft join\\n(\\n  select\\n       vl.old_man_id\\n      ,vl.floor_id\\n      ,vl.countermand_time\\n      ,vs.countermand_cnt_day --当日退住次数\\n  from\\n  (\\n    select  \\n        a.old_man_id,b.floor_id,countermand_time\\n        ,row_number()over(partition by a.old_man_id,b.floor_id order by a.countermand_time desc) as rank\\n    from db_dw_hr.clife_hr_dwd_reside_manage_info a\\n    left join db_dw_hr.clife_hr_dim_location_room b on a.room_id = b.room_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  )vl\\n  left join\\n  (\\n    select\\n        a.old_man_id\\n       ,b.floor_id\\n       ,count(1) as countermand_cnt_day --当日退住次数\\n       ,substr(a.countermand_time,1,10) as countermand_time\\n    from db_dw_hr.clife_hr_dwd_reside_manage_info a\\n    left join db_dw_hr.clife_hr_dim_location_room b on a.room_id = b.room_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    group by a.old_man_id\\n            ,b.floor_id\\n            ,substr(a.countermand_time,1,10)\\n  )vs on vl.old_man_id = vs.old_man_id and vl.floor_id = vs.floor_id and vs.countermand_time = substr(vl.countermand_time,1,10)\\n  where vl.rank=1\\n)t2 on t.old_man_id = t2.old_man_id and t.floor_id = t2.floor_id\\nleft join\\n(\\n  select\\n       vd.old_man_id\\n      ,vd.floor_id\\n      ,vd.leave_create_time\\n      ,e.sick_leave_num_day   --当日病假次数\\n      ,e.casual_leave_num_day --当日事假次数\\n      ,e.other_leave_num_day  --当日其他假次数\\n      ,e.leave_time_day  --当日请假时长\\n  from\\n  (\\n    select\\n         tmp.old_man_id\\n        ,b.floor_id\\n        ,tmp.leave_create_time\\n        ,row_number()over(partition by tmp.old_man_id,b.floor_id order by tmp.leave_create_time desc) as rank\\n    from\\n    (\\n      select \\n           a.old_man_id\\n          ,a.room_id\\n          ,ip.leave_create_time\\n          ,ip.leave_time\\n          ,ip.leave_type\\n      from db_dw_hr.clife_hr_dwd_reside_manage_info a\\n      lateral view explodemulti(if(a.leave_times is null,'',a.leave_times),if(a.leave_types is null,'',a.leave_types),if(a.leave_create_times is null,'',a.leave_create_times)) ip as leave_time,leave_type,leave_create_time\\n      where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    )tmp\\n    left join db_dw_hr.clife_hr_dim_location_room b on tmp.room_id = b.room_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  )vd\\n  left join \\n  (\\n    select\\n         tmp.old_man_id\\n        ,b.floor_id\\n        ,sum(tmp.leave_time) as leave_time_day  --当日请假时长\\n        ,sum(case when tmp.leave_type = 0 then 1 else 0 end) as sick_leave_num_day   --当日病假次数\\n        ,sum(case when tmp.leave_type = 1 then 1 else 0 end) as casual_leave_num_day --当日事假次数\\n        ,sum(case when tmp.leave_type = 2 then 1 else 0 end) as other_leave_num_day  --当日其他假次数\\n        ,substr(tmp.leave_create_time,1,10) as leave_create_time\\n    from\\n    (\\n      select \\n           a.old_man_id\\n          ,a.room_id\\n          ,ip.leave_create_time\\n          ,ip.leave_time\\n          ,ip.leave_type\\n      from db_dw_hr.clife_hr_dwd_reside_manage_info a\\n      lateral view explodemulti(if(a.leave_times is null,'',a.leave_times),if(a.leave_types is null,'',a.leave_types),if(a.leave_create_times is null,'',a.leave_create_times)) ip as leave_time,leave_type,leave_create_time\\n      where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    )tmp\\n    left join db_dw_hr.clife_hr_dim_location_room b on tmp.room_id = b.room_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    group by tmp.old_man_id\\n            ,b.floor_id\\n            ,substr(tmp.leave_create_time,1,10)\\n  )e on vd.old_man_id = e.old_man_id and vd.floor_id = e.floor_id and substr(vd.leave_create_time,1,10) = e.leave_create_time\\n  where vd.rank = 1\\n)t3 on t.old_man_id = t3.old_man_id and t.floor_id = t3.floor_id\\nleft join \\n(\\n  select \\n       vl.old_man_id\\n      ,vl.floor_id\\n      ,vl.reside_time\\n      ,vs.reside_cnt_day --当日入住次数\\n  from\\n  (\\n    select  \\n         a.old_man_id,b.floor_id,a.reside_status,a.room_id,a.bed_id,a.reside_time\\n        ,row_number()over(partition by a.old_man_id,b.floor_id order by a.reside_time desc) as rank \\n    from db_dw_hr.clife_hr_dwd_reside_manage_info a\\n    left join db_dw_hr.clife_hr_dim_location_room b on a.room_id = b.room_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  )vl\\n  left join \\n  (\\n    select\\n         a.old_man_id\\n        ,b.floor_id\\n        ,count(1) as reside_cnt_day --当日入住次数\\n        ,substr(a.reside_time,1,10) as reside_time\\n    from db_dw_hr.clife_hr_dwd_reside_manage_info a\\n    left join db_dw_hr.clife_hr_dim_location_room b on a.room_id = b.room_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    group by a.old_man_id\\n            ,b.floor_id\\n            ,substr(a.reside_time,1,10)\\n   )vs on vl.old_man_id = vs.old_man_id and vl.floor_id = vs.floor_id and vs.reside_time = substr(vl.reside_time,1,10)\\n   where vl.rank=1\\n)t5 on t.old_man_id = t5.old_man_id and t.floor_id = t5.floor_id\\nleft join\\n(\\n  select\\n       vl.old_man_id\\n      ,vl.floor_id\\n      ,vl.visit_time\\n      ,vs.visit_day_cnt  --当日探访人数\\n  from\\n  (\\n    select\\n         tmp.old_man_id\\n        ,b.floor_id\\n        ,tmp.visit_time\\n        ,row_number()over(partition by tmp.old_man_id,b.floor_id order by tmp.visit_time desc) as rank_visit \\n\\tfrom\\n    (\\n      select \\n           a.old_man_id\\n          ,a.room_id\\n          ,ip.relatives_name\\n          ,ip.visit_time\\n      from db_dw_hr.clife_hr_dwd_reside_manage_info a\\n      lateral view explodemulti(if(a.relatives_names is null,'',a.relatives_names),if(a.visit_times is null,'',a.visit_times)) ip as relatives_name,visit_time\\n      where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    )tmp\\n    left join db_dw_hr.clife_hr_dim_location_room b on tmp.room_id = b.room_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  )vl\\n  left join\\n  (\\n    select\\n         tmp.old_man_id\\n        ,b.floor_id\\n        ,count(1) as visit_day_cnt  --当日探访人数\\n        ,substr(tmp.visit_time,1,10) as visit_time\\n    from\\n    (\\n      select \\n           a.old_man_id\\n          ,a.room_id\\n          ,ip.relatives_name\\n          ,ip.visit_time\\n      from db_dw_hr.clife_hr_dwd_reside_manage_info a\\n      lateral view explodemulti(if(a.relatives_names is null,'',a.relatives_names),if(a.visit_times is null,'',a.visit_times)) ip as relatives_name,visit_time\\n      where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    )tmp\\n    left join db_dw_hr.clife_hr_dim_location_room b on tmp.room_id = b.room_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    group by tmp.old_man_id\\n            ,b.floor_id\\n            ,substr(tmp.visit_time,1,10)\\n   ) vs on vl.old_man_id = vs.old_man_id and vl.floor_id = vs.floor_id and substr(vl.visit_time ,1,10) = vs.visit_time\\n   where vl.rank_visit = 1\\n)t6 on t.old_man_id = t6.old_man_id and t.floor_id = t6.floor_id\",\"udfs\":\"13\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dwm_recharge_consumption_aggregation\"]},{\"type\":\"SQL\",\"id\":\"tasks-3-2842zk\",\"name\":\"clife_hr_dwm_service_record_aggregation\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dwm_service_record_aggregation partition(part_date)\\nselect\\n     t.nursin_homes_id    --养老院id\\n    ,t.service_type       --服务类型（增值or基础）\\n    ,t.service_type_id    --服务类型id\\n    ,t.service_project_id --服务项目id\\n    ,t.nursing_homes_name --养老院名称\\n    ,t.sub_org_id         --机构id\\n    ,t.sub_org_name       --机构名称\\n    ,t.org_id             --集团id\\n    ,t.org_name           --集团名称\\n    ,t.cost               --服务总费用\\n    ,t.service_cnt        --服务数\\n    ,t.already_settle_service_num     --已结算服务数\\n    ,t.no_settle_service_num          --未结算服务数\\n    ,t.wait_complete_service_num      --待完成服务数\\n    ,t.complete_service_num           --已完成服务数\\n    ,t.evaluation_service_num         --已评价服务数\\n    ,t.evaluation_wait_num            --待评价服务数\\n    ,t.evaluation_good_num            --好评数\\n    ,t.evaluation_middle_num          --中评数\\n    ,t.evaluation_bad_num             --差评数\\n    ,t2.service_cnt_day           --当日服务数(create_time)\\n    ,t3.complete_service_cnt_day  --当日完成服务数(service_finish_time)\\n    ,t4.evaluation_cnt_day        --当日评价数(评价时间 evaluate_times)\\n    ,t4.evaluation_good_num_day   --当日好评数(评价时间 evaluate_times)\\n    ,t4.evaluation_middle_num_day --当日中评数(评价时间 evaluate_times)\\n    ,t4.evaluation_bad_num_day    --当日差评数(评价时间 evaluate_times)\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --分区日期\\nfrom\\n(\\n  select\\n       nursin_homes_id  --养老院id\\n      ,service_type     --服务类型（增值or基础）\\n      ,service_type_id  --服务类型id\\n      ,service_project_id --服务项目id\\n      ,max(nursing_homes_name) as nursing_homes_name --养老院名称\\n      ,max(sub_org_id)         as sub_org_id--机构id\\n      ,max(sub_org_name)       as sub_org_name--机构名称\\n      ,max(org_id)             as org_id--集团id\\n      ,max(org_name)           as org_name--集团名称\\n      ,sum(cost)               as cost  --服务总费用\\n      ,count(1) as  service_cnt --服务数\\n      ,sum(case when settlement_status =  2 then 1 else 0 end ) as  already_settle_service_num     --已结算服务数\\n      ,sum(case when settlement_status =  3 then 1 else 0 end ) as  no_settle_service_num          --未结算服务数\\n      ,sum(case when service_status = 1  then 1 else 0 end )    as  wait_complete_service_num      --待完成服务数\\n      ,sum(case when service_status = 2  then 1 else 0 end )    as  complete_service_num           --已完成服务数\\n      ,sum(case when service_status = 3  then 1 else 0 end )    as  evaluation_service_num         --已评价服务数\\n      ,sum(case when evaluation_status = 0  then 1 else 0 end ) as  evaluation_wait_num            --待评价服务数\\n      ,sum(case when evaluation_status = 1  then 1 else 0 end ) as  evaluation_good_num            --好评数\\n      ,sum(case when evaluation_status = 2  then 1 else 0 end ) as  evaluation_middle_num          --中评数\\n      ,sum(case when evaluation_status = 3  then 1 else 0 end ) as  evaluation_bad_num             --差评数\\n  from db_dw_hr.clife_hr_dwd_service_record_info a\\n  where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by nursin_homes_id\\n          ,service_type       \\n          ,service_type_id    \\n          ,service_project_id \\n)t\\nleft join\\n(--根据养老院id，服务类型，,服务类型id,服务项目id,create_time 排序，取最新一条\\n  select\\n       vl.nursin_homes_id  --养老院id\\n      ,vl.service_type     --服务类型（增值or基础）\\n      ,vl.service_type_id  --服务类型id\\n      ,vl.service_project_id --服务项目id\\n      ,vl.create_time\\n      ,vs.service_cnt_day --当日服务数\\n  from\\n  (\\n     select\\n          nursin_homes_id  --养老院id\\n         ,service_type     --服务类型（增值or基础）\\n         ,service_type_id  --服务类型id\\n         ,service_project_id --服务项目id\\n         ,create_time  --创建时间\\n         ,row_number()over(partition by nursin_homes_id,service_type,service_type_id,service_project_id order by create_time desc) as rank\\n     from db_dw_hr.clife_hr_dwd_service_record_info\\n\\t where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  )vl\\n  left join\\n  (\\n     select\\n          nursin_homes_id  --养老院id\\n         ,service_type     --服务类型（增值or基础）\\n         ,service_type_id  --服务类型id\\n         ,service_project_id --服务项目id\\n         ,count(1) as service_cnt_day --当日服务数\\n         ,substr(create_time,1,10) as service_time\\n     from db_dw_hr.clife_hr_dwd_service_record_info\\n\\t where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n     group by nursin_homes_id\\n             ,service_type   \\n             ,service_type_id\\n             ,service_project_id\\n             ,substr(create_time,1,10)\\n   )vs on vl.nursin_homes_id = vs.nursin_homes_id and vl.service_type = vs.service_type and substr(vl.create_time,1,10) = vs.service_time and vl.service_type_id = vs.service_type_id and vl.service_project_id = vs.service_project_id \\n   where vl.rank = 1\\n)t2 on t.nursin_homes_id = t2.nursin_homes_id and t.service_type = t2.service_type and t.service_type_id = t2.service_type_id and t.service_project_id = t2.service_project_id \\nleft join\\n(----根据养老院id，服务类型，,服务类型id,服务项目id,service_finish_time 排序，取最新一条\\n  select\\n       vl.nursin_homes_id  --养老院id\\n      ,vl.service_type     --服务类型（增值or基础）\\n      ,vl.service_type_id  --服务类型id\\n      ,vl.service_project_id --服务项目id\\n      ,vl.service_finish_time\\n      ,vs.complete_service_cnt_day --当日完成服务数\\n  from\\n  (\\n     select\\n          nursin_homes_id  --养老院id\\n         ,service_type     --服务类型（增值or基础）\\n         ,service_type_id  --服务类型id\\n         ,service_project_id --服务项目id\\n         ,service_finish_time\\n         ,row_number()over(partition by nursin_homes_id,service_type,service_type_id,service_project_id order by service_finish_time desc) as rank\\n     from db_dw_hr.clife_hr_dwd_service_record_info\\n\\t where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  )vl\\n  left join\\n  (\\n     select\\n          nursin_homes_id  --养老院id\\n         ,service_type     --服务类型（增值or基础）\\n         ,service_type_id  --服务类型id\\n         ,service_project_id --服务项目id\\n         ,sum(case when service_status = 2 or service_status = 3  then 1 else 0 end) as complete_service_cnt_day --当日完成服务数\\n         ,substr(service_finish_time,1,10) as service_time\\n     from db_dw_hr.clife_hr_dwd_service_record_info\\n\\t where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n     group by nursin_homes_id\\n             ,service_type   \\n             ,service_type_id\\n             ,service_project_id\\n             ,substr(service_finish_time,1,10)\\n   )vs on vl.nursin_homes_id = vs.nursin_homes_id and vl.service_type = vs.service_type and substr(vl.service_finish_time,1,10) = vs.service_time and vl.service_type_id = vs.service_type_id and vl.service_project_id = vs.service_project_id \\n   where vl.rank = 1\\n)t3 on t.nursin_homes_id = t3.nursin_homes_id and t.service_type = t3.service_type and t.service_type_id = t3.service_type_id and t.service_project_id = t3.service_project_id \\nleft join\\n(----根据养老院id，服务类型，,服务类型id,服务项目id,evaluate_times 排序，取最新一条\\n  select\\n       vl.nursin_homes_id  --养老院id\\n      ,vl.service_type     --服务类型（增值or基础）\\n      ,vl.service_type_id  --服务类型id\\n      ,vl.service_project_id --服务项目id\\n      ,vl.evaluate_time\\n      ,vs.evaluation_cnt_day --当日评价数\\n      ,vs.evaluation_good_num_day   --当日好评数\\n      ,vs.evaluation_middle_num_day --当日中评数\\n      ,vs.evaluation_bad_num_day    --当日差评数\\n  from\\n  (\\n     select\\n          nursin_homes_id  --养老院id\\n         ,service_type     --服务类型（增值or基础）\\n         ,service_type_id  --服务类型id\\n         ,service_project_id --服务项目id\\n         ,evaluate_time\\n         ,row_number()over(partition by nursin_homes_id,service_type,service_type_id,service_project_id order by evaluate_time desc) as rank\\n     from db_dw_hr.clife_hr_dwd_service_record_info\\n\\t where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  )vl\\n  left join\\n  (\\n     select\\n          nursin_homes_id  --养老院id\\n         ,service_type     --服务类型（增值or基础）\\n         ,service_type_id  --服务类型id\\n         ,service_project_id --服务项目id\\n         ,count(1) as evaluation_cnt_day --当日评价数\\n         ,sum(case when evaluation_status = 1 then 1 else 0 end) as evaluation_good_num_day   --当日好评数\\n         ,sum(case when evaluation_status = 2 then 1 else 0 end) as evaluation_middle_num_day --当日中评数\\n         ,sum(case when evaluation_status = 3 then 1 else 0 end) as evaluation_bad_num_day    --当日差评数\\n         ,substr(evaluate_time,1,10) as service_time\\n     from db_dw_hr.clife_hr_dwd_service_record_info\\n\\t where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n     group by nursin_homes_id\\n             ,service_type   \\n             ,service_type_id\\n             ,service_project_id\\n             ,substr(evaluate_time,1,10)\\n   )vs on vl.nursin_homes_id = vs.nursin_homes_id and vl.service_type = vs.service_type and substr(vl.evaluate_time,1,10) = vs.service_time and vl.service_type_id = vs.service_type_id and vl.service_project_id = vs.service_project_id \\n   where vl.rank = 1\\n)t4 on t.nursin_homes_id = t4.nursin_homes_id and t.service_type = t4.service_type and t.service_type_id = t4.service_type_id and t.service_project_id = t4.service_project_id \",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dwm_reside_manage_aggregation\"]}],\"tenantId\":-1,\"timeout\":0}",
			"description": "华润数仓轻度汇总层",
			"globalParams": "[]",
			"globalParamList": [],
			"globalParamMap": {},
			"createTime": "2021-07-21T12:07:13.000+0000",
			"updateTime": "2021-08-03T07:57:16.000+0000",
			"flag": "YES",
			"userId": 143,
			"userName": "shucang0907",
			"projectName": null,
			"locations": "{\"tasks-31836\":{\"name\":\"clife_hr_dwm_market\",\"targetarr\":\"\",\"nodenumber\":\"1\",\"x\":43,\"y\":173},\"tasks-3-2f06kr\":{\"name\":\"clife_hr_dwm_activity_manage_aggregation\",\"targetarr\":\"tasks-31836\",\"nodenumber\":\"1\",\"x\":0,\"y\":332},\"tasks-3-2ykax\":{\"name\":\"clife_hr_dwm_recharge_consumption_aggregation\",\"targetarr\":\"tasks-3-2f06kr\",\"nodenumber\":\"1\",\"x\":208,\"y\":339},\"tasks-3-7802r9\":{\"name\":\"clife_hr_dwm_reside_manage_aggregation\",\"targetarr\":\"tasks-3-2ykax\",\"nodenumber\":\"1\",\"x\":447,\"y\":353},\"tasks-3-2842zk\":{\"name\":\"clife_hr_dwm_service_record_aggregation\",\"targetarr\":\"tasks-3-7802r9\",\"nodenumber\":\"0\",\"x\":690,\"y\":352}}",
			"connects": "[{\"endPointSourceId\":\"tasks-3-2f06kr\",\"endPointTargetId\":\"tasks-3-2ykax\"},{\"endPointSourceId\":\"tasks-3-2ykax\",\"endPointTargetId\":\"tasks-3-7802r9\"},{\"endPointSourceId\":\"tasks-3-7802r9\",\"endPointTargetId\":\"tasks-3-2842zk\"},{\"endPointSourceId\":\"tasks-31836\",\"endPointTargetId\":\"tasks-3-2f06kr\"}]",
			"receivers": "",
			"receiversCc": "",
			"leadMobile": "",
			"ddAlarmId": 0,
			"scheduleReleaseState": null,
			"timeout": 0,
			"tenantId": -1,
			"taskType": "SHELL"
		}, {
			"id": 335,
			"name": "db_dim_hr",
			"version": 0,
			"releaseState": "ONLINE",
			"projectId": 1,
			"processDefinitionJson": "{\"globalParams\":[],\"tasks\":[{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"账户维表\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dim_account partition(part_date)        \\nselect\\n     a.account_id        \\n    ,a.old_man_id        \\n    ,a.membership_id     \\n    ,a.member_status     \\n    ,a.account_name      \\n    ,a.attributes        \\n    ,a.symbol            \\n    ,b.nurse_home_id\\n    ,c.nursing_homes_name\\n    ,c.area_id           \\n    ,a.org_id            \\n    ,b.org_name          \\n    ,a.sub_org_id        \\n    ,b.sub_org_name      \\n    ,a.create_time       \\n    ,a.update_time\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom \\n(\\n  select\\n       account_id        \\n      ,old_man_id    \\n      ,null as membership_id     \\n      ,null as member_status     \\n      ,account_name      \\n      ,attributes        \\n      ,symbol                      \\n      ,org_id                \\n      ,sub_org_id             \\n      ,create_time       \\n      ,update_time\\n  from db_ods_hr.clife_hr_ods_account \\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')  \\n    and state=1\\n  union all\\n  select\\n       id as account_id\\n      ,null as old_man_id\\n      ,member_id  as membership_id\\n      ,member_status\\n      ,null as account_name\\n      ,null as attributes\\n      ,null as symbol\\n      ,org_id\\n      ,sub_org_id\\n      ,create_time\\n      ,update_time\\n  from db_ods_hr.clife_hr_ods_member_account\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    and id<>member_id  \\n    and state=1\\n)a\\nleft join db_ods_hr.clife_hr_ods_org_nurse b on a.sub_org_id = b.sub_org_id  and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_ods_hr.clife_hr_ods_nursing_homes_baseinfo c on b.nurse_home_id = c.nursing_homes_id  and c.part_date = regexp_replace(date_sub(current_date(),1),'-','')    \",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_dim_account\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_dim_admin_sub_org\"],\"id\":\"tasks-34644\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"咨询客户\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dim_advisory_customer partition(part_date)         \\nselect\\n a.advisory_customer_id \\n,a.customer_name        \\n,a.phone_number         \\n,a.intentional_type     \\n,a.sex                \\n,a.reception_date       \\n,a.sales_consultant_id  \\n,a.sales_consultant_name\\n,a.create_time          \\n,a.update_time          \\n,a.create_user_id       \\n,a.org_id               \\n,b.org_name             \\n,a.sub_org_id           \\n,b.sub_org_name         \\n,a.status\\n,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_ods_hr.clife_hr_ods_advisory_customer a\\nleft join db_dw_hr.clife_hr_dim_admin_sub_org b on a.sub_org_id = b.sub_org_id  and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\nwhere a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_dim_advisory_customer\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_dim_account\"],\"id\":\"tasks-3-1y77b7\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"评估报告\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dim_assess_report partition(part_date)         \\nselect\\n assess_report_id     \\n,assess_report_no     \\n,assess_report_status \\n,assess_report_level  \\n,illness_level        \\n,old_man_level        \\n,nursing_level        \\n,social_support_level \\n,create_time          \\n,update_time          \\n,org_id               \\n,sub_org_id           \\n,state                \\n,syndrome_number \\n,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_ods_hr.clife_hr_ods_assess_report a\\nwhere a.part_date=regexp_replace(date_sub(current_date(),1),'-','')      \",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_dim_assess_report\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_dim_advisory_customer\"],\"id\":\"tasks-3-2xe3zd\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"卡\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dim_card partition(part_date)         \\nselect\\n     a.card_id                   \\n    ,a.create_time               \\n    ,a.create_user_id            \\n    ,a.create_user_name          \\n    ,a.card_name                 \\n    ,a.type_option               \\n    ,a.type                      \\n    ,a.org_id                    \\n    ,b.org_name                  \\n    ,a.sub_orgs                  \\n    ,a.inherit_status            \\n    ,a.transfer_status           \\n    ,a.return_status             \\n    ,a.borrow_status             \\n    ,a.renewal_status            \\n    ,a.sojourn_status            \\n    ,a.discount_status           \\n    ,a.discount_des              \\n    ,a.health_check_status       \\n    ,a.health_check_des          \\n    ,a.exclusive_status          \\n    ,a.exclusive_des             \\n    ,a.priority_residence_status \\n    ,a.priority_residence_des    \\n    ,a.travel_status             \\n    ,a.travel_des                \\n    ,a.age_limit_status          \\n    ,a.woman_min_age_limit       \\n    ,a.woman_max_age_limit       \\n    ,a.man_max_age_limit         \\n    ,a.man_min_age_limit         \\n    ,a.time_limit_status         \\n    ,a.min_time_limit            \\n    ,a.max_time_limit            \\n    ,a.min_time_unit             \\n    ,a.constitution_name         \\n    ,a.constitution_url          \\n    ,a.description               \\n    ,case when a.del_flag = 0 then 1 else 0 end as del_flag\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_ods_hr.clife_hr_ods_card a\\nleft join db_ods_hr.clife_hr_ods_admin_org b on a.org_id = b.org_id  and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\nwhere a.part_date=regexp_replace(date_sub(current_date(),1),'-','')      \",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_dim_card\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_dim_assess_report\"],\"id\":\"tasks-3-205482\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"会籍卡产品\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dim_card_product partition(part_date)         \\nselect\\n a.product_id      \\n,a.create_time     \\n,a.create_user_id  \\n,a.org_id          \\n,b.org_name        \\n,a.sub_org_id      \\n,b.sub_org_name    \\n,a.card_id         \\n,a.batch           \\n,a.status\\n,case when a.del_flag = 0 then 1 else 0 end as del_flag  \\n,a.room_type_option\\n,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_ods_hr.clife_hr_ods_card_product a\\nleft join db_dw_hr.clife_hr_dim_admin_sub_org b on a.sub_org_id = b.sub_org_id  and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\nwhere a.part_date=regexp_replace(date_sub(current_date(),1),'-','')      \",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_dim_card_product\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_dim_card\"],\"id\":\"tasks-3-40g66f\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"定金合同\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dim_contract_deposit partition(part_date) \\nselect\\n     deposit_id     \\n    ,deposit_num    \\n    ,intent_user_id \\n    ,payee_name     \\n    ,payee_phone    \\n    ,membership_id  \\n    ,membership_name\\n    ,house_type_id  \\n    ,deposit_status \\n    ,user_id  \\n    ,sub_org_id     \\n    ,org_id         \\n    ,remark         \\n    ,create_time    \\n    ,update_time    \\n    ,building_id    \\n    ,floor_id       \\n    ,room_id        \\n    ,bed_id         \\n    ,apply_id \\n    ,receipt_number\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date--动态分区\\nfrom db_ods_hr.clife_hr_ods_contract_deposit a\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_dim_contract_deposit\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_dim_card_product\"],\"id\":\"tasks-3-6zf1ql\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"签约合同\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dim_contract_sign partition(part_date) \\nselect\\n     a.sign_id                  \\n    ,a.contract_num             \\n    ,a.contract_status          \\n    ,a.membership_type          \\n    ,a.membership_name          \\n    ,a.membership_num           \\n    ,a.chip_num                 \\n    ,a.building_id              \\n    ,a.floor_id                 \\n    ,a.room_id                  \\n    ,a.bed_id                   \\n    ,a.sign_house               \\n    ,a.originator_type          \\n    ,a.reason                   \\n    ,a.is_pay_deposit           \\n    ,a.pay_state                \\n    ,a.sign_date                \\n    ,a.card_valid               \\n    ,a.house_type               \\n    ,a.is_divided               \\n    ,a.membership_effective_time\\n    ,a.membership_id            \\n    ,a.product_id               \\n    ,a.user_id                  \\n    ,a.sub_org_id               \\n    ,b.sub_org_name             \\n    ,a.org_id                   \\n    ,b.org_name                 \\n    ,a.cancle_time              \\n    ,a.is_agency                \\t\\n    ,a.agency_id                \\t\\n    ,a.payment_type_id          \\t\\n    ,a.payment_type_name        \\t\\n    ,a.service_fee_id           \\t\\n    ,a.is_trust                 \\t\\n    ,a.trust_id\\n    ,case when a.show_status = 0 then 1 \\n          when a.show_status = 1 then 0  \\n      else null end as show_status\\t\\n    ,case when a.del_flag = 0 then 1 \\n          when a.del_flag = 1 then 0 \\n     else null end as del_flag\\t\\n    ,a.service_fee_name         \\t\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_ods_hr.clife_hr_ods_contract_sign a\\nleft join db_dw_hr.clife_hr_dim_admin_sub_org b on a.sub_org_id = b.sub_org_id  and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\nwhere a.part_date = regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_dim_contract_sign\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_dim_contract_deposit\"],\"id\":\"tasks-3-6le1th\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"意向客户\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dim_customer partition(part_date) \\nselect\\n     a.customer_id         --'意向客户id'\\n    ,a.customer_name       --'姓名'\\n    ,a.customer_type       --客户类型  1代表买，0代表租\\n    ,a.sex                 --'性别选项id'\\n    ,a.phone_num           --'联系电话'\\n    ,a.credent_type        --'证件类型'\\n    ,a.id_card_num         --'证件号'\\n    ,a.birthday            --'生日'\\n    ,a.reception_date      --'接待日期'\\n    ,a.intentional_type_one--'首次意向类型 1感兴趣、2不感兴趣、3一般、4希望购买'\\n    ,a.intentional_type     --'意向类型 1感兴趣、2不感兴趣、3一般、4希望购买'\\n    ,a.sales_consultant_id           --'销售顾问id'\\n    ,a.sales_consultant_name         --'销售顾问姓名'\\n    ,a.guardian_name                 --'监护人姓名'\\n    ,case when a.guardian_sex = 1 then 0\\n          when a.guardian_sex = 2 then 1\\n     else a.guardian_sex end as \\tguardian_sex\\t  --'监护人性别 0 男  1 女 2 其他'\\n    ,a.relationship                  --'监护人与意向客户的关系 0-其他 1-父子 2-父女 3-母子 4-母女 5-爷孙'\\n    ,a.guardian_phone_num            --'监护人联系方式'\\n    ,a.guardian_credent_type         --'监护人证件类型'\\n    ,a.guardian_id_card_num          --'监护人证件号'\\n    ,a.remark                      --'备注'\\n    ,a.create_time                 --'创建时间'\\n    ,a.create_user_id              --'创建人'\\n    ,a.create_user_name            --'创建人姓名'\\n    ,a.update_time                   --'修改时间'\\n    ,a.sub_org_id                    --'机构id'\\n    ,b.sub_org_name                    --'机构名称'\\n    ,a.org_id                        --'集团id'\\n    ,b.org_name                       --'集团名称'\\n    ,a.trade_channel_ids           --'渠道id'\\n    ,a.trade_channel_types         --'渠道类型'\\n    ,a.return_visit_remind_time    --'回访提醒时间'\\n    ,a.visit_type                  --'来访方式选项id'\\n    ,a.filling_time                --'填表时间'\\n    ,a.questionnaire_id            --'问卷答案id'\\n    ,case when del_flag = 0 then 1 \\n          when del_flag = 1 then 0 \\n     else null end as del_flag\\t --'删除标记 1正常 0删除'\\n    ,a.membership_id               --'意向会籍id'\\n    ,a.membership_name             --'意向会籍名称'\\n    ,a.status                      --'状态 0意向中 1申请中 2签约中 3已签约 | 4已作废'\\n    ,case when a.phone_visit = 2 then 0 else a.phone_visit end as phone_visit\\t \\n    ,case when a.receive_status = 2 then 0 else a.receive_status end as receive_status\\t \\n    ,a.apartment_type              --'关注公寓类型'\\n    ,a.room_type                   --'关注房型'\\n    ,a.vitality_intention          --'活力公寓租赁倾向'\\n    ,a.customer_lv                 --'客户等级'\\n    ,a.possible_customer           --'解决服务费抗性后极有可能签约的客户'\\n    ,a.cost_type                   --'期望服务费方案'\\n    ,a.age                         --'年龄'\\n    ,a.retire_worker               --'退休前工作'\\n    ,a.hobbies                     --'爱好'\\n    ,a.about_org                   --'提及机构'\\n    ,a.resistance                   --'项目抗性'\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom\\n(\\nselect\\n     customer_id                 --'意向客户id'\\n    ,name as  customer_name      --'姓名'\\n    ,1 as customer_type          --客户类型  1代表买，0代表租\\n    ,case when sex_option = 40054 then 0\\n          when sex_option = 40055 then 1\\n     else sex_option end as sex           --'性别选项id'\\n    ,phone as phone_num          --'联系电话'\\n    ,credent_type                --'证件类型'\\n    ,id_card_no as id_card_num   --'证件号'\\n    ,birthday                    --'生日'\\n    ,null as reception_date      --'接待日期'\\n    ,null as intentional_type_one--'首次意向类型 1感兴趣、2不感兴趣、3一般、4希望购买'\\n    ,intentional_type            --'意向类型 1感兴趣、2不感兴趣、3一般、4希望购买'\\n    ,null as sales_consultant_id           --'销售顾问id'\\n    ,null as sales_consultant_name         --'销售顾问姓名'\\n    ,null as guardian_name                 --'监护人姓名'\\n    ,null as guardian_sex                  --'监护人性别 0 其他 1 男 2 女'\\n    ,null as relationship                  --'监护人与意向客户的关系 0-其他 1-父子 2-父女 3-母子 4-母女 5-爷孙'\\n    ,null as guardian_phone_num            --'监护人联系方式'\\n    ,null as guardian_credent_type         --'监护人证件类型'\\n    ,null as guardian_id_card_num          --'监护人证件号'\\n    ,remark                      --'备注'\\n    ,create_time                 --'创建时间'\\n    ,create_user_id              --'创建人'\\n    ,null as create_user_name            --'创建人姓名'\\n    ,null as update_time                   --'修改时间'\\n    ,sub_org_id                    --'机构id'\\n    ,org_id                        --'集团id'\\n    ,trade_channel_ids           --'渠道id'\\n    ,trade_channel_types         --'渠道类型'\\n    ,return_visit_remind_time    --'回访提醒时间'\\n    ,visit_type                  --'来访方式选项id'\\n    ,filling_time                --'填表时间'\\n    ,questionnaire_id            --'问卷答案id'\\n    ,del_flag                    --'删除标记 0正常 1删除'\\n    ,membership_id               --'意向会籍id'\\n    ,membership_name             --'意向会籍名称'\\n    ,status                      --'状态 0意向中 1申请中 2签约中 3已签约 | 4已作废'\\n    ,phone_visit                 --'是否来电转来访 1:是 2：否'\\n    ,receive_status              --'是否有效接待'\\n    ,apartment_type              --'关注公寓类型'\\n    ,room_type                   --'关注房型'\\n    ,vitality_intention          --'活力公寓租赁倾向'\\n    ,customer_lv                 --'客户等级'\\n    ,possible_customer           --'解决服务费抗性后极有可能签约的客户'\\n    ,cost_type                   --'期望服务费方案'\\n    ,age                         --'年龄'\\n    ,retire_worker               --'退休前工作'\\n    ,hobbies                     --'爱好'\\n    ,about_org                   --'提及机构'\\n    ,resistance                   --'项目抗性'\\nfrom db_ods_hr.clife_hr_ods_intentional_customer\\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nunion all\\nselect\\n     intention_customer_id as customer_id         --'意向客户主键Id'\\n    ,customer_name                 --'客户姓名'\\n    ,0 as customer_type            --客户类型  1代表买，0代表租\\n    ,sex                           --'性别(0:男1女)'\\n    ,phone_num                     --'电话号码'\\n    ,credent_type                  --'证件类型'\\n    ,id_card_num                   --'证件号'\\n    ,birthday                      --'生日'\\n    ,reception_date                --'接待日期'\\n    ,null as intentional_type_one  --'首次意向类型 1感兴趣、2不感兴趣、3一般、4希望购买'\\n    ,intentional_type              --'意向类型 1感兴趣、2不感兴趣、3一般、4希望购买'\\n    ,sales_consultant_id           --'销售顾问id'\\n    ,sales_consultant_name         --'销售顾问姓名'\\n    ,guardian_name                 --'监护人姓名'\\n    ,guardian_sex                  --'监护人性别 0 其他 1 男 2 女'\\n    ,relationship                  --'监护人与意向客户的关系 0-其他 1-父子 2-父女 3-母子 4-母女 5-爷孙'\\n    ,guardian_phone_num            --'监护人联系方式'\\n    ,guardian_credent_type         --'监护人证件类型'\\n    ,guardian_id_card_num          --'监护人证件号'\\n    ,remark                        --'备注'\\n    ,create_time                   --'创建时间'\\n    ,create_user_id                --'创建人id'\\n    ,null as create_user_name      --'创建人姓名'\\n    ,update_time                   --'修改时间'\\n    ,sub_org_id                    --'机构id'\\n    ,org_id                        --'集团id'\\n    ,null as trade_channel_ids           --'渠道id'\\n    ,null as trade_channel_types         --'渠道类型'\\n    ,null as return_visit_remind_time    --'回访提醒时间'\\n    ,null as visit_type                  --'来访方式选项id'\\n    ,null as filling_time                --'填表时间'\\n    ,null as questionnaire_id            --'问卷答案id'\\n    ,status as del_flag                    --'删除标记 0正常 1删除'\\n    ,null as membership_id               --'意向会籍id'\\n    ,null as membership_name             --'意向会籍名称'\\n    ,null as status                      --'状态'\\n    ,null as phone_visit                 --'是否来电转来访 1:是 2：否'\\n    ,null as receive_status              --'是否有效接待'\\n    ,null as apartment_type              --'关注公寓类型'\\n    ,null as room_type                   --'关注房型'\\n    ,null as vitality_intention          --'活力公寓租赁倾向'\\n    ,null as customer_lv                 --'客户等级'\\n    ,null as possible_customer           --'解决服务费抗性后极有可能签约的客户'\\n    ,null as cost_type                   --'期望服务费方案'\\n    ,null as age                         --'年龄'\\n    ,null as retire_worker               --'退休前工作'\\n    ,null as hobbies                     --'爱好'\\n    ,null as about_org                   --'提及机构'\\n    ,null as resistance                   --'项目抗性'\\nfrom db_ods_hr.clife_hr_ods_intention_customer\\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','') \\n)a \\nleft join db_dw_hr.clife_hr_dim_admin_sub_org b on a.sub_org_id = b.sub_org_id  and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_dim_customer\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_dim_contract_sign\"],\"id\":\"tasks-3-4hg7lt\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"设备\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dim_device partition(part_date)         \\nselect\\n a.device_id                 --设备id\\n,a.product_id                --产品id\\n,b.device_type_id            --设备大类\\n,a.device_sub_type_id        --设备小类\\n,a.mac_address               --mac地址\\n,a.device_num                --设备的编号\\n,b.dev_sub_key_id            --'外键关联小分类主键'\\n,b.developer_id              --'开发者Id'      \\n,b.product_version           --'产品序号'      \\n,b.product_icon              --'产品的图标'      \\n,b.bind_type                 --'绑定类型'      \\n,b.bind_type_version         --'通信模块版本'      \\n,b.module_id                 --'模块id'      \\n,b.product_name              --'产品名称'      \\n,b.product_code              --'产品型号'      \\n,b.device_key                --'设备接入秘钥'      \\n,b.`mode`                    --'模式'      \\n,b.brand_id                  --'品牌ID'      \\n,b.status                    --'状态'      \\n,b.radiocast_name            --'设备广播名'      \\n,b.remark                    --'备注'      \\n,b.qrcode                    --'二维码'          \\n,b.bar_code                  --'条形码'      \\n,b.ssid                      --'SSID'\\n,b.program_burning_file      --'程序烧录文件'      \\n,b.functional_schematic_file --'功能原理图'      \\n,b.bill_of_material_file     --'物料清单附件'      \\n,b.is_auto_config            --'是否由自动配置生成的产品'      \\n,b.port_number               --'控制端口数'      \\n,b.gateway_type              --'网关通信技术的类型'      \\n,b.third_category_id         --'产品类目第三级id'\\n,c.all_category_name          --'三级类目全称'\\n,c.default_device_subtype_id  --'开放平台4.0中一个三级类目id默认对应一个小类id用于走逻辑'\\n,c.device_type_name           --'设备类型名称'\\n,c.device_icon                --'设备图标'\\n,c.sub_category_id            --'产品类目第二级id'\\n,c.is_show                    --'是否显示'\\n,e.control_class              --'是否是控制类'\\n,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom\\n(\\n  select\\n       device_id      --'设备id',\\n      ,mac_address    --'mac地址',\\n      ,product_id     --'产品id',\\n      ,device_type_id --'设备类型',\\n      ,device_sub_type_id  --'设备小类'\\n      ,device_num          --'设备的编号'\\n  from db_ods_hr.clife_hr_ods_nurse_device\\n  where part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n  union all\\n  select\\n       device_id                --'设备id',\\n      ,mac as mac_address       --'mac地址',\\n      ,cast(type as bigint) as product_id       --'产品id',\\n      ,null as device_type_id   --'设备类型',\\n      ,sub_type as device_sub_type_id  --'设备小类'\\n      ,device_num                      --'设备编码'\\n  from db_ods_hr.clife_hr_ods_nurse_third_device\\n  where part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n)a\\nleft join db_ods_hr.clife_hr_ods_product b on a.product_id=b.product_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_ods_hr.clife_hr_ods_device_type c on b.device_type_id=c.device_type_id and c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_ods_hr.clife_hr_ods_device_category d on d.sub_category_id=c.sub_category_id and d.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_ods_hr.clife_hr_ods_device_subtype e on b.dev_sub_key_id=e.dev_sub_key_id and e.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_dim_device\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_dim_customer\"],\"id\":\"tasks-3-24up7\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"地域\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"postStatements\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"receiversCc\":\"\",\"udfs\":\"\",\"type\":\"HIVE\",\"title\":\"\",\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dim_geographic_info partition(part_date) \\nselect \\n     a.area_id\\t                           --县级市、区id\\n    ,a.area_name\\t                       --县级市、区名称\\n    ,a.city_id\\t                           --城市id\\n    ,b.baidu_city_code\\t                   --百度城市编码\\n    ,b.city_name\\t                       --城市名称\\n    ,b.city_english_name\\t               --城市英文名称\\n    ,b.longitude\\tas  city_longitude     --城市经度\\n    ,b.latitude\\tas  city_latitude          --城市纬度\\n    ,b.is_capital                          --是否为省会城市\\n    ,b.province_id\\t                       --省份id\\n    ,c.province_name\\t                   --省份名称\\n    ,c.province_english_name               --省份英文名\\n    ,c.longitude\\tas province_longitude  --省份经度\\n    ,c.latitude\\tas province_latitude       --省份纬度\\n    ,c.baidu_code                          --省份百度编码\\n    ,d.partition_id                        --县级市、区id\\n    ,d.partition_name                      --县级市、区名称\\n    ,d.country_id                          --国家id\\n    ,e.country_name                        --国家名称\\n    ,e.country_en_name                     --国家英文名\\n    ,regexp_replace(date_sub(from_unixtime(unix_timestamp() ,'yyyy-MM-dd'),1),'-','')\\nfrom db_ods_hr.clife_hr_ods_area a\\nleft join db_ods_hr.clife_hr_ods_city  b on a.city_id = b.city_id\\nleft join db_ods_hr.clife_hr_ods_province c on  b.province_id = c.province_id\\nleft join db_ods_hr.clife_hr_ods_partition d on  c.partition_id = d.partition_id\\nleft join db_ods_hr.clife_hr_ods_country e on  d.country_id = e.country_id\",\"preStatements\":[],\"sqlType\":\"1\",\"receivers\":\"\",\"datasource\":103,\"showType\":\"TABLE\",\"localParams\":[],\"datasourceName\":\"db_ods_hr\"},\"timeout\":{\"enable\":false,\"strategy\":\"\"},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_dim_geographic_info\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_dim_device\"],\"id\":\"tasks-3-2cs6dn\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"积分产品兑换\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dim_integral_goods partition(part_date) \\nselect\\n     a.id                  \\n    ,a.integral_goods_id  \\n    ,a.integral_goods_name\\n    ,a.create_time        \\n    ,a.update_time        \\n    ,a.create_user_id     \\n    ,a.update_user_id     \\n    ,a.status             \\n    ,a.org_id             \\n    ,a.sub_org_id         \\n    ,b.org_name           \\n    ,b.sub_org_name        \\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_ods_hr.clife_hr_ods_integral_goods a\\nleft join db_dw_hr.clife_hr_dim_admin_sub_org b on a.sub_org_id = b.sub_org_id  and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\nwhere a.part_date = regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_dim_integral_goods\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_dim_geographic_info\"],\"id\":\"tasks-3-36r43z\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"会籍\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dim_membership partition(part_date) \\nselect\\n     a.id               \\n    ,a.contract_id      \\n    ,a.membership_status\\n    ,a.return_status    \\n    ,a.user_id          \\n    ,a.sub_org_id       \\n    ,b.sub_org_name     \\n    ,a.org_id           \\n    ,b.org_name\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_ods_hr.clife_hr_ods_membership a\\nleft join db_dw_hr.clife_hr_dim_admin_sub_org b on a.sub_org_id = b.sub_org_id  and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\nwhere a.part_date = regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_dim_membership\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_dim_integral_goods\"],\"id\":\"tasks-3-t057k\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"房间\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dim_location_room partition(part_date) \\nselect\\n a.room_id\\n,a.floor_id\\n,b.floor_name\\n,a.nursing_homes_id\\n,a.room_type\\n,a.house_type_id\\n,a.house_type_name\\n,a.orientation\\n,a.orientation_name\\n,a.room_attribute\\n,case when a.sales_status = 0 then 1\\n      when a.sales_status = 1 then 0\\n else null end as sales_status\\n,a.room_name\\n,a.inside_room_types\\n,c.building_id\\n,c.building_name\\n,c.type\\n,c.floor_amount\\n,c.floor_room_amount\\n,c.location_describe\\n,c.use_describe\\n,d.bed_amount\\n,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_ods_hr.clife_hr_ods_location_room a\\nleft join db_ods_hr.clife_hr_ods_location_floor b on a.floor_id = b.floor_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_ods_hr.clife_hr_ods_location_building c on b.building_id = c.building_id and c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\n(\\n  select room_id,count(bed_id) as bed_amount\\n  from db_ods_hr.clife_hr_ods_location_bed  \\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by room_id\\n)d on a.room_id=d.room_id\\nwhere a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_dim_location_room\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_dim_membership\"],\"id\":\"tasks-3-fv2xo\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"权益人\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dim_membership_owner partition(part_date)         \\nselect\\n     a.id\\n    ,a.name\\n    ,case when a.sex = 1 then 0 \\n          when a.sex = 2 then 1 \\n     else a.sex end as sex\\n    ,a.birthday\\n    ,a.phone                  \\n    ,a.id_card\\n    ,a.card_type\\n    ,a.age\\n    ,a.census_register\\n    ,a.census_province_id\\n    ,a.census_province_name   \\n    ,a.census_city_id\\n    ,a.census_city_name\\n    ,a.census_area_id\\n    ,a.census_area_name       \\n    ,a.residence\\n    ,a.residence_province_id\\n    ,a.residence_province_name\\n    ,a.residence_city_id\\n    ,a.residence_city_name\\n    ,a.residence_area_id\\n    ,a.residence_area_name    \\n    ,a.unit\\n    ,a.title\\n    ,a.hobbies\\n    ,a.physical_condition\\n    ,a.disease_history\\n    ,a.`type`\\n    ,a.user_id                \\n    ,a.org_id\\n    ,b.org_name\\n    ,a.sub_org_id\\n    ,b.sub_org_name\\n    ,case when a.status = 0 then 1\\n          when a.status = 1 then 0\\n     else null end as status\\t\\t  \\n    ,a.audit_user_id\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_ods_hr.clife_hr_ods_membership_owner a\\nleft join db_dw_hr.clife_hr_dim_admin_sub_org b on a.sub_org_id = b.sub_org_id  and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\nwhere a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_dim_membership_owner\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_dim_location_room\"],\"id\":\"tasks-3-5fh1y3\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"养老机构\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dim_nursing_home partition(part_date) \\nselect \\n     a.nursing_homes_id        --养老机构id\\n    ,a.nursing_homes_name\\n    ,f.sub_org_id\\n    ,f.org_id\\n    ,a.partition_id\\n    ,a.province_id\\n    ,a.city_id\\n    ,a.area_id\\n    ,a.location_detail\\n    ,a.account_id\\n    ,a.status\\n    ,f.org_name\\n    ,f.sub_org_name\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date--动态分区\\nfrom db_ods_hr.clife_hr_ods_nursing_homes_baseinfo a  \\nleft join db_ods_hr.clife_hr_ods_org_nurse f on a.nursing_homes_id = f.nurse_home_id and f.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nwhere a.part_date = regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_dim_nursing_home\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_dim_membership_owner\"],\"id\":\"tasks-3-4qy5lp\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"老人合同\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dim_old_man_contract partition(part_date) \\nselect\\n     a.contract_id       \\n    ,a.pre_contract_id    \\n    ,b.old_man_name      \\n    ,b.old_man_id        \\n    ,b.sex               \\n    ,b.phone      \\n    ,b.card_type      \\n    ,b.card_num         \\n    ,a.state            \\n    ,b.bed_id            \\n    ,b.room_attribute  \\n    ,b.room_name  \\n    ,b.room_id           \\n    ,b.floor_id          \\n    ,b.building_id       \\n    ,a.org_id            \\n    ,a.sub_org_id        \\n    ,f.nurse_home_id  \\n    ,b.create_user_id    \\n    ,b.create_user_name  \\n    ,b.create_time       \\n    ,b.update_user_id    \\n    ,b.update_user_name  \\n    ,b.update_time       \\n    ,c.org_name       \\n    ,c.sub_org_name      \\n    ,d.nursing_homes_name \\t\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_ods_hr.clife_hr_ods_old_man_contract a\\nleft join db_ods_hr.clife_hr_ods_check_in b on a.old_man_check_in_id = b.old_man_check_in_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_dw_hr.clife_hr_dim_admin_sub_org c on a.sub_org_id = c.sub_org_id  and c.part_date = regexp_replace(date_sub(current_date(),1),'-','')   \\nleft join db_ods_hr.clife_hr_ods_org_nurse f on a.sub_org_id = f.sub_org_id and f.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_ods_hr.clife_hr_ods_nursing_homes_baseinfo d on f.nurse_home_id = d.nursing_homes_id  and d.part_date=regexp_replace(date_sub(current_date(),1),'-','')       \\nwhere a.part_date = regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_dim_old_man_contract\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_dim_nursing_home\"],\"id\":\"tasks-3-1nw5qn\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"渠道\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dim_trade_channel partition(part_date)         \\nselect\\n a.id\\n,a.trade_channel_name\\n,a.channel_type\\n,c.channel_type_name\\n,a.remark\\n,a.create_time\\n,a.user_id\\n,a.org_id\\n,b.org_name\\n,a.sub_org_id\\n,b.sub_org_name\\n,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_ods_hr.clife_hr_ods_trade_channel a\\nleft join db_dw_hr.clife_hr_dim_admin_sub_org b on a.sub_org_id = b.sub_org_id  and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_ods_hr.clife_hr_ods_trade_channel_type c on a.channel_type=c.id and c.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\nwhere a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_dim_trade_channel\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_dim_old_man_contract\"],\"id\":\"tasks-3-1bn4ys\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"工作人员\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dim_worker_new partition(part_date) \\nselect\\n a.worker_id       \\n,a.worker_role_id  \\n,a.worker_name     \\n,a.credent_type    \\n,a.credent_number  \\n,a.sex\\n,a.birthday        \\n,if(datediff(CURRENT_DATE,CONCAT(substr(CURRENT_DATE,0,4),substr(a.birthday,5,7)))>=0,\\n(substr(CURRENT_DATE,0,4) - substr(a.birthday,0,4)),\\n(substr(CURRENT_DATE,0,4) - substr(a.birthday,0,4)-1)) as age             \\n,a.natives_province\\n,a.natives_city    \\n,a.native_address  \\n,a.worker_type     \\n,a.sub_org_id      \\n,c.sub_org_name    \\n,a.org_id          \\n,c.org_name        \\n,a.phone           \\n,a.user_id\\n,a.portrait_url    \\n,a.nurse_home_id   \\n,a.worker_status   \\n,a.personnel_type  \\n,a.occupation_type \\n,a.position        \\n,a.department_name \\n,a.department_id   \\n,a.live_address\\n,a.nurse_worker_id\\n,regexp_replace(date_sub(current_date(),1),'-','') as part_date--动态分区\\nfrom db_ods_hr.clife_hr_ods_worker_new a\\nleft join db_dw_hr.clife_hr_dim_admin_sub_org c on a.sub_org_id = c.sub_org_id  and c.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\nwhere a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_dim_worker_new\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_dim_trade_channel\"],\"id\":\"tasks-3-2gg5cg\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"老人\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dim_old_man partition(part_date) \\nselect \\n a.old_man_id           \\n,a.old_man_name         \\n,a.nursin_homes_id      \\n,a.id_card_no           \\n,a.sex             \\n,a.birthday             \\n,a.lunar_birthday       \\n,a.solar_birthday       \\n,a.illness_case_ids     \\n,a.location_id          \\n,c.live_address         \\n,c.live_city            \\n,a.portrait_url         \\n,a.phone                \\n,a.contact_information  \\n,c.nation               \\n,c.social_security_card \\n,c.card_place           \\n,c.card_hospital        \\n,c.education_degree     \\n,c.religion             \\n,c.marital_status       \\n,c.living_status        \\n,c.medical_costs        \\n,c.finance_source       \\n,c.dementia             \\n,c.mental_disease       \\n,c.native_address       \\n,c.native_place         \\n,c.guardian             \\n,c.guardian_contactInfo \\n,c.guardian_phone       \\n,c.guardian_relationship\\n,c.guardian_email       \\n,c.ability_level        \\n,c.politic_countenance  \\n,c.blood_type           \\n,c.is_local_household_registration\\n,c.retirement_career     \\n,c.emergency_name        \\n,c.emergency_relationship\\n,c.emergency_contactInfo \\n,concat_ws('-',d.province_name,d.city_name,d.area_name) as birthplace\\n,a.old_man_startus        \\n,a.admission_date        \\n,a.checkin_date          \\n,a.nurse_point_ids       \\n,a.nurse_man_id          \\n,a.need_nurse            \\n,a.location_id as room_id\\n,a.bed_id                      \\n,a.user_id               \\n,a.center_id             \\n,a.nursing_level_id      \\n,a.nursing_level         \\n,a.service_scheme_id     \\n,a.service_scheme_name  \\n,if(datediff(CURRENT_DATE,CONCAT(substr(CURRENT_DATE,0,4),substr(a.birthday,5,7)))>=0,\\n\\t(substr(CURRENT_DATE,0,4) - substr(a.birthday,0,4)),\\n\\t(substr(CURRENT_DATE,0,4) - substr(a.birthday,0,4)-1)) as age  \\n,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_ods_hr.clife_hr_ods_old_man a\\nleft join db_ods_hr.clife_hr_ods_old_man_extend c on a.old_man_id=c.old_man_id and c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_dw_hr.clife_hr_dim_geographic_info d on c.area = d.area_id\\nwhere a.part_date = regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"timeout\":{},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_dim_old_man\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_dim_worker_new\"],\"id\":\"tasks-3-49o2wl\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"活动室\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dim_activity_room partition(part_date) \\nselect\\n     a.id                 \\n    ,a.room_name         \\n    ,a.room_status\\n    ,a.location          \\n    ,a.nursing_homes_id  \\n    ,b.nursing_homes_name\\n    ,b.org_id            \\n    ,b.org_name          \\n    ,b.sub_org_id        \\n    ,b.sub_org_name      \\n    ,a.create_time       \\n    ,a.`start`             \\n    ,a.`end`               \\n    ,a.work_id           \\n    ,a.update_time\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_ods_hr.clife_hr_ods_org_activity_room a\\nleft join  db_dw_hr.clife_hr_dim_nursing_home b on a.nursing_homes_id = b.nursing_homes_id and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')  \\nwhere a.part_date = regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_dim_activity_room\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_dim_old_man\"],\"id\":\"tasks-3-72f5lv\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dim_admin_sub_org partition(part_date) \\nselect\\n     a.sub_org_id       \\n    ,a.org_info_id      \\n    ,a.org_type         \\n    ,a.parent_org_id    \\n    ,a.org_id           \\n    ,a.org_name as  sub_org_name       \\n    ,a.org_account      \\n    ,a.org_account_id   \\n    ,a.org_password     \\n    ,a.valid_time       \\n    ,a.lose_time        \\n    ,a.org_desc         \\n    ,a.org_picture      \\n    ,a.status           \\n    ,a.app_id           \\n    ,a.org_code         \\n    ,a.org_group_id     \\n    ,a.handle_user      \\n    ,a.type             \\n    ,a.update_time      \\n    ,a.create_time      \\n    ,a.ubdertake_type   \\n    ,a.operation_model  \\n    ,a.org_lv           \\n    ,a.area             \\n    ,a.province         \\n    ,a.city             \\n    ,a.town             \\n    ,a.village          \\n    ,a.principal        \\n    ,a.link_phone       \\n    ,a.address          \\n    ,a.sub_org_type     \\n    ,a.area_id          \\n    ,a.service_province \\n    ,a.service_city     \\n    ,a.service_area     \\n    ,a.latitude         \\n    ,a.longitude\\n    ,b.org_name\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom db_ods_hr.clife_hr_ods_admin_sub_org a\\nleft join db_ods_hr.clife_hr_ods_admin_org b on a.org_id=b.org_id  and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nwhere a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_dim_admin_sub_org\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[\"clife_hr_dim_admin_org\"],\"id\":\"tasks-3-7ou4pz\",\"workerGroup\":-1},{\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"type\":\"SQL\",\"params\":{\"type\":\"HIVE\",\"datasource\":103,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dim_admin_org partition(part_date) \\nselect\\n     org_id           \\n    ,org_info_id      \\n    ,org_type         \\n    ,org_name         \\n    ,org_account      \\n    ,org_account_id   \\n    ,org_password     \\n    ,valid_time       \\n    ,lose_time        \\n    ,org_desc         \\n    ,org_picture      \\n    ,status           \\n    ,app_id           \\n    ,org_code         \\n    ,org_group_id     \\n    ,handle_user      \\n    ,type             \\n    ,update_time      \\n    ,create_time      \\n    ,principal        \\n    ,link_phone       \\n    ,area             \\n    ,province         \\n    ,city             \\n    ,town             \\n    ,address          \\n    ,latitude         \\n    ,longitude\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\t\\nfrom db_ods_hr.clife_hr_ods_admin_org a\\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"maxRetryTimes\":\"0\",\"taskInstancePriority\":\"MEDIUM\",\"name\":\"clife_hr_dim_admin_org\",\"dependence\":{},\"retryInterval\":\"1\",\"preTasks\":[],\"id\":\"tasks-3-5jh3lc\",\"workerGroup\":-1}],\"tenantId\":-1,\"timeout\":0}",
			"description": "",
			"globalParams": "[]",
			"globalParamList": [],
			"globalParamMap": {},
			"createTime": "2021-07-20T03:24:20.000+0000",
			"updateTime": "2021-08-03T02:31:01.000+0000",
			"flag": "YES",
			"userId": 143,
			"userName": "shucang0907",
			"projectName": null,
			"locations": "{\"tasks-34644\":{\"name\":\"clife_hr_dim_account\",\"targetarr\":\"tasks-3-7ou4pz\",\"nodenumber\":\"2\",\"x\":480,\"y\":211},\"tasks-3-1y77b7\":{\"name\":\"clife_hr_dim_advisory_customer\",\"targetarr\":\"tasks-34644\",\"nodenumber\":\"1\",\"x\":680,\"y\":223},\"tasks-3-2xe3zd\":{\"name\":\"clife_hr_dim_assess_report\",\"targetarr\":\"tasks-3-1y77b7\",\"nodenumber\":\"1\",\"x\":883,\"y\":207},\"tasks-3-205482\":{\"name\":\"clife_hr_dim_card\",\"targetarr\":\"tasks-3-2xe3zd\",\"nodenumber\":\"1\",\"x\":1043,\"y\":218},\"tasks-3-40g66f\":{\"name\":\"clife_hr_dim_card_product\",\"targetarr\":\"tasks-3-205482\",\"nodenumber\":\"1\",\"x\":1190,\"y\":225},\"tasks-3-6zf1ql\":{\"name\":\"clife_hr_dim_contract_deposit\",\"targetarr\":\"tasks-3-40g66f\",\"nodenumber\":\"1\",\"x\":1410,\"y\":226},\"tasks-3-6le1th\":{\"name\":\"clife_hr_dim_contract_sign\",\"targetarr\":\"tasks-3-6zf1ql\",\"nodenumber\":\"1\",\"x\":1607,\"y\":212},\"tasks-3-4hg7lt\":{\"name\":\"clife_hr_dim_customer\",\"targetarr\":\"tasks-3-6le1th\",\"nodenumber\":\"1\",\"x\":1775,\"y\":176},\"tasks-3-24up7\":{\"name\":\"clife_hr_dim_device\",\"targetarr\":\"tasks-3-4hg7lt\",\"nodenumber\":\"1\",\"x\":1929,\"y\":228},\"tasks-3-2cs6dn\":{\"name\":\"clife_hr_dim_geographic_info\",\"targetarr\":\"tasks-3-24up7\",\"nodenumber\":\"1\",\"x\":2090,\"y\":218},\"tasks-3-36r43z\":{\"name\":\"clife_hr_dim_integral_goods\",\"targetarr\":\"tasks-3-2cs6dn\",\"nodenumber\":\"1\",\"x\":2295,\"y\":233},\"tasks-3-t057k\":{\"name\":\"clife_hr_dim_membership\",\"targetarr\":\"tasks-3-36r43z\",\"nodenumber\":\"1\",\"x\":2499,\"y\":233},\"tasks-3-fv2xo\":{\"name\":\"clife_hr_dim_location_room\",\"targetarr\":\"tasks-3-t057k\",\"nodenumber\":\"1\",\"x\":2704,\"y\":229},\"tasks-3-5fh1y3\":{\"name\":\"clife_hr_dim_membership_owner\",\"targetarr\":\"tasks-3-fv2xo\",\"nodenumber\":\"1\",\"x\":2935,\"y\":222},\"tasks-3-4qy5lp\":{\"name\":\"clife_hr_dim_nursing_home\",\"targetarr\":\"tasks-3-5fh1y3\",\"nodenumber\":\"1\",\"x\":3150,\"y\":229},\"tasks-3-1nw5qn\":{\"name\":\"clife_hr_dim_old_man_contract\",\"targetarr\":\"tasks-3-4qy5lp\",\"nodenumber\":\"1\",\"x\":3367,\"y\":223},\"tasks-3-1bn4ys\":{\"name\":\"clife_hr_dim_trade_channel\",\"targetarr\":\"tasks-3-1nw5qn\",\"nodenumber\":\"1\",\"x\":3582,\"y\":226},\"tasks-3-2gg5cg\":{\"name\":\"clife_hr_dim_worker_new\",\"targetarr\":\"tasks-3-1bn4ys\",\"nodenumber\":\"1\",\"x\":3766,\"y\":233},\"tasks-3-49o2wl\":{\"name\":\"clife_hr_dim_old_man\",\"targetarr\":\"tasks-3-2gg5cg\",\"nodenumber\":\"1\",\"x\":3957,\"y\":238},\"tasks-3-72f5lv\":{\"name\":\"clife_hr_dim_activity_room\",\"targetarr\":\"tasks-3-49o2wl\",\"nodenumber\":\"1\",\"x\":4156,\"y\":230},\"tasks-3-7ou4pz\":{\"name\":\"clife_hr_dim_admin_sub_org\",\"targetarr\":\"tasks-3-5jh3lc\",\"nodenumber\":\"1\",\"x\":316,\"y\":206},\"tasks-3-5jh3lc\":{\"name\":\"clife_hr_dim_admin_org\",\"targetarr\":\"\",\"nodenumber\":\"1\",\"x\":155,\"y\":206}}",
			"connects": "[{\"endPointSourceId\":\"tasks-3-1y77b7\",\"endPointTargetId\":\"tasks-3-2xe3zd\"},{\"endPointSourceId\":\"tasks-3-2xe3zd\",\"endPointTargetId\":\"tasks-3-205482\"},{\"endPointSourceId\":\"tasks-3-205482\",\"endPointTargetId\":\"tasks-3-40g66f\"},{\"endPointSourceId\":\"tasks-3-40g66f\",\"endPointTargetId\":\"tasks-3-6zf1ql\"},{\"endPointSourceId\":\"tasks-3-6zf1ql\",\"endPointTargetId\":\"tasks-3-6le1th\"},{\"endPointSourceId\":\"tasks-3-6le1th\",\"endPointTargetId\":\"tasks-3-4hg7lt\"},{\"endPointSourceId\":\"tasks-3-4hg7lt\",\"endPointTargetId\":\"tasks-3-24up7\"},{\"endPointSourceId\":\"tasks-3-24up7\",\"endPointTargetId\":\"tasks-3-2cs6dn\"},{\"endPointSourceId\":\"tasks-3-2cs6dn\",\"endPointTargetId\":\"tasks-3-36r43z\"},{\"endPointSourceId\":\"tasks-3-36r43z\",\"endPointTargetId\":\"tasks-3-t057k\"},{\"endPointSourceId\":\"tasks-3-t057k\",\"endPointTargetId\":\"tasks-3-fv2xo\"},{\"endPointSourceId\":\"tasks-3-fv2xo\",\"endPointTargetId\":\"tasks-3-5fh1y3\"},{\"endPointSourceId\":\"tasks-3-5fh1y3\",\"endPointTargetId\":\"tasks-3-4qy5lp\"},{\"endPointSourceId\":\"tasks-3-4qy5lp\",\"endPointTargetId\":\"tasks-3-1nw5qn\"},{\"endPointSourceId\":\"tasks-3-1nw5qn\",\"endPointTargetId\":\"tasks-3-1bn4ys\"},{\"endPointSourceId\":\"tasks-3-1bn4ys\",\"endPointTargetId\":\"tasks-3-2gg5cg\"},{\"endPointSourceId\":\"tasks-3-2gg5cg\",\"endPointTargetId\":\"tasks-3-49o2wl\"},{\"endPointSourceId\":\"tasks-34644\",\"endPointTargetId\":\"tasks-3-1y77b7\"},{\"endPointSourceId\":\"tasks-3-49o2wl\",\"endPointTargetId\":\"tasks-3-72f5lv\"},{\"endPointSourceId\":\"tasks-3-5jh3lc\",\"endPointTargetId\":\"tasks-3-7ou4pz\"},{\"endPointSourceId\":\"tasks-3-7ou4pz\",\"endPointTargetId\":\"tasks-34644\"}]",
			"receivers": "",
			"receiversCc": "",
			"leadMobile": "",
			"ddAlarmId": 0,
			"scheduleReleaseState": null,
			"timeout": 0,
			"tenantId": -1,
			"taskType": "SHELL"
		}, {
			"id": 338,
			"name": "db_dws_hr",
			"version": 0,
			"releaseState": "ONLINE",
			"projectId": 1,
			"processDefinitionJson": "{\"globalParams\":[],\"tasks\":[{\"type\":\"SQL\",\"id\":\"tasks-29812\",\"name\":\"clife_hr_customer_crm_visit_base_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table if not exists db_dw_hr.clife_hr_customer_crm_visit_base_info_tmp stored as parquet as\\nselect \\n a.intention_customer_id --意向客户id\\n,max(a.name)        as name                     --客户姓名\\n,max(a.sex)     sex --性别\\n,max(a.intention_type)  as  intentional_type  --当前意向类型\\n,max(a.membership_adviser_id)  as membership_adviser_id   --会籍顾问id\\n,max(a.membership_adviser_name)  membership_adviser_name   --会籍顾问名称\\n,max(a.trade_channel_ids)   trade_channel_ids   --渠道id\\n,max(a.sub_org_id) sub_org_id\\n,max(a.first_intention_type) first_intention_type   -- 首次意向\\n,max(a.regist_time)     regist_time        --意向客户录入时间\\n,max(a.visit_time)      visit_time        --回访时间\\n,max(a.visit_cnt)       visit_cnt        --回访次数\\n,max(a.remind_visit_time)   remind_visit_time    --提醒回访时间\\n,max(a.assess_time)   assess_time         -- 评估时间\\n,concat_ws(',',collect_list(from_unixtime( cast(a.deposit_time as int),'yyyy-MM-dd  HH:mm:ss')))   as deposit_time_list      -- '下定时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(a.sign_time as int),'yyyy-MM-dd  HH:mm:ss')))  as sign_time_list       -- '签约时间集合'\\nfrom db_dw_hr.clife_hr_dwd_market a \\nwhere a.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\ngroup by a.intention_customer_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_customer_crm_visit_base_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-84421\",\"name\":\"drop_clife_hr_customer_crm_visit_base_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_customer_crm_visit_base_info_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[]},{\"type\":\"SQL\",\"id\":\"tasks-73988\",\"name\":\"clife_hr_dws_market_by_sub_org_f\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_sub_org_f partition(part_date)\\nselect\\nif(b1.sub_org_id is null,a1.sub_org_id,b1.sub_org_id) as sub_org_id                          --   '养老机构id',\\n,if(b1.sub_org_name is null,a1.sub_org_name,b1.sub_org_name) as sub_org_name                        --   '养老机构名称'\\n,if(b1.org_id is null,a1.org_id,b1.org_id) as org_id                              --   '养老集团id'\\n,if(b1.org_id is null,a1.org_id,b1.org_id) as org_name                            --   '养老集团名称'\\n,if(b1.area_id is null,a1.area_id,b1.area_id) as area_id                             --   '区域id'\\n,if(b1.area_name is null,a1.area_name,b1.area_name) as area_name                           --   '区域名称'\\n,a1.advisory_customer_cnt               --   '咨询客户数'\\n,a1.pension_first_intent_high_cnt       --   '客户跟踪模块首次意向感兴趣客户数'\\n,a1.pension_first_intent_mid_cnt        --   '客户跟踪模块首次意向兴趣一般客户数'\\n,a1.pension_first_intent_low_cnt        --   '客户跟踪模块首次意向不感兴趣客户数'\\n,a1.pension_first_intent_highest_cnt    --   '客户跟踪模块首次意向希望购买客户数'\\n,a1.pension_intent_high_cnt             --   '客户跟踪模块当前意向感兴趣客户数'\\n,a1.pension_intent_mid_cnt              --   '客户跟踪模块当前意向兴趣一般客户数'\\n,a1.pension_intent_low_cnt              --   '客户跟踪模块当前意向不感兴趣客户数'\\n,a1.pension_intent_highest_cnt          --   '客户跟踪模块当前意向希望购买客户数'\\n,b1.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,b1.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,b1.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,b1.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,b1.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,b1.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,b1.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,b1.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,a1.pension_intent_cnt                  --   '客户跟踪模块意向客户数'\\n,b1.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,b1.deposit_cust_cnt                    --   '下定客户数'\\n,b1.sign_cust_cnt                       --   '签约客户数'\\n,c1.transfer_to_member_cnt              --   '转让会籍数'\\n,c1.transfer_from_member_cnt            --   '继承会籍数'\\n,c1.withdraw_member_cnt                 --   '退会会籍数'\\n,a1.advisory_cust_visit_cnt             --   '咨询客户回访次数'\\n,a1.pension_intent_cust_visit_cnt       --   '客户跟踪模块意向客户回访次数'\\n,b1.crm_intent_cust_visit_cnt           --   '营销管理模块意向客户回访次数'\\n,b1.deposit_cust_visit_cnt              --   '下定客户回访次数'\\n,b1.sign_cust_visit_cnt                 --   '签约客户回访次数'\\n,a1.avg_advisory_cust_visit_cnt         --   '咨询客户平均回访次数'\\n,a1.avg_pension_intent_cust_visit_cnt   --   '客户跟踪模块意向客户平均回访次数'\\n,b1.avg_crm_intent_cust_visit_cnt       --   '营销管理模块意向客户平均回访次数'\\n,b1.avg_deposit_cust_visit_cnt          --   '下定客户平均回访次数'\\n,b1.avg_sign_cust_visit_cnt             --   '签约客户平均回访次数'\\n,c1.apply_member_cnt                    --   '预申请会籍数量'\\n,c1.deposit_member_cnt                  --   '下定会籍数量'\\n,d1.deposit_room_cnt                    --   '下定房间数量'\\n,c1.sign_member_cnt                     --   '签约会籍数量'\\n,d1.sign_room_cnt                       --   '签约房间数量'\\n,e1.deposit_amount                      --   '下定额'\\n,e1.sales_amount                        --   '销售额'\\n,e1.card_pay_amount                     --\\t  '刷卡金额'\\n,e1.cash_pay_amount                     --   '现金金额'\\n,e1.weixin_pay_amount                   --   '微信支付金额'\\n,e1.alipay_amount                       --   '阿里支付金额'\\t\\n,e1.other_pay_amount                    --   '其他方式支付金额'\\n,e1.received_amount                     --   '已收金额'\\n,e1.received_installment_amount         --   '已收分期金额'\\n,e1.received_occupancy_amount           --   '已收占用费'\\n,e1.membership_amount                   --   '会籍费'\\n,e1.overdue_amount                      --   '滞纳金'\\n,e1.received_overdue_amount             --   '已收滞纳金'\\n,e1.other_amount                        --   '其他费用'\\n,e1.manager_amount                      --   '管理费'\\n,e1.trust_amount                        --   '托管费' \\n,e1.membership_discount_amount          --   '会籍优惠价' \\n,e1.card_amount                         --   '卡费'\\n,e1.card_manager_amount                 --   '卡管理费'\\n,e1.other_transfor_to_amount            --   '其他转让费' \\n,e1.transfor_to_amount                  --   '转让费'\\n,e1.other_transfor_from_amount          --   '其他继承费' \\n,e1.transfor_from_amount                --   '继承费'\\n,e1.withdraw_amount                     --   '退会金额' \\n,(a1.assess_cust_cnt+b1.assess_cust_cnt)  as assess_cust_cnt                     --   '评估客户数'\\n,a1.ask_check_in_cust_cnt               --   '发起入住通知客户数'\\n,(a1.assess_cnt+b1.assess_cnt)  as assess_cnt                          --   '评估总次数'\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom \\n(select\\na.sub_org_id\\n,max(a.sub_org_name) sub_org_name\\n,max(a.org_id)    org_id\\n,max(org_name)    org_name\\n,max(area_id)     area_id\\n,max(area_name)   area_name\\n,count(distinct advisory_customer_id)  as advisory_customer_cnt     --'咨询客户数'\\n,sum(first_high_cnt)  as pension_first_intent_high_cnt  --'客户跟踪模块首次意向感兴趣客户数'\\n,sum(first_mid_cnt)  as pension_first_intent_mid_cnt  --'客户跟踪模块首次意向兴趣一般客户数'\\n,sum(first_low_cnt)  as pension_first_intent_low_cnt  --'客户跟踪模块首次意向不感兴趣客户数'\\n,sum(first_highest_cnt)  as pension_first_intent_highest_cnt  --'客户跟踪模块首次意向希望购买客户数'\\n,sum(high_cnt)     as pension_intent_high_cnt  --'客户跟踪模块意向感兴趣客户数'\\n,sum(mid_cnt)      as pension_intent_mid_cnt   --'客户跟踪模块意向兴趣一般客户数'\\n,sum(low_cnt)      as pension_intent_low_cnt   --'客户跟踪模块意向不感兴趣客户数'\\n,sum(highest_cnt)  as pension_intent_highest_cnt  --'客户跟踪模块意向希望购买客户数'\\n,count(distinct intention_customer_id)  as pension_intent_cnt    --'客户跟踪模块意向客户数',\\n,sum(advisory_visit_cnt)  as advisory_cust_visit_cnt   --'咨询客户回访次数'\\n,sum(intention_visit_cnt)   as pension_intent_cust_visit_cnt  -- '客户跟踪模块意向客户回访次数'\\n,sum(advisory_visit_cnt)/count(advisory_customer_id)  as avg_advisory_cust_visit_cnt  --'咨询客户平均回访次数'\\n,sum(intention_visit_cnt)/count(distinct intention_customer_id)  as avg_pension_intent_cust_visit_cnt  --'客户跟踪模块意向客户平均回访次数'\\n,sum(assess_cnt) as assess_cnt   --'总评估次数'\\n,count(distinct assess_cust_cnt) as assess_cust_cnt\\n,count(distinct ask_check_in_cust) as ask_check_in_cust_cnt\\nfrom \\n(select \\n t.advisory_customer_id\\n,t.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,t.sub_org_name                       --  '养老机构名称'\\n,t.org_id                             --  '集团id'\\n,t.org_name                           --  '集团名称'\\n,t.area_id                            --  '区域id'\\n,t.area_name\\n,case when t.first_intention_type=1 then 1 else 0 end as first_high_cnt\\n,case when t.first_intention_type=2 then 1 else 0 end as first_mid_cnt\\n,case when t.first_intention_type=3 then 1 else 0 end as first_low_cnt\\n,case when t.first_intention_type=4 then 1 else 0 end as first_highest_cnt\\n,case when t.intention_type=1 then 1 else 0 end as high_cnt\\n,case when t.intention_type=2 then 1 else 0 end as mid_cnt\\n,case when t.intention_type=3 then 1 else 0 end as low_cnt\\n,case when t.intention_type=4 then 1 else 0 end as highest_cnt\\n,case when t.advisory_customer_id is not null then visit_cnt else 0 end advisory_visit_cnt\\n,case when t.intention_customer_id is not null then visit_cnt else 0 end intention_visit_cnt\\n,t.assess_cnt                       -- '评估次数'\\n,case when t.assess_cnt>0 then t.intention_customer_id else null end assess_cust_cnt\\n,case when ask_check_in_time is not null then t.intention_customer_id else null end ask_check_in_cust\\nfrom db_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0) a\\ngroup by a.sub_org_id)  a1\\nfull join\\n(\\n select\\n t1.sub_org_id\\n,max(t1.sub_org_name) sub_org_name\\n,max(t1.org_id)    org_id\\n,max(t1.org_name)    org_name\\n,max(t1.area_id)     area_id\\n,max(t1.area_name)   area_name\\n,sum(first_high_cnt)  as crm_first_intent_high_cnt  --'营销管理模块首次意向感兴趣客户数'\\n,sum(first_mid_cnt)   as crm_first_intent_mid_cnt   --'营销管理模块首次意向兴趣一般客户数'\\n,sum(first_low_cnt)   as crm_first_intent_low_cnt   --'营销管理模块首次意向不感兴趣客户数'\\n,sum(first_highest_cnt)  as crm_first_intent_highest_cnt  --'营销管理模块首次意向希望购买客户数'\\n,sum(high_cnt)     as crm_intent_high_cnt  --'营销管理模块意向感兴趣客户数'\\n,sum(mid_cnt)      as crm_intent_mid_cnt   --'营销管理模块意向兴趣一般客户数'\\n,sum(low_cnt)      as crm_intent_low_cnt   --'营销管理模块意向不感兴趣客户数'\\n,sum(highest_cnt)  as crm_intent_highest_cnt  --'营销管理模块意向希望购买客户数'\\n,count(distinct intention_customer_id)  as crm_intent_cnt    --'营销管理模块意向客户数',\\n,sum(t1.visit_cnt)   as crm_intent_cust_visit_cnt  -- '营销管理模块意向客户回访次数'\\n,sum(t1.visit_cnt)/count(distinct intention_customer_id)  as avg_crm_intent_cust_visit_cnt  --'营销管理模块意向客户平均回访次数'\\n,sum(deposit_cust_cnt) as deposit_cust_cnt   --'下定客户数'\\n,sum(sign_cust_cnt)  as sign_cust_cnt        --'签约客户数'\\n,sum(deposit_cust_visit_cnt)   as deposit_cust_visit_cnt  --'下定客户回访总次数'\\n,sum(sign_cust_vist_cnt)   as   sign_cust_visit_cnt    -- '签约客户回访总次数'\\n,sum(deposit_cust_visit_cnt)/sum(deposit_cust_cnt)  as avg_deposit_cust_visit_cnt  --'下定客户平均回访次数'\\n,sum(sign_cust_vist_cnt)/sum(sign_cust_cnt)  as avg_sign_cust_visit_cnt  --'签约客户平均回访次数'\\n,sum(assess_cnt) assess_cnt\\n,sum(assess_cust_cnt)  assess_cust_cnt\\n from \\n(\\nselect \\n b.intention_customer_id\\n,b.sub_org_id\\n,b.sub_org_name\\n,b.org_id\\n,b.org_name\\n,b.area_id\\n,b.area_name\\n,b.visit_cnt\\n,b.assess_cnt\\n,case when b.first_intention_type=1 then 1 else 0 end as first_high_cnt\\n,case when b.first_intention_type=2 then 1 else 0 end as first_mid_cnt\\n,case when b.first_intention_type=3 then 1 else 0 end as first_low_cnt\\n,case when b.first_intention_type=4 then 1 else 0 end as first_highest_cnt\\n,case when b.intention_type=1 then 1 else 0 end as high_cnt\\n,case when b.intention_type=2 then 1 else 0 end as mid_cnt\\n,case when b.intention_type=3 then 1 else 0 end as low_cnt\\n,case when b.intention_type=4 then 1 else 0 end as highest_cnt\\n,case when b.deposit_time is not null then 1 else 0 end as deposit_cust_cnt\\n,case when b.sign_time is not null then b.visit_cnt else 0 end as sign_cust_cnt\\n,case when b.deposit_time is not null then b.visit_cnt else 0 end as deposit_cust_visit_cnt\\n,case when b.sign_time is not null then b.visit_cnt else 0 end as sign_cust_vist_cnt\\n,case when b.assess_cnt is not null then 1 else 0 end as assess_cust_cnt\\nfrom \\n(\\nselect \\n t.intention_customer_id\\n,max(t.sub_org_id )  sub_org_id                      --  '养老机构id'\\n,max(t.sub_org_name)   sub_org_name                    --  '养老机构名称'\\n,max(t.org_id)      org_id                      --  '集团id'\\n,max(t.org_name)    org_name                       --  '集团名称'\\n,max(t.area_id)     area_id                       --  '区域id'\\n,max(t.area_name)   area_name                       --  '区域名称'\\n,max(t.visit_cnt)   visit_cnt                       --  '回访次数'\\n,max(t.first_intention_type)    first_intention_type           --  '首次意向'\\n,max(t.intention_type)          intention_type           --  '当前意向' \\n,max(t.assess_cnt)    assess_cnt                       \\n,concat_ws(',',collect_list(from_unixtime( cast(t.deposit_time as int),'yyyy-MM-dd  HH:mm:ss')))   as deposit_time      -- '下定时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.sign_time as int),'yyyy-MM-dd  HH:mm:ss')))  as sign_time       -- '签约时间集合'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\ngroup by t.intention_customer_id\\n) b\\n) t1\\ngroup by t1.sub_org_id) b1 \\non a1.sub_org_id=b1.sub_org_id\\nleft join \\n(\\nselect\\nt1.sub_org_id\\n,sum(t1.apply_member_cnt)  apply_member_cnt\\n,sum(t1.deposit_member_cnt)  deposit_member_cnt\\n,sum(t1.sign_member_cnt)  sign_member_cnt\\n,sum(t1.transfer_to_member_cnt)   transfer_to_member_cnt\\n,sum(t1.transfer_from_member_cnt)  transfer_from_member_cnt\\n,sum(t1.withdraw_member_cnt)   withdraw_member_cnt\\nfrom \\n(\\nselect \\nc.membership_id\\n,c.sub_org_id\\n,case when apply_time   is null then 1 else 0 end as apply_member_cnt\\n,case when deposit_time is null then 1 else 0 end as deposit_member_cnt\\n,case when sign_time   is null then 1 else 0 end as sign_member_cnt\\n,case when transfer_to_time is null then 1 else 0 end as transfer_to_member_cnt\\n,case when transfer_from_time is null then 1 else 0 end as transfer_from_member_cnt\\n,case when withdraw_time is null then 1 else 0 end as withdraw_member_cnt\\nfrom \\n(select \\n t.membership_id  \\n,max(t.sub_org_id )  sub_org_id                      --  '养老机构id'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.apply_time as int),'yyyy-MM-dd  HH:mm:ss')))   as apply_time      -- '预申请时间集合' \\n,concat_ws(',',collect_list(from_unixtime( cast(t.deposit_time as int),'yyyy-MM-dd  HH:mm:ss')))   as deposit_time      -- '下定时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.sign_time as int),'yyyy-MM-dd  HH:mm:ss')))  as sign_time       -- '签约时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.transfor_to_time as int),'yyyy-MM-dd  HH:mm:ss')))  as transfer_to_time       -- '转让时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.transfor_from_time as int),'yyyy-MM-dd  HH:mm:ss')))  as transfer_from_time       -- '继承时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.withdraw_time as int),'yyyy-MM-dd  HH:mm:ss')))  as withdraw_time       -- '退会时间集合'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\ngroup by t.membership_id)  c\\n) t1\\ngroup by t1.sub_org_id) c1\\non b1.sub_org_id=c1.sub_org_id\\nleft join \\n(\\nselect\\nt1.sub_org_id\\n,sum(t1.deposit_room_cnt)  deposit_room_cnt\\n,sum(t1.sign_room_cnt)  sign_room_cnt\\nfrom \\n(\\nselect \\nc.room_id\\n,c.sub_org_id\\n,case when deposit_time is null then 1 else 0 end as deposit_room_cnt\\n,case when sign_time   is null then 1 else 0 end as sign_room_cnt\\nfrom \\n(select \\n t.room_id  \\n,max(t.sub_org_id )  sub_org_id                      --  '养老机构id' \\n,concat_ws(',',collect_list(from_unixtime( cast(t.deposit_time as int),'yyyy-MM-dd  HH:mm:ss')))   as deposit_time      -- '下定时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.sign_time as int),'yyyy-MM-dd  HH:mm:ss')))  as sign_time       -- '签约时间集合'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\ngroup by t.room_id)  c\\n) t1\\ngroup by t1.sub_org_id) d1\\non b1.sub_org_id=d1.sub_org_id\\nleft join \\n(select \\n sub_org_id\\n,sum(deposit_amount)    deposit_amount         --     '下定额'\\n,sum(card_pay_amount)   card_pay_amount         --\\t    '刷卡金额'\\n,sum(cash_pay_amount)   cash_pay_amount         --     '现金金额'\\n,sum(weixin_pay_amount) weixin_pay_amount         --     '微信支付金额'\\n,sum(alipay_amount)     alipay_amount         --     '阿里支付金额'\\t\\n,sum(other_pay_amount)  other_pay_amount         --     '其他方式支付金额'\\n,sum(receivable_amount) sales_amount            --  '应收金额'\\n,sum(received_amount)   received_amount            --  '已收金额'\\n,sum(received_installment_amount) received_installment_amount    --  '已收分期金额'\\n,sum(received_occupancy_amount)   received_occupancy_amount    --  '已收占用费'\\n,sum(membership_amount)           membership_amount     --  '会籍费'\\n,sum(overdue_amount)              overdue_amount    --  '滞纳金'\\n,sum(received_overdue_amount)     received_overdue_amount    --  '已收滞纳金'\\n,sum(other_amount)                other_amount     --  '其他费用'\\n,sum(manager_amount)              manager_amount       --  '管理费'\\n,sum(trust_amount)                trust_amount      --  '托管费'\\n,sum(membership_discount_amount)  membership_discount_amount      --  '会籍优惠价'  \\n,sum(card_amount)                 card_amount        --  '卡费'\\n,sum(card_manager_amount)         card_manager_amount     --  '卡管理费'\\n,sum(other_transfor_to_amount)    other_transfor_to_amount     --  '其他转让费' \\n,sum(transfor_to_amount)          transfor_to_amount      --  '转让费'\\n,sum(other_transfor_from_amount)  other_transfor_from_amount    --  '其他继承费'\\n,sum(transfor_from_amount)        transfor_from_amount       --  '继承费'\\n,sum(withdraw_amount)             withdraw_amount        --  '退会金额'\\nfrom db_dw_hr.clife_hr_dwm_market where part_date= regexp_replace(date_sub(current_date(),1),'-','')\\ngroup by sub_org_id\\n) e1\\non b1.sub_org_id=e1.sub_org_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_customer_crm_visit_base_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-14647\",\"name\":\"clife_hr_dws_market_by_sub_org_d_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table if not exists db_dw_hr.clife_hr_dws_market_by_sub_org_d_tmp stored as parquet as \\nselect\\nsplit(getSet2(concat(if(a1.sub_org_id is null,'',a1.sub_org_id),',',if(tt1.sub_org_id is null,'',tt1.sub_org_id),',',if(ta1.sub_org_id is null,'',ta1.sub_org_id),',',if(ta2.sub_org_id is null,'',ta2.sub_org_id),',',if(tt4.sub_org_id is null,'',tt4.sub_org_id),',',if(b1.sub_org_id is null,'',b1.sub_org_id),',',if(tt2.sub_org_id is null,'',tt2.sub_org_id),',',if(tt3.sub_org_id is null,'',tt3.sub_org_id),',',if(tt5.sub_org_id is null,'',tt5.sub_org_id),',',if(tt6.sub_org_id is null,'',tt6.sub_org_id),',',if(tt7.sub_org_id is null,'',tt7.sub_org_id),',',if(tt8.sub_org_id is null,'',tt8.sub_org_id),',',if(tt9.sub_org_id is null,'',tt9.sub_org_id),',',if(tt10.sub_org_id is null,'',tt10.sub_org_id),',','')),',')[1] as sub_org_id                          --   '养老机构id',\\n,tt1.advisory_customer_cnt               --   '咨询客户数'\\n,a1.pension_first_intent_high_cnt       --   '客户跟踪模块首次意向感兴趣客户数'\\n,a1.pension_first_intent_mid_cnt        --   '客户跟踪模块首次意向兴趣一般客户数'\\n,a1.pension_first_intent_low_cnt        --   '客户跟踪模块首次意向不感兴趣客户数'\\n,a1.pension_first_intent_highest_cnt    --   '客户跟踪模块首次意向希望购买客户数'\\n,a1.pension_intent_high_cnt             --   '客户跟踪模块当前意向感兴趣客户数'\\n,a1.pension_intent_mid_cnt              --   '客户跟踪模块当前意向兴趣一般客户数'\\n,a1.pension_intent_low_cnt              --   '客户跟踪模块当前意向不感兴趣客户数'\\n,a1.pension_intent_highest_cnt          --   '客户跟踪模块当前意向希望购买客户数'\\n,b1.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,b1.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,b1.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,b1.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,b1.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,b1.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,b1.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,b1.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,a1.pension_intent_cnt                  --   '客户跟踪模块意向客户数'\\n,b1.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,tt2.deposit_cust_cnt                    --   '下定客户数'\\n,tt3.sign_cust_cnt                       --   '签约客户数'\\n,tt8.transfer_to_member_cnt              --   '转让会籍数'\\n,tt9.transfer_from_member_cnt            --   '继承会籍数'\\n,tt10.withdraw_member_cnt                 --   '退会会籍数'\\n,tt4.advisory_cust_visit_cnt             --   '咨询客户回访次数'\\n,tt4.pension_intent_cust_visit_cnt       --   '客户跟踪模块意向客户回访次数'\\n,tt5.crm_intent_cust_visit_cnt           --   '营销管理模块意向客户回访次数'\\n,tt5.deposit_cust_visit_cnt              --   '下定客户回访次数'\\n,tt5.sign_cust_visit_cnt                 --   '签约客户回访次数'\\n,tt4.avg_advisory_cust_visit_cnt         --   '咨询客户平均回访次数'\\n,tt4.avg_pension_intent_cust_visit_cnt   --   '客户跟踪模块意向客户平均回访次数'\\n,tt5.avg_crm_intent_cust_visit_cnt       --   '营销管理模块意向客户平均回访次数'\\n,tt5.avg_deposit_cust_visit_cnt          --   '下定客户平均回访次数'\\n,tt5.avg_sign_cust_visit_cnt             --   '签约客户平均回访次数'\\n,tt7.apply_member_cnt                    --   '预申请会籍数量'\\n,tt2.deposit_member_cnt                  --   '下定会籍数量'\\n,tt2.deposit_room_cnt                    --   '下定房间数量'\\n,tt3.sign_member_cnt                     --   '签约会籍数量'\\n,tt3.sign_room_cnt                       --   '签约房间数量'\\n,tt2.deposit_amount                      --   '下定额'\\n,tt3.sales_amount                        --   '销售额'\\n,tt3.card_pay_amount                     --\\t  '刷卡金额'\\n,tt3.cash_pay_amount                     --   '现金金额'\\n,tt3.weixin_pay_amount                   --   '微信支付金额'\\n,tt3.alipay_amount                       --   '阿里支付金额'\\t\\n,tt3.other_pay_amount                    --   '其他方式支付金额'\\n,tt3.received_amount                     --   '已收金额'\\n,tt3.received_installment_amount         --   '已收分期金额'\\n,tt3.received_occupancy_amount           --   '已收占用费'\\n,tt3.membership_amount                   --   '会籍费'\\n,tt3.overdue_amount                      --   '滞纳金'\\n,tt3.received_overdue_amount             --   '已收滞纳金'\\n,tt3.other_amount                        --   '其他费用'\\n,tt3.manager_amount                      --   '管理费'\\n,tt3.trust_amount                        --   '托管费' \\n,tt3.membership_discount_amount          --   '会籍优惠价' \\n,tt3.card_amount                         --   '卡费'\\n,tt3.card_manager_amount                 --   '卡管理费'\\n,tt8.other_transfer_to_amount            --   '其他转让费' \\n,tt8.transfer_to_amount                  --   '转让费'\\n,tt9.other_transfer_from_amount          --   '其他继承费' \\n,tt9.transfer_from_amount                --   '继承费'\\n,tt10.withdraw_amount                     --   '退会金额' \\n,(ta1.assess_cust_cnt+tt6.assess_cust_cnt)  as assess_cust_cnt                     --   '评估客户数'\\n,ta2.ask_check_in_cust_cnt               --   '发起入住通知客户数'\\n,(ta1.assess_cnt+tt6.assess_cnt)  as assess_cnt                          --   '评估总次数'\\n,split(getSet2(concat(if(a1.regist_date is null,'',a1.regist_date),',',if(tt1.adviser_date is null,'',tt1.adviser_date),',',if(ta1.assess_date is null,'',ta1.assess_date),',',if(ta2.ask_date is null,'',ta2.ask_date),',',if(tt4.visit_date is null,'',tt4.visit_date),',',if(b1.regist_date is null,'',b1.regist_date),',',if(tt2.deposit_date is null,'',tt2.deposit_date),',',if(tt3.sign_date is null,'',tt3.sign_date),',',if(tt5.visit_date is null,'',tt5.visit_date),',',if(tt6.assess_date is null,'',tt6.assess_date),',',if(tt7.apply_date is null,'',tt7.apply_date),',',if(tt8.transfer_to_date is null,'',tt8.transfer_to_date),',',if(tt9.transfer_from_date is null,'',tt9.transfer_from_date),',',if(tt10.withdraw_date is null,'',tt10.withdraw_date),',','')),',')[1]  as data_date                  -- 数据日期\\nfrom \\n(\\nselect\\na.sub_org_id\\n,a.regist_date\\n,sum(first_high_cnt)  as pension_first_intent_high_cnt  --'客户跟踪模块首次意向感兴趣客户数'\\n,sum(first_mid_cnt)  as pension_first_intent_mid_cnt  --'客户跟踪模块首次意向兴趣一般客户数'\\n,sum(first_low_cnt)  as pension_first_intent_low_cnt  --'客户跟踪模块首次意向不感兴趣客户数'\\n,sum(first_highest_cnt)  as pension_first_intent_highest_cnt  --'客户跟踪模块首次意向希望购买客户数'\\n,sum(high_cnt)     as pension_intent_high_cnt  --'客户跟踪模块意向感兴趣客户数'\\n,sum(mid_cnt)      as pension_intent_mid_cnt   --'客户跟踪模块意向兴趣一般客户数'\\n,sum(low_cnt)      as pension_intent_low_cnt   --'客户跟踪模块意向不感兴趣客户数'\\n,sum(highest_cnt)  as pension_intent_highest_cnt  --'客户跟踪模块意向希望购买客户数'\\n,count(distinct intention_customer_id)  as pension_intent_cnt    --'客户跟踪模块意向客户数',\\nfrom\\n(select \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,t.sub_org_name                       --  '养老机构名称'\\n,t.org_id                             --  '集团id'\\n,t.org_name                           --  '集团名称'\\n,t.area_id                            --  '区域id'\\n,t.area_name\\n,from_unixtime( cast(t.regist_time as int),'yyyy-MM-dd') as regist_date                        -- '意向客户录入日期'\\n,case when t.first_intention_type=1 then 1 else 0 end as first_high_cnt\\n,case when t.first_intention_type=2 then 1 else 0 end as first_mid_cnt\\n,case when t.first_intention_type=3 then 1 else 0 end as first_low_cnt\\n,case when t.first_intention_type=4 then 1 else 0 end as first_highest_cnt\\n,case when t.intention_type=1 then 1 else 0 end as high_cnt\\n,case when t.intention_type=2 then 1 else 0 end as mid_cnt\\n,case when t.intention_type=3 then 1 else 0 end as low_cnt\\n,case when t.intention_type=4 then 1 else 0 end as highest_cnt\\nfrom db_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0\\n) a\\ngroup by a.sub_org_id,regist_date\\n)  a1\\nfull join \\n(select\\na.sub_org_id\\n,a.adviser_date\\n,count(distinct advisory_customer_id)  as advisory_customer_cnt    --'咨询客户数',\\nfrom \\n(select \\nt.advisory_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,from_unixtime( cast(t.adviser_time as int),'yyyy-MM-dd') as adviser_date                        -- '意向客户录入日期'\\n,case when t.intention_customer_id is not null then visit_cnt else 0 end intention_visit_cnt\\nfrom db_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0\\n) a\\ngroup by a.sub_org_id,a.adviser_date)  tt1\\non a1.sub_org_id=tt1.sub_org_id  and a1.regist_date=tt1.adviser_date\\nfull join\\n(\\nselect \\na.sub_org_id\\n,a.assess_date\\n,count(distinct intention_customer_id)  as assess_cust_cnt  --'发起评估客户数'\\n,count(assess_time2)           as   assess_cnt              --'评估次数'\\nfrom \\n(\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,assess_time2\\n,substr(assess_time2,1,10) as assess_date                         -- 列开的发起评估时间\\nfrom db_dw_hr.clife_hr_dwd_market t \\nlateral view explode(split(assess_time,',')) l1 as assess_time2\\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0\\n)  a \\ngroup by a.sub_org_id,a.assess_date\\n)  ta1\\non a1.sub_org_id=ta1.sub_org_id  and a1.regist_date=ta1.assess_date\\nfull join \\n(\\nselect\\naa.sub_org_id\\n,aa.ask_date\\n,count(aa.intention_customer_id)   ask_check_in_cust_cnt            --'发起入住通知客户数'\\nfrom \\n(\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,from_unixtime( cast(t.ask_check_in_time as int),'yyyy-MM-dd') as ask_date                         -- 列开的发起评估时间\\nfrom db_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0\\n) aa\\ngroup by aa.sub_org_id,aa.ask_date\\n)  ta2\\non a1.sub_org_id=ta2.sub_org_id and a1.regist_date=ta2.ask_date\\nfull join\\n(\\nselect\\naa4.sub_org_id\\n,aa4.visit_date\\n,count(distinct intention_customer_id)  int_cnt\\n,count(distinct advisory_customer_id)   adv_cnt\\n,sum(int_visit_cnt)  as pension_intent_cust_visit_cnt\\n,sum(adv_visit_cnt)  as advisory_cust_visit_cnt\\n,sum(int_visit_cnt)/count(distinct intention_customer_id)   as avg_pension_intent_cust_visit_cnt\\n,sum(adv_visit_cnt)/count(distinct advisory_customer_id)  as avg_advisory_cust_visit_cnt\\nfrom \\n(\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,visit_time2\\n,substr(visit_time2,1,10) as visit_date                         -- 列开的回访时间\\n,t.visit_time\\n,t.advisory_customer_id\\n,case when t.visit_time is not null and visit_time2 is not null and t.intention_customer_id is not null then 1 else 0 end int_visit_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.advisory_customer_id is not null then 1 else 0 end adv_visit_cnt\\nfrom db_dw_hr.clife_hr_dwd_market t \\nlateral view explode(split(visit_time,',')) l1 as visit_time2\\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0\\n)  aa4 \\ngroup by aa4.sub_org_id,aa4.visit_date\\n)  tt4\\non a1.sub_org_id=tt4.sub_org_id and a1.regist_date=tt4.visit_date\\nfull join \\n(\\n select\\n t1.sub_org_id\\n,t1.regist_date\\n,sum(first_high_cnt)  as crm_first_intent_high_cnt  --'营销管理模块首次意向感兴趣客户数'\\n,sum(first_mid_cnt)   as crm_first_intent_mid_cnt   --'营销管理模块首次意向兴趣一般客户数'\\n,sum(first_low_cnt)   as crm_first_intent_low_cnt   --'营销管理模块首次意向不感兴趣客户数'\\n,sum(first_highest_cnt)  as crm_first_intent_highest_cnt  --'营销管理模块首次意向希望购买客户数'\\n,sum(high_cnt)     as crm_intent_high_cnt  --'营销管理模块意向感兴趣客户数'\\n,sum(mid_cnt)      as crm_intent_mid_cnt   --'营销管理模块意向兴趣一般客户数'\\n,sum(low_cnt)      as crm_intent_low_cnt   --'营销管理模块意向不感兴趣客户数'\\n,sum(highest_cnt)  as crm_intent_highest_cnt  --'营销管理模块意向希望购买客户数'\\n,count(distinct intention_customer_id)  as crm_intent_cnt    --'营销管理模块意向客户数',\\n from \\n(\\nselect \\n b.intention_customer_id\\n,b.sub_org_id\\n,b.sub_org_name\\n,b.org_id\\n,b.org_name\\n,b.area_id\\n,b.area_name\\n,b.visit_cnt\\n,b.assess_cnt\\n,case when b.first_intention_type=1 then 1 else 0 end as first_high_cnt\\n,case when b.first_intention_type=2 then 1 else 0 end as first_mid_cnt\\n,case when b.first_intention_type=3 then 1 else 0 end as first_low_cnt\\n,case when b.first_intention_type=4 then 1 else 0 end as first_highest_cnt\\n,case when b.intention_type=1 then 1 else 0 end as high_cnt\\n,case when b.intention_type=2 then 1 else 0 end as mid_cnt\\n,case when b.intention_type=3 then 1 else 0 end as low_cnt\\n,case when b.intention_type=4 then 1 else 0 end as highest_cnt\\n,from_unixtime( cast(regist_time as int),'yyyy-MM-dd')  as regist_date\\nfrom \\n(\\nselect \\n t.intention_customer_id\\n,max(t.sub_org_id )  sub_org_id                      --  '养老机构id'\\n,max(t.sub_org_name)   sub_org_name                    --  '养老机构名称'\\n,max(t.org_id)      org_id                      --  '集团id'\\n,max(t.org_name)    org_name                       --  '集团名称'\\n,max(t.area_id)     area_id                       --  '区域id'\\n,max(t.area_name)   area_name                       --  '区域名称'\\n,max(t.visit_cnt)   visit_cnt                       --  '回访次数'\\n,max(t.first_intention_type)    first_intention_type           --  '首次意向'\\n,max(t.intention_type)          intention_type           --  '当前意向' \\n,max(t.assess_cnt)    assess_cnt                       \\n,max(t.regist_time)   as regist_time\\nfrom\\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\ngroup by t.intention_customer_id\\n) b\\n) t1\\ngroup by t1.sub_org_id,t1.regist_date) b1 \\non a1.sub_org_id=b1.sub_org_id and a1.regist_date=b1.regist_date\\nfull join \\n(\\nselect \\naa2.sub_org_id\\n,aa2.deposit_date\\n,count(distinct intention_customer_id) as deposit_cust_cnt  -- '下定客户数'\\n,sum(deposit_amount)    deposit_amount         --     '下定额'\\n,count(distinct membership_id)   as deposit_member_cnt\\n,count(distinct room_id)         as deposit_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,deposit_amount             --     '下定额'\\n,from_unixtime( cast(deposit_time as int),'yyyy-MM-dd')  as deposit_date \\n,t.membership_id\\n,t.room_id\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa2\\ngroup by aa2.sub_org_id,aa2.deposit_date\\n)  tt2\\non a1.sub_org_id=tt2.sub_org_id and a1.regist_date=tt2.deposit_date\\nfull join \\n(\\nselect \\naa3.sub_org_id\\n,aa3.sign_date\\n,count(distinct intention_customer_id) as sign_cust_cnt  -- '下定客户数'\\n,sum(card_pay_amount)   card_pay_amount         --\\t    '刷卡金额'\\n,sum(cash_pay_amount)   cash_pay_amount         --     '现金金额'\\n,sum(weixin_pay_amount) weixin_pay_amount         --     '微信支付金额'\\n,sum(alipay_amount)     alipay_amount         --     '阿里支付金额'\\t\\n,sum(other_pay_amount)  other_pay_amount         --     '其他方式支付金额'\\n,sum(receivable_amount) sales_amount            --  '销售金额'\\n,sum(received_amount)   received_amount            --  '已收金额'\\n,sum(received_installment_amount) received_installment_amount    --  '已收分期金额'\\n,sum(received_occupancy_amount)   received_occupancy_amount    --  '已收占用费'\\n,sum(membership_amount)           membership_amount     --  '会籍费'\\n,sum(overdue_amount)              overdue_amount    --  '滞纳金'\\n,sum(received_overdue_amount)     received_overdue_amount    --  '已收滞纳金'\\n,sum(other_amount)                other_amount     --  '其他费用'\\n,sum(manager_amount)              manager_amount       --  '管理费'\\n,sum(trust_amount)                trust_amount      --  '托管费'\\n,sum(membership_discount_amount)  membership_discount_amount      --  '会籍优惠价'  \\n,sum(card_amount)                 card_amount        --  '卡费'\\n,sum(card_manager_amount)         card_manager_amount     --  '卡管理费'\\n,count(distinct membership_id)   as sign_member_cnt\\n,count(distinct room_id)         as sign_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,t.membership_id\\n,t.room_id\\n,from_unixtime( cast(sign_time as int),'yyyy-MM-dd')  as sign_date\\n,case when pay_type_id=0 then received_amount else null end as  card_pay_amount            --\\t    '刷卡金额'\\n,case when pay_type_id=1 then received_amount else null end as  cash_pay_amount            --     '现金金额'\\n,case when pay_type_id=2 then received_amount else null end as  weixin_pay_amount          --     '微信支付金额'\\n,case when pay_type_id=3 then received_amount else null end as  alipay_amount              --     '阿里支付金额'\\t\\n,case when pay_type_id=4 then received_amount else null end as  other_pay_amount           --     '其他方式支付金额'\\n,receivable_amount             --  '应收金额'\\n,received_amount               --  '已收金额'\\n,received_installment_amount   --  '已收分期金额'\\n,received_occupancy_amount     --  '已收占用费'\\n,membership_amount             --  '会籍费'\\n,overdue_amount                --  '滞纳金'\\n,received_overdue_amount       --  '已收滞纳金'\\n,other_amount                  --  '其他费用'\\n,manager_amount                --  '管理费'\\n,trust_amount                  --  '托管费'\\n,membership_discount_amount    --  '会籍优惠价'  \\n,card_amount                   --  '卡费'\\n,card_manager_amount           --  '卡管理费' \\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa3\\ngroup by aa3.sub_org_id,aa3.sign_date\\n)  tt3\\non a1.sub_org_id=tt3.sub_org_id and a1.regist_date=tt3.sign_date\\nfull join \\n(\\nselect\\naa5.sub_org_id\\n,aa5.visit_date\\n,count(distinct aa5.intention_customer_id)  int_cnt\\n,count(aa5.visit_time2)  as crm_intent_cust_visit_cnt\\n,count(aa5.visit_time2)/count(distinct aa5.intention_customer_id)   as avg_crm_intent_cust_visit_cnt\\n,count(distinct aa5.deposit_visit_cust_cnt)  deposit_cust_visit_cnt\\n,sum(aa5.deposit_visit_cnt)  as deposit_visit_cnt\\n,count(distinct aa5.deposit_visit_cust_cnt)/sum(aa5.deposit_visit_cnt)   as avg_deposit_cust_visit_cnt\\n,count(distinct aa5.sign_visit_cust_cnt)  sign_cust_visit_cnt\\n,sum(aa5.sign_visit_cnt)  as sign_visit_cnt\\n,count(distinct aa5.sign_visit_cust_cnt)/sum(aa5.sign_visit_cnt)   as avg_sign_cust_visit_cnt\\nfrom \\n(   -- 回访过程\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,visit_time2\\n,substr(visit_time2,1,10) as visit_date                         -- 列开的回访时间\\n,t.visit_time\\n,case when t.visit_time is not null and visit_time2 is not null and t.deposit_time_list is not null then 1 else 0 end deposit_visit_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.sign_time_list is not null then 1 else 0 end sign_visit_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.deposit_time_list is not null then intention_customer_id else null end deposit_visit_cust_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.sign_time_list is not null then intention_customer_id else null end sign_visit_cust_cnt\\nfrom db_dw_hr.clife_hr_customer_crm_visit_base_info_tmp t \\nlateral view explode(split(visit_time,',')) l1 as visit_time2\\n) as aa5 \\ngroup by aa5.sub_org_id,aa5.visit_date\\n)  tt5\\non a1.sub_org_id=tt5.sub_org_id and a1.regist_date=tt5.visit_date\\nfull join \\n(\\nselect \\naa6.sub_org_id\\n,aa6.assess_date\\n,count(distinct intention_customer_id)  as assess_cust_cnt  --'发起评估客户数'\\n,count(assess_time2)           as   assess_cnt              --'评估次数'\\nfrom \\n(     --评估相关过程\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,assess_time2\\n,substr(assess_time2,1,10) as assess_date                         -- 列开的发起评估时间\\nfrom db_dw_hr.clife_hr_customer_crm_visit_base_info_tmp t \\nlateral view explode(split(assess_time,',')) l1 as assess_time2\\n)  aa6 \\ngroup by aa6.sub_org_id,aa6.assess_date\\n)  tt6\\non a1.sub_org_id=tt6.sub_org_id and a1.regist_date=tt6.assess_date\\nfull join \\n(\\nselect\\naa7.sub_org_id\\n,aa7.apply_date\\n,count(distinct pre_membership_id) as apply_member_cnt\\nfrom\\n(\\nselect \\nt.pre_membership_id\\n,t.sub_org_id\\n,from_unixtime( cast(t.apply_time as int),'yyyy-MM-dd')  apply_date\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa7\\ngroup by aa7.sub_org_id,aa7.apply_date\\n) tt7\\non a1.sub_org_id=tt7.sub_org_id and a1.regist_date=tt7.apply_date\\nfull join \\n(\\nselect\\naa8.sub_org_id\\n,aa8.transfer_to_date\\n,count(distinct membership_id) as transfer_to_member_cnt\\n,sum(other_transfor_to_amount)    other_transfer_to_amount     --  '其他转让费' \\n,sum(transfor_to_amount)          transfer_to_amount      --  '转让费'\\nfrom\\n(\\nselect \\nt.membership_id\\n,t.other_transfor_to_amount      --  '其他转让费' \\n,t.transfor_to_amount            --  '转让费'\\n,t.sub_org_id\\n,from_unixtime( cast(t.transfor_to_time as int),'yyyy-MM-dd')  transfer_to_date\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa8\\ngroup by aa8.sub_org_id,aa8.transfer_to_date\\n) tt8\\non a1.sub_org_id=tt8.sub_org_id and a1.regist_date=tt8.transfer_to_date\\nfull join \\n(\\nselect\\naa9.sub_org_id\\n,aa9.transfer_from_date\\n,count(distinct membership_id) as transfer_from_member_cnt\\n,sum(other_transfor_from_amount)    other_transfer_from_amount     \\n,sum(transfor_from_amount)          transfer_from_amount  \\nfrom   \\n(\\nselect \\nt.membership_id\\n,t.other_transfor_from_amount       \\n,t.transfor_from_amount            \\n,t.sub_org_id\\n,from_unixtime( cast(t.transfor_from_time as int),'yyyy-MM-dd')  transfer_from_date\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa9\\ngroup by aa9.sub_org_id,aa9.transfer_from_date\\n) tt9\\non a1.sub_org_id=tt9.sub_org_id and a1.regist_date=tt9.transfer_from_date\\nfull join \\n(\\nselect\\naa10.sub_org_id\\n,aa10.withdraw_date\\n,count(distinct membership_id) as withdraw_member_cnt   \\n,sum(withdraw_amount)          withdraw_amount \\nfrom    \\n(\\nselect \\nt.membership_id      \\n,t.withdraw_amount            \\n,t.sub_org_id\\n,from_unixtime( cast(t.withdraw_time as int),'yyyy-MM-dd')  withdraw_date\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa10\\ngroup by aa10.sub_org_id,aa10.withdraw_date\\n) tt10\\non a1.sub_org_id=tt10.sub_org_id and a1.regist_date=tt10.withdraw_date\",\"udfs\":\"14\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_market_by_sub_org_d_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-55309\",\"name\":\"clife_hr_dws_market_by_sub_org_d\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_sub_org_d partition(part_date)\\nselect\\na.sub_org_id                          --   '养老机构id'\\n,b.sub_org_name                        --   '养老机构名称'\\n,b.org_id                              --   '养老集团id'\\n,b.org_name                            --   '养老集团名称'\\n,c.area_id                             --   '区域id'\\n,c.area_name                           --   '区域名称'\\n,a.advisory_customer_cnt               --   '咨询客户数'\\n,a.pension_first_intent_high_cnt       --   '客户跟踪模块首次意向感兴趣客户数'\\n,a.pension_first_intent_mid_cnt        --   '客户跟踪模块首次意向兴趣一般客户数'\\n,a.pension_first_intent_low_cnt        --   '客户跟踪模块首次意向不感兴趣客户数'\\n,a.pension_first_intent_highest_cnt    --   '客户跟踪模块首次意向希望购买客户数'\\n,a.pension_intent_high_cnt             --   '客户跟踪模块当前意向感兴趣客户数'\\n,a.pension_intent_mid_cnt              --   '客户跟踪模块当前意向兴趣一般客户数'\\n,a.pension_intent_low_cnt              --   '客户跟踪模块当前意向不感兴趣客户数'\\n,a.pension_intent_highest_cnt          --   '客户跟踪模块当前意向希望购买客户数'\\n,a.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,a.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,a.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,a.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,a.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,a.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,a.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,a.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,a.pension_intent_cnt                  --   '客户跟踪模块意向客户数'\\n,a.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,a.deposit_cust_cnt                    --   '下定客户数'\\n,a.sign_cust_cnt                       --   '签约客户数'\\n,a.transfer_to_member_cnt              --   '转让会籍数'\\n,a.transfer_from_member_cnt            --   '继承会籍数'\\n,a.withdraw_member_cnt                 --   '退会会籍数'\\n,a.advisory_cust_visit_cnt             --   '咨询客户回访次数'\\n,a.pension_intent_cust_visit_cnt       --   '客户跟踪模块意向客户回访次数'\\n,a.crm_intent_cust_visit_cnt           --   '营销管理模块意向客户回访次数'\\n,a.deposit_cust_visit_cnt              --   '下定客户回访次数'\\n,a.sign_cust_visit_cnt                 --   '签约客户回访次数'\\n,a.avg_advisory_cust_visit_cnt         --   '咨询客户平均回访次数'\\n,a.avg_pension_intent_cust_visit_cnt   --   '客户跟踪模块意向客户平均回访次数'\\n,a.avg_crm_intent_cust_visit_cnt       --   '营销管理模块意向客户平均回访次数'\\n,a.avg_deposit_cust_visit_cnt          --   '下定客户平均回访次数'\\n,a.avg_sign_cust_visit_cnt             --   '签约客户平均回访次数'\\n,a.apply_member_cnt                    --   '预申请会籍数量'\\n,a.deposit_member_cnt                  --   '下定会籍数量'\\n,a.deposit_room_cnt                    --   '下定房间数量'\\n,a.sign_member_cnt                     --   '签约会籍数量'\\n,a.sign_room_cnt                       --   '签约房间数量'\\n,a.deposit_amount                      --  '下定额'\\n,a.sales_amount                        --  '销售额'\\n,a.card_pay_amount                     --  '刷卡金额'\\n,a.cash_pay_amount                     --  '现金金额'\\n,a.weixin_pay_amount                   --  '微信支付金额'\\n,a.alipay_amount                       --  '阿里支付金额'\\t\\n,a.other_pay_amount                    --  '其他方式支付金额'\\n,a.received_amount                     --  '已收金额'\\n,a.other_transfer_to_amount            --  '其他转让费' \\n,a.transfer_to_amount                  --  '转让费' \\n,a.other_transfer_from_amount          --  '其他继承费' \\n,a.transfer_from_amount                --  '继承费'\\n,a.withdraw_amount                     --  '退会金额' \\n,a.assess_cust_cnt                     --   '评估客户数'\\n,a.ask_check_in_cust_cnt               --   '发起入住通知客户数'\\n,a.assess_cnt                          --   '评估总次数'\\n,a.data_date                           --   '数据日期'\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom \\ndb_dw_hr.clife_hr_dws_market_by_sub_org_d_tmp a \\nleft join \\ndb_dw_hr.clife_hr_dim_admin_sub_org b\\non a.sub_org_id=b.sub_org_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_geographic_info c \\non concat(substr(b.city,1,5),b.area,'0000')=c.area_id\\nand c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_sub_org_d_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-5-13m4j4\",\"name\":\"drop_clife_hr_dws_market_by_sub_org_d_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_market_by_sub_org_d_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_sub_org_f\"]},{\"type\":\"SQL\",\"id\":\"tasks-69565\",\"name\":\"drop_clife_hr_dws_market_by_sub_org_m_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_market_by_sub_org_m_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_sub_org_d\"]},{\"type\":\"SQL\",\"id\":\"tasks-59070\",\"name\":\"clife_hr_dws_market_by_sub_org_m_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table if not exists db_dw_hr.clife_hr_dws_market_by_sub_org_m_tmp stored as parquet as \\nselect\\nsplit(getSet2(concat(if(a1.sub_org_id is null,'',a1.sub_org_id),',',if(tt1.sub_org_id is null,'',tt1.sub_org_id),',',if(ta1.sub_org_id is null,'',ta1.sub_org_id),',',if(ta2.sub_org_id is null,'',ta2.sub_org_id),',',if(tt4.sub_org_id is null,'',tt4.sub_org_id),',',if(b1.sub_org_id is null,'',b1.sub_org_id),',',if(tt2.sub_org_id is null,'',tt2.sub_org_id),',',if(tt3.sub_org_id is null,'',tt3.sub_org_id),',',if(tt5.sub_org_id is null,'',tt5.sub_org_id),',',if(tt6.sub_org_id is null,'',tt6.sub_org_id),',',if(tt7.sub_org_id is null,'',tt7.sub_org_id),',',if(tt8.sub_org_id is null,'',tt8.sub_org_id),',',if(tt9.sub_org_id is null,'',tt9.sub_org_id),',',if(tt10.sub_org_id is null,'',tt10.sub_org_id),',','')),',')[1] as sub_org_id                          --   '养老机构id',\\n,tt1.advisory_customer_cnt               --   '咨询客户数'\\n,a1.pension_first_intent_high_cnt       --   '客户跟踪模块首次意向感兴趣客户数'\\n,a1.pension_first_intent_mid_cnt        --   '客户跟踪模块首次意向兴趣一般客户数'\\n,a1.pension_first_intent_low_cnt        --   '客户跟踪模块首次意向不感兴趣客户数'\\n,a1.pension_first_intent_highest_cnt    --   '客户跟踪模块首次意向希望购买客户数'\\n,a1.pension_intent_high_cnt             --   '客户跟踪模块当前意向感兴趣客户数'\\n,a1.pension_intent_mid_cnt              --   '客户跟踪模块当前意向兴趣一般客户数'\\n,a1.pension_intent_low_cnt              --   '客户跟踪模块当前意向不感兴趣客户数'\\n,a1.pension_intent_highest_cnt          --   '客户跟踪模块当前意向希望购买客户数'\\n,b1.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,b1.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,b1.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,b1.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,b1.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,b1.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,b1.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,b1.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,a1.pension_intent_cnt                  --   '客户跟踪模块意向客户数'\\n,b1.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,tt2.deposit_cust_cnt                    --   '下定客户数'\\n,tt3.sign_cust_cnt                       --   '签约客户数'\\n,tt8.transfer_to_member_cnt              --   '转让会籍数'\\n,tt9.transfer_from_member_cnt            --   '继承会籍数'\\n,tt10.withdraw_member_cnt                 --   '退会会籍数'\\n,tt4.advisory_cust_visit_cnt             --   '咨询客户回访次数'\\n,tt4.pension_intent_cust_visit_cnt       --   '客户跟踪模块意向客户回访次数'\\n,tt5.crm_intent_cust_visit_cnt           --   '营销管理模块意向客户回访次数'\\n,tt5.deposit_cust_visit_cnt              --   '下定客户回访次数'\\n,tt5.sign_cust_visit_cnt                 --   '签约客户回访次数'\\n,tt4.avg_advisory_cust_visit_cnt         --   '咨询客户平均回访次数'\\n,tt4.avg_pension_intent_cust_visit_cnt   --   '客户跟踪模块意向客户平均回访次数'\\n,tt5.avg_crm_intent_cust_visit_cnt       --   '营销管理模块意向客户平均回访次数'\\n,tt5.avg_deposit_cust_visit_cnt          --   '下定客户平均回访次数'\\n,tt5.avg_sign_cust_visit_cnt             --   '签约客户平均回访次数'\\n,tt7.apply_member_cnt                    --   '预申请会籍数量'\\n,tt2.deposit_member_cnt                  --   '下定会籍数量'\\n,tt2.deposit_room_cnt                    --   '下定房间数量'\\n,tt3.sign_member_cnt                     --   '签约会籍数量'\\n,tt3.sign_room_cnt                       --   '签约房间数量'\\n,tt2.deposit_amount                      --   '下定额'\\n,tt3.sales_amount                        --   '销售额'\\n,tt3.card_pay_amount                     --\\t  '刷卡金额'\\n,tt3.cash_pay_amount                     --   '现金金额'\\n,tt3.weixin_pay_amount                   --   '微信支付金额'\\n,tt3.alipay_amount                       --   '阿里支付金额'\\t\\n,tt3.other_pay_amount                    --   '其他方式支付金额'\\n,tt3.received_amount                     --   '已收金额'\\n,tt3.received_installment_amount         --   '已收分期金额'\\n,tt3.received_occupancy_amount           --   '已收占用费'\\n,tt3.membership_amount                   --   '会籍费'\\n,tt3.overdue_amount                      --   '滞纳金'\\n,tt3.received_overdue_amount             --   '已收滞纳金'\\n,tt3.other_amount                        --   '其他费用'\\n,tt3.manager_amount                      --   '管理费'\\n,tt3.trust_amount                        --   '托管费' \\n,tt3.membership_discount_amount          --   '会籍优惠价' \\n,tt3.card_amount                         --   '卡费'\\n,tt3.card_manager_amount                 --   '卡管理费'\\n,tt8.other_transfer_to_amount            --   '其他转让费' \\n,tt8.transfer_to_amount                  --   '转让费'\\n,tt9.other_transfer_from_amount          --   '其他继承费' \\n,tt9.transfer_from_amount                --   '继承费'\\n,tt10.withdraw_amount                     --   '退会金额' \\n,(ta1.assess_cust_cnt+tt6.assess_cust_cnt)  as assess_cust_cnt                     --   '评估客户数'\\n,ta2.ask_check_in_cust_cnt               --   '发起入住通知客户数'\\n,(ta1.assess_cnt+tt6.assess_cnt)  as assess_cnt                          --   '评估总次数'\\n,split(getSet2(concat(if(a1.regist_month is null,'',a1.regist_month),',',if(tt1.adviser_month is null,'',tt1.adviser_month),',',if(ta1.assess_month is null,'',ta1.assess_month),',',if(ta2.ask_month is null,'',ta2.ask_month),',',if(tt4.visit_month is null,'',tt4.visit_month),',',if(b1.regist_month is null,'',b1.regist_month),',',if(tt2.deposit_month is null,'',tt2.deposit_month),',',if(tt3.sign_month is null,'',tt3.sign_month),',',if(tt5.visit_month is null,'',tt5.visit_month),',',if(tt6.assess_month is null,'',tt6.assess_month),',',if(tt7.apply_date is null,'',tt7.apply_date),',',if(tt8.transfer_to_month is null,'',tt8.transfer_to_month),',',if(tt9.transfer_from_month is null,'',tt9.transfer_from_month),',',if(tt10.withdraw_month is null,'',tt10.withdraw_month),',','')),',')[1]  as data_month                  -- 数据日期\\nfrom \\n(\\nselect\\na.sub_org_id\\n,a.regist_month\\n,sum(first_high_cnt)  as pension_first_intent_high_cnt  --'客户跟踪模块首次意向感兴趣客户数'\\n,sum(first_mid_cnt)  as pension_first_intent_mid_cnt  --'客户跟踪模块首次意向兴趣一般客户数'\\n,sum(first_low_cnt)  as pension_first_intent_low_cnt  --'客户跟踪模块首次意向不感兴趣客户数'\\n,sum(first_highest_cnt)  as pension_first_intent_highest_cnt  --'客户跟踪模块首次意向希望购买客户数'\\n,sum(high_cnt)     as pension_intent_high_cnt  --'客户跟踪模块意向感兴趣客户数'\\n,sum(mid_cnt)      as pension_intent_mid_cnt   --'客户跟踪模块意向兴趣一般客户数'\\n,sum(low_cnt)      as pension_intent_low_cnt   --'客户跟踪模块意向不感兴趣客户数'\\n,sum(highest_cnt)  as pension_intent_highest_cnt  --'客户跟踪模块意向希望购买客户数'\\n,count(distinct intention_customer_id)  as pension_intent_cnt    --'客户跟踪模块意向客户数',\\nfrom\\n(select \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,t.sub_org_name                       --  '养老机构名称'\\n,t.org_id                             --  '集团id'\\n,t.org_name                           --  '集团名称'\\n,t.area_id                            --  '区域id'\\n,t.area_name\\n,from_unixtime( cast(t.regist_time as int),'yyyy-MM') as regist_month                        -- '意向客户录入日期'\\n,case when t.first_intention_type=1 then 1 else 0 end as first_high_cnt\\n,case when t.first_intention_type=2 then 1 else 0 end as first_mid_cnt\\n,case when t.first_intention_type=3 then 1 else 0 end as first_low_cnt\\n,case when t.first_intention_type=4 then 1 else 0 end as first_highest_cnt\\n,case when t.intention_type=1 then 1 else 0 end as high_cnt\\n,case when t.intention_type=2 then 1 else 0 end as mid_cnt\\n,case when t.intention_type=3 then 1 else 0 end as low_cnt\\n,case when t.intention_type=4 then 1 else 0 end as highest_cnt\\nfrom db_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0\\n) a\\ngroup by a.sub_org_id,regist_month\\n)  a1\\nfull join \\n(select\\na.sub_org_id\\n,a.adviser_month\\n,count(distinct advisory_customer_id)  as advisory_customer_cnt    --'咨询客户数',\\nfrom \\n(select \\nt.advisory_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,from_unixtime( cast(t.adviser_time as int),'yyyy-MM') as adviser_month                        -- '意向客户录入日期'\\n,case when t.intention_customer_id is not null then visit_cnt else 0 end intention_visit_cnt\\nfrom db_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0\\n) a\\ngroup by a.sub_org_id,a.adviser_month)  tt1\\non a1.sub_org_id=tt1.sub_org_id  and a1.regist_month=tt1.adviser_month\\nfull join\\n(\\nselect \\na.sub_org_id\\n,a.assess_month\\n,count(distinct intention_customer_id)  as assess_cust_cnt  --'发起评估客户数'\\n,count(assess_time2)           as   assess_cnt              --'评估次数'\\nfrom \\n(\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,assess_time2\\n,substr(assess_time2,1,7) as assess_month                         -- 列开的发起评估时间\\nfrom db_dw_hr.clife_hr_dwd_market t \\nlateral view explode(split(assess_time,',')) l1 as assess_time2\\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0\\n)  a \\ngroup by a.sub_org_id,a.assess_month\\n)  ta1\\non a1.sub_org_id=ta1.sub_org_id  and a1.regist_month=ta1.assess_month\\nfull join \\n(\\nselect\\naa.sub_org_id\\n,aa.ask_month\\n,count(aa.intention_customer_id)   ask_check_in_cust_cnt            --'发起入住通知客户数'\\nfrom \\n(\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,from_unixtime( cast(t.ask_check_in_time as int),'yyyy-MM') as ask_month                         -- 列开的发起评估时间\\nfrom db_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0\\n) aa\\ngroup by aa.sub_org_id,aa.ask_month\\n)  ta2\\non a1.sub_org_id=ta2.sub_org_id and a1.regist_month=ta2.ask_month\\nfull join\\n(\\nselect\\naa4.sub_org_id\\n,aa4.visit_month\\n,count(distinct intention_customer_id)  int_cnt\\n,count(distinct advisory_customer_id)   adv_cnt\\n,sum(int_visit_cnt)  as pension_intent_cust_visit_cnt\\n,sum(adv_visit_cnt)  as advisory_cust_visit_cnt\\n,sum(int_visit_cnt)/count(distinct intention_customer_id)   as avg_pension_intent_cust_visit_cnt\\n,sum(adv_visit_cnt)/count(distinct advisory_customer_id)  as avg_advisory_cust_visit_cnt\\nfrom \\n(\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,visit_time2\\n,substr(visit_time2,1,7) as visit_month                         -- 列开的回访时间\\n,t.visit_time\\n,t.advisory_customer_id\\n,case when t.visit_time is not null and visit_time2 is not null and t.intention_customer_id is not null then 1 else 0 end int_visit_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.advisory_customer_id is not null then 1 else 0 end adv_visit_cnt\\nfrom db_dw_hr.clife_hr_dwd_market t \\nlateral view explode(split(visit_time,',')) l1 as visit_time2\\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0\\n)  aa4 \\ngroup by aa4.sub_org_id,aa4.visit_month\\n)  tt4\\non a1.sub_org_id=tt4.sub_org_id and a1.regist_month=tt4.visit_month\\nfull join \\n(\\n select\\n t1.sub_org_id\\n,t1.regist_month\\n,sum(first_high_cnt)  as crm_first_intent_high_cnt  --'营销管理模块首次意向感兴趣客户数'\\n,sum(first_mid_cnt)   as crm_first_intent_mid_cnt   --'营销管理模块首次意向兴趣一般客户数'\\n,sum(first_low_cnt)   as crm_first_intent_low_cnt   --'营销管理模块首次意向不感兴趣客户数'\\n,sum(first_highest_cnt)  as crm_first_intent_highest_cnt  --'营销管理模块首次意向希望购买客户数'\\n,sum(high_cnt)     as crm_intent_high_cnt  --'营销管理模块意向感兴趣客户数'\\n,sum(mid_cnt)      as crm_intent_mid_cnt   --'营销管理模块意向兴趣一般客户数'\\n,sum(low_cnt)      as crm_intent_low_cnt   --'营销管理模块意向不感兴趣客户数'\\n,sum(highest_cnt)  as crm_intent_highest_cnt  --'营销管理模块意向希望购买客户数'\\n,count(distinct intention_customer_id)  as crm_intent_cnt    --'营销管理模块意向客户数',\\n from \\n(\\nselect \\n b.intention_customer_id\\n,b.sub_org_id\\n,b.sub_org_name\\n,b.org_id\\n,b.org_name\\n,b.area_id\\n,b.area_name\\n,b.visit_cnt\\n,b.assess_cnt\\n,case when b.first_intention_type=1 then 1 else 0 end as first_high_cnt\\n,case when b.first_intention_type=2 then 1 else 0 end as first_mid_cnt\\n,case when b.first_intention_type=3 then 1 else 0 end as first_low_cnt\\n,case when b.first_intention_type=4 then 1 else 0 end as first_highest_cnt\\n,case when b.intention_type=1 then 1 else 0 end as high_cnt\\n,case when b.intention_type=2 then 1 else 0 end as mid_cnt\\n,case when b.intention_type=3 then 1 else 0 end as low_cnt\\n,case when b.intention_type=4 then 1 else 0 end as highest_cnt\\n,from_unixtime( cast(regist_time as int),'yyyy-MM')  as regist_month\\nfrom \\n(\\nselect \\n t.intention_customer_id\\n,max(t.sub_org_id )  sub_org_id                      --  '养老机构id'\\n,max(t.sub_org_name)   sub_org_name                    --  '养老机构名称'\\n,max(t.org_id)      org_id                      --  '集团id'\\n,max(t.org_name)    org_name                       --  '集团名称'\\n,max(t.area_id)     area_id                       --  '区域id'\\n,max(t.area_name)   area_name                       --  '区域名称'\\n,max(t.visit_cnt)   visit_cnt                       --  '回访次数'\\n,max(t.first_intention_type)    first_intention_type           --  '首次意向'\\n,max(t.intention_type)          intention_type           --  '当前意向' \\n,max(t.assess_cnt)    assess_cnt                       \\n,max(t.regist_time)   as regist_time\\nfrom\\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\ngroup by t.intention_customer_id\\n) b\\n) t1\\ngroup by t1.sub_org_id,t1.regist_month) b1 \\non a1.sub_org_id=b1.sub_org_id and a1.regist_month=b1.regist_month\\nfull join \\n(\\nselect \\naa2.sub_org_id\\n,aa2.deposit_month\\n,count(distinct intention_customer_id) as deposit_cust_cnt  -- '下定客户数'\\n,sum(deposit_amount)    deposit_amount         --     '下定额'\\n,count(distinct membership_id)   as deposit_member_cnt\\n,count(distinct room_id)         as deposit_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,deposit_amount             --     '下定额'\\n,from_unixtime( cast(deposit_time as int),'yyyy-MM')  as deposit_month \\n,t.membership_id\\n,t.room_id\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa2\\ngroup by aa2.sub_org_id,aa2.deposit_month\\n)  tt2\\non a1.sub_org_id=tt2.sub_org_id and a1.regist_month=tt2.deposit_month\\nfull join \\n(\\nselect \\naa3.sub_org_id\\n,aa3.sign_month\\n,count(distinct intention_customer_id) as sign_cust_cnt  -- '下定客户数'\\n,sum(card_pay_amount)   card_pay_amount         --\\t    '刷卡金额'\\n,sum(cash_pay_amount)   cash_pay_amount         --     '现金金额'\\n,sum(weixin_pay_amount) weixin_pay_amount         --     '微信支付金额'\\n,sum(alipay_amount)     alipay_amount         --     '阿里支付金额'\\t\\n,sum(other_pay_amount)  other_pay_amount         --     '其他方式支付金额'\\n,sum(receivable_amount) sales_amount            --  '销售金额'\\n,sum(received_amount)   received_amount            --  '已收金额'\\n,sum(received_installment_amount) received_installment_amount    --  '已收分期金额'\\n,sum(received_occupancy_amount)   received_occupancy_amount    --  '已收占用费'\\n,sum(membership_amount)           membership_amount     --  '会籍费'\\n,sum(overdue_amount)              overdue_amount    --  '滞纳金'\\n,sum(received_overdue_amount)     received_overdue_amount    --  '已收滞纳金'\\n,sum(other_amount)                other_amount     --  '其他费用'\\n,sum(manager_amount)              manager_amount       --  '管理费'\\n,sum(trust_amount)                trust_amount      --  '托管费'\\n,sum(membership_discount_amount)  membership_discount_amount      --  '会籍优惠价'  \\n,sum(card_amount)                 card_amount        --  '卡费'\\n,sum(card_manager_amount)         card_manager_amount     --  '卡管理费'\\n,count(distinct membership_id)   as sign_member_cnt\\n,count(distinct room_id)         as sign_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,t.membership_id\\n,t.room_id\\n,from_unixtime( cast(sign_time as int),'yyyy-MM')  as sign_month\\n,case when pay_type_id=0 then received_amount else null end as  card_pay_amount            --\\t    '刷卡金额'\\n,case when pay_type_id=1 then received_amount else null end as  cash_pay_amount            --     '现金金额'\\n,case when pay_type_id=2 then received_amount else null end as  weixin_pay_amount          --     '微信支付金额'\\n,case when pay_type_id=3 then received_amount else null end as  alipay_amount              --     '阿里支付金额'\\t\\n,case when pay_type_id=4 then received_amount else null end as  other_pay_amount           --     '其他方式支付金额'\\n,receivable_amount             --  '应收金额'\\n,received_amount               --  '已收金额'\\n,received_installment_amount   --  '已收分期金额'\\n,received_occupancy_amount     --  '已收占用费'\\n,membership_amount             --  '会籍费'\\n,overdue_amount                --  '滞纳金'\\n,received_overdue_amount       --  '已收滞纳金'\\n,other_amount                  --  '其他费用'\\n,manager_amount                --  '管理费'\\n,trust_amount                  --  '托管费'\\n,membership_discount_amount    --  '会籍优惠价'  \\n,card_amount                   --  '卡费'\\n,card_manager_amount           --  '卡管理费' \\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa3\\ngroup by aa3.sub_org_id,aa3.sign_month\\n)  tt3\\non a1.sub_org_id=tt3.sub_org_id and a1.regist_month=tt3.sign_month\\nfull join \\n(\\nselect\\naa5.sub_org_id\\n,aa5.visit_month\\n,count(distinct aa5.intention_customer_id)  int_cnt\\n,count(aa5.visit_time2)  as crm_intent_cust_visit_cnt\\n,count(aa5.visit_time2)/count(distinct aa5.intention_customer_id)   as avg_crm_intent_cust_visit_cnt\\n,count(distinct aa5.deposit_visit_cust_cnt)  deposit_cust_visit_cnt\\n,sum(aa5.deposit_visit_cnt)  as deposit_visit_cnt\\n,count(distinct aa5.deposit_visit_cust_cnt)/sum(aa5.deposit_visit_cnt)   as avg_deposit_cust_visit_cnt\\n,count(distinct aa5.sign_visit_cust_cnt)  sign_cust_visit_cnt\\n,sum(aa5.sign_visit_cnt)  as sign_visit_cnt\\n,count(distinct aa5.sign_visit_cust_cnt)/sum(aa5.sign_visit_cnt)   as avg_sign_cust_visit_cnt\\nfrom \\n(   -- 回访过程\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,visit_time2\\n,substr(visit_time2,1,7) as visit_month                         -- 列开的回访时间\\n,t.visit_time\\n,case when t.visit_time is not null and visit_time2 is not null and t.deposit_time_list is not null then 1 else 0 end deposit_visit_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.sign_time_list is not null then 1 else 0 end sign_visit_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.deposit_time_list is not null then intention_customer_id else null end deposit_visit_cust_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.sign_time_list is not null then intention_customer_id else null end sign_visit_cust_cnt\\nfrom db_dw_hr.clife_hr_customer_crm_visit_base_info_tmp t \\nlateral view explode(split(visit_time,',')) l1 as visit_time2\\n) as aa5 \\ngroup by aa5.sub_org_id,aa5.visit_month\\n)  tt5\\non a1.sub_org_id=tt5.sub_org_id and a1.regist_month=tt5.visit_month\\nfull join \\n(\\nselect \\naa6.sub_org_id\\n,aa6.assess_month\\n,count(distinct intention_customer_id)  as assess_cust_cnt  --'发起评估客户数'\\n,count(assess_time2)           as   assess_cnt              --'评估次数'\\nfrom \\n(     --评估相关过程\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,assess_time2\\n,substr(assess_time2,1,7) as assess_month                         -- 列开的发起评估时间\\nfrom db_dw_hr.clife_hr_customer_crm_visit_base_info_tmp t \\nlateral view explode(split(assess_time,',')) l1 as assess_time2\\n)  aa6 \\ngroup by aa6.sub_org_id,aa6.assess_month\\n)  tt6\\non a1.sub_org_id=tt6.sub_org_id and a1.regist_month=tt6.assess_month\\nfull join \\n(\\nselect\\naa7.sub_org_id\\n,aa7.apply_date\\n,count(distinct pre_membership_id) as apply_member_cnt\\nfrom\\n(\\nselect \\nt.pre_membership_id\\n,t.sub_org_id\\n,from_unixtime( cast(t.apply_time as int),'yyyy-MM')  apply_date\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa7\\ngroup by aa7.sub_org_id,aa7.apply_date\\n) tt7\\non a1.sub_org_id=tt7.sub_org_id and a1.regist_month=tt7.apply_date\\nfull join \\n(\\nselect\\naa8.sub_org_id\\n,aa8.transfer_to_month\\n,count(distinct membership_id) as transfer_to_member_cnt\\n,sum(other_transfor_to_amount)    other_transfer_to_amount     --  '其他转让费' \\n,sum(transfor_to_amount)          transfer_to_amount      --  '转让费'\\nfrom\\n(\\nselect \\nt.membership_id\\n,t.other_transfor_to_amount      --  '其他转让费' \\n,t.transfor_to_amount            --  '转让费'\\n,t.sub_org_id\\n,from_unixtime( cast(t.transfor_to_time as int),'yyyy-MM')  transfer_to_month\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa8\\ngroup by aa8.sub_org_id,aa8.transfer_to_month\\n) tt8\\non a1.sub_org_id=tt8.sub_org_id and a1.regist_month=tt8.transfer_to_month\\nfull join \\n(\\nselect\\naa9.sub_org_id\\n,aa9.transfer_from_month\\n,count(distinct membership_id) as transfer_from_member_cnt\\n,sum(other_transfor_from_amount)    other_transfer_from_amount     \\n,sum(transfor_from_amount)          transfer_from_amount  \\nfrom   \\n(\\nselect \\nt.membership_id\\n,t.other_transfor_from_amount       \\n,t.transfor_from_amount            \\n,t.sub_org_id\\n,from_unixtime( cast(t.transfor_from_time as int),'yyyy-MM')  transfer_from_month\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa9\\ngroup by aa9.sub_org_id,aa9.transfer_from_month\\n) tt9\\non a1.sub_org_id=tt9.sub_org_id and a1.regist_month=tt9.transfer_from_month\\nfull join \\n(\\nselect\\naa10.sub_org_id\\n,aa10.withdraw_month\\n,count(distinct membership_id) as withdraw_member_cnt   \\n,sum(withdraw_amount)          withdraw_amount \\nfrom    \\n(\\nselect \\nt.membership_id      \\n,t.withdraw_amount            \\n,t.sub_org_id\\n,from_unixtime( cast(t.withdraw_time as int),'yyyy-MM')  withdraw_month\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa10\\ngroup by aa10.sub_org_id,aa10.withdraw_month\\n) tt10\\non a1.sub_org_id=tt10.sub_org_id and a1.regist_month=tt10.withdraw_month\",\"udfs\":\"14\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_market_by_sub_org_m_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-28229\",\"name\":\"clife_hr_dws_market_by_sub_org_m\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_sub_org_m partition(part_date)\\nselect\\na.sub_org_id                          --   '养老机构id'\\n,b.sub_org_name                        --   '养老机构名称'\\n,b.org_id                              --   '养老集团id'\\n,b.org_name                            --   '养老集团名称'\\n,c.area_id                             --   '区域id'\\n,c.area_name                           --   '区域名称'\\n,a.advisory_customer_cnt               --   '咨询客户数'\\n,a.pension_first_intent_high_cnt       --   '客户跟踪模块首次意向感兴趣客户数'\\n,a.pension_first_intent_mid_cnt        --   '客户跟踪模块首次意向兴趣一般客户数'\\n,a.pension_first_intent_low_cnt        --   '客户跟踪模块首次意向不感兴趣客户数'\\n,a.pension_first_intent_highest_cnt    --   '客户跟踪模块首次意向希望购买客户数'\\n,a.pension_intent_high_cnt             --   '客户跟踪模块当前意向感兴趣客户数'\\n,a.pension_intent_mid_cnt              --   '客户跟踪模块当前意向兴趣一般客户数'\\n,a.pension_intent_low_cnt              --   '客户跟踪模块当前意向不感兴趣客户数'\\n,a.pension_intent_highest_cnt          --   '客户跟踪模块当前意向希望购买客户数'\\n,a.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,a.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,a.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,a.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,a.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,a.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,a.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,a.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,a.pension_intent_cnt                  --   '客户跟踪模块意向客户数'\\n,a.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,a.deposit_cust_cnt                    --   '下定客户数'\\n,a.sign_cust_cnt                       --   '签约客户数'\\n,a.transfer_to_member_cnt              --   '转让会籍数'\\n,a.transfer_from_member_cnt            --   '继承会籍数'\\n,a.withdraw_member_cnt                 --   '退会会籍数'\\n,a.advisory_cust_visit_cnt             --   '咨询客户回访次数'\\n,a.pension_intent_cust_visit_cnt       --   '客户跟踪模块意向客户回访次数'\\n,a.crm_intent_cust_visit_cnt           --   '营销管理模块意向客户回访次数'\\n,a.deposit_cust_visit_cnt              --   '下定客户回访次数'\\n,a.sign_cust_visit_cnt                 --   '签约客户回访次数'\\n,a.avg_advisory_cust_visit_cnt         --   '咨询客户平均回访次数'\\n,a.avg_pension_intent_cust_visit_cnt   --   '客户跟踪模块意向客户平均回访次数'\\n,a.avg_crm_intent_cust_visit_cnt       --   '营销管理模块意向客户平均回访次数'\\n,a.avg_deposit_cust_visit_cnt          --   '下定客户平均回访次数'\\n,a.avg_sign_cust_visit_cnt             --   '签约客户平均回访次数'\\n,a.apply_member_cnt                    --   '预申请会籍数量'\\n,a.deposit_member_cnt                  --   '下定会籍数量'\\n,a.deposit_room_cnt                    --   '下定房间数量'\\n,a.sign_member_cnt                     --   '签约会籍数量'\\n,a.sign_room_cnt                       --   '签约房间数量'\\n,a.deposit_amount                      --  '下定额'\\n,a.sales_amount                        --  '销售额'\\n,a.card_pay_amount                     --  '刷卡金额'\\n,a.cash_pay_amount                     --  '现金金额'\\n,a.weixin_pay_amount                   --  '微信支付金额'\\n,a.alipay_amount                       --  '阿里支付金额'\\t\\n,a.other_pay_amount                    --  '其他方式支付金额'\\n,a.received_amount                     --  '已收金额'\\n,a.other_transfer_to_amount            --  '其他转让费' \\n,a.transfer_to_amount                  --  '转让费' \\n,a.other_transfer_from_amount          --  '其他继承费' \\n,a.transfer_from_amount                --  '继承费'\\n,a.withdraw_amount                     --  '退会金额' \\n,a.assess_cust_cnt                     --   '评估客户数'\\n,a.ask_check_in_cust_cnt               --   '发起入住通知客户数'\\n,a.assess_cnt                          --   '评估总次数'\\n,a.data_month                           --   '数据日期'\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom \\ndb_dw_hr.clife_hr_dws_market_by_sub_org_m_tmp a \\nleft join \\ndb_dw_hr.clife_hr_dim_admin_sub_org b\\non a.sub_org_id=b.sub_org_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_geographic_info c \\non concat(substr(b.city,1,5),b.area,'0000')=c.area_id\\nand c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_sub_org_m_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-13268\",\"name\":\"clife_hr_dws_market_by_sub_org_y_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table if not exists db_dw_hr.clife_hr_dws_market_by_sub_org_y_tmp stored as parquet as \\nselect\\nsplit(getSet2(concat(if(a1.sub_org_id is null,'',a1.sub_org_id),',',if(tt1.sub_org_id is null,'',tt1.sub_org_id),',',if(ta1.sub_org_id is null,'',ta1.sub_org_id),',',if(ta2.sub_org_id is null,'',ta2.sub_org_id),',',if(tt4.sub_org_id is null,'',tt4.sub_org_id),',',if(b1.sub_org_id is null,'',b1.sub_org_id),',',if(tt2.sub_org_id is null,'',tt2.sub_org_id),',',if(tt3.sub_org_id is null,'',tt3.sub_org_id),',',if(tt5.sub_org_id is null,'',tt5.sub_org_id),',',if(tt6.sub_org_id is null,'',tt6.sub_org_id),',',if(tt7.sub_org_id is null,'',tt7.sub_org_id),',',if(tt8.sub_org_id is null,'',tt8.sub_org_id),',',if(tt9.sub_org_id is null,'',tt9.sub_org_id),',',if(tt10.sub_org_id is null,'',tt10.sub_org_id),',','')),',')[1] as sub_org_id                          --   '养老机构id',\\n,tt1.advisory_customer_cnt               --   '咨询客户数'\\n,a1.pension_first_intent_high_cnt       --   '客户跟踪模块首次意向感兴趣客户数'\\n,a1.pension_first_intent_mid_cnt        --   '客户跟踪模块首次意向兴趣一般客户数'\\n,a1.pension_first_intent_low_cnt        --   '客户跟踪模块首次意向不感兴趣客户数'\\n,a1.pension_first_intent_highest_cnt    --   '客户跟踪模块首次意向希望购买客户数'\\n,a1.pension_intent_high_cnt             --   '客户跟踪模块当前意向感兴趣客户数'\\n,a1.pension_intent_mid_cnt              --   '客户跟踪模块当前意向兴趣一般客户数'\\n,a1.pension_intent_low_cnt              --   '客户跟踪模块当前意向不感兴趣客户数'\\n,a1.pension_intent_highest_cnt          --   '客户跟踪模块当前意向希望购买客户数'\\n,b1.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,b1.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,b1.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,b1.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,b1.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,b1.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,b1.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,b1.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,a1.pension_intent_cnt                  --   '客户跟踪模块意向客户数'\\n,b1.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,tt2.deposit_cust_cnt                    --   '下定客户数'\\n,tt3.sign_cust_cnt                       --   '签约客户数'\\n,tt8.transfer_to_member_cnt              --   '转让会籍数'\\n,tt9.transfer_from_member_cnt            --   '继承会籍数'\\n,tt10.withdraw_member_cnt                 --   '退会会籍数'\\n,tt4.advisory_cust_visit_cnt             --   '咨询客户回访次数'\\n,tt4.pension_intent_cust_visit_cnt       --   '客户跟踪模块意向客户回访次数'\\n,tt5.crm_intent_cust_visit_cnt           --   '营销管理模块意向客户回访次数'\\n,tt5.deposit_cust_visit_cnt              --   '下定客户回访次数'\\n,tt5.sign_cust_visit_cnt                 --   '签约客户回访次数'\\n,tt4.avg_advisory_cust_visit_cnt         --   '咨询客户平均回访次数'\\n,tt4.avg_pension_intent_cust_visit_cnt   --   '客户跟踪模块意向客户平均回访次数'\\n,tt5.avg_crm_intent_cust_visit_cnt       --   '营销管理模块意向客户平均回访次数'\\n,tt5.avg_deposit_cust_visit_cnt          --   '下定客户平均回访次数'\\n,tt5.avg_sign_cust_visit_cnt             --   '签约客户平均回访次数'\\n,tt7.apply_member_cnt                    --   '预申请会籍数量'\\n,tt2.deposit_member_cnt                  --   '下定会籍数量'\\n,tt2.deposit_room_cnt                    --   '下定房间数量'\\n,tt3.sign_member_cnt                     --   '签约会籍数量'\\n,tt3.sign_room_cnt                       --   '签约房间数量'\\n,tt2.deposit_amount                      --   '下定额'\\n,tt3.sales_amount                        --   '销售额'\\n,tt3.card_pay_amount                     --\\t  '刷卡金额'\\n,tt3.cash_pay_amount                     --   '现金金额'\\n,tt3.weixin_pay_amount                   --   '微信支付金额'\\n,tt3.alipay_amount                       --   '阿里支付金额'\\t\\n,tt3.other_pay_amount                    --   '其他方式支付金额'\\n,tt3.received_amount                     --   '已收金额'\\n,tt3.received_installment_amount         --   '已收分期金额'\\n,tt3.received_occupancy_amount           --   '已收占用费'\\n,tt3.membership_amount                   --   '会籍费'\\n,tt3.overdue_amount                      --   '滞纳金'\\n,tt3.received_overdue_amount             --   '已收滞纳金'\\n,tt3.other_amount                        --   '其他费用'\\n,tt3.manager_amount                      --   '管理费'\\n,tt3.trust_amount                        --   '托管费' \\n,tt3.membership_discount_amount          --   '会籍优惠价' \\n,tt3.card_amount                         --   '卡费'\\n,tt3.card_manager_amount                 --   '卡管理费'\\n,tt8.other_transfer_to_amount            --   '其他转让费' \\n,tt8.transfer_to_amount                  --   '转让费'\\n,tt9.other_transfer_from_amount          --   '其他继承费' \\n,tt9.transfer_from_amount                --   '继承费'\\n,tt10.withdraw_amount                     --   '退会金额' \\n,(ta1.assess_cust_cnt+tt6.assess_cust_cnt)  as assess_cust_cnt                     --   '评估客户数'\\n,ta2.ask_check_in_cust_cnt               --   '发起入住通知客户数'\\n,(ta1.assess_cnt+tt6.assess_cnt)  as assess_cnt                          --   '评估总次数'\\n,split(getSet2(concat(if(a1.regist_year is null,'',a1.regist_year),',',if(tt1.adviser_year is null,'',tt1.adviser_year),',',if(ta1.assess_year is null,'',ta1.assess_year),',',if(ta2.ask_year is null,'',ta2.ask_year),',',if(tt4.visit_year is null,'',tt4.visit_year),',',if(b1.regist_year is null,'',b1.regist_year),',',if(tt2.deposit_year is null,'',tt2.deposit_year),',',if(tt3.sign_year is null,'',tt3.sign_year),',',if(tt5.visit_year is null,'',tt5.visit_year),',',if(tt6.assess_year is null,'',tt6.assess_year),',',if(tt7.apply_date is null,'',tt7.apply_date),',',if(tt8.transfer_to_year is null,'',tt8.transfer_to_year),',',if(tt9.transfer_from_year is null,'',tt9.transfer_from_year),',',if(tt10.withdraw_year is null,'',tt10.withdraw_year),',','')),',')[1]  as data_year                  -- 数据日期\\nfrom \\n(\\nselect\\na.sub_org_id\\n,a.regist_year\\n,sum(first_high_cnt)  as pension_first_intent_high_cnt  --'客户跟踪模块首次意向感兴趣客户数'\\n,sum(first_mid_cnt)  as pension_first_intent_mid_cnt  --'客户跟踪模块首次意向兴趣一般客户数'\\n,sum(first_low_cnt)  as pension_first_intent_low_cnt  --'客户跟踪模块首次意向不感兴趣客户数'\\n,sum(first_highest_cnt)  as pension_first_intent_highest_cnt  --'客户跟踪模块首次意向希望购买客户数'\\n,sum(high_cnt)     as pension_intent_high_cnt  --'客户跟踪模块意向感兴趣客户数'\\n,sum(mid_cnt)      as pension_intent_mid_cnt   --'客户跟踪模块意向兴趣一般客户数'\\n,sum(low_cnt)      as pension_intent_low_cnt   --'客户跟踪模块意向不感兴趣客户数'\\n,sum(highest_cnt)  as pension_intent_highest_cnt  --'客户跟踪模块意向希望购买客户数'\\n,count(distinct intention_customer_id)  as pension_intent_cnt    --'客户跟踪模块意向客户数',\\nfrom\\n(select \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,t.sub_org_name                       --  '养老机构名称'\\n,t.org_id                             --  '集团id'\\n,t.org_name                           --  '集团名称'\\n,t.area_id                            --  '区域id'\\n,t.area_name\\n,from_unixtime( cast(t.regist_time as int),'yyyy') as regist_year                        -- '意向客户录入日期'\\n,case when t.first_intention_type=1 then 1 else 0 end as first_high_cnt\\n,case when t.first_intention_type=2 then 1 else 0 end as first_mid_cnt\\n,case when t.first_intention_type=3 then 1 else 0 end as first_low_cnt\\n,case when t.first_intention_type=4 then 1 else 0 end as first_highest_cnt\\n,case when t.intention_type=1 then 1 else 0 end as high_cnt\\n,case when t.intention_type=2 then 1 else 0 end as mid_cnt\\n,case when t.intention_type=3 then 1 else 0 end as low_cnt\\n,case when t.intention_type=4 then 1 else 0 end as highest_cnt\\nfrom db_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0\\n) a\\ngroup by a.sub_org_id,regist_year\\n)  a1\\nfull join \\n(select\\na.sub_org_id\\n,a.adviser_year\\n,count(distinct advisory_customer_id)  as advisory_customer_cnt    --'咨询客户数',\\nfrom \\n(select \\nt.advisory_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,from_unixtime( cast(t.adviser_time as int),'yyyy') as adviser_year                        -- '意向客户录入日期'\\n,case when t.intention_customer_id is not null then visit_cnt else 0 end intention_visit_cnt\\nfrom db_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0\\n) a\\ngroup by a.sub_org_id,a.adviser_year)  tt1\\non a1.sub_org_id=tt1.sub_org_id  and a1.regist_year=tt1.adviser_year\\nfull join\\n(\\nselect \\na.sub_org_id\\n,a.assess_year\\n,count(distinct intention_customer_id)  as assess_cust_cnt  --'发起评估客户数'\\n,count(assess_time2)           as   assess_cnt              --'评估次数'\\nfrom \\n(\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,assess_time2\\n,substr(assess_time2,1,4) as assess_year                         -- 列开的发起评估时间\\nfrom db_dw_hr.clife_hr_dwd_market t \\nlateral view explode(split(assess_time,',')) l1 as assess_time2\\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0\\n)  a \\ngroup by a.sub_org_id,a.assess_year\\n)  ta1\\non a1.sub_org_id=ta1.sub_org_id  and a1.regist_year=ta1.assess_year\\nfull join \\n(\\nselect\\naa.sub_org_id\\n,aa.ask_year\\n,count(aa.intention_customer_id)   ask_check_in_cust_cnt            --'发起入住通知客户数'\\nfrom \\n(\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,from_unixtime( cast(t.ask_check_in_time as int),'yyyy') as ask_year                         -- 列开的发起评估时间\\nfrom db_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0\\n) aa\\ngroup by aa.sub_org_id,aa.ask_year\\n)  ta2\\non a1.sub_org_id=ta2.sub_org_id and a1.regist_year=ta2.ask_year\\nfull join\\n(\\nselect\\naa4.sub_org_id\\n,aa4.visit_year\\n,count(distinct intention_customer_id)  int_cnt\\n,count(distinct advisory_customer_id)   adv_cnt\\n,sum(int_visit_cnt)  as pension_intent_cust_visit_cnt\\n,sum(adv_visit_cnt)  as advisory_cust_visit_cnt\\n,sum(int_visit_cnt)/count(distinct intention_customer_id)   as avg_pension_intent_cust_visit_cnt\\n,sum(adv_visit_cnt)/count(distinct advisory_customer_id)  as avg_advisory_cust_visit_cnt\\nfrom \\n(\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,visit_time2\\n,substr(visit_time2,1,4) as visit_year                         -- 列开的回访时间\\n,t.visit_time\\n,t.advisory_customer_id\\n,case when t.visit_time is not null and visit_time2 is not null and t.intention_customer_id is not null then 1 else 0 end int_visit_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.advisory_customer_id is not null then 1 else 0 end adv_visit_cnt\\nfrom db_dw_hr.clife_hr_dwd_market t \\nlateral view explode(split(visit_time,',')) l1 as visit_time2\\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0\\n)  aa4 \\ngroup by aa4.sub_org_id,aa4.visit_year\\n)  tt4\\non a1.sub_org_id=tt4.sub_org_id and a1.regist_year=tt4.visit_year\\nfull join \\n(\\n select\\n t1.sub_org_id\\n,t1.regist_year\\n,sum(first_high_cnt)  as crm_first_intent_high_cnt  --'营销管理模块首次意向感兴趣客户数'\\n,sum(first_mid_cnt)   as crm_first_intent_mid_cnt   --'营销管理模块首次意向兴趣一般客户数'\\n,sum(first_low_cnt)   as crm_first_intent_low_cnt   --'营销管理模块首次意向不感兴趣客户数'\\n,sum(first_highest_cnt)  as crm_first_intent_highest_cnt  --'营销管理模块首次意向希望购买客户数'\\n,sum(high_cnt)     as crm_intent_high_cnt  --'营销管理模块意向感兴趣客户数'\\n,sum(mid_cnt)      as crm_intent_mid_cnt   --'营销管理模块意向兴趣一般客户数'\\n,sum(low_cnt)      as crm_intent_low_cnt   --'营销管理模块意向不感兴趣客户数'\\n,sum(highest_cnt)  as crm_intent_highest_cnt  --'营销管理模块意向希望购买客户数'\\n,count(distinct intention_customer_id)  as crm_intent_cnt    --'营销管理模块意向客户数',\\n from \\n(\\nselect \\n b.intention_customer_id\\n,b.sub_org_id\\n,b.sub_org_name\\n,b.org_id\\n,b.org_name\\n,b.area_id\\n,b.area_name\\n,b.visit_cnt\\n,b.assess_cnt\\n,case when b.first_intention_type=1 then 1 else 0 end as first_high_cnt\\n,case when b.first_intention_type=2 then 1 else 0 end as first_mid_cnt\\n,case when b.first_intention_type=3 then 1 else 0 end as first_low_cnt\\n,case when b.first_intention_type=4 then 1 else 0 end as first_highest_cnt\\n,case when b.intention_type=1 then 1 else 0 end as high_cnt\\n,case when b.intention_type=2 then 1 else 0 end as mid_cnt\\n,case when b.intention_type=3 then 1 else 0 end as low_cnt\\n,case when b.intention_type=4 then 1 else 0 end as highest_cnt\\n,from_unixtime( cast(regist_time as int),'yyyy')  as regist_year\\nfrom \\n(\\nselect \\n t.intention_customer_id\\n,max(t.sub_org_id )  sub_org_id                      --  '养老机构id'\\n,max(t.sub_org_name)   sub_org_name                    --  '养老机构名称'\\n,max(t.org_id)      org_id                      --  '集团id'\\n,max(t.org_name)    org_name                       --  '集团名称'\\n,max(t.area_id)     area_id                       --  '区域id'\\n,max(t.area_name)   area_name                       --  '区域名称'\\n,max(t.visit_cnt)   visit_cnt                       --  '回访次数'\\n,max(t.first_intention_type)    first_intention_type           --  '首次意向'\\n,max(t.intention_type)          intention_type           --  '当前意向' \\n,max(t.assess_cnt)    assess_cnt                       \\n,max(t.regist_time)   as regist_time\\nfrom\\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\ngroup by t.intention_customer_id\\n) b\\n) t1\\ngroup by t1.sub_org_id,t1.regist_year) b1 \\non a1.sub_org_id=b1.sub_org_id and a1.regist_year=b1.regist_year\\nfull join \\n(\\nselect \\naa2.sub_org_id\\n,aa2.deposit_year\\n,count(distinct intention_customer_id) as deposit_cust_cnt  -- '下定客户数'\\n,sum(deposit_amount)    deposit_amount         --     '下定额'\\n,count(distinct membership_id)   as deposit_member_cnt\\n,count(distinct room_id)         as deposit_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,deposit_amount             --     '下定额'\\n,from_unixtime( cast(deposit_time as int),'yyyy')  as deposit_year \\n,t.membership_id\\n,t.room_id\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa2\\ngroup by aa2.sub_org_id,aa2.deposit_year\\n)  tt2\\non a1.sub_org_id=tt2.sub_org_id and a1.regist_year=tt2.deposit_year\\nfull join \\n(\\nselect \\naa3.sub_org_id\\n,aa3.sign_year\\n,count(distinct intention_customer_id) as sign_cust_cnt  -- '下定客户数'\\n,sum(card_pay_amount)   card_pay_amount         --\\t    '刷卡金额'\\n,sum(cash_pay_amount)   cash_pay_amount         --     '现金金额'\\n,sum(weixin_pay_amount) weixin_pay_amount         --     '微信支付金额'\\n,sum(alipay_amount)     alipay_amount         --     '阿里支付金额'\\t\\n,sum(other_pay_amount)  other_pay_amount         --     '其他方式支付金额'\\n,sum(receivable_amount) sales_amount            --  '销售金额'\\n,sum(received_amount)   received_amount            --  '已收金额'\\n,sum(received_installment_amount) received_installment_amount    --  '已收分期金额'\\n,sum(received_occupancy_amount)   received_occupancy_amount    --  '已收占用费'\\n,sum(membership_amount)           membership_amount     --  '会籍费'\\n,sum(overdue_amount)              overdue_amount    --  '滞纳金'\\n,sum(received_overdue_amount)     received_overdue_amount    --  '已收滞纳金'\\n,sum(other_amount)                other_amount     --  '其他费用'\\n,sum(manager_amount)              manager_amount       --  '管理费'\\n,sum(trust_amount)                trust_amount      --  '托管费'\\n,sum(membership_discount_amount)  membership_discount_amount      --  '会籍优惠价'  \\n,sum(card_amount)                 card_amount        --  '卡费'\\n,sum(card_manager_amount)         card_manager_amount     --  '卡管理费'\\n,count(distinct membership_id)   as sign_member_cnt\\n,count(distinct room_id)         as sign_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,t.membership_id\\n,t.room_id\\n,from_unixtime( cast(sign_time as int),'yyyy')  as sign_year\\n,case when pay_type_id=0 then received_amount else null end as  card_pay_amount            --\\t    '刷卡金额'\\n,case when pay_type_id=1 then received_amount else null end as  cash_pay_amount            --     '现金金额'\\n,case when pay_type_id=2 then received_amount else null end as  weixin_pay_amount          --     '微信支付金额'\\n,case when pay_type_id=3 then received_amount else null end as  alipay_amount              --     '阿里支付金额'\\t\\n,case when pay_type_id=4 then received_amount else null end as  other_pay_amount           --     '其他方式支付金额'\\n,receivable_amount             --  '应收金额'\\n,received_amount               --  '已收金额'\\n,received_installment_amount   --  '已收分期金额'\\n,received_occupancy_amount     --  '已收占用费'\\n,membership_amount             --  '会籍费'\\n,overdue_amount                --  '滞纳金'\\n,received_overdue_amount       --  '已收滞纳金'\\n,other_amount                  --  '其他费用'\\n,manager_amount                --  '管理费'\\n,trust_amount                  --  '托管费'\\n,membership_discount_amount    --  '会籍优惠价'  \\n,card_amount                   --  '卡费'\\n,card_manager_amount           --  '卡管理费' \\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa3\\ngroup by aa3.sub_org_id,aa3.sign_year\\n)  tt3\\non a1.sub_org_id=tt3.sub_org_id and a1.regist_year=tt3.sign_year\\nfull join \\n(\\nselect\\naa5.sub_org_id\\n,aa5.visit_year\\n,count(distinct aa5.intention_customer_id)  int_cnt\\n,count(aa5.visit_time2)  as crm_intent_cust_visit_cnt\\n,count(aa5.visit_time2)/count(distinct aa5.intention_customer_id)   as avg_crm_intent_cust_visit_cnt\\n,count(distinct aa5.deposit_visit_cust_cnt)  deposit_cust_visit_cnt\\n,sum(aa5.deposit_visit_cnt)  as deposit_visit_cnt\\n,count(distinct aa5.deposit_visit_cust_cnt)/sum(aa5.deposit_visit_cnt)   as avg_deposit_cust_visit_cnt\\n,count(distinct aa5.sign_visit_cust_cnt)  sign_cust_visit_cnt\\n,sum(aa5.sign_visit_cnt)  as sign_visit_cnt\\n,count(distinct aa5.sign_visit_cust_cnt)/sum(aa5.sign_visit_cnt)   as avg_sign_cust_visit_cnt\\nfrom \\n(   -- 回访过程\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,visit_time2\\n,substr(visit_time2,1,4) as visit_year                         -- 列开的回访时间\\n,t.visit_time\\n,case when t.visit_time is not null and visit_time2 is not null and t.deposit_time_list is not null then 1 else 0 end deposit_visit_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.sign_time_list is not null then 1 else 0 end sign_visit_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.deposit_time_list is not null then intention_customer_id else null end deposit_visit_cust_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.sign_time_list is not null then intention_customer_id else null end sign_visit_cust_cnt\\nfrom db_dw_hr.clife_hr_customer_crm_visit_base_info_tmp t \\nlateral view explode(split(visit_time,',')) l1 as visit_time2\\n) as aa5 \\ngroup by aa5.sub_org_id,aa5.visit_year\\n)  tt5\\non a1.sub_org_id=tt5.sub_org_id and a1.regist_year=tt5.visit_year\\nfull join \\n(\\nselect \\naa6.sub_org_id\\n,aa6.assess_year\\n,count(distinct intention_customer_id)  as assess_cust_cnt  --'发起评估客户数'\\n,count(assess_time2)           as   assess_cnt              --'评估次数'\\nfrom \\n(     --评估相关过程\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,assess_time2\\n,substr(assess_time2,1,4) as assess_year                         -- 列开的发起评估时间\\nfrom db_dw_hr.clife_hr_customer_crm_visit_base_info_tmp t \\nlateral view explode(split(assess_time,',')) l1 as assess_time2\\n)  aa6 \\ngroup by aa6.sub_org_id,aa6.assess_year\\n)  tt6\\non a1.sub_org_id=tt6.sub_org_id and a1.regist_year=tt6.assess_year\\nfull join \\n(\\nselect\\naa7.sub_org_id\\n,aa7.apply_date\\n,count(distinct pre_membership_id) as apply_member_cnt\\nfrom\\n(\\nselect \\nt.pre_membership_id\\n,t.sub_org_id\\n,from_unixtime( cast(t.apply_time as int),'yyyy')  apply_date\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa7\\ngroup by aa7.sub_org_id,aa7.apply_date\\n) tt7\\non a1.sub_org_id=tt7.sub_org_id and a1.regist_year=tt7.apply_date\\nfull join \\n(\\nselect\\naa8.sub_org_id\\n,aa8.transfer_to_year\\n,count(distinct membership_id) as transfer_to_member_cnt\\n,sum(other_transfor_to_amount)    other_transfer_to_amount     --  '其他转让费' \\n,sum(transfor_to_amount)          transfer_to_amount      --  '转让费'\\nfrom\\n(\\nselect \\nt.membership_id\\n,t.other_transfor_to_amount      --  '其他转让费' \\n,t.transfor_to_amount            --  '转让费'\\n,t.sub_org_id\\n,from_unixtime( cast(t.transfor_to_time as int),'yyyy')  transfer_to_year\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa8\\ngroup by aa8.sub_org_id,aa8.transfer_to_year\\n) tt8\\non a1.sub_org_id=tt8.sub_org_id and a1.regist_year=tt8.transfer_to_year\\nfull join \\n(\\nselect\\naa9.sub_org_id\\n,aa9.transfer_from_year\\n,count(distinct membership_id) as transfer_from_member_cnt\\n,sum(other_transfor_from_amount)    other_transfer_from_amount     \\n,sum(transfor_from_amount)          transfer_from_amount  \\nfrom   \\n(\\nselect \\nt.membership_id\\n,t.other_transfor_from_amount       \\n,t.transfor_from_amount            \\n,t.sub_org_id\\n,from_unixtime( cast(t.transfor_from_time as int),'yyyy')  transfer_from_year\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa9\\ngroup by aa9.sub_org_id,aa9.transfer_from_year\\n) tt9\\non a1.sub_org_id=tt9.sub_org_id and a1.regist_year=tt9.transfer_from_year\\nfull join \\n(\\nselect\\naa10.sub_org_id\\n,aa10.withdraw_year\\n,count(distinct membership_id) as withdraw_member_cnt   \\n,sum(withdraw_amount)          withdraw_amount \\nfrom    \\n(\\nselect \\nt.membership_id      \\n,t.withdraw_amount            \\n,t.sub_org_id\\n,from_unixtime( cast(t.withdraw_time as int),'yyyy')  withdraw_year\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa10\\ngroup by aa10.sub_org_id,aa10.withdraw_year\\n) tt10\\non a1.sub_org_id=tt10.sub_org_id and a1.regist_year=tt10.withdraw_year\",\"udfs\":\"14\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_market_by_sub_org_y_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-9297\",\"name\":\"drop_clife_hr_dws_market_by_sub_org_y_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_market_by_sub_org_y_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_sub_org_m\"]},{\"type\":\"SQL\",\"id\":\"tasks-38171\",\"name\":\"clife_hr_dws_market_by_sub_org_y\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_sub_org_y partition(part_date)\\nselect\\na.sub_org_id                          --   '养老机构id'\\n,b.sub_org_name                        --   '养老机构名称'\\n,b.org_id                              --   '养老集团id'\\n,b.org_name                            --   '养老集团名称'\\n,c.area_id                             --   '区域id'\\n,c.area_name                           --   '区域名称'\\n,a.advisory_customer_cnt               --   '咨询客户数'\\n,a.pension_first_intent_high_cnt       --   '客户跟踪模块首次意向感兴趣客户数'\\n,a.pension_first_intent_mid_cnt        --   '客户跟踪模块首次意向兴趣一般客户数'\\n,a.pension_first_intent_low_cnt        --   '客户跟踪模块首次意向不感兴趣客户数'\\n,a.pension_first_intent_highest_cnt    --   '客户跟踪模块首次意向希望购买客户数'\\n,a.pension_intent_high_cnt             --   '客户跟踪模块当前意向感兴趣客户数'\\n,a.pension_intent_mid_cnt              --   '客户跟踪模块当前意向兴趣一般客户数'\\n,a.pension_intent_low_cnt              --   '客户跟踪模块当前意向不感兴趣客户数'\\n,a.pension_intent_highest_cnt          --   '客户跟踪模块当前意向希望购买客户数'\\n,a.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,a.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,a.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,a.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,a.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,a.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,a.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,a.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,a.pension_intent_cnt                  --   '客户跟踪模块意向客户数'\\n,a.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,a.deposit_cust_cnt                    --   '下定客户数'\\n,a.sign_cust_cnt                       --   '签约客户数'\\n,a.transfer_to_member_cnt              --   '转让会籍数'\\n,a.transfer_from_member_cnt            --   '继承会籍数'\\n,a.withdraw_member_cnt                 --   '退会会籍数'\\n,a.advisory_cust_visit_cnt             --   '咨询客户回访次数'\\n,a.pension_intent_cust_visit_cnt       --   '客户跟踪模块意向客户回访次数'\\n,a.crm_intent_cust_visit_cnt           --   '营销管理模块意向客户回访次数'\\n,a.deposit_cust_visit_cnt              --   '下定客户回访次数'\\n,a.sign_cust_visit_cnt                 --   '签约客户回访次数'\\n,a.avg_advisory_cust_visit_cnt         --   '咨询客户平均回访次数'\\n,a.avg_pension_intent_cust_visit_cnt   --   '客户跟踪模块意向客户平均回访次数'\\n,a.avg_crm_intent_cust_visit_cnt       --   '营销管理模块意向客户平均回访次数'\\n,a.avg_deposit_cust_visit_cnt          --   '下定客户平均回访次数'\\n,a.avg_sign_cust_visit_cnt             --   '签约客户平均回访次数'\\n,a.apply_member_cnt                    --   '预申请会籍数量'\\n,a.deposit_member_cnt                  --   '下定会籍数量'\\n,a.deposit_room_cnt                    --   '下定房间数量'\\n,a.sign_member_cnt                     --   '签约会籍数量'\\n,a.sign_room_cnt                       --   '签约房间数量'\\n,a.deposit_amount                      --  '下定额'\\n,a.sales_amount                        --  '销售额'\\n,a.card_pay_amount                     --  '刷卡金额'\\n,a.cash_pay_amount                     --  '现金金额'\\n,a.weixin_pay_amount                   --  '微信支付金额'\\n,a.alipay_amount                       --  '阿里支付金额'\\t\\n,a.other_pay_amount                    --  '其他方式支付金额'\\n,a.received_amount                     --  '已收金额'\\n,a.other_transfer_to_amount            --  '其他转让费' \\n,a.transfer_to_amount                  --  '转让费' \\n,a.other_transfer_from_amount          --  '其他继承费' \\n,a.transfer_from_amount                --  '继承费'\\n,a.withdraw_amount                     --  '退会金额' \\n,a.assess_cust_cnt                     --   '评估客户数'\\n,a.ask_check_in_cust_cnt               --   '发起入住通知客户数'\\n,a.assess_cnt                          --   '评估总次数'\\n,a.data_year                           --   '数据日期'\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom \\ndb_dw_hr.clife_hr_dws_market_by_sub_org_y_tmp a \\nleft join \\ndb_dw_hr.clife_hr_dim_admin_sub_org b\\non a.sub_org_id=b.sub_org_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_geographic_info c \\non concat(substr(b.city,1,5),b.area,'0000')=c.area_id\\nand c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_sub_org_y_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-26239\",\"name\":\"clife_hr_dws_market_by_channel_f\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_channel_f partition(part_date)\\nselect \\na.channel_id                          --  '渠道id'\\n,a.sub_org_id                          --  '养老机构id'\\n,max(a.sub_org_name)  sub_org_name                      --  '养老机构名称'\\n,max(a.org_id)    org_id                          --  '养老集团id'\\n,max(a.org_name)   org_name                         --  '养老集团名称'\\n,max(a.area_id)    area_id                         --  '区域id'\\n,max(a.area_name)   area_name                        --  '区域名称'\\n,max(b.trade_channel_name) channel_name                        --  '渠道名称'\\n,max(b.channel_type)    channel_type                     --  '渠道类型'\\n,max(b.channel_type_name)   channel_type_name                --  '渠道类型名称'\\n,count( distinct intention_customer_id) crm_intent_cnt                      --  '营销管理模块意向客户数'\\n,count( distinct deposit_cust) deposit_cust_cnt                    --  '下定客户数'\\n,count( distinct deposit_cust)/count( distinct intention_customer_id)  as deposit_ratio                       --  '下定转化率'\\n,count( distinct sign_cust) sign_cust_cnt                       --  '签约客户数'\\n,count( distinct sign_cust)/count( distinct deposit_cust) as sign_ratio                          --  '签约转化率'\\n,count(distinct pre_membership_id)  apply_member_cnt                    --  '预申请会籍数量'\\n,count(distinct deposit_member)  deposit_member_cnt                  --  '下定会籍数量'\\n,count(distinct deposit_room) deposit_room_cnt                    --  '下定房间数量'\\n,count(distinct sign_member) sign_member_cnt                     --  '签约会籍数量'\\n,count(distinct sign_room) sign_room_cnt                       --  '签约房间数量'\\n,sum(deposit_amount) deposit_amount                      -- '下定额'\\n,sum(receivable_amount) sales_amount                        -- '销售额'\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom \\n(\\nselect \\nintention_customer_id              --  '意向客户id'\\n,pre_membership_id                  --  '预申请会籍id'\\n,membership_id                      --  '会籍id'\\n,trade_channel_ids                  --  '渠道id'\\n,sub_org_id                         --  '养老机构id'\\n,sub_org_name                       --  '养老机构名称'\\n,org_id                             --  '集团id'\\n,org_name                           --  '集团名称'\\n,area_id                            --  '区域id'\\n,area_name\\n,deposit_time                       --  '下定时间'\\n,sign_time                          --  '签约时间'\\n,deposit_amount                     --  '定金金额'\\n,receivable_amount                  --  '应收金额'\\n,channel_id\\n,case when deposit_time is not null then intention_customer_id else null end as deposit_cust\\n,case when sign_time is not null then intention_customer_id else null end as sign_cust\\n,case when deposit_time is not null then membership_id else null end as deposit_member\\n,case when sign_time is not null then membership_id else null end as sign_member\\n,case when deposit_time is not null then room_id else null end as deposit_room\\n,case when sign_time is not null then room_id else null end as sign_room\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nlateral view explode(split(trade_channel_ids,',')) l1 as  channel_id\\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  a \\nleft join \\ndb_dw_hr.clife_hr_dim_trade_channel  b\\non a.channel_id=b.id and  b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\ngroup by a.sub_org_id,a.channel_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_sub_org_y\"]},{\"type\":\"SQL\",\"id\":\"tasks-93545\",\"name\":\"clife_hr_dws_market_by_channel_d_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table db_dw_hr.clife_hr_dws_market_by_channel_d_tmp stored as parquet as \\nSELECT\\nsplit(getSet2(concat(if(tt1.channel_id is null,'',tt1.channel_id),',',if(tt2.channel_id is null,'',tt2.channel_id),',',if(tt3.channel_id is null,'',tt3.channel_id),',',if(tt4.channel_id is null,'',tt4.channel_id),',','')),',')[1]  as channel_id                          --  '渠道id'\\n,split(getSet2(concat(if(tt1.sub_org_id is null,'',tt1.sub_org_id),',',if(tt2.sub_org_id is null,'',tt2.sub_org_id),',',if(tt3.sub_org_id is null,'',tt3.sub_org_id),',',if(tt4.sub_org_id is null,'',tt4.sub_org_id),',','')),',')[1]  as sub_org_id                           --  '养老机构id'\\n,tt4.crm_intent_cnt                      --  '营销管理模块意向客户数'\\n,tt2.deposit_cust_cnt                    --  '下定客户数'\\n,tt3.sign_cust_cnt                       --  '签约客户数'\\n,tt1.apply_member_cnt                    --  '预申请会籍数量'\\n,tt2.deposit_member_cnt                  --  '下定会籍数量'\\n,tt2.deposit_room_cnt                    --  '下定房间数量'\\n,tt3.sign_member_cnt                     --  '签约会籍数量'\\n,tt3.sign_room_cnt                       --  '签约房间数量'\\n,tt2.deposit_amount                      -- '下定额'\\n,tt3.sales_amount                        -- '销售额'\\n,split(getSet2(concat(if(tt1.apply_date is null,'',tt1.apply_date),',',if(tt2.deposit_date is null,'',tt2.deposit_date),',',if(tt3.sign_date is null,'',tt3.sign_date),',',if(tt4.regist_date is null,'',tt4.regist_date),',','')),',')[1]  as data_date\\nfrom \\n(select \\na.sub_org_id\\n,a.channel_id\\n,a.apply_date  \\n,count(distinct pre_membership_id)     as apply_member_cnt \\nfrom \\n(\\nselect \\npre_membership_id                      --  '会籍id'\\n,trade_channel_ids                  --  '渠道id'\\n,sub_org_id                         --  '养老机构id'\\n,apply_time                       --  '申请时间'\\n,channel_id\\n,from_unixtime( cast(t.apply_time as int),'yyyy-MM-dd')  as apply_date    -- '申请日期'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nlateral view explode(split(trade_channel_ids,',')) l1 as  channel_id\\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n) a \\ngroup by a.sub_org_id,a.channel_id,a.apply_date\\n) tt1\\nfull join \\n(select \\na.sub_org_id\\n,a.channel_id\\n,a.deposit_date\\n,count(distinct intention_customer_id)  as deposit_cust_cnt   \\n,count(distinct membership_id)     as deposit_member_cnt\\n,count(distinct room_id)     as deposit_room_cnt\\n,sum(deposit_amount)         as deposit_amount   \\nfrom \\n(\\nselect \\nintention_customer_id              --  '意向客户id'\\n,membership_id                      --  '会籍id'\\n,room_id\\n,trade_channel_ids                  --  '渠道id'\\n,sub_org_id                         --  '养老机构id'\\n,deposit_time                       --  '下定时间'\\n,deposit_amount                     --  '定金金额'\\n,channel_id\\n,from_unixtime( cast(t.deposit_time as int),'yyyy-MM-dd')  as deposit_date    -- '下定日期'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nlateral view explode(split(trade_channel_ids,',')) l1 as  channel_id\\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n) a \\ngroup by a.sub_org_id,a.channel_id,a.deposit_date\\n) tt2\\non tt1.sub_org_id=tt2.sub_org_id and tt1.channel_id=tt2.channel_id and tt1.apply_date=tt2.deposit_date\\nfull join \\n(select \\na.sub_org_id\\n,a.channel_id\\n,a.sign_date\\n,count(distinct intention_customer_id)  as sign_cust_cnt   \\n,count(distinct membership_id)     as sign_member_cnt\\n,count(distinct room_id)     as sign_room_cnt\\n,sum(receivable_amount)         as sales_amount   \\nfrom \\n(\\nselect \\nintention_customer_id              --  '意向客户id'\\n,membership_id                      --  '会籍id'\\n,room_id\\n,trade_channel_ids                  --  '渠道id'\\n,sub_org_id                         --  '养老机构id'\\n,sign_time                       --  '签约时间'\\n,receivable_amount                     --  '应收金额'\\n,channel_id\\n,from_unixtime( cast(t.sign_time as int),'yyyy-MM-dd')  as sign_date    -- '签约日期'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nlateral view explode(split(trade_channel_ids,',')) l1 as  channel_id\\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n) a \\ngroup by a.sub_org_id,a.channel_id,a.sign_date\\n) tt3\\non tt1.sub_org_id=tt3.sub_org_id and tt1.channel_id=tt3.channel_id and tt1.apply_date=tt3.sign_date\\nfull join \\n(select \\na.sub_org_id\\n,a.channel_id\\n,a.regist_date  \\n,count(distinct intention_customer_id)     as crm_intent_cnt \\nfrom \\n(\\nselect \\nintention_customer_id              --  '意向客户id'\\n,trade_channel_ids                  --  '渠道id'\\n,sub_org_id                         --  '养老机构id'\\n,regist_time                       --  '录入时间'\\n,channel_id\\n,from_unixtime( cast(t.regist_time as int),'yyyy-MM-dd')  as regist_date    -- '申请日期'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nlateral view explode(split(trade_channel_ids,',')) l1 as  channel_id\\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n) a \\ngroup by a.sub_org_id,a.channel_id,a.regist_date\\n) tt4\\non tt1.sub_org_id=tt4.sub_org_id and tt1.channel_id=tt4.channel_id and tt1.apply_date=tt4.regist_date\",\"udfs\":\"14\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_market_by_channel_d_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-50210\",\"name\":\"drop_clife_hr_dws_market_by_channel_d_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_market_by_channel_d_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_channel_f\"]},{\"type\":\"SQL\",\"id\":\"tasks-18848\",\"name\":\"clife_hr_dws_market_by_channel_d\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_channel_d partition(part_date)\\nselect \\na.channel_id                         --   '渠道id'\\n,a.sub_org_id                         --   '养老机构id'\\n,b.sub_org_name                       --   '养老机构名称'\\n,b.org_id                             --   '养老集团id'\\n,b.org_name                           --   '养老集团名称'\\n,d.area_id                            --   '区域id'\\n,d.area_name                          --   '区域名称'\\n,c.trade_channel_name                       --   '渠道名称'\\n,c.channel_type                        --   '渠道类型'\\n,c.channel_type_name                  --   '渠道类型名称'\\n,a.crm_intent_cnt                     --   '营销管理模块意向客户数'\\n,a.deposit_cust_cnt                   --   '下定客户数'\\n,a.sign_cust_cnt                      --   '签约客户数'\\n,a.apply_member_cnt                   --   '预申请会籍数量'\\n,a.deposit_member_cnt                 --   '下定会籍数量'\\n,a.deposit_room_cnt                   --   '下定房间数量'\\n,a.sign_member_cnt                    --   '签约会籍数量'\\n,a.sign_room_cnt                      --   '签约房间数量'\\n,a.deposit_amount                     --  '下定额'\\n,a.sales_amount                       --  '销售额'\\n,a.data_date\\n,regexp_replace(date_sub(current_date(),1),'-','')  part_date\\nfrom \\ndb_dw_hr.clife_hr_dws_market_by_channel_d_tmp a \\nleft join \\ndb_dw_hr.clife_hr_dim_admin_sub_org b\\non a.sub_org_id=b.sub_org_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_trade_channel c \\non a.channel_id=c.id  and c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_geographic_info d \\non concat(substr(b.city,1,5),b.area,'0000')=d.area_id\\nand d.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_channel_d_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-60591\",\"name\":\"clife_hr_dws_market_by_channel_m_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table db_dw_hr.clife_hr_dws_market_by_channel_m_tmp stored as parquet as \\nselect\\nsplit(getSet2(concat(if(tt1.channel_id is null,'',tt1.channel_id),',',if(tt2.channel_id is null,'',tt2.channel_id),',',if(tt3.channel_id is null,'',tt3.channel_id),',',if(tt4.channel_id is null,'',tt4.channel_id),',','')),',')[1]  as channel_id                          --  '渠道id'\\n,split(getSet2(concat(if(tt1.sub_org_id is null,'',tt1.sub_org_id),',',if(tt2.sub_org_id is null,'',tt2.sub_org_id),',',if(tt3.sub_org_id is null,'',tt3.sub_org_id),',',if(tt4.sub_org_id is null,'',tt4.sub_org_id),',','')),',')[1]  as sub_org_id                           --  '养老机构id'\\n,tt4.crm_intent_cnt                      --  '营销管理模块意向客户数'\\n,tt2.deposit_cust_cnt                    --  '下定客户数'\\n,tt3.sign_cust_cnt                       --  '签约客户数'\\n,tt1.apply_member_cnt                    --  '预申请会籍数量'\\n,tt2.deposit_member_cnt                  --  '下定会籍数量'\\n,tt2.deposit_room_cnt                    --  '下定房间数量'\\n,tt3.sign_member_cnt                     --  '签约会籍数量'\\n,tt3.sign_room_cnt                       --  '签约房间数量'\\n,tt2.deposit_amount                      -- '下定额'\\n,tt3.sales_amount                        -- '销售额'\\n,split(getSet2(concat(if(tt1.apply_month is null,'',tt1.apply_month),',',if(tt2.deposit_month is null,'',tt2.deposit_month),',',if(tt3.sign_month is null,'',tt3.sign_month),',',if(tt4.regist_month is null,'',tt4.regist_month),',','')),',')[1]  as data_month\\nfrom \\n(select \\na.sub_org_id\\n,a.channel_id\\n,a.apply_month  \\n,count(distinct pre_membership_id)     as apply_member_cnt \\nfrom \\n(\\nselect \\npre_membership_id                      --  '会籍id'\\n,trade_channel_ids                  --  '渠道id'\\n,sub_org_id                         --  '养老机构id'\\n,apply_time                       --  '申请时间'\\n,channel_id\\n,from_unixtime( cast(t.apply_time as int),'yyyy-MM')  as apply_month    -- '申请日期'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nlateral view explode(split(trade_channel_ids,',')) l1 as  channel_id\\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n) a \\ngroup by a.sub_org_id,a.channel_id,a.apply_month\\n) tt1\\nfull join \\n(select \\na.sub_org_id\\n,a.channel_id\\n,a.deposit_month\\n,count(distinct intention_customer_id)  as deposit_cust_cnt   \\n,count(distinct membership_id)     as deposit_member_cnt\\n,count(distinct room_id)     as deposit_room_cnt\\n,sum(deposit_amount)         as deposit_amount   \\nfrom \\n(\\nselect \\nintention_customer_id              --  '意向客户id'\\n,membership_id                      --  '会籍id'\\n,room_id\\n,trade_channel_ids                  --  '渠道id'\\n,sub_org_id                         --  '养老机构id'\\n,deposit_time                       --  '下定时间'\\n,deposit_amount                     --  '定金金额'\\n,channel_id\\n,from_unixtime( cast(t.deposit_time as int),'yyyy-MM')  as deposit_month    -- '下定日期'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nlateral view explode(split(trade_channel_ids,',')) l1 as  channel_id\\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n) a \\ngroup by a.sub_org_id,a.channel_id,a.deposit_month\\n) tt2\\non tt1.sub_org_id=tt2.sub_org_id and tt1.channel_id=tt2.channel_id and tt1.apply_month=tt2.deposit_month\\nfull join \\n(select \\na.sub_org_id\\n,a.channel_id\\n,a.sign_month\\n,count(distinct intention_customer_id)  as sign_cust_cnt   \\n,count(distinct membership_id)     as sign_member_cnt\\n,count(distinct room_id)     as sign_room_cnt\\n,sum(receivable_amount)         as sales_amount   \\nfrom \\n(\\nselect \\nintention_customer_id              --  '意向客户id'\\n,membership_id                      --  '会籍id'\\n,room_id\\n,trade_channel_ids                  --  '渠道id'\\n,sub_org_id                         --  '养老机构id'\\n,sign_time                       --  '签约时间'\\n,receivable_amount                     --  '应收金额'\\n,channel_id\\n,from_unixtime( cast(t.sign_time as int),'yyyy-MM')  as sign_month    -- '签约日期'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nlateral view explode(split(trade_channel_ids,',')) l1 as  channel_id\\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n) a \\ngroup by a.sub_org_id,a.channel_id,a.sign_month\\n) tt3\\non tt1.sub_org_id=tt3.sub_org_id and tt1.channel_id=tt3.channel_id and tt1.apply_month=tt3.sign_month\\nfull join \\n(select \\na.sub_org_id\\n,a.channel_id\\n,a.regist_month  \\n,count(distinct intention_customer_id)     as crm_intent_cnt \\nfrom \\n(\\nselect \\nintention_customer_id              --  '意向客户id'\\n,trade_channel_ids                  --  '渠道id'\\n,sub_org_id                         --  '养老机构id'\\n,regist_time                       --  '录入时间'\\n,channel_id\\n,from_unixtime( cast(t.regist_time as int),'yyyy-MM')  as regist_month    -- '申请日期'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nlateral view explode(split(trade_channel_ids,',')) l1 as  channel_id\\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n) a \\ngroup by a.sub_org_id,a.channel_id,a.regist_month\\n) tt4\\non tt1.sub_org_id=tt4.sub_org_id and tt1.channel_id=tt4.channel_id and tt1.apply_month=tt4.regist_month\",\"udfs\":\"14\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_market_by_channel_m_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-27447\",\"name\":\"drop_clife_hr_dws_market_by_channel_m_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_market_by_channel_m_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_channel_d\"]},{\"type\":\"SQL\",\"id\":\"tasks-84782\",\"name\":\"clife_hr_dws_market_by_channel_m\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_channel_m partition(part_date)\\nselect \\na.channel_id                         --   '渠道id'\\n,a.sub_org_id                         --   '养老机构id'\\n,b.sub_org_name                       --   '养老机构名称'\\n,b.org_id                             --   '养老集团id'\\n,b.org_name                           --   '养老集团名称'\\n,d.area_id                            --   '区域id'\\n,d.area_name                          --   '区域名称'\\n,c.trade_channel_name                       --   '渠道名称'\\n,c.channel_type                        --   '渠道类型'\\n,c.channel_type_name                  --   '渠道类型名称'\\n,a.crm_intent_cnt                     --   '营销管理模块意向客户数'\\n,a.deposit_cust_cnt                   --   '下定客户数'\\n,a.sign_cust_cnt                      --   '签约客户数'\\n,a.apply_member_cnt                   --   '预申请会籍数量'\\n,a.deposit_member_cnt                 --   '下定会籍数量'\\n,a.deposit_room_cnt                   --   '下定房间数量'\\n,a.sign_member_cnt                    --   '签约会籍数量'\\n,a.sign_room_cnt                      --   '签约房间数量'\\n,a.deposit_amount                     --  '下定额'\\n,a.sales_amount                       --  '销售额'\\n,a.data_month\\n,regexp_replace(date_sub(current_date(),1),'-','')  part_date\\nfrom \\ndb_dw_hr.clife_hr_dws_market_by_channel_m_tmp a \\nleft join \\ndb_dw_hr.clife_hr_dim_admin_sub_org b\\non a.sub_org_id=b.sub_org_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_trade_channel c \\non a.channel_id=c.id  and c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_geographic_info d \\non concat(substr(b.city,1,5),b.area,'0000')=d.area_id\\nand d.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_channel_m_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-95409\",\"name\":\"clife_hr_dws_market_by_adv_member_d_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table if not exists db_dw_hr.clife_hr_dws_market_by_adv_member_d_tmp stored as parquet as \\nselect\\nsplit(getSet2(concat(if(a1.membership_adviser_id is null,'',a1.membership_adviser_id),',',if(tt1.membership_adviser_id is null,'',tt1.membership_adviser_id),',',if(tt4.membership_adviser_id is null,'',tt4.membership_adviser_id),',',if(b1.membership_adviser_id is null,'',b1.membership_adviser_id),',',if(tt2.membership_adviser_id is null,'',tt2.membership_adviser_id),',',if(tt3.membership_adviser_id is null,'',tt3.membership_adviser_id),',',if(tt5.membership_adviser_id is null,'',tt5.membership_adviser_id),',',if(tt7.membership_adviser_id is null,'',tt7.membership_adviser_id),',','')),',')[1] as membership_adviser_id                          --   '会籍顾问id',\\n,split(getSet2(concat(if(a1.sub_org_id is null,'',a1.sub_org_id),',',if(tt1.sub_org_id is null,'',tt1.sub_org_id),',',if(tt4.sub_org_id is null,'',tt4.sub_org_id),',',if(b1.sub_org_id is null,'',b1.sub_org_id),',',if(tt2.sub_org_id is null,'',tt2.sub_org_id),',',if(tt3.sub_org_id is null,'',tt3.sub_org_id),',',if(tt5.sub_org_id is null,'',tt5.sub_org_id),',',if(tt7.sub_org_id is null,'',tt7.sub_org_id),',','')),',')[1] as sub_org_id                          --   '养老机构id',\\n,tt1.advisory_customer_cnt               --   '咨询客户数'\\n,a1.pension_intent_cnt                  --   '客户跟踪模块意向客户数'\\n,b1.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,tt2.deposit_cust_cnt                    --   '下定客户数'\\n,tt3.sign_cust_cnt                       --   '签约客户数'\\n,tt4.advisory_cust_visit_cnt             --   '咨询客户回访次数'\\n,tt4.pension_intent_visit_cnt as pension_intent_cust_visit_cnt       --   '客户跟踪模块意向客户回访次数'\\n,tt5.crm_intent_visit_cnt as crm_intent_cust_visit_cnt           --   '营销管理模块意向客户回访次数'\\n,tt5.deposit_cust_visit_cnt              --   '下定客户回访次数'\\n,tt5.sign_cust_visit_cnt                 --   '签约客户回访次数'\\n,tt4.avg_advisory_cust_visit_cnt         --   '咨询客户平均回访次数'\\n,tt4.avg_pension_intent_cust_visit_cnt   --   '客户跟踪模块意向客户平均回访次数'\\n,tt5.avg_crm_intent_cust_visit_cnt       --   '营销管理模块意向客户平均回访次数'\\n,tt5.avg_deposit_cust_visit_cnt          --   '下定客户平均回访次数'\\n,tt5.avg_sign_cust_visit_cnt             --   '签约客户平均回访次数'\\n,tt7.apply_member_cnt                    --   '预申请会籍数量'\\n,tt2.deposit_member_cnt                  --   '下定会籍数量'\\n,tt2.deposit_room_cnt                    --   '下定房间数量'\\n,tt3.sign_member_cnt                     --   '签约会籍数量'\\n,tt3.sign_room_cnt                       --   '签约房间数量'\\n,tt2.deposit_amount                      --   '下定额'\\n,tt3.sales_amount                        --   '销售额'\\n,split(getSet2(concat(if(a1.regist_date is null,'',a1.regist_date),',',if(tt1.adviser_date is null,'',tt1.adviser_date),',',if(tt4.visit_date is null,'',tt4.visit_date),',',if(b1.regist_date is null,'',b1.regist_date),',',if(tt2.deposit_date is null,'',tt2.deposit_date),',',if(tt3.sign_date is null,'',tt3.sign_date),',',if(tt5.visit_date is null,'',tt5.visit_date),',',if(tt7.apply_date is null,'',tt7.apply_date),',','')),',')[1]  as data_date                  -- 数据日期\\nfrom \\n(select\\na.sub_org_id\\n,membership_adviser_id\\n,a.regist_date\\n,count(distinct intention_customer_id)  as pension_intent_cnt    --'客户跟踪模块意向客户数',\\nfrom\\n(select \\nt.intention_customer_id\\n,t.membership_adviser_id\\n,t.sub_org_id                         --  '养老机构id'\\n,t.sub_org_name                       --  '养老机构名称'\\n,t.org_id                             --  '集团id'\\n,t.org_name                           --  '集团名称'\\n,t.area_id                            --  '区域id'\\n,t.area_name\\n,from_unixtime( cast(t.regist_time as int),'yyyy-MM-dd') as regist_date                        -- '意向客户录入日期'\\nfrom db_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0\\n) a\\ngroup by a.sub_org_id,a.membership_adviser_id,a.regist_date)  a1\\nfull join \\n(select\\na.sub_org_id\\n,a.membership_adviser_id\\n,a.adviser_date\\n,count(distinct advisory_customer_id)  as advisory_customer_cnt    --'咨询客户数',\\nfrom \\n(select \\nt.advisory_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,t.membership_adviser_id\\n,from_unixtime( cast(t.adviser_time as int),'yyyy-MM-dd') as adviser_date                        -- '意向客户录入日期'\\n,case when t.intention_customer_id is not null then visit_cnt else 0 end intention_visit_cnt\\nfrom db_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0\\n) a\\ngroup by a.sub_org_id,a.membership_adviser_id,a.adviser_date)  tt1\\non a1.sub_org_id=tt1.sub_org_id and a1.membership_adviser_id=tt1.membership_adviser_id and a1.regist_date=tt1.adviser_date\\nfull join \\n(\\nselect\\naa4.sub_org_id\\n,aa4.membership_adviser_id\\n,aa4.visit_date\\n,count(distinct intention_customer_id)  int_cnt\\n,count(distinct advisory_customer_id)   adv_cnt\\n,sum(int_visit_cnt)  as pension_intent_visit_cnt\\n,sum(adv_visit_cnt)  as advisory_cust_visit_cnt\\n,sum(int_visit_cnt)/count(distinct intention_customer_id)   as avg_pension_intent_cust_visit_cnt\\n,sum(adv_visit_cnt)/count(distinct advisory_customer_id)  as avg_advisory_cust_visit_cnt\\nfrom \\n(\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,t.membership_adviser_id\\n,visit_time2\\n,substr(visit_time2,1,10) as visit_date                         -- 列开的回访时间\\n,t.visit_time\\n,t.advisory_customer_id\\n,case when t.visit_time is not null and visit_time2 is not null and t.intention_customer_id is not null then 1 else 0 end int_visit_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.advisory_customer_id is not null then 1 else 0 end adv_visit_cnt\\nfrom db_dw_hr.clife_hr_dwd_market t \\nlateral view explode(split(visit_time,',')) l1 as visit_time2\\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0\\n)  aa4 \\ngroup by aa4.sub_org_id,aa4.membership_adviser_id,aa4.visit_date\\n)  tt4\\non a1.sub_org_id=tt4.sub_org_id and a1.membership_adviser_id=tt4.membership_adviser_id and a1.regist_date=tt4.visit_date\\nfull join \\n(\\n select\\n t1.sub_org_id\\n,t1.regist_date\\n,t1.membership_adviser_id\\n,count(distinct intention_customer_id)  as crm_intent_cnt    --'营销管理模块意向客户数',\\n from \\n(\\nselect \\n b.intention_customer_id\\n,b.sub_org_id\\n,b.membership_adviser_id\\n,from_unixtime( cast(regist_time as int),'yyyy-MM-dd')  as regist_date\\nfrom \\n(\\nselect \\n t.intention_customer_id\\n,max(t.membership_adviser_id) membership_adviser_id\\n,max(t.sub_org_id) sub_org_id                     \\n,max(t.regist_time)   as regist_time\\nfrom\\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\ngroup by t.intention_customer_id\\n) b\\n) t1\\ngroup by t1.sub_org_id,t1.membership_adviser_id,t1.regist_date) b1 \\non a1.sub_org_id=b1.sub_org_id  and a1.membership_adviser_id=b1.membership_adviser_id and a1.regist_date=b1.regist_date\\nfull join \\n(\\nselect \\naa2.sub_org_id\\n,aa2.membership_adviser_id\\n,aa2.deposit_date\\n,count(distinct intention_customer_id) as deposit_cust_cnt  -- '下定客户数'\\n,sum(deposit_amount)    deposit_amount         --     '下定额'\\n,count(distinct membership_id)   as deposit_member_cnt\\n,count(distinct room_id)         as deposit_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,membership_adviser_id\\n,deposit_amount             --     '下定额'\\n,from_unixtime( cast(deposit_time as int),'yyyy-MM-dd')  as deposit_date \\n,t.membership_id\\n,t.room_id\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa2\\ngroup by aa2.sub_org_id,aa2.membership_adviser_id,aa2.deposit_date\\n)  tt2\\non a1.sub_org_id=tt2.sub_org_id and a1.membership_adviser_id=tt2.membership_adviser_id and a1.regist_date=tt2.deposit_date\\nfull join \\n(\\nselect \\naa3.sub_org_id\\n,aa3.sign_date\\n,aa3.membership_adviser_id\\n,count(distinct intention_customer_id) as sign_cust_cnt  -- '签约客户数'\\n,sum(receivable_amount) sales_amount            --  '销售金额'\\n,sum(received_amount)   received_amount            --  '已收金额'\\n,count(distinct membership_id)   as sign_member_cnt\\n,count(distinct room_id)         as sign_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,membership_adviser_id\\n,t.membership_id\\n,t.room_id\\n,from_unixtime( cast(sign_time as int),'yyyy-MM-dd')  as sign_date\\n,receivable_amount             --  '应收金额'\\n,received_amount               --  '已收金额'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa3\\ngroup by aa3.sub_org_id,aa3.membership_adviser_id,aa3.sign_date\\n)  tt3\\non a1.sub_org_id=tt3.sub_org_id  and a1.membership_adviser_id=tt3.membership_adviser_id and a1.regist_date=tt3.sign_date\\nfull join \\n(\\nselect\\naa5.sub_org_id\\n,aa5.visit_date\\n,aa5.membership_adviser_id\\n,count(distinct intention_customer_id)  int_cnt\\n,count(visit_time2)  as crm_intent_visit_cnt\\n,count(visit_time2) /count(distinct intention_customer_id)   as avg_crm_intent_cust_visit_cnt\\n,count(distinct deposit_visit_cust_cnt)  deposit_cust_visit_cnt\\n,sum(deposit_visit_cnt)  as deposit_visit_cnt\\n,sum(deposit_visit_cnt)/count(distinct deposit_visit_cust_cnt)   as avg_deposit_cust_visit_cnt\\n,count(distinct sign_visit_cust_cnt)  sign_cust_visit_cnt\\n,sum(sign_visit_cnt)  as sign_visit_cnt\\n,sum(sign_visit_cnt)/count(distinct sign_visit_cust_cnt)   as avg_sign_cust_visit_cnt\\nfrom \\n(   -- 回访过程\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,t.membership_adviser_id\\n,visit_time2\\n,substr(visit_time2,1,10) as visit_date                         -- 列开的回访时间\\n,t.visit_time\\n,case when t.visit_time is not null and visit_time2 is not null and t.deposit_time_list is not null then 1 else 0 end deposit_visit_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.sign_time_list is not null then 1 else 0 end sign_visit_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.deposit_time_list is not null then intention_customer_id else null end deposit_visit_cust_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.sign_time_list is not null then intention_customer_id else null end sign_visit_cust_cnt\\nfrom db_dw_hr.clife_hr_customer_crm_visit_base_info_tmp t \\nlateral view explode(split(visit_time,',')) l1 as visit_time2\\n)  aa5 \\ngroup by aa5.sub_org_id,aa5.membership_adviser_id,aa5.visit_date\\n)  tt5\\non a1.sub_org_id=tt5.sub_org_id and a1.membership_adviser_id=tt5.membership_adviser_id and a1.regist_date=tt5.visit_date\\nfull join\\n(\\nselect\\naa7.sub_org_id\\n,aa7.apply_date\\n,aa7.membership_adviser_id\\n,count(distinct pre_membership_id) as apply_member_cnt\\n  from\\n(\\nselect \\nt.pre_membership_id\\n,t.sub_org_id\\n,t.membership_adviser_id\\n,from_unixtime( cast(t.apply_time as int),'yyyy-MM-dd')  apply_date\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa7\\ngroup by aa7.sub_org_id,aa7.membership_adviser_id,aa7.apply_date\\n) tt7\\non a1.sub_org_id=tt7.sub_org_id and a1.membership_adviser_id=tt7.membership_adviser_id and a1.regist_date=tt7.apply_date\",\"udfs\":\"14\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_market_by_adv_member_d_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-91762\",\"name\":\"drop_clife_hr_dws_market_by_adv_member_d_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_market_by_adv_member_d_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_adv_member_f\"]},{\"type\":\"SQL\",\"id\":\"tasks-56748\",\"name\":\"clife_hr_dws_market_by_adv_member_d\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_adv_member_d partition(part_date)\\nselect\\na.membership_adviser_id                --   '会籍顾问id'\\n,a.sub_org_id                          --   '养老机构id'\\n,b.sub_org_name                        --   '养老机构名称'\\n,b.org_id                              --   '养老集团id'\\n,b.org_name                            --   '养老集团名称'\\n,d.area_id                             --   '区域id'\\n,d.area_name                           --   '区域名称'\\n,c.worker_name   as membership_adviser_name     -- '会籍顾问名称'\\n,a.advisory_customer_cnt               --   '咨询客户数'\\n,a.pension_intent_cnt                  --   '客户跟踪模块意向客户数'\\n,a.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,a.deposit_cust_cnt                    --   '下定客户数'\\n,a.sign_cust_cnt                       --   '签约客户数'\\n,a.advisory_cust_visit_cnt             --   '咨询客户回访次数'\\n,a.pension_intent_cust_visit_cnt       --   '客户跟踪模块意向客户回访次数'\\n,a.crm_intent_cust_visit_cnt           --   '营销管理模块意向客户回访次数'\\n,a.deposit_cust_visit_cnt              --   '下定客户回访次数'\\n,a.sign_cust_visit_cnt                 --   '签约客户回访次数'\\n,a.avg_advisory_cust_visit_cnt         --   '咨询客户平均回访次数'\\n,a.avg_pension_intent_cust_visit_cnt   --   '客户跟踪模块意向客户平均回访次数'\\n,a.avg_crm_intent_cust_visit_cnt       --   '营销管理模块意向客户平均回访次数'\\n,a.avg_deposit_cust_visit_cnt          --   '下定客户平均回访次数'\\n,a.avg_sign_cust_visit_cnt             --   '签约客户平均回访次数'\\n,a.apply_member_cnt                    --   '预申请会籍数量'\\n,a.deposit_member_cnt                  --   '下定会籍数量'\\n,a.deposit_room_cnt                    --   '下定房间数量'\\n,a.sign_member_cnt                     --   '签约会籍数量'\\n,a.sign_room_cnt                       --   '签约房间数量'\\n,a.deposit_amount                      --  '下定额'\\n,a.sales_amount                        --  '销售额'\\n,a.data_date                           --   '数据日期'\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom \\ndb_dw_hr.clife_hr_dws_market_by_adv_member_d_tmp a \\nleft join \\ndb_dw_hr.clife_hr_dim_admin_sub_org b\\non a.sub_org_id=b.sub_org_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_worker_new c\\non a.membership_adviser_id=c.nurse_worker_id and c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_geographic_info d \\non concat(substr(b.city,1,5),b.area,'0000')=d.area_id\\nand d.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_adv_member_d_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-67054\",\"name\":\"clife_hr_dws_market_by_adv_member_m_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table if not exists db_dw_hr.clife_hr_dws_market_by_adv_member_m_tmp stored as parquet as \\nselect\\nsplit(getSet2(concat(if(a1.membership_adviser_id is null,'',a1.membership_adviser_id),',',if(tt1.membership_adviser_id is null,'',tt1.membership_adviser_id),',',if(tt4.membership_adviser_id is null,'',tt4.membership_adviser_id),',',if(b1.membership_adviser_id is null,'',b1.membership_adviser_id),',',if(tt2.membership_adviser_id is null,'',tt2.membership_adviser_id),',',if(tt3.membership_adviser_id is null,'',tt3.membership_adviser_id),',',if(tt5.membership_adviser_id is null,'',tt5.membership_adviser_id),',',if(tt7.membership_adviser_id is null,'',tt7.membership_adviser_id),',','')),',')[1] as membership_adviser_id                          --   '会籍顾问id',\\n,split(getSet2(concat(if(a1.sub_org_id is null,'',a1.sub_org_id),',',if(tt1.sub_org_id is null,'',tt1.sub_org_id),',',if(tt4.sub_org_id is null,'',tt4.sub_org_id),',',if(b1.sub_org_id is null,'',b1.sub_org_id),',',if(tt2.sub_org_id is null,'',tt2.sub_org_id),',',if(tt3.sub_org_id is null,'',tt3.sub_org_id),',',if(tt5.sub_org_id is null,'',tt5.sub_org_id),',',if(tt7.sub_org_id is null,'',tt7.sub_org_id),',','')),',')[1] as sub_org_id                          --   '养老机构id',\\n,tt1.advisory_customer_cnt               --   '咨询客户数'\\n,a1.pension_intent_cnt                  --   '客户跟踪模块意向客户数'\\n,b1.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,tt2.deposit_cust_cnt                    --   '下定客户数'\\n,tt3.sign_cust_cnt                       --   '签约客户数'\\n,tt4.advisory_cust_visit_cnt             --   '咨询客户回访次数'\\n,tt4.pension_intent_visit_cnt as pension_intent_cust_visit_cnt       --   '客户跟踪模块意向客户回访次数'\\n,tt5.crm_intent_visit_cnt as crm_intent_cust_visit_cnt           --   '营销管理模块意向客户回访次数'\\n,tt5.deposit_cust_visit_cnt              --   '下定客户回访次数'\\n,tt5.sign_cust_visit_cnt                 --   '签约客户回访次数'\\n,tt4.avg_advisory_cust_visit_cnt         --   '咨询客户平均回访次数'\\n,tt4.avg_pension_intent_cust_visit_cnt   --   '客户跟踪模块意向客户平均回访次数'\\n,tt5.avg_crm_intent_cust_visit_cnt       --   '营销管理模块意向客户平均回访次数'\\n,tt5.avg_deposit_cust_visit_cnt          --   '下定客户平均回访次数'\\n,tt5.avg_sign_cust_visit_cnt             --   '签约客户平均回访次数'\\n,tt7.apply_member_cnt                    --   '预申请会籍数量'\\n,tt2.deposit_member_cnt                  --   '下定会籍数量'\\n,tt2.deposit_room_cnt                    --   '下定房间数量'\\n,tt3.sign_member_cnt                     --   '签约会籍数量'\\n,tt3.sign_room_cnt                       --   '签约房间数量'\\n,tt2.deposit_amount                      --   '下定额'\\n,tt3.sales_amount                        --   '销售额'\\n,split(getSet2(concat(if(a1.regist_month is null,'',a1.regist_month),',',if(tt1.adviser_month is null,'',tt1.adviser_month),',',if(tt4.visit_month is null,'',tt4.visit_month),',',if(b1.regist_month is null,'',b1.regist_month),',',if(tt2.deposit_month is null,'',tt2.deposit_month),',',if(tt3.sign_month is null,'',tt3.sign_month),',',if(tt5.visit_month is null,'',tt5.visit_month),',',if(tt7.apply_month is null,'',tt7.apply_month),',','')),',')[1]  as data_month                  -- 数据日期\\nfrom \\n(select\\na.sub_org_id\\n,membership_adviser_id\\n,a.regist_month\\n,count(distinct intention_customer_id)  as pension_intent_cnt    --'客户跟踪模块意向客户数',\\nfrom\\n(select \\nt.intention_customer_id\\n,t.membership_adviser_id\\n,t.sub_org_id                         --  '养老机构id'\\n,t.sub_org_name                       --  '养老机构名称'\\n,t.org_id                             --  '集团id'\\n,t.org_name                           --  '集团名称'\\n,t.area_id                            --  '区域id'\\n,t.area_name\\n,from_unixtime( cast(t.regist_time as int),'yyyy-MM') as regist_month                        -- '意向客户录入日期'\\nfrom db_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0\\n) a\\ngroup by a.sub_org_id,a.membership_adviser_id,a.regist_month)  a1\\nfull join \\n(select\\na.sub_org_id\\n,a.membership_adviser_id\\n,a.adviser_month\\n,count(distinct advisory_customer_id)  as advisory_customer_cnt    --'咨询客户数',\\nfrom \\n(select \\nt.advisory_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,t.membership_adviser_id\\n,from_unixtime( cast(t.adviser_time as int),'yyyy-MM') as adviser_month                        -- '意向客户录入日期'\\n,case when t.intention_customer_id is not null then visit_cnt else 0 end intention_visit_cnt\\nfrom db_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0\\n) a\\ngroup by a.sub_org_id,a.membership_adviser_id,a.adviser_month)  tt1\\non a1.sub_org_id=tt1.sub_org_id and a1.membership_adviser_id=tt1.membership_adviser_id and a1.regist_month=tt1.adviser_month\\nfull join \\n(\\nselect\\naa4.sub_org_id\\n,aa4.membership_adviser_id\\n,aa4.visit_month\\n,count(distinct intention_customer_id)  int_cnt\\n,count(distinct advisory_customer_id)   adv_cnt\\n,sum(int_visit_cnt)  as pension_intent_visit_cnt\\n,sum(adv_visit_cnt)  as advisory_cust_visit_cnt\\n,sum(int_visit_cnt)/count(distinct intention_customer_id)   as avg_pension_intent_cust_visit_cnt\\n,sum(adv_visit_cnt)/count(distinct advisory_customer_id)  as avg_advisory_cust_visit_cnt\\nfrom \\n(\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,t.membership_adviser_id\\n,visit_time2\\n,substr(visit_time2,1,7) as visit_month                         -- 列开的回访时间\\n,t.visit_time\\n,t.advisory_customer_id\\n,case when t.visit_time is not null and visit_time2 is not null and t.intention_customer_id is not null then 1 else 0 end int_visit_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.advisory_customer_id is not null then 1 else 0 end adv_visit_cnt\\nfrom db_dw_hr.clife_hr_dwd_market t \\nlateral view explode(split(visit_time,',')) l1 as visit_time2\\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0\\n)  aa4 \\ngroup by aa4.sub_org_id,aa4.membership_adviser_id,aa4.visit_month\\n)  tt4\\non a1.sub_org_id=tt4.sub_org_id and a1.membership_adviser_id=tt4.membership_adviser_id and a1.regist_month=tt4.visit_month\\nfull join \\n(\\n select\\n t1.sub_org_id\\n,t1.regist_month\\n,t1.membership_adviser_id\\n,count(distinct intention_customer_id)  as crm_intent_cnt    --'营销管理模块意向客户数',\\n from \\n(\\nselect \\n b.intention_customer_id\\n,b.sub_org_id\\n,b.membership_adviser_id\\n,from_unixtime( cast(regist_time as int),'yyyy-MM')  as regist_month\\nfrom \\n(\\nselect \\n t.intention_customer_id\\n,max(t.membership_adviser_id) membership_adviser_id\\n,max(t.sub_org_id) sub_org_id                     \\n,max(t.regist_time)   as regist_time\\nfrom\\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\ngroup by t.intention_customer_id\\n) b\\n) t1\\ngroup by t1.sub_org_id,t1.membership_adviser_id,t1.regist_month) b1 \\non a1.sub_org_id=b1.sub_org_id  and a1.membership_adviser_id=b1.membership_adviser_id and a1.regist_month=b1.regist_month\\nfull join \\n(\\nselect \\naa2.sub_org_id\\n,aa2.membership_adviser_id\\n,aa2.deposit_month\\n,count(distinct intention_customer_id) as deposit_cust_cnt  -- '下定客户数'\\n,sum(deposit_amount)    deposit_amount         --     '下定额'\\n,count(distinct membership_id)   as deposit_member_cnt\\n,count(distinct room_id)         as deposit_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,membership_adviser_id\\n,deposit_amount             --     '下定额'\\n,from_unixtime( cast(deposit_time as int),'yyyy-MM')  as deposit_month \\n,t.membership_id\\n,t.room_id\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa2\\ngroup by aa2.sub_org_id,aa2.membership_adviser_id,aa2.deposit_month\\n)  tt2\\non a1.sub_org_id=tt2.sub_org_id and a1.membership_adviser_id=tt2.membership_adviser_id and a1.regist_month=tt2.deposit_month\\nfull join \\n(\\nselect \\naa3.sub_org_id\\n,aa3.sign_month\\n,aa3.membership_adviser_id\\n,count(distinct intention_customer_id) as sign_cust_cnt  -- '签约客户数'\\n,sum(receivable_amount) sales_amount            --  '销售金额'\\n,sum(received_amount)   received_amount            --  '已收金额'\\n,count(distinct membership_id)   as sign_member_cnt\\n,count(distinct room_id)         as sign_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,membership_adviser_id\\n,t.membership_id\\n,t.room_id\\n,from_unixtime( cast(sign_time as int),'yyyy-MM')  as sign_month\\n,receivable_amount             --  '应收金额'\\n,received_amount               --  '已收金额'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa3\\ngroup by aa3.sub_org_id,aa3.membership_adviser_id,aa3.sign_month\\n)  tt3\\non a1.sub_org_id=tt3.sub_org_id  and a1.membership_adviser_id=tt3.membership_adviser_id and a1.regist_month=tt3.sign_month\\nfull join \\n(\\nselect\\naa5.sub_org_id\\n,aa5.visit_month\\n,aa5.membership_adviser_id\\n,count(distinct intention_customer_id)  int_cnt\\n,count(visit_time2)  as crm_intent_visit_cnt\\n,count(visit_time2) /count(distinct intention_customer_id)   as avg_crm_intent_cust_visit_cnt\\n,count(distinct deposit_visit_cust_cnt)  deposit_cust_visit_cnt\\n,sum(deposit_visit_cnt)  as deposit_visit_cnt\\n,sum(deposit_visit_cnt)/count(distinct deposit_visit_cust_cnt)   as avg_deposit_cust_visit_cnt\\n,count(distinct sign_visit_cust_cnt)  sign_cust_visit_cnt\\n,sum(sign_visit_cnt)  as sign_visit_cnt\\n,sum(sign_visit_cnt)/count(distinct sign_visit_cust_cnt)   as avg_sign_cust_visit_cnt\\nfrom \\n(   -- 回访过程\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,t.membership_adviser_id\\n,visit_time2\\n,substr(visit_time2,1,7) as visit_month                         -- 列开的回访时间\\n,t.visit_time\\n,case when t.visit_time is not null and visit_time2 is not null and t.deposit_time_list is not null then 1 else 0 end deposit_visit_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.sign_time_list is not null then 1 else 0 end sign_visit_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.deposit_time_list is not null then intention_customer_id else null end deposit_visit_cust_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.sign_time_list is not null then intention_customer_id else null end sign_visit_cust_cnt\\nfrom db_dw_hr.clife_hr_customer_crm_visit_base_info_tmp t \\nlateral view explode(split(visit_time,',')) l1 as visit_time2\\n)  aa5 \\ngroup by aa5.sub_org_id,aa5.membership_adviser_id,aa5.visit_month\\n)  tt5\\non a1.sub_org_id=tt5.sub_org_id and a1.membership_adviser_id=tt5.membership_adviser_id and a1.regist_month=tt5.visit_month\\nfull join\\n(\\nselect\\naa7.sub_org_id\\n,aa7.apply_month\\n,aa7.membership_adviser_id\\n,count(distinct pre_membership_id) as apply_member_cnt\\n  from\\n(\\nselect \\nt.pre_membership_id\\n,t.sub_org_id\\n,t.membership_adviser_id\\n,from_unixtime( cast(t.apply_time as int),'yyyy-MM')  apply_month\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa7\\ngroup by aa7.sub_org_id,aa7.membership_adviser_id,aa7.apply_month\\n) tt7\\non a1.sub_org_id=tt7.sub_org_id and a1.membership_adviser_id=tt7.membership_adviser_id and a1.regist_month=tt7.apply_month\",\"udfs\":\"14\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_market_by_adv_member_m_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-38397\",\"name\":\"drop_clife_hr_dws_market_by_adv_member_m_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_market_by_adv_member_m_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_adv_member_d\"]},{\"type\":\"SQL\",\"id\":\"tasks-99738\",\"name\":\"clife_hr_dws_market_by_adv_member_m\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_adv_member_m partition(part_date)\\nselect\\na.membership_adviser_id                --   '会籍顾问id'\\n,a.sub_org_id                          --   '养老机构id'\\n,b.sub_org_name                        --   '养老机构名称'\\n,b.org_id                              --   '养老集团id'\\n,b.org_name                            --   '养老集团名称'\\n,d.area_id                             --   '区域id'\\n,d.area_name                           --   '区域名称'\\n,c.worker_name   as membership_adviser_name     -- '会籍顾问名称'\\n,a.advisory_customer_cnt               --   '咨询客户数'\\n,a.pension_intent_cnt                  --   '客户跟踪模块意向客户数'\\n,a.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,a.deposit_cust_cnt                    --   '下定客户数'\\n,a.sign_cust_cnt                       --   '签约客户数'\\n,a.advisory_cust_visit_cnt             --   '咨询客户回访次数'\\n,a.pension_intent_cust_visit_cnt       --   '客户跟踪模块意向客户回访次数'\\n,a.crm_intent_cust_visit_cnt           --   '营销管理模块意向客户回访次数'\\n,a.deposit_cust_visit_cnt              --   '下定客户回访次数'\\n,a.sign_cust_visit_cnt                 --   '签约客户回访次数'\\n,a.avg_advisory_cust_visit_cnt         --   '咨询客户平均回访次数'\\n,a.avg_pension_intent_cust_visit_cnt   --   '客户跟踪模块意向客户平均回访次数'\\n,a.avg_crm_intent_cust_visit_cnt       --   '营销管理模块意向客户平均回访次数'\\n,a.avg_deposit_cust_visit_cnt          --   '下定客户平均回访次数'\\n,a.avg_sign_cust_visit_cnt             --   '签约客户平均回访次数'\\n,a.apply_member_cnt                    --   '预申请会籍数量'\\n,a.deposit_member_cnt                  --   '下定会籍数量'\\n,a.deposit_room_cnt                    --   '下定房间数量'\\n,a.sign_member_cnt                     --   '签约会籍数量'\\n,a.sign_room_cnt                       --   '签约房间数量'\\n,a.deposit_amount                      --  '下定额'\\n,a.sales_amount                        --  '销售额'\\n,a.data_month                           --   '数据日期'\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom \\ndb_dw_hr.clife_hr_dws_market_by_adv_member_m_tmp a \\nleft join \\ndb_dw_hr.clife_hr_dim_admin_sub_org b\\non a.sub_org_id=b.sub_org_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_worker_new c\\non a.membership_adviser_id=c.nurse_worker_id and c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_geographic_info d \\non concat(substr(b.city,1,5),b.area,'0000')=d.area_id\\nand d.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_adv_member_m_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-74043\",\"name\":\"clife_hr_dws_market_by_adv_member_y_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table if not exists db_dw_hr.clife_hr_dws_market_by_adv_member_y_tmp stored as parquet as \\nselect\\nsplit(getSet2(concat(if(a1.membership_adviser_id is null,'',a1.membership_adviser_id),',',if(tt1.membership_adviser_id is null,'',tt1.membership_adviser_id),',',if(tt4.membership_adviser_id is null,'',tt4.membership_adviser_id),',',if(b1.membership_adviser_id is null,'',b1.membership_adviser_id),',',if(tt2.membership_adviser_id is null,'',tt2.membership_adviser_id),',',if(tt3.membership_adviser_id is null,'',tt3.membership_adviser_id),',',if(tt5.membership_adviser_id is null,'',tt5.membership_adviser_id),',',if(tt7.membership_adviser_id is null,'',tt7.membership_adviser_id),',','')),',')[1] as membership_adviser_id                          --   '会籍顾问id',\\n,split(getSet2(concat(if(a1.sub_org_id is null,'',a1.sub_org_id),',',if(tt1.sub_org_id is null,'',tt1.sub_org_id),',',if(tt4.sub_org_id is null,'',tt4.sub_org_id),',',if(b1.sub_org_id is null,'',b1.sub_org_id),',',if(tt2.sub_org_id is null,'',tt2.sub_org_id),',',if(tt3.sub_org_id is null,'',tt3.sub_org_id),',',if(tt5.sub_org_id is null,'',tt5.sub_org_id),',',if(tt7.sub_org_id is null,'',tt7.sub_org_id),',','')),',')[1] as sub_org_id                          --   '养老机构id',\\n,tt1.advisory_customer_cnt               --   '咨询客户数'\\n,a1.pension_intent_cnt                  --   '客户跟踪模块意向客户数'\\n,b1.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,tt2.deposit_cust_cnt                    --   '下定客户数'\\n,tt3.sign_cust_cnt                       --   '签约客户数'\\n,tt4.advisory_cust_visit_cnt             --   '咨询客户回访次数'\\n,tt4.pension_intent_visit_cnt as pension_intent_cust_visit_cnt       --   '客户跟踪模块意向客户回访次数'\\n,tt5.crm_intent_visit_cnt as crm_intent_cust_visit_cnt           --   '营销管理模块意向客户回访次数'\\n,tt5.deposit_cust_visit_cnt              --   '下定客户回访次数'\\n,tt5.sign_cust_visit_cnt                 --   '签约客户回访次数'\\n,tt4.avg_advisory_cust_visit_cnt         --   '咨询客户平均回访次数'\\n,tt4.avg_pension_intent_cust_visit_cnt   --   '客户跟踪模块意向客户平均回访次数'\\n,tt5.avg_crm_intent_cust_visit_cnt       --   '营销管理模块意向客户平均回访次数'\\n,tt5.avg_deposit_cust_visit_cnt          --   '下定客户平均回访次数'\\n,tt5.avg_sign_cust_visit_cnt             --   '签约客户平均回访次数'\\n,tt7.apply_member_cnt                    --   '预申请会籍数量'\\n,tt2.deposit_member_cnt                  --   '下定会籍数量'\\n,tt2.deposit_room_cnt                    --   '下定房间数量'\\n,tt3.sign_member_cnt                     --   '签约会籍数量'\\n,tt3.sign_room_cnt                       --   '签约房间数量'\\n,tt2.deposit_amount                      --   '下定额'\\n,tt3.sales_amount                        --   '销售额'\\n,split(getSet2(concat(if(a1.regist_year is null,'',a1.regist_year),',',if(tt1.adviser_year is null,'',tt1.adviser_year),',',if(tt4.visit_year is null,'',tt4.visit_year),',',if(b1.regist_year is null,'',b1.regist_year),',',if(tt2.deposit_year is null,'',tt2.deposit_year),',',if(tt3.sign_year is null,'',tt3.sign_year),',',if(tt5.visit_year is null,'',tt5.visit_year),',',if(tt7.apply_year is null,'',tt7.apply_year),',','')),',')[1]  as data_year                  -- 数据日期\\nfrom \\n(select\\na.sub_org_id\\n,membership_adviser_id\\n,a.regist_year\\n,count(distinct intention_customer_id)  as pension_intent_cnt    --'客户跟踪模块意向客户数',\\nfrom\\n(select \\nt.intention_customer_id\\n,t.membership_adviser_id\\n,t.sub_org_id                         --  '养老机构id'\\n,t.sub_org_name                       --  '养老机构名称'\\n,t.org_id                             --  '集团id'\\n,t.org_name                           --  '集团名称'\\n,t.area_id                            --  '区域id'\\n,t.area_name\\n,from_unixtime( cast(t.regist_time as int),'yyyy') as regist_year                        -- '意向客户录入日期'\\nfrom db_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0\\n) a\\ngroup by a.sub_org_id,a.membership_adviser_id,a.regist_year)  a1\\nfull join \\n(select\\na.sub_org_id\\n,a.membership_adviser_id\\n,a.adviser_year\\n,count(distinct advisory_customer_id)  as advisory_customer_cnt    --'咨询客户数',\\nfrom \\n(select \\nt.advisory_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,t.membership_adviser_id\\n,from_unixtime( cast(t.adviser_time as int),'yyyy') as adviser_year                        -- '意向客户录入日期'\\n,case when t.intention_customer_id is not null then visit_cnt else 0 end intention_visit_cnt\\nfrom db_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0\\n) a\\ngroup by a.sub_org_id,a.membership_adviser_id,a.adviser_year)  tt1\\non a1.sub_org_id=tt1.sub_org_id and a1.membership_adviser_id=tt1.membership_adviser_id and a1.regist_year=tt1.adviser_year\\nfull join \\n(\\nselect\\naa4.sub_org_id\\n,aa4.membership_adviser_id\\n,aa4.visit_year\\n,count(distinct intention_customer_id)  int_cnt\\n,count(distinct advisory_customer_id)   adv_cnt\\n,sum(int_visit_cnt)  as pension_intent_visit_cnt\\n,sum(adv_visit_cnt)  as advisory_cust_visit_cnt\\n,sum(int_visit_cnt)/count(distinct intention_customer_id)   as avg_pension_intent_cust_visit_cnt\\n,sum(adv_visit_cnt)/count(distinct advisory_customer_id)  as avg_advisory_cust_visit_cnt\\nfrom \\n(\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,t.membership_adviser_id\\n,visit_time2\\n,substr(visit_time2,1,4) as visit_year                         -- 列开的回访时间\\n,t.visit_time\\n,t.advisory_customer_id\\n,case when t.visit_time is not null and visit_time2 is not null and t.intention_customer_id is not null then 1 else 0 end int_visit_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.advisory_customer_id is not null then 1 else 0 end adv_visit_cnt\\nfrom db_dw_hr.clife_hr_dwd_market t \\nlateral view explode(split(visit_time,',')) l1 as visit_time2\\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0\\n)  aa4 \\ngroup by aa4.sub_org_id,aa4.membership_adviser_id,aa4.visit_year\\n)  tt4\\non a1.sub_org_id=tt4.sub_org_id and a1.membership_adviser_id=tt4.membership_adviser_id and a1.regist_year=tt4.visit_year\\nfull join \\n(\\n select\\n t1.sub_org_id\\n,t1.regist_year\\n,t1.membership_adviser_id\\n,count(distinct intention_customer_id)  as crm_intent_cnt    --'营销管理模块意向客户数',\\n from \\n(\\nselect \\n b.intention_customer_id\\n,b.sub_org_id\\n,b.membership_adviser_id\\n,from_unixtime( cast(regist_time as int),'yyyy')  as regist_year\\nfrom \\n(\\nselect \\n t.intention_customer_id\\n,max(t.membership_adviser_id) membership_adviser_id\\n,max(t.sub_org_id) sub_org_id                     \\n,max(t.regist_time)   as regist_time\\nfrom\\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\ngroup by t.intention_customer_id\\n) b\\n) t1\\ngroup by t1.sub_org_id,t1.membership_adviser_id,t1.regist_year) b1 \\non a1.sub_org_id=b1.sub_org_id  and a1.membership_adviser_id=b1.membership_adviser_id and a1.regist_year=b1.regist_year\\nfull join \\n(\\nselect \\naa2.sub_org_id\\n,aa2.membership_adviser_id\\n,aa2.deposit_year\\n,count(distinct intention_customer_id) as deposit_cust_cnt  -- '下定客户数'\\n,sum(deposit_amount)    deposit_amount         --     '下定额'\\n,count(distinct membership_id)   as deposit_member_cnt\\n,count(distinct room_id)         as deposit_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,membership_adviser_id\\n,deposit_amount             --     '下定额'\\n,from_unixtime( cast(deposit_time as int),'yyyy')  as deposit_year \\n,t.membership_id\\n,t.room_id\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa2\\ngroup by aa2.sub_org_id,aa2.membership_adviser_id,aa2.deposit_year\\n)  tt2\\non a1.sub_org_id=tt2.sub_org_id and a1.membership_adviser_id=tt2.membership_adviser_id and a1.regist_year=tt2.deposit_year\\nfull join \\n(\\nselect \\naa3.sub_org_id\\n,aa3.sign_year\\n,aa3.membership_adviser_id\\n,count(distinct intention_customer_id) as sign_cust_cnt  -- '签约客户数'\\n,sum(receivable_amount) sales_amount            --  '销售金额'\\n,sum(received_amount)   received_amount            --  '已收金额'\\n,count(distinct membership_id)   as sign_member_cnt\\n,count(distinct room_id)         as sign_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,membership_adviser_id\\n,t.membership_id\\n,t.room_id\\n,from_unixtime( cast(sign_time as int),'yyyy')  as sign_year\\n,receivable_amount             --  '应收金额'\\n,received_amount               --  '已收金额'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa3\\ngroup by aa3.sub_org_id,aa3.membership_adviser_id,aa3.sign_year\\n)  tt3\\non a1.sub_org_id=tt3.sub_org_id  and a1.membership_adviser_id=tt3.membership_adviser_id and a1.regist_year=tt3.sign_year\\nfull join \\n(\\nselect\\naa5.sub_org_id\\n,aa5.visit_year\\n,aa5.membership_adviser_id\\n,count(distinct intention_customer_id)  int_cnt\\n,count(visit_time2)  as crm_intent_visit_cnt\\n,count(visit_time2) /count(distinct intention_customer_id)   as avg_crm_intent_cust_visit_cnt\\n,count(distinct deposit_visit_cust_cnt)  deposit_cust_visit_cnt\\n,sum(deposit_visit_cnt)  as deposit_visit_cnt\\n,sum(deposit_visit_cnt)/count(distinct deposit_visit_cust_cnt)   as avg_deposit_cust_visit_cnt\\n,count(distinct sign_visit_cust_cnt)  sign_cust_visit_cnt\\n,sum(sign_visit_cnt)  as sign_visit_cnt\\n,sum(sign_visit_cnt)/count(distinct sign_visit_cust_cnt)   as avg_sign_cust_visit_cnt\\nfrom \\n(   -- 回访过程\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,t.membership_adviser_id\\n,visit_time2\\n,substr(visit_time2,1,4) as visit_year                         -- 列开的回访时间\\n,t.visit_time\\n,case when t.visit_time is not null and visit_time2 is not null and t.deposit_time_list is not null then 1 else 0 end deposit_visit_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.sign_time_list is not null then 1 else 0 end sign_visit_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.deposit_time_list is not null then intention_customer_id else null end deposit_visit_cust_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.sign_time_list is not null then intention_customer_id else null end sign_visit_cust_cnt\\nfrom db_dw_hr.clife_hr_customer_crm_visit_base_info_tmp t \\nlateral view explode(split(visit_time,',')) l1 as visit_time2\\n)  aa5 \\ngroup by aa5.sub_org_id,aa5.membership_adviser_id,aa5.visit_year\\n)  tt5\\non a1.sub_org_id=tt5.sub_org_id and a1.membership_adviser_id=tt5.membership_adviser_id and a1.regist_year=tt5.visit_year\\nfull join\\n(\\nselect\\naa7.sub_org_id\\n,aa7.apply_year\\n,aa7.membership_adviser_id\\n,count(distinct pre_membership_id) as apply_member_cnt\\n  from\\n(\\nselect \\nt.pre_membership_id\\n,t.sub_org_id\\n,t.membership_adviser_id\\n,from_unixtime( cast(t.apply_time as int),'yyyy')  apply_year\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa7\\ngroup by aa7.sub_org_id,aa7.membership_adviser_id,aa7.apply_year\\n) tt7\\non a1.sub_org_id=tt7.sub_org_id and a1.membership_adviser_id=tt7.membership_adviser_id and a1.regist_year=tt7.apply_year\",\"udfs\":\"14\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_market_by_adv_member_y_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-75049\",\"name\":\"drop_clife_hr_dws_market_by_adv_member_y_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_market_by_adv_member_y_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_adv_member_m\"]},{\"type\":\"SQL\",\"id\":\"tasks-66049\",\"name\":\"clife_hr_dws_market_by_adv_member_y\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_adv_member_y partition(part_date)\\nselect\\na.membership_adviser_id                --   '会籍顾问id'\\n,a.sub_org_id                          --   '养老机构id'\\n,b.sub_org_name                        --   '养老机构名称'\\n,b.org_id                              --   '养老集团id'\\n,b.org_name                            --   '养老集团名称'\\n,d.area_id                             --   '区域id'\\n,d.area_name                           --   '区域名称'\\n,c.worker_name   as membership_adviser_name     -- '会籍顾问名称'\\n,a.advisory_customer_cnt               --   '咨询客户数'\\n,a.pension_intent_cnt                  --   '客户跟踪模块意向客户数'\\n,a.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,a.deposit_cust_cnt                    --   '下定客户数'\\n,a.sign_cust_cnt                       --   '签约客户数'\\n,a.advisory_cust_visit_cnt             --   '咨询客户回访次数'\\n,a.pension_intent_cust_visit_cnt       --   '客户跟踪模块意向客户回访次数'\\n,a.crm_intent_cust_visit_cnt           --   '营销管理模块意向客户回访次数'\\n,a.deposit_cust_visit_cnt              --   '下定客户回访次数'\\n,a.sign_cust_visit_cnt                 --   '签约客户回访次数'\\n,a.avg_advisory_cust_visit_cnt         --   '咨询客户平均回访次数'\\n,a.avg_pension_intent_cust_visit_cnt   --   '客户跟踪模块意向客户平均回访次数'\\n,a.avg_crm_intent_cust_visit_cnt       --   '营销管理模块意向客户平均回访次数'\\n,a.avg_deposit_cust_visit_cnt          --   '下定客户平均回访次数'\\n,a.avg_sign_cust_visit_cnt             --   '签约客户平均回访次数'\\n,a.apply_member_cnt                    --   '预申请会籍数量'\\n,a.deposit_member_cnt                  --   '下定会籍数量'\\n,a.deposit_room_cnt                    --   '下定房间数量'\\n,a.sign_member_cnt                     --   '签约会籍数量'\\n,a.sign_room_cnt                       --   '签约房间数量'\\n,a.deposit_amount                      --  '下定额'\\n,a.sales_amount                        --  '销售额'\\n,a.data_year                           --   '数据日期'\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom \\ndb_dw_hr.clife_hr_dws_market_by_adv_member_y_tmp a \\nleft join \\ndb_dw_hr.clife_hr_dim_admin_sub_org b\\non a.sub_org_id=b.sub_org_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_worker_new c\\non a.membership_adviser_id=c.nurse_worker_id and c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_geographic_info d \\non concat(substr(b.city,1,5),b.area,'0000')=d.area_id\\nand d.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_adv_member_y_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-56289\",\"name\":\"clife_hr_dws_crm_cust_building_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table db_dw_hr.clife_hr_dws_crm_cust_building_info_tmp stored as parquet as \\nselect \\n t.intention_customer_id\\n,max(t.sub_org_id )  sub_org_id                      --  '养老机构id'\\n,max(t.sub_org_name)   sub_org_name                    --  '养老机构名称'\\n,max(t.org_id)      org_id                      --  '集团id'\\n,max(t.org_name)    org_name                       --  '集团名称'\\n,max(t.area_id)     area_id                       --  '区域id'\\n,max(t.area_name)   area_name                       --  '区域名称'\\n,max(t.visit_cnt)   visit_cnt                       --  '回访次数'\\n,max(t.first_intention_type)    first_intention_type           --  '首次意向'\\n,max(t.intention_type)          intention_type           --  '当前意向' \\n,max(t.assess_cnt)    assess_cnt     \\n,max(t.regist_time)   regist_time               \\n,concat_ws(',',collect_list(from_unixtime( cast(t.deposit_time as int),'yyyy-MM-dd  HH:mm:ss')))   as deposit_time      -- '下定时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.sign_time as int),'yyyy-MM-dd  HH:mm:ss')))  as sign_time       -- '签约时间集合'\\n,concat_ws(',',collect_set(cast(building_id as string)))  as building_ids       -- '楼栋ids'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\ngroup by t.intention_customer_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_crm_cust_building_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-27310\",\"name\":\"drop_clife_hr_dws_crm_cust_building_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_crm_cust_building_info_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_adv_member_y\"]},{\"type\":\"SQL\",\"id\":\"tasks-4419\",\"name\":\"clife_hr_dws_crm_member_building_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table db_dw_hr.clife_hr_dws_crm_member_building_info_tmp stored as parquet as \\nselect \\n t.membership_id  \\n,max(t.sub_org_id )  sub_org_id                      --  '养老机构id'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.apply_time as int),'yyyy-MM-dd  HH:mm:ss')))   as apply_time      -- '预申请时间集合' \\n,concat_ws(',',collect_list(from_unixtime( cast(t.deposit_time as int),'yyyy-MM-dd  HH:mm:ss')))   as deposit_time      -- '下定时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.sign_time as int),'yyyy-MM-dd  HH:mm:ss')))  as sign_time       -- '签约时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.transfor_to_time as int),'yyyy-MM-dd  HH:mm:ss')))  as transfer_to_time       -- '转让时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.transfor_from_time as int),'yyyy-MM-dd  HH:mm:ss')))  as transfer_from_time       -- '继承时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.withdraw_time as int),'yyyy-MM-dd  HH:mm:ss')))  as withdraw_time       -- '退会时间集合'\\n,concat_ws(',',collect_set(cast(building_id as string)))  as building_ids       -- '楼栋ids'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\ngroup by t.membership_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_crm_member_building_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-57976\",\"name\":\"drop_clife_hr_dws_crm_member_building_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_crm_member_building_info_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_crm_cust_building_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-29712\",\"name\":\"clife_hr_dws_market_by_building_f\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_building_f partition(part_date)\\nselect\\nb1.building_id as building_id      --'楼栋'\\n,b1.sub_org_id as sub_org_id                          --   '养老机构id',\\n,b1.sub_org_name as sub_org_name                        --   '养老机构名称'\\n,b1.org_id as org_id                              --   '养老集团id'\\n,b1.org_id as org_name                            --   '养老集团名称'\\n,b1.area_id as area_id                             --   '区域id'\\n,b1.area_name as area_name                           --   '区域名称'\\n,b1.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,b1.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,b1.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,b1.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,b1.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,b1.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,b1.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,b1.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,b1.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,b1.deposit_cust_cnt                    --   '下定客户数'\\n,b1.sign_cust_cnt                       --   '签约客户数'\\n,c1.transfer_to_member_cnt              --   '转让会籍数'\\n,c1.transfer_from_member_cnt            --   '继承会籍数'\\n,c1.withdraw_member_cnt                 --   '退会会籍数'\\n,b1.crm_intent_cust_visit_cnt           --   '营销管理模块意向客户回访次数'\\n,b1.deposit_cust_visit_cnt              --   '下定客户回访次数'\\n,b1.sign_cust_vist_cnt as sign_cust_visit_cnt                 --   '签约客户回访次数'\\n,b1.avg_crm_intent_cust_visit_cnt       --   '营销管理模块意向客户平均回访次数'\\n,b1.avg_deposit_cust_visit_cnt          --   '下定客户平均回访次数'\\n,b1.avg_sign_cust_visit_cnt             --   '签约客户平均回访次数'\\n,c1.apply_member_cnt                    --   '预申请会籍数量'\\n,c1.deposit_member_cnt                  --   '下定会籍数量'\\n,d1.deposit_room_cnt                    --   '下定房间数量'\\n,c1.sign_member_cnt                     --   '签约会籍数量'\\n,d1.sign_room_cnt                       --   '签约房间数量'\\n,e1.deposit_amount                      --   '下定额'\\n,e1.sales_amount                        --   '销售额'\\n,e1.card_pay_amount                     --\\t  '刷卡金额'\\n,e1.cash_pay_amount                     --   '现金金额'\\n,e1.weixin_pay_amount                   --   '微信支付金额'\\n,e1.alipay_amount                       --   '阿里支付金额'\\t\\n,e1.other_pay_amount                    --   '其他方式支付金额'\\n,e1.received_amount                     --   '已收金额'\\n,e1.received_installment_amount         --   '已收分期金额'\\n,e1.received_occupancy_amount           --   '已收占用费'\\n,e1.membership_amount                   --   '会籍费'\\n,e1.overdue_amount                      --   '滞纳金'\\n,e1.received_overdue_amount             --   '已收滞纳金'\\n,e1.other_amount                        --   '其他费用'\\n,e1.manager_amount                      --   '管理费'\\n,e1.trust_amount                        --   '托管费' \\n,e1.membership_discount_amount          --   '会籍优惠价' \\n,e1.card_amount                         --   '卡费'\\n,e1.card_manager_amount                 --   '卡管理费'\\n,e1.other_transfor_to_amount            --   '其他转让费' \\n,e1.transfor_to_amount                  --   '转让费'\\n,e1.other_transfor_from_amount          --   '其他继承费' \\n,e1.transfor_from_amount                --   '继承费'\\n,e1.withdraw_amount                     --   '退会金额' \\n,b1.assess_cust_cnt  as assess_cust_cnt                     --   '评估客户数'\\n,b1.assess_cnt  as assess_cnt                          --   '评估总次数'\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom \\n(\\n select\\n t1.sub_org_id\\n,t1.building_id\\n,max(t1.sub_org_name) sub_org_name\\n,max(t1.org_id)    org_id\\n,max(t1.org_name)    org_name\\n,max(t1.area_id)     area_id\\n,max(t1.area_name)   area_name\\n,sum(first_high_cnt)  as crm_first_intent_high_cnt  --'营销管理模块首次意向感兴趣客户数'\\n,sum(first_mid_cnt)   as crm_first_intent_mid_cnt   --'营销管理模块首次意向兴趣一般客户数'\\n,sum(first_low_cnt)   as crm_first_intent_low_cnt   --'营销管理模块首次意向不感兴趣客户数'\\n,sum(first_highest_cnt)  as crm_first_intent_highest_cnt  --'营销管理模块首次意向希望购买客户数'\\n,sum(high_cnt)     as crm_intent_high_cnt  --'营销管理模块意向感兴趣客户数'\\n,sum(mid_cnt)      as crm_intent_mid_cnt   --'营销管理模块意向兴趣一般客户数'\\n,sum(low_cnt)      as crm_intent_low_cnt   --'营销管理模块意向不感兴趣客户数'\\n,sum(highest_cnt)  as crm_intent_highest_cnt  --'营销管理模块意向希望购买客户数'\\n,count(distinct intention_customer_id)  as crm_intent_cnt    --'营销管理模块意向客户数',\\n,sum(t1.visit_cnt)   as crm_intent_cust_visit_cnt  -- '营销管理模块意向客户回访次数'\\n,sum(t1.visit_cnt)/count(distinct intention_customer_id)  as avg_crm_intent_cust_visit_cnt  --'营销管理模块意向客户平均回访次数'\\n,sum(deposit_cust_cnt) as deposit_cust_cnt   --'下定客户数'\\n,sum(sign_cust_cnt)  as sign_cust_cnt        --'签约客户数'\\n,sum(deposit_cust_visit_cnt)   as deposit_cust_visit_cnt  --'下定客户回访总次数'\\n,sum(sign_cust_vist_cnt)   as   sign_cust_vist_cnt    -- '签约客户回访总次数'\\n,sum(deposit_cust_visit_cnt)/sum(deposit_cust_cnt)  as avg_deposit_cust_visit_cnt  --'下定客户平均回访次数'\\n,sum(sign_cust_vist_cnt)/sum(sign_cust_cnt)  as avg_sign_cust_visit_cnt  --'签约客户平均回访次数'\\n,sum(assess_cnt) assess_cnt\\n,sum(assess_cust_cnt)  assess_cust_cnt\\n from \\n(\\nselect \\n b.intention_customer_id\\n,b.sub_org_id\\n,b.sub_org_name\\n,b.org_id\\n,b.org_name\\n,b.area_id\\n,b.area_name\\n,b.visit_cnt\\n,b.assess_cnt\\n,b.building_id\\n,case when b.first_intention_type=1 then 1 else 0 end as first_high_cnt\\n,case when b.first_intention_type=2 then 1 else 0 end as first_mid_cnt\\n,case when b.first_intention_type=3 then 1 else 0 end as first_low_cnt\\n,case when b.first_intention_type=4 then 1 else 0 end as first_highest_cnt\\n,case when b.intention_type=1 then 1 else 0 end as high_cnt\\n,case when b.intention_type=2 then 1 else 0 end as mid_cnt\\n,case when b.intention_type=3 then 1 else 0 end as low_cnt\\n,case when b.intention_type=4 then 1 else 0 end as highest_cnt\\n,case when b.deposit_time is not null then 1 else 0 end as deposit_cust_cnt\\n,case when b.sign_time is not null then b.visit_cnt else 0 end as sign_cust_cnt\\n,case when b.deposit_time is not null then b.visit_cnt else 0 end as deposit_cust_visit_cnt\\n,case when b.sign_time is not null then b.visit_cnt else 0 end as sign_cust_vist_cnt\\n,case when b.assess_cnt is not null then 1 else 0 end as assess_cust_cnt\\nfrom \\n(\\nselect \\n t.intention_customer_id\\n,t.sub_org_id                      --  '养老机构id'\\n,t.sub_org_name                    --  '养老机构名称'\\n,t.org_id                      --  '集团id'\\n,t.org_name                       --  '集团名称'\\n,t.area_id                       --  '区域id'\\n,t.area_name                       --  '区域名称'\\n,t.visit_cnt                       --  '回访次数'\\n,t.first_intention_type           --  '首次意向'\\n,t.intention_type           --  '当前意向' \\n,t.assess_cnt                       \\n,t.deposit_time      -- '下定时间集合'\\n,t.sign_time       -- '签约时间集合'\\n,l1.building_id \\nfrom db_dw_hr.clife_hr_dws_crm_cust_building_info_tmp t \\nlateral view explode(split(building_ids,','))   l1 as  building_id \\n) b\\n) t1\\ngroup by t1.sub_org_id,t1.building_id) b1 \\nfull join \\n(\\nselect\\nt1.sub_org_id\\n,t1.building_id\\n,sum(t1.apply_member_cnt)  apply_member_cnt\\n,sum(t1.deposit_member_cnt)  deposit_member_cnt\\n,sum(t1.sign_member_cnt)  sign_member_cnt\\n,sum(t1.transfer_to_member_cnt)   transfer_to_member_cnt\\n,sum(t1.transfer_from_member_cnt)  transfer_from_member_cnt\\n,sum(t1.withdraw_member_cnt)   withdraw_member_cnt\\nfrom \\n(\\nselect \\nc.membership_id\\n,c.sub_org_id\\n,c.building_id\\n,case when apply_time   is null then 1 else 0 end as apply_member_cnt\\n,case when deposit_time is null then 1 else 0 end as deposit_member_cnt\\n,case when sign_time   is null then 1 else 0 end as sign_member_cnt\\n,case when transfer_to_time is null then 1 else 0 end as transfer_to_member_cnt\\n,case when transfer_from_time is null then 1 else 0 end as transfer_from_member_cnt\\n,case when withdraw_time is null then 1 else 0 end as withdraw_member_cnt\\nfrom \\n(select \\n t.membership_id  \\n,t.sub_org_id                      --  '养老机构id'\\n,building_id\\n,apply_time      -- '预申请时间集合' \\n,deposit_time      -- '下定时间集合'\\n,sign_time       -- '签约时间集合'\\n,transfer_to_time       -- '转让时间集合'\\n,transfer_from_time       -- '继承时间集合'\\n,withdraw_time       -- '退会时间集合'\\nfrom \\ndb_dw_hr.clife_hr_dws_crm_member_building_info_tmp  t \\nlateral view explode(split(building_ids,','))   l1 as  building_id )  c\\n) t1\\ngroup by t1.sub_org_id,t1.building_id) c1\\non b1.sub_org_id=c1.sub_org_id  and b1.building_id=c1.building_id\\nleft join \\n(\\nselect\\nt1.sub_org_id\\n,t1.building_id\\n,sum(t1.deposit_room_cnt)  deposit_room_cnt\\n,sum(t1.sign_room_cnt)  sign_room_cnt\\nfrom \\n(\\nselect \\nc.room_id\\n,c.sub_org_id\\n,c.building_id\\n,case when deposit_time is null then 1 else 0 end as deposit_room_cnt\\n,case when sign_time   is null then 1 else 0 end as sign_room_cnt\\nfrom \\n(select \\n t.room_id  \\n,max(t.sub_org_id )  sub_org_id                      --  '养老机构id' \\n,t.building_id  building_id\\n,concat_ws(',',collect_list(from_unixtime( cast(t.deposit_time as int),'yyyy-MM-dd  HH:mm:ss')))   as deposit_time      -- '下定时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.sign_time as int),'yyyy-MM-dd  HH:mm:ss')))  as sign_time       -- '签约时间集合'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\ngroup by t.room_id,t.building_id)  c\\n) t1\\ngroup by t1.sub_org_id,t1.building_id) d1\\non b1.sub_org_id=d1.sub_org_id  and b1.building_id=d1.building_id\\nleft join \\n(select \\n sub_org_id\\n,building_id\\n,sum(deposit_amount)    deposit_amount         --     '下定额'\\n,sum(card_pay_amount)   card_pay_amount         --\\t    '刷卡金额'\\n,sum(cash_pay_amount)   cash_pay_amount         --     '现金金额'\\n,sum(weixin_pay_amount) weixin_pay_amount         --     '微信支付金额'\\n,sum(alipay_amount)     alipay_amount         --     '阿里支付金额'\\t\\n,sum(other_pay_amount)  other_pay_amount         --     '其他方式支付金额'\\n,sum(receivable_amount) sales_amount            --  '应收金额'\\n,sum(received_amount)   received_amount            --  '已收金额'\\n,sum(received_installment_amount) received_installment_amount    --  '已收分期金额'\\n,sum(received_occupancy_amount)   received_occupancy_amount    --  '已收占用费'\\n,sum(membership_amount)           membership_amount     --  '会籍费'\\n,sum(overdue_amount)              overdue_amount    --  '滞纳金'\\n,sum(received_overdue_amount)     received_overdue_amount    --  '已收滞纳金'\\n,sum(other_amount)                other_amount     --  '其他费用'\\n,sum(manager_amount)              manager_amount       --  '管理费'\\n,sum(trust_amount)                trust_amount      --  '托管费'\\n,sum(membership_discount_amount)  membership_discount_amount      --  '会籍优惠价'  \\n,sum(card_amount)                 card_amount        --  '卡费'\\n,sum(card_manager_amount)         card_manager_amount     --  '卡管理费'\\n,sum(other_transfor_to_amount)    other_transfor_to_amount     --  '其他转让费' \\n,sum(transfor_to_amount)          transfor_to_amount      --  '转让费'\\n,sum(other_transfor_from_amount)  other_transfor_from_amount    --  '其他继承费'\\n,sum(transfor_from_amount)        transfor_from_amount       --  '继承费'\\n,sum(withdraw_amount)             withdraw_amount        --  '退会金额'\\nfrom db_dw_hr.clife_hr_dwm_market where part_date= regexp_replace(date_sub(current_date(),1),'-','')\\ngroup by sub_org_id,building_id\\n) e1\\non b1.sub_org_id=e1.sub_org_id  and b1.building_id=e1.building_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_crm_member_building_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-37471\",\"name\":\"clife_hr_customer_crm_visit_building_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table if not exists db_dw_hr.clife_hr_customer_crm_visit_building_info_tmp stored as parquet as\\nselect \\n a.intention_customer_id --意向客户id\\n,max(a.name)        as name                     --客户姓名\\n,max(a.sex)     sex --性别\\n,max(a.intention_type)  as  intentional_type  --当前意向类型\\n,max(a.membership_adviser_id)  as membership_adviser_id   --会籍顾问id\\n,max(a.membership_adviser_name)  membership_adviser_name   --会籍顾问名称\\n,max(a.trade_channel_ids)   trade_channel_ids   --渠道id\\n,max(a.sub_org_id) sub_org_id\\n,max(a.first_intention_type) first_intention_type   -- 首次意向\\n,max(a.regist_time)     regist_time        --意向客户录入时间\\n,max(a.visit_time)      visit_time        --回访时间\\n,max(a.visit_cnt)       visit_cnt        --回访次数\\n,max(a.remind_visit_time)   remind_visit_time    --提醒回访时间\\n,max(a.assess_time)   assess_time         -- 评估时间\\n,concat_ws(',',collect_list(from_unixtime( cast(a.deposit_time as int),'yyyy-MM-dd  HH:mm:ss')))   as deposit_time_list      -- '下定时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(a.sign_time as int),'yyyy-MM-dd  HH:mm:ss')))  as sign_time_list       -- '签约时间集合'\\n,concat_ws(',',collect_list(cast(building_id as string)))  as building_ids       -- '楼栋ids'\\nfrom db_dw_hr.clife_hr_dwd_market a \\nwhere a.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\ngroup by a.intention_customer_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_customer_crm_visit_building_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-81839\",\"name\":\"drop_clife_hr_customer_crm_visit_building_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_customer_crm_visit_building_info_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_building_f\"]},{\"type\":\"SQL\",\"id\":\"tasks-18930\",\"name\":\"clife_hr_dws_market_by_building_d_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table if not exists db_dw_hr.clife_hr_dws_market_by_building_d_tmp stored as parquet as \\nselect\\nsplit(getSet2(concat(if(b1.building_id is null,'',b1.building_id),',',if(tt2.building_id is null,'',tt2.building_id),',',if(tt3.building_id is null,'',tt3.building_id),',',if(tt5.building_id is null,'',tt5.building_id),',',if(tt6.building_id is null,'',tt6.building_id),',',if(tt7.building_id is null,'',tt7.building_id),',',if(tt8.building_id is null,'',tt8.building_id),',',if(tt9.building_id is null,'',tt9.building_id),',',if(tt10.building_id is null,'',tt10.building_id),',','')),',')[1] as building_id\\n,split(getSet2(concat(if(b1.sub_org_id is null,'',b1.sub_org_id),',',if(tt2.sub_org_id is null,'',tt2.sub_org_id),',',if(tt3.sub_org_id is null,'',tt3.sub_org_id),',',if(tt5.sub_org_id is null,'',tt5.sub_org_id),',',if(tt6.sub_org_id is null,'',tt6.sub_org_id),',',if(tt7.sub_org_id is null,'',tt7.sub_org_id),',',if(tt8.sub_org_id is null,'',tt8.sub_org_id),',',if(tt9.sub_org_id is null,'',tt9.sub_org_id),',',if(tt10.sub_org_id is null,'',tt10.sub_org_id),',','')),',')[1] as sub_org_id                          --   '养老机构id',\\n,b1.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,b1.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,b1.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,b1.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,b1.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,b1.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,b1.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,b1.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,b1.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,tt2.deposit_cust_cnt                    --   '下定客户数'\\n,tt3.sign_cust_cnt                       --   '签约客户数'\\n,tt8.transfer_to_member_cnt              --   '转让会籍数'\\n,tt9.transfer_from_member_cnt            --   '继承会籍数'\\n,tt10.withdraw_member_cnt                 --   '退会会籍数'\\n,tt5.crm_intent_visit_cnt as crm_intent_cust_visit_cnt           --   '营销管理模块意向客户回访次数'\\n,tt5.deposit_cust_visit_cnt              --   '下定客户回访次数'\\n,tt5.sign_cust_visit_cnt                 --   '签约客户回访次数'\\n,tt5.avg_crm_intent_cust_visit_cnt       --   '营销管理模块意向客户平均回访次数'\\n,tt5.avg_deposit_cust_visit_cnt          --   '下定客户平均回访次数'\\n,tt5.avg_sign_cust_visit_cnt             --   '签约客户平均回访次数'\\n,tt7.apply_member_cnt                    --   '预申请会籍数量'\\n,tt2.deposit_member_cnt                  --   '下定会籍数量'\\n,tt2.deposit_room_cnt                    --   '下定房间数量'\\n,tt3.sign_member_cnt                     --   '签约会籍数量'\\n,tt3.sign_room_cnt                       --   '签约房间数量'\\n,tt2.deposit_amount                      --   '下定额'\\n,tt3.sales_amount                        --   '销售额'\\n,tt3.card_pay_amount                     --\\t  '刷卡金额'\\n,tt3.cash_pay_amount                     --   '现金金额'\\n,tt3.weixin_pay_amount                   --   '微信支付金额'\\n,tt3.alipay_amount                       --   '阿里支付金额'\\t\\n,tt3.other_pay_amount                    --   '其他方式支付金额'\\n,tt3.received_amount                     --   '已收金额'\\n,tt3.received_installment_amount         --   '已收分期金额'\\n,tt3.received_occupancy_amount           --   '已收占用费'\\n,tt3.membership_amount                   --   '会籍费'\\n,tt3.overdue_amount                      --   '滞纳金'\\n,tt3.received_overdue_amount             --   '已收滞纳金'\\n,tt3.other_amount                        --   '其他费用'\\n,tt3.manager_amount                      --   '管理费'\\n,tt3.trust_amount                        --   '托管费' \\n,tt3.membership_discount_amount          --   '会籍优惠价' \\n,tt3.card_amount                         --   '卡费'\\n,tt3.card_manager_amount                 --   '卡管理费'\\n,tt8.other_transfor_to_amount            --   '其他转让费' \\n,tt8.transfor_to_amount                  --   '转让费'\\n,tt9.other_transfer_from_amount          --   '其他继承费' \\n,tt9.transfer_from_amount                --   '继承费'\\n,tt10.withdraw_amount                     --   '退会金额' \\n,tt6.assess_cust_cnt  as assess_cust_cnt                     --   '评估客户数'\\n,tt6.assess_cnt  as assess_cnt                          --   '评估总次数'\\n,split(getSet2(concat(if(b1.regist_date is null,'',b1.regist_date),',',if(tt2.deposit_date is null,'',tt2.deposit_date),',',if(tt3.sign_date is null,'',tt3.sign_date),',',if(tt5.visit_date is null,'',tt5.visit_date),',',if(tt6.assess_date is null,'',tt6.assess_date),',',if(tt7.apply_date is null,'',tt7.apply_date),',',if(tt8.transfer_to_date is null,'',tt8.transfer_to_date),',',if(tt9.transfer_from_date is null,'',tt9.transfer_from_date),',',if(tt10.withdraw_date is null,'',tt10.withdraw_date),',','')),',')[1]  as data_date                  -- 数据日期\\nfrom  \\n(\\n select\\n t1.sub_org_id\\n,t1.building_id\\n,t1.regist_date\\n,sum(t1.first_high_cnt)  as crm_first_intent_high_cnt  --'营销管理模块首次意向感兴趣客户数'\\n,sum(t1.first_mid_cnt)   as crm_first_intent_mid_cnt   --'营销管理模块首次意向兴趣一般客户数'\\n,sum(t1.first_low_cnt)   as crm_first_intent_low_cnt   --'营销管理模块首次意向不感兴趣客户数'\\n,sum(t1.first_highest_cnt)  as crm_first_intent_highest_cnt  --'营销管理模块首次意向希望购买客户数'\\n,sum(t1.high_cnt)     as crm_intent_high_cnt  --'营销管理模块意向感兴趣客户数'\\n,sum(t1.mid_cnt)      as crm_intent_mid_cnt   --'营销管理模块意向兴趣一般客户数'\\n,sum(t1.low_cnt)      as crm_intent_low_cnt   --'营销管理模块意向不感兴趣客户数'\\n,sum(t1.highest_cnt)  as crm_intent_highest_cnt  --'营销管理模块意向希望购买客户数'\\n,count(distinct t1.intention_customer_id)  as crm_intent_cnt    --'营销管理模块意向客户数',\\n from \\n(\\nselect \\n b.intention_customer_id\\n,b.sub_org_id\\n,b.sub_org_name\\n,b.org_id\\n,b.org_name\\n,b.area_id\\n,b.area_name\\n,case when b.first_intention_type=1 then 1 else 0 end as first_high_cnt\\n,case when b.first_intention_type=2 then 1 else 0 end as first_mid_cnt\\n,case when b.first_intention_type=3 then 1 else 0 end as first_low_cnt\\n,case when b.first_intention_type=4 then 1 else 0 end as first_highest_cnt\\n,case when b.intention_type=1 then 1 else 0 end as high_cnt\\n,case when b.intention_type=2 then 1 else 0 end as mid_cnt\\n,case when b.intention_type=3 then 1 else 0 end as low_cnt\\n,case when b.intention_type=4 then 1 else 0 end as highest_cnt\\n,from_unixtime( cast(b.regist_time as int),'yyyy-MM-dd')  as regist_date\\n,l1.building_id\\nfrom \\ndb_dw_hr.clife_hr_dws_crm_cust_building_info_tmp b \\nlateral view explode(split(building_ids,',')) l1 as building_id\\n) as t1\\ngroup by t1.sub_org_id,t1.building_id,t1.regist_date) b1 \\nfull join \\n(\\nselect \\naa2.sub_org_id\\n,building_id\\n,aa2.deposit_date\\n,count(distinct intention_customer_id) as deposit_cust_cnt  -- '下定客户数'\\n,sum(deposit_amount)    deposit_amount         --     '下定额'\\n,count(distinct membership_id)   as deposit_member_cnt\\n,count(distinct room_id)         as deposit_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,building_id\\n,deposit_amount             --     '下定额'\\n,from_unixtime( cast(deposit_time as int),'yyyy-MM-dd')  as deposit_date \\n,t.membership_id\\n,t.room_id\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa2\\ngroup by aa2.sub_org_id,aa2.building_id,aa2.deposit_date\\n)  tt2\\non b1.sub_org_id=tt2.sub_org_id  and b1.building_id=tt2.building_id and b1.regist_date=tt2.deposit_date\\nfull join \\n(\\nselect \\naa3.sub_org_id\\n,aa3.sign_date\\n,aa3.building_id\\n,count(distinct intention_customer_id) as sign_cust_cnt  -- '下定客户数'\\n,sum(card_pay_amount)   card_pay_amount         --\\t    '刷卡金额'\\n,sum(cash_pay_amount)   cash_pay_amount         --     '现金金额'\\n,sum(weixin_pay_amount) weixin_pay_amount         --     '微信支付金额'\\n,sum(alipay_amount)     alipay_amount         --     '阿里支付金额'\\t\\n,sum(other_pay_amount)  other_pay_amount         --     '其他方式支付金额'\\n,sum(receivable_amount) sales_amount            --  '销售金额'\\n,sum(received_amount)   received_amount            --  '已收金额'\\n,sum(received_installment_amount) received_installment_amount    --  '已收分期金额'\\n,sum(received_occupancy_amount)   received_occupancy_amount    --  '已收占用费'\\n,sum(membership_amount)           membership_amount     --  '会籍费'\\n,sum(overdue_amount)              overdue_amount    --  '滞纳金'\\n,sum(received_overdue_amount)     received_overdue_amount    --  '已收滞纳金'\\n,sum(other_amount)                other_amount     --  '其他费用'\\n,sum(manager_amount)              manager_amount       --  '管理费'\\n,sum(trust_amount)                trust_amount      --  '托管费'\\n,sum(membership_discount_amount)  membership_discount_amount      --  '会籍优惠价'  \\n,sum(card_amount)                 card_amount        --  '卡费'\\n,sum(card_manager_amount)         card_manager_amount     --  '卡管理费'\\n,count(distinct membership_id)   as sign_member_cnt\\n,count(distinct room_id)         as sign_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,building_id\\n,t.membership_id\\n,t.room_id\\n,from_unixtime( cast(sign_time as int),'yyyy-MM-dd')  as sign_date\\n,case when pay_type_id=0 then received_amount else null end as  card_pay_amount            --\\t    '刷卡金额'\\n,case when pay_type_id=1 then received_amount else null end as  cash_pay_amount            --     '现金金额'\\n,case when pay_type_id=2 then received_amount else null end as  weixin_pay_amount          --     '微信支付金额'\\n,case when pay_type_id=3 then received_amount else null end as  alipay_amount              --     '阿里支付金额'\\t\\n,case when pay_type_id=4 then received_amount else null end as  other_pay_amount           --     '其他方式支付金额'\\n,receivable_amount             --  '应收金额'\\n,received_amount               --  '已收金额'\\n,received_installment_amount   --  '已收分期金额'\\n,received_occupancy_amount     --  '已收占用费'\\n,membership_amount             --  '会籍费'\\n,overdue_amount                --  '滞纳金'\\n,received_overdue_amount       --  '已收滞纳金'\\n,other_amount                  --  '其他费用'\\n,manager_amount                --  '管理费'\\n,trust_amount                  --  '托管费'\\n,membership_discount_amount    --  '会籍优惠价'  \\n,card_amount                   --  '卡费'\\n,card_manager_amount           --  '卡管理费' \\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa3\\ngroup by aa3.sub_org_id,aa3.building_id,aa3.sign_date\\n)  tt3\\non b1.sub_org_id=tt3.sub_org_id and b1.building_id=tt3.building_id and b1.regist_date=tt3.sign_date\\nfull join \\n(\\nselect\\naa5.sub_org_id\\n,aa5.building_id\\n,aa5.visit_date\\n,count(distinct intention_customer_id)  int_cnt\\n,count(visit_time2)  as crm_intent_visit_cnt\\n,count(visit_time2)/count(distinct intention_customer_id)   as avg_crm_intent_cust_visit_cnt\\n,count(distinct deposit_visit_cust_cnt)  deposit_cust_visit_cnt\\n,sum(deposit_visit_cnt)  as deposit_visit_cnt\\n,sum(deposit_visit_cnt)/count(distinct deposit_visit_cust_cnt)   as avg_deposit_cust_visit_cnt\\n,count(distinct sign_visit_cust_cnt)  sign_cust_visit_cnt\\n,sum(sign_visit_cnt)  as sign_visit_cnt\\n,sum(sign_visit_cnt)/count(distinct sign_visit_cust_cnt)   as avg_sign_cust_visit_cnt\\n  from \\n(   -- 回访过程\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,building_id\\n,visit_time2\\n,substr(visit_time2,1,10) as visit_date                         -- 列开的回访时间\\n,t.visit_time\\n,case when t.visit_time is not null and visit_time2 is not null and t.deposit_time_list is not null then 1 else 0 end deposit_visit_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.sign_time_list is not null then 1 else 0 end sign_visit_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.deposit_time_list is not null then intention_customer_id else null end deposit_visit_cust_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.sign_time_list is not null then intention_customer_id else null end sign_visit_cust_cnt\\nfrom db_dw_hr.clife_hr_customer_crm_visit_building_info_tmp t \\nlateral view explode(split(visit_time,',')) l1 as visit_time2\\nlateral view explode(split(building_ids,',')) l2 as building_id\\n)  aa5 \\ngroup by aa5.sub_org_id,aa5.building_id,aa5.visit_date\\n)  tt5\\non b1.sub_org_id=tt5.sub_org_id and b1.building_id=tt5.building_id and b1.regist_date=tt5.visit_date\\nfull join \\n(\\nselect \\naa6.sub_org_id\\n,aa6.building_id\\n,aa6.assess_date\\n,count(distinct intention_customer_id)  as assess_cust_cnt  --'发起评估客户数'\\n,count(assess_time2)           as   assess_cnt              --'评估次数'\\nfrom \\n(     --评估相关过程\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,building_id\\n,assess_time2\\n,substr(assess_time2,1,10) as assess_date                         -- 列开的发起评估时间\\nfrom db_dw_hr.clife_hr_customer_crm_visit_building_info_tmp t \\nlateral view explode(split(assess_time,',')) l1 as assess_time2\\nlateral view explode(split(building_ids,',')) l2 as building_id\\n)  aa6 \\ngroup by aa6.sub_org_id,aa6.building_id,aa6.assess_date\\n)  tt6\\non b1.sub_org_id=tt6.sub_org_id  and b1.building_id=tt6.building_id and b1.regist_date=tt6.assess_date\\nfull join \\n(\\nselect\\naa7.sub_org_id\\n,aa7.building_id\\n,aa7.apply_date\\n,count(distinct pre_membership_id) as apply_member_cnt\\n  from\\n(\\nselect \\nt.pre_membership_id\\n,t.sub_org_id\\n,t.building_id\\n,from_unixtime( cast(t.apply_time as int),'yyyy-MM-dd')  apply_date\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa7\\ngroup by aa7.sub_org_id,aa7.building_id,aa7.apply_date\\n) tt7\\non b1.sub_org_id=tt7.sub_org_id  and b1.building_id=tt7.building_id and b1.regist_date=tt7.apply_date\\nfull join \\n(\\nselect\\naa8.sub_org_id\\n,aa8.building_id\\n,aa8.transfer_to_date\\n,count(distinct membership_id) as transfer_to_member_cnt\\n,sum(other_transfor_to_amount)    other_transfor_to_amount     --  '其他转让费' \\n,sum(transfor_to_amount)          transfor_to_amount      --  '转让费'\\nfrom\\n(\\nselect \\nt.membership_id\\n,t.other_transfor_to_amount      --  '其他转让费' \\n,t.transfor_to_amount            --  '转让费'\\n,t.sub_org_id\\n,t.building_id\\n,from_unixtime( cast(t.transfor_to_time as int),'yyyy-MM-dd')  transfer_to_date\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa8\\ngroup by aa8.sub_org_id,aa8.building_id,aa8.transfer_to_date\\n) tt8\\non b1.sub_org_id=tt8.sub_org_id and b1.building_id=tt8.building_id and b1.regist_date=tt8.transfer_to_date\\nfull join \\n(\\nselect\\naa9.sub_org_id\\n,aa9.building_id\\n,aa9.transfer_from_date\\n,count(distinct membership_id) as transfer_from_member_cnt\\n,sum(other_transfer_from_amount)    other_transfer_from_amount     \\n,sum(transfer_from_amount)          transfer_from_amount\\n  from\\n(\\nselect \\nt.membership_id\\n,t.other_transfor_from_amount as other_transfer_from_amount       \\n,t.transfor_from_amount as transfer_from_amount           \\n,t.sub_org_id\\n,t.building_id\\n,from_unixtime( cast(t.transfor_from_time as int),'yyyy-MM-dd')  transfer_from_date\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa9\\ngroup by aa9.sub_org_id, aa9.building_id,aa9.transfer_from_date\\n) tt9\\non b1.sub_org_id=tt9.sub_org_id and b1.building_id=tt9.building_id and b1.regist_date=tt9.transfer_from_date\\nfull join \\n(\\nselect\\naa10.sub_org_id\\n,aa10.building_id\\n,aa10.withdraw_date\\n,count(distinct membership_id) as withdraw_member_cnt   \\n,sum(withdraw_amount)          withdraw_amount   \\n  from\\n(\\nselect \\nt.membership_id      \\n,t.withdraw_amount            \\n,t.sub_org_id\\n,t.building_id\\n,from_unixtime( cast(t.withdraw_time as int),'yyyy-MM-dd')  withdraw_date\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa10\\ngroup by aa10.sub_org_id,aa10.building_id,aa10.withdraw_date\\n) tt10\\non b1.sub_org_id=tt10.sub_org_id and b1.building_id=tt10.building_id and b1.regist_date=tt10.withdraw_date\",\"udfs\":\"14\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_market_by_building_d_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-5428\",\"name\":\"drop_clife_hr_dws_market_by_building_d_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_market_by_building_d_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_customer_crm_visit_building_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-24960\",\"name\":\"clife_hr_dws_market_by_building_d\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_building_d partition(part_date)\\nselect\\na.building_id\\n,a.sub_org_id                          --   '养老机构id'\\n,b.sub_org_name                        --   '养老机构名称'\\n,b.org_id                              --   '养老集团id'\\n,b.org_name                            --   '养老集团名称'\\n,c.area_id                             --   '区域id'\\n,c.area_name                           --   '区域名称'\\n,a.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,a.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,a.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,a.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,a.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,a.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,a.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,a.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,a.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,a.deposit_cust_cnt                    --   '下定客户数'\\n,a.sign_cust_cnt                       --   '签约客户数'\\n,a.transfer_to_member_cnt              --   '转让会籍数'\\n,a.transfer_from_member_cnt            --   '继承会籍数'\\n,a.withdraw_member_cnt                 --   '退会会籍数'\\n,a.crm_intent_cust_visit_cnt           --   '营销管理模块意向客户回访次数'\\n,a.deposit_cust_visit_cnt              --   '下定客户回访次数'\\n,a.sign_cust_visit_cnt                 --   '签约客户回访次数'\\n,a.avg_crm_intent_cust_visit_cnt       --   '营销管理模块意向客户平均回访次数'\\n,a.avg_deposit_cust_visit_cnt          --   '下定客户平均回访次数'\\n,a.avg_sign_cust_visit_cnt             --   '签约客户平均回访次数'\\n,a.apply_member_cnt                    --   '预申请会籍数量'\\n,a.deposit_member_cnt                  --   '下定会籍数量'\\n,a.deposit_room_cnt                    --   '下定房间数量'\\n,a.sign_member_cnt                     --   '签约会籍数量'\\n,a.sign_room_cnt                       --   '签约房间数量'\\n,a.deposit_amount                      --  '下定额'\\n,a.sales_amount                        --  '销售额'\\n,a.card_pay_amount                     --  '刷卡金额'\\n,a.cash_pay_amount                     --  '现金金额'\\n,a.weixin_pay_amount                   --  '微信支付金额'\\n,a.alipay_amount                       --  '阿里支付金额'\\t\\n,a.other_pay_amount                    --  '其他方式支付金额'\\n,a.received_amount                     --  '已收金额'\\n,a.other_transfor_to_amount            --  '其他转让费' \\n,a.transfor_to_amount                  --  '转让费' \\n,a.other_transfer_from_amount          --  '其他继承费' \\n,a.transfer_from_amount                --  '继承费'\\n,a.withdraw_amount                     --  '退会金额' \\n,a.assess_cust_cnt                     --   '评估客户数'\\n,a.assess_cnt                          --   '评估总次数'\\n,a.data_date                           --   '数据日期'\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom \\ndb_dw_hr.clife_hr_dws_market_by_building_d_tmp a \\nleft join \\ndb_dw_hr.clife_hr_dim_admin_sub_org b\\non a.sub_org_id=b.sub_org_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_geographic_info c \\non concat(substr(b.city,1,5),b.area,'0000')=c.area_id\\nand c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_building_d_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-12222\",\"name\":\"clife_hr_dws_market_by_building_m_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table if not exists db_dw_hr.clife_hr_dws_market_by_building_m_tmp stored as parquet as \\nselect\\nsplit(getSet2(concat(if(b1.building_id is null,'',b1.building_id),',',if(tt2.building_id is null,'',tt2.building_id),',',if(tt3.building_id is null,'',tt3.building_id),',',if(tt5.building_id is null,'',tt5.building_id),',',if(tt6.building_id is null,'',tt6.building_id),',',if(tt7.building_id is null,'',tt7.building_id),',',if(tt8.building_id is null,'',tt8.building_id),',',if(tt9.building_id is null,'',tt9.building_id),',',if(tt10.building_id is null,'',tt10.building_id),',','')),',')[1] as building_id\\n,split(getSet2(concat(if(b1.sub_org_id is null,'',b1.sub_org_id),',',if(tt2.sub_org_id is null,'',tt2.sub_org_id),',',if(tt3.sub_org_id is null,'',tt3.sub_org_id),',',if(tt5.sub_org_id is null,'',tt5.sub_org_id),',',if(tt6.sub_org_id is null,'',tt6.sub_org_id),',',if(tt7.sub_org_id is null,'',tt7.sub_org_id),',',if(tt8.sub_org_id is null,'',tt8.sub_org_id),',',if(tt9.sub_org_id is null,'',tt9.sub_org_id),',',if(tt10.sub_org_id is null,'',tt10.sub_org_id),',','')),',')[1] as sub_org_id                          --   '养老机构id',\\n,b1.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,b1.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,b1.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,b1.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,b1.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,b1.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,b1.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,b1.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,b1.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,tt2.deposit_cust_cnt                    --   '下定客户数'\\n,tt3.sign_cust_cnt                       --   '签约客户数'\\n,tt8.transfer_to_member_cnt              --   '转让会籍数'\\n,tt9.transfer_from_member_cnt            --   '继承会籍数'\\n,tt10.withdraw_member_cnt                 --   '退会会籍数'\\n,tt5.crm_intent_visit_cnt as crm_intent_cust_visit_cnt           --   '营销管理模块意向客户回访次数'\\n,tt5.deposit_cust_visit_cnt              --   '下定客户回访次数'\\n,tt5.sign_cust_visit_cnt                 --   '签约客户回访次数'\\n,tt5.avg_crm_intent_cust_visit_cnt       --   '营销管理模块意向客户平均回访次数'\\n,tt5.avg_deposit_cust_visit_cnt          --   '下定客户平均回访次数'\\n,tt5.avg_sign_cust_visit_cnt             --   '签约客户平均回访次数'\\n,tt7.apply_member_cnt                    --   '预申请会籍数量'\\n,tt2.deposit_member_cnt                  --   '下定会籍数量'\\n,tt2.deposit_room_cnt                    --   '下定房间数量'\\n,tt3.sign_member_cnt                     --   '签约会籍数量'\\n,tt3.sign_room_cnt                       --   '签约房间数量'\\n,tt2.deposit_amount                      --   '下定额'\\n,tt3.sales_amount                        --   '销售额'\\n,tt3.card_pay_amount                     --\\t  '刷卡金额'\\n,tt3.cash_pay_amount                     --   '现金金额'\\n,tt3.weixin_pay_amount                   --   '微信支付金额'\\n,tt3.alipay_amount                       --   '阿里支付金额'\\t\\n,tt3.other_pay_amount                    --   '其他方式支付金额'\\n,tt3.received_amount                     --   '已收金额'\\n,tt3.received_installment_amount         --   '已收分期金额'\\n,tt3.received_occupancy_amount           --   '已收占用费'\\n,tt3.membership_amount                   --   '会籍费'\\n,tt3.overdue_amount                      --   '滞纳金'\\n,tt3.received_overdue_amount             --   '已收滞纳金'\\n,tt3.other_amount                        --   '其他费用'\\n,tt3.manager_amount                      --   '管理费'\\n,tt3.trust_amount                        --   '托管费' \\n,tt3.membership_discount_amount          --   '会籍优惠价' \\n,tt3.card_amount                         --   '卡费'\\n,tt3.card_manager_amount                 --   '卡管理费'\\n,tt8.other_transfor_to_amount            --   '其他转让费' \\n,tt8.transfor_to_amount                  --   '转让费'\\n,tt9.other_transfer_from_amount          --   '其他继承费' \\n,tt9.transfer_from_amount                --   '继承费'\\n,tt10.withdraw_amount                     --   '退会金额' \\n,tt6.assess_cust_cnt  as assess_cust_cnt                     --   '评估客户数'\\n,tt6.assess_cnt  as assess_cnt                          --   '评估总次数'\\n,split(getSet2(concat(if(b1.regist_month is null,'',b1.regist_month),',',if(tt2.deposit_month is null,'',tt2.deposit_month),',',if(tt3.sign_month is null,'',tt3.sign_month),',',if(tt5.visit_month is null,'',tt5.visit_month),',',if(tt6.assess_month is null,'',tt6.assess_month),',',if(tt7.apply_month is null,'',tt7.apply_month),',',if(tt8.transfer_to_month is null,'',tt8.transfer_to_month),',',if(tt9.transfer_from_month is null,'',tt9.transfer_from_month),',',if(tt10.withdraw_month is null,'',tt10.withdraw_month),',','')),',')[1]  as data_month                  -- 数据日期\\nfrom  \\n(\\n select\\n t1.sub_org_id\\n,t1.building_id\\n,t1.regist_month\\n,sum(t1.first_high_cnt)  as crm_first_intent_high_cnt  --'营销管理模块首次意向感兴趣客户数'\\n,sum(t1.first_mid_cnt)   as crm_first_intent_mid_cnt   --'营销管理模块首次意向兴趣一般客户数'\\n,sum(t1.first_low_cnt)   as crm_first_intent_low_cnt   --'营销管理模块首次意向不感兴趣客户数'\\n,sum(t1.first_highest_cnt)  as crm_first_intent_highest_cnt  --'营销管理模块首次意向希望购买客户数'\\n,sum(t1.high_cnt)     as crm_intent_high_cnt  --'营销管理模块意向感兴趣客户数'\\n,sum(t1.mid_cnt)      as crm_intent_mid_cnt   --'营销管理模块意向兴趣一般客户数'\\n,sum(t1.low_cnt)      as crm_intent_low_cnt   --'营销管理模块意向不感兴趣客户数'\\n,sum(t1.highest_cnt)  as crm_intent_highest_cnt  --'营销管理模块意向希望购买客户数'\\n,count(distinct t1.intention_customer_id)  as crm_intent_cnt    --'营销管理模块意向客户数',\\n from \\n(\\nselect \\n b.intention_customer_id\\n,b.sub_org_id\\n,b.sub_org_name\\n,b.org_id\\n,b.org_name\\n,b.area_id\\n,b.area_name\\n,case when b.first_intention_type=1 then 1 else 0 end as first_high_cnt\\n,case when b.first_intention_type=2 then 1 else 0 end as first_mid_cnt\\n,case when b.first_intention_type=3 then 1 else 0 end as first_low_cnt\\n,case when b.first_intention_type=4 then 1 else 0 end as first_highest_cnt\\n,case when b.intention_type=1 then 1 else 0 end as high_cnt\\n,case when b.intention_type=2 then 1 else 0 end as mid_cnt\\n,case when b.intention_type=3 then 1 else 0 end as low_cnt\\n,case when b.intention_type=4 then 1 else 0 end as highest_cnt\\n,from_unixtime( cast(b.regist_time as int),'yyyy-MM')  as regist_month\\n,l1.building_id\\nfrom \\ndb_dw_hr.clife_hr_dws_crm_cust_building_info_tmp b \\nlateral view explode(split(building_ids,',')) l1 as building_id\\n) as t1\\ngroup by t1.sub_org_id,t1.building_id,t1.regist_month) b1 \\nfull join \\n(\\nselect \\naa2.sub_org_id\\n,building_id\\n,aa2.deposit_month\\n,count(distinct intention_customer_id) as deposit_cust_cnt  -- '下定客户数'\\n,sum(deposit_amount)    deposit_amount         --     '下定额'\\n,count(distinct membership_id)   as deposit_member_cnt\\n,count(distinct room_id)         as deposit_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,building_id\\n,deposit_amount             --     '下定额'\\n,from_unixtime( cast(deposit_time as int),'yyyy-MM')  as deposit_month \\n,t.membership_id\\n,t.room_id\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa2\\ngroup by aa2.sub_org_id,aa2.building_id,aa2.deposit_month\\n)  tt2\\non b1.sub_org_id=tt2.sub_org_id  and b1.building_id=tt2.building_id and b1.regist_month=tt2.deposit_month\\nfull join \\n(\\nselect \\naa3.sub_org_id\\n,aa3.sign_month\\n,aa3.building_id\\n,count(distinct intention_customer_id) as sign_cust_cnt  -- '下定客户数'\\n,sum(card_pay_amount)   card_pay_amount         --\\t    '刷卡金额'\\n,sum(cash_pay_amount)   cash_pay_amount         --     '现金金额'\\n,sum(weixin_pay_amount) weixin_pay_amount         --     '微信支付金额'\\n,sum(alipay_amount)     alipay_amount         --     '阿里支付金额'\\t\\n,sum(other_pay_amount)  other_pay_amount         --     '其他方式支付金额'\\n,sum(receivable_amount) sales_amount            --  '销售金额'\\n,sum(received_amount)   received_amount            --  '已收金额'\\n,sum(received_installment_amount) received_installment_amount    --  '已收分期金额'\\n,sum(received_occupancy_amount)   received_occupancy_amount    --  '已收占用费'\\n,sum(membership_amount)           membership_amount     --  '会籍费'\\n,sum(overdue_amount)              overdue_amount    --  '滞纳金'\\n,sum(received_overdue_amount)     received_overdue_amount    --  '已收滞纳金'\\n,sum(other_amount)                other_amount     --  '其他费用'\\n,sum(manager_amount)              manager_amount       --  '管理费'\\n,sum(trust_amount)                trust_amount      --  '托管费'\\n,sum(membership_discount_amount)  membership_discount_amount      --  '会籍优惠价'  \\n,sum(card_amount)                 card_amount        --  '卡费'\\n,sum(card_manager_amount)         card_manager_amount     --  '卡管理费'\\n,count(distinct membership_id)   as sign_member_cnt\\n,count(distinct room_id)         as sign_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,building_id\\n,t.membership_id\\n,t.room_id\\n,from_unixtime( cast(sign_time as int),'yyyy-MM')  as sign_month\\n,case when pay_type_id=0 then received_amount else null end as  card_pay_amount            --\\t    '刷卡金额'\\n,case when pay_type_id=1 then received_amount else null end as  cash_pay_amount            --     '现金金额'\\n,case when pay_type_id=2 then received_amount else null end as  weixin_pay_amount          --     '微信支付金额'\\n,case when pay_type_id=3 then received_amount else null end as  alipay_amount              --     '阿里支付金额'\\t\\n,case when pay_type_id=4 then received_amount else null end as  other_pay_amount           --     '其他方式支付金额'\\n,receivable_amount             --  '应收金额'\\n,received_amount               --  '已收金额'\\n,received_installment_amount   --  '已收分期金额'\\n,received_occupancy_amount     --  '已收占用费'\\n,membership_amount             --  '会籍费'\\n,overdue_amount                --  '滞纳金'\\n,received_overdue_amount       --  '已收滞纳金'\\n,other_amount                  --  '其他费用'\\n,manager_amount                --  '管理费'\\n,trust_amount                  --  '托管费'\\n,membership_discount_amount    --  '会籍优惠价'  \\n,card_amount                   --  '卡费'\\n,card_manager_amount           --  '卡管理费' \\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa3\\ngroup by aa3.sub_org_id,aa3.building_id,aa3.sign_month\\n)  tt3\\non b1.sub_org_id=tt3.sub_org_id and b1.building_id=tt3.building_id and b1.regist_month=tt3.sign_month\\nfull join \\n(\\nselect\\naa5.sub_org_id\\n,aa5.building_id\\n,aa5.visit_month\\n,count(distinct intention_customer_id)  int_cnt\\n,count(visit_time2)  as crm_intent_visit_cnt\\n,count(visit_time2)/count(distinct intention_customer_id)   as avg_crm_intent_cust_visit_cnt\\n,count(distinct deposit_visit_cust_cnt)  deposit_cust_visit_cnt\\n,sum(deposit_visit_cnt)  as deposit_visit_cnt\\n,sum(deposit_visit_cnt)/count(distinct deposit_visit_cust_cnt)   as avg_deposit_cust_visit_cnt\\n,count(distinct sign_visit_cust_cnt)  sign_cust_visit_cnt\\n,sum(sign_visit_cnt)  as sign_visit_cnt\\n,sum(sign_visit_cnt)/count(distinct sign_visit_cust_cnt)   as avg_sign_cust_visit_cnt\\n  from \\n(   -- 回访过程\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,building_id\\n,visit_time2\\n,substr(visit_time2,1,7) as visit_month                         -- 列开的回访时间\\n,t.visit_time\\n,case when t.visit_time is not null and visit_time2 is not null and t.deposit_time_list is not null then 1 else 0 end deposit_visit_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.sign_time_list is not null then 1 else 0 end sign_visit_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.deposit_time_list is not null then intention_customer_id else null end deposit_visit_cust_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.sign_time_list is not null then intention_customer_id else null end sign_visit_cust_cnt\\nfrom db_dw_hr.clife_hr_customer_crm_visit_building_info_tmp t \\nlateral view explode(split(visit_time,',')) l1 as visit_time2\\nlateral view explode(split(building_ids,',')) l2 as building_id\\n)  aa5 \\ngroup by aa5.sub_org_id,aa5.building_id,aa5.visit_month\\n)  tt5\\non b1.sub_org_id=tt5.sub_org_id and b1.building_id=tt5.building_id and b1.regist_month=tt5.visit_month\\nfull join \\n(\\nselect \\naa6.sub_org_id\\n,aa6.building_id\\n,aa6.assess_month\\n,count(distinct intention_customer_id)  as assess_cust_cnt  --'发起评估客户数'\\n,count(assess_time2)           as   assess_cnt              --'评估次数'\\nfrom \\n(     --评估相关过程\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,building_id\\n,assess_time2\\n,substr(assess_time2,1,7) as assess_month                         -- 列开的发起评估时间\\nfrom db_dw_hr.clife_hr_customer_crm_visit_building_info_tmp t \\nlateral view explode(split(assess_time,',')) l1 as assess_time2\\nlateral view explode(split(building_ids,',')) l2 as building_id\\n)  aa6 \\ngroup by aa6.sub_org_id,aa6.building_id,aa6.assess_month\\n)  tt6\\non b1.sub_org_id=tt6.sub_org_id  and b1.building_id=tt6.building_id and b1.regist_month=tt6.assess_month\\nfull join \\n(\\nselect\\naa7.sub_org_id\\n,aa7.building_id\\n,aa7.apply_month\\n,count(distinct pre_membership_id) as apply_member_cnt\\n  from\\n(\\nselect \\nt.pre_membership_id\\n,t.sub_org_id\\n,t.building_id\\n,from_unixtime( cast(t.apply_time as int),'yyyy-MM')  apply_month\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa7\\ngroup by aa7.sub_org_id,aa7.building_id,aa7.apply_month\\n) tt7\\non b1.sub_org_id=tt7.sub_org_id  and b1.building_id=tt7.building_id and b1.regist_month=tt7.apply_month\\nfull join \\n(\\nselect\\naa8.sub_org_id\\n,aa8.building_id\\n,aa8.transfer_to_month\\n,count(distinct membership_id) as transfer_to_member_cnt\\n,sum(other_transfor_to_amount)    other_transfor_to_amount     --  '其他转让费' \\n,sum(transfor_to_amount)          transfor_to_amount      --  '转让费'\\nfrom\\n(\\nselect \\nt.membership_id\\n,t.other_transfor_to_amount      --  '其他转让费' \\n,t.transfor_to_amount            --  '转让费'\\n,t.sub_org_id\\n,t.building_id\\n,from_unixtime( cast(t.transfor_to_time as int),'yyyy-MM')  transfer_to_month\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa8\\ngroup by aa8.sub_org_id,aa8.building_id,aa8.transfer_to_month\\n) tt8\\non b1.sub_org_id=tt8.sub_org_id and b1.building_id=tt8.building_id and b1.regist_month=tt8.transfer_to_month\\nfull join \\n(\\nselect\\naa9.sub_org_id\\n,aa9.building_id\\n,aa9.transfer_from_month\\n,count(distinct membership_id) as transfer_from_member_cnt\\n,sum(other_transfer_from_amount)    other_transfer_from_amount     \\n,sum(transfer_from_amount)          transfer_from_amount\\n  from\\n(\\nselect \\nt.membership_id\\n,t.other_transfor_from_amount as other_transfer_from_amount       \\n,t.transfor_from_amount as transfer_from_amount           \\n,t.sub_org_id\\n,t.building_id\\n,from_unixtime( cast(t.transfor_from_time as int),'yyyy-MM')  transfer_from_month\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa9\\ngroup by aa9.sub_org_id, aa9.building_id,aa9.transfer_from_month\\n) tt9\\non b1.sub_org_id=tt9.sub_org_id and b1.building_id=tt9.building_id and b1.regist_month=tt9.transfer_from_month\\nfull join \\n(\\nselect\\naa10.sub_org_id\\n,aa10.building_id\\n,aa10.withdraw_month\\n,count(distinct membership_id) as withdraw_member_cnt   \\n,sum(withdraw_amount)          withdraw_amount   \\n  from\\n(\\nselect \\nt.membership_id      \\n,t.withdraw_amount            \\n,t.sub_org_id\\n,t.building_id\\n,from_unixtime( cast(t.withdraw_time as int),'yyyy-MM')  withdraw_month\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa10\\ngroup by aa10.sub_org_id,aa10.building_id,aa10.withdraw_month\\n) tt10\\non b1.sub_org_id=tt10.sub_org_id and b1.building_id=tt10.building_id and b1.regist_month=tt10.withdraw_month\",\"udfs\":\"14\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_market_by_building_m_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-15896\",\"name\":\"drop_clife_hr_dws_market_by_building_m_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_market_by_building_m_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_building_d\"]},{\"type\":\"SQL\",\"id\":\"tasks-41791\",\"name\":\"clife_hr_dws_market_by_building_m\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_building_m partition(part_date)\\nselect\\na.building_id\\n,a.sub_org_id                          --   '养老机构id'\\n,b.sub_org_name                        --   '养老机构名称'\\n,b.org_id                              --   '养老集团id'\\n,b.org_name                            --   '养老集团名称'\\n,c.area_id                             --   '区域id'\\n,c.area_name                           --   '区域名称'\\n,a.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,a.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,a.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,a.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,a.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,a.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,a.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,a.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,a.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,a.deposit_cust_cnt                    --   '下定客户数'\\n,a.sign_cust_cnt                       --   '签约客户数'\\n,a.transfer_to_member_cnt              --   '转让会籍数'\\n,a.transfer_from_member_cnt            --   '继承会籍数'\\n,a.withdraw_member_cnt                 --   '退会会籍数'\\n,a.crm_intent_cust_visit_cnt           --   '营销管理模块意向客户回访次数'\\n,a.deposit_cust_visit_cnt              --   '下定客户回访次数'\\n,a.sign_cust_visit_cnt                 --   '签约客户回访次数'\\n,a.avg_crm_intent_cust_visit_cnt       --   '营销管理模块意向客户平均回访次数'\\n,a.avg_deposit_cust_visit_cnt          --   '下定客户平均回访次数'\\n,a.avg_sign_cust_visit_cnt             --   '签约客户平均回访次数'\\n,a.apply_member_cnt                    --   '预申请会籍数量'\\n,a.deposit_member_cnt                  --   '下定会籍数量'\\n,a.deposit_room_cnt                    --   '下定房间数量'\\n,a.sign_member_cnt                     --   '签约会籍数量'\\n,a.sign_room_cnt                       --   '签约房间数量'\\n,a.deposit_amount                      --  '下定额'\\n,a.sales_amount                        --  '销售额'\\n,a.card_pay_amount                     --  '刷卡金额'\\n,a.cash_pay_amount                     --  '现金金额'\\n,a.weixin_pay_amount                   --  '微信支付金额'\\n,a.alipay_amount                       --  '阿里支付金额'\\t\\n,a.other_pay_amount                    --  '其他方式支付金额'\\n,a.received_amount                     --  '已收金额'\\n,a.other_transfor_to_amount            --  '其他转让费' \\n,a.transfor_to_amount                  --  '转让费' \\n,a.other_transfer_from_amount          --  '其他继承费' \\n,a.transfer_from_amount                --  '继承费'\\n,a.withdraw_amount                     --  '退会金额' \\n,a.assess_cust_cnt                     --   '评估客户数'\\n,a.assess_cnt                          --   '评估总次数'\\n,a.data_month                           --   '数据日期'\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom \\ndb_dw_hr.clife_hr_dws_market_by_building_m_tmp a \\nleft join \\ndb_dw_hr.clife_hr_dim_admin_sub_org b\\non a.sub_org_id=b.sub_org_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_geographic_info c \\non concat(substr(b.city,1,5),b.area,'0000')=c.area_id\\nand c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_building_m_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-42924\",\"name\":\"clife_hr_dws_market_by_building_y_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table if not exists db_dw_hr.clife_hr_dws_market_by_building_y_tmp stored as parquet as \\nselect\\nsplit(getSet2(concat(if(b1.building_id is null,'',b1.building_id),',',if(tt2.building_id is null,'',tt2.building_id),',',if(tt3.building_id is null,'',tt3.building_id),',',if(tt5.building_id is null,'',tt5.building_id),',',if(tt6.building_id is null,'',tt6.building_id),',',if(tt7.building_id is null,'',tt7.building_id),',',if(tt8.building_id is null,'',tt8.building_id),',',if(tt9.building_id is null,'',tt9.building_id),',',if(tt10.building_id is null,'',tt10.building_id),',','')),',')[1] as building_id\\n,split(getSet2(concat(if(b1.sub_org_id is null,'',b1.sub_org_id),',',if(tt2.sub_org_id is null,'',tt2.sub_org_id),',',if(tt3.sub_org_id is null,'',tt3.sub_org_id),',',if(tt5.sub_org_id is null,'',tt5.sub_org_id),',',if(tt6.sub_org_id is null,'',tt6.sub_org_id),',',if(tt7.sub_org_id is null,'',tt7.sub_org_id),',',if(tt8.sub_org_id is null,'',tt8.sub_org_id),',',if(tt9.sub_org_id is null,'',tt9.sub_org_id),',',if(tt10.sub_org_id is null,'',tt10.sub_org_id),',','')),',')[1] as sub_org_id                          --   '养老机构id',\\n,b1.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,b1.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,b1.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,b1.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,b1.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,b1.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,b1.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,b1.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,b1.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,tt2.deposit_cust_cnt                    --   '下定客户数'\\n,tt3.sign_cust_cnt                       --   '签约客户数'\\n,tt8.transfer_to_member_cnt              --   '转让会籍数'\\n,tt9.transfer_from_member_cnt            --   '继承会籍数'\\n,tt10.withdraw_member_cnt                 --   '退会会籍数'\\n,tt5.crm_intent_visit_cnt as crm_intent_cust_visit_cnt           --   '营销管理模块意向客户回访次数'\\n,tt5.deposit_cust_visit_cnt              --   '下定客户回访次数'\\n,tt5.sign_cust_visit_cnt                 --   '签约客户回访次数'\\n,tt5.avg_crm_intent_cust_visit_cnt       --   '营销管理模块意向客户平均回访次数'\\n,tt5.avg_deposit_cust_visit_cnt          --   '下定客户平均回访次数'\\n,tt5.avg_sign_cust_visit_cnt             --   '签约客户平均回访次数'\\n,tt7.apply_member_cnt                    --   '预申请会籍数量'\\n,tt2.deposit_member_cnt                  --   '下定会籍数量'\\n,tt2.deposit_room_cnt                    --   '下定房间数量'\\n,tt3.sign_member_cnt                     --   '签约会籍数量'\\n,tt3.sign_room_cnt                       --   '签约房间数量'\\n,tt2.deposit_amount                      --   '下定额'\\n,tt3.sales_amount                        --   '销售额'\\n,tt3.card_pay_amount                     --\\t  '刷卡金额'\\n,tt3.cash_pay_amount                     --   '现金金额'\\n,tt3.weixin_pay_amount                   --   '微信支付金额'\\n,tt3.alipay_amount                       --   '阿里支付金额'\\t\\n,tt3.other_pay_amount                    --   '其他方式支付金额'\\n,tt3.received_amount                     --   '已收金额'\\n,tt3.received_installment_amount         --   '已收分期金额'\\n,tt3.received_occupancy_amount           --   '已收占用费'\\n,tt3.membership_amount                   --   '会籍费'\\n,tt3.overdue_amount                      --   '滞纳金'\\n,tt3.received_overdue_amount             --   '已收滞纳金'\\n,tt3.other_amount                        --   '其他费用'\\n,tt3.manager_amount                      --   '管理费'\\n,tt3.trust_amount                        --   '托管费' \\n,tt3.membership_discount_amount          --   '会籍优惠价' \\n,tt3.card_amount                         --   '卡费'\\n,tt3.card_manager_amount                 --   '卡管理费'\\n,tt8.other_transfor_to_amount            --   '其他转让费' \\n,tt8.transfor_to_amount                  --   '转让费'\\n,tt9.other_transfer_from_amount          --   '其他继承费' \\n,tt9.transfer_from_amount                --   '继承费'\\n,tt10.withdraw_amount                     --   '退会金额' \\n,tt6.assess_cust_cnt  as assess_cust_cnt                     --   '评估客户数'\\n,tt6.assess_cnt  as assess_cnt                          --   '评估总次数'\\n,split(getSet2(concat(if(b1.regist_year is null,'',b1.regist_year),',',if(tt2.deposit_year is null,'',tt2.deposit_year),',',if(tt3.sign_year is null,'',tt3.sign_year),',',if(tt5.visit_year is null,'',tt5.visit_year),',',if(tt6.assess_year is null,'',tt6.assess_year),',',if(tt7.apply_year is null,'',tt7.apply_year),',',if(tt8.transfer_to_year is null,'',tt8.transfer_to_year),',',if(tt9.transfer_from_year is null,'',tt9.transfer_from_year),',',if(tt10.withdraw_year is null,'',tt10.withdraw_year),',','')),',')[1]  as data_year                  -- 数据日期\\nfrom  \\n(\\n select\\n t1.sub_org_id\\n,t1.building_id\\n,t1.regist_year\\n,sum(t1.first_high_cnt)  as crm_first_intent_high_cnt  --'营销管理模块首次意向感兴趣客户数'\\n,sum(t1.first_mid_cnt)   as crm_first_intent_mid_cnt   --'营销管理模块首次意向兴趣一般客户数'\\n,sum(t1.first_low_cnt)   as crm_first_intent_low_cnt   --'营销管理模块首次意向不感兴趣客户数'\\n,sum(t1.first_highest_cnt)  as crm_first_intent_highest_cnt  --'营销管理模块首次意向希望购买客户数'\\n,sum(t1.high_cnt)     as crm_intent_high_cnt  --'营销管理模块意向感兴趣客户数'\\n,sum(t1.mid_cnt)      as crm_intent_mid_cnt   --'营销管理模块意向兴趣一般客户数'\\n,sum(t1.low_cnt)      as crm_intent_low_cnt   --'营销管理模块意向不感兴趣客户数'\\n,sum(t1.highest_cnt)  as crm_intent_highest_cnt  --'营销管理模块意向希望购买客户数'\\n,count(distinct t1.intention_customer_id)  as crm_intent_cnt    --'营销管理模块意向客户数',\\n from \\n(\\nselect \\n b.intention_customer_id\\n,b.sub_org_id\\n,b.sub_org_name\\n,b.org_id\\n,b.org_name\\n,b.area_id\\n,b.area_name\\n,case when b.first_intention_type=1 then 1 else 0 end as first_high_cnt\\n,case when b.first_intention_type=2 then 1 else 0 end as first_mid_cnt\\n,case when b.first_intention_type=3 then 1 else 0 end as first_low_cnt\\n,case when b.first_intention_type=4 then 1 else 0 end as first_highest_cnt\\n,case when b.intention_type=1 then 1 else 0 end as high_cnt\\n,case when b.intention_type=2 then 1 else 0 end as mid_cnt\\n,case when b.intention_type=3 then 1 else 0 end as low_cnt\\n,case when b.intention_type=4 then 1 else 0 end as highest_cnt\\n,from_unixtime( cast(b.regist_time as int),'yyyy')  as regist_year\\n,l1.building_id\\nfrom \\ndb_dw_hr.clife_hr_dws_crm_cust_building_info_tmp b \\nlateral view explode(split(building_ids,',')) l1 as building_id\\n) as t1\\ngroup by t1.sub_org_id,t1.building_id,t1.regist_year) b1 \\nfull join \\n(\\nselect \\naa2.sub_org_id\\n,building_id\\n,aa2.deposit_year\\n,count(distinct intention_customer_id) as deposit_cust_cnt  -- '下定客户数'\\n,sum(deposit_amount)    deposit_amount         --     '下定额'\\n,count(distinct membership_id)   as deposit_member_cnt\\n,count(distinct room_id)         as deposit_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,building_id\\n,deposit_amount             --     '下定额'\\n,from_unixtime( cast(deposit_time as int),'yyyy')  as deposit_year \\n,t.membership_id\\n,t.room_id\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa2\\ngroup by aa2.sub_org_id,aa2.building_id,aa2.deposit_year\\n)  tt2\\non b1.sub_org_id=tt2.sub_org_id  and b1.building_id=tt2.building_id and b1.regist_year=tt2.deposit_year\\nfull join \\n(\\nselect \\naa3.sub_org_id\\n,aa3.sign_year\\n,aa3.building_id\\n,count(distinct intention_customer_id) as sign_cust_cnt  -- '下定客户数'\\n,sum(card_pay_amount)   card_pay_amount         --\\t    '刷卡金额'\\n,sum(cash_pay_amount)   cash_pay_amount         --     '现金金额'\\n,sum(weixin_pay_amount) weixin_pay_amount         --     '微信支付金额'\\n,sum(alipay_amount)     alipay_amount         --     '阿里支付金额'\\t\\n,sum(other_pay_amount)  other_pay_amount         --     '其他方式支付金额'\\n,sum(receivable_amount) sales_amount            --  '销售金额'\\n,sum(received_amount)   received_amount            --  '已收金额'\\n,sum(received_installment_amount) received_installment_amount    --  '已收分期金额'\\n,sum(received_occupancy_amount)   received_occupancy_amount    --  '已收占用费'\\n,sum(membership_amount)           membership_amount     --  '会籍费'\\n,sum(overdue_amount)              overdue_amount    --  '滞纳金'\\n,sum(received_overdue_amount)     received_overdue_amount    --  '已收滞纳金'\\n,sum(other_amount)                other_amount     --  '其他费用'\\n,sum(manager_amount)              manager_amount       --  '管理费'\\n,sum(trust_amount)                trust_amount      --  '托管费'\\n,sum(membership_discount_amount)  membership_discount_amount      --  '会籍优惠价'  \\n,sum(card_amount)                 card_amount        --  '卡费'\\n,sum(card_manager_amount)         card_manager_amount     --  '卡管理费'\\n,count(distinct membership_id)   as sign_member_cnt\\n,count(distinct room_id)         as sign_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,building_id\\n,t.membership_id\\n,t.room_id\\n,from_unixtime( cast(sign_time as int),'yyyy')  as sign_year\\n,case when pay_type_id=0 then received_amount else null end as  card_pay_amount            --\\t    '刷卡金额'\\n,case when pay_type_id=1 then received_amount else null end as  cash_pay_amount            --     '现金金额'\\n,case when pay_type_id=2 then received_amount else null end as  weixin_pay_amount          --     '微信支付金额'\\n,case when pay_type_id=3 then received_amount else null end as  alipay_amount              --     '阿里支付金额'\\t\\n,case when pay_type_id=4 then received_amount else null end as  other_pay_amount           --     '其他方式支付金额'\\n,receivable_amount             --  '应收金额'\\n,received_amount               --  '已收金额'\\n,received_installment_amount   --  '已收分期金额'\\n,received_occupancy_amount     --  '已收占用费'\\n,membership_amount             --  '会籍费'\\n,overdue_amount                --  '滞纳金'\\n,received_overdue_amount       --  '已收滞纳金'\\n,other_amount                  --  '其他费用'\\n,manager_amount                --  '管理费'\\n,trust_amount                  --  '托管费'\\n,membership_discount_amount    --  '会籍优惠价'  \\n,card_amount                   --  '卡费'\\n,card_manager_amount           --  '卡管理费' \\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa3\\ngroup by aa3.sub_org_id,aa3.building_id,aa3.sign_year\\n)  tt3\\non b1.sub_org_id=tt3.sub_org_id and b1.building_id=tt3.building_id and b1.regist_year=tt3.sign_year\\nfull join \\n(\\nselect\\naa5.sub_org_id\\n,aa5.building_id\\n,aa5.visit_year\\n,count(distinct intention_customer_id)  int_cnt\\n,count(visit_time2)  as crm_intent_visit_cnt\\n,count(visit_time2)/count(distinct intention_customer_id)   as avg_crm_intent_cust_visit_cnt\\n,count(distinct deposit_visit_cust_cnt)  deposit_cust_visit_cnt\\n,sum(deposit_visit_cnt)  as deposit_visit_cnt\\n,sum(deposit_visit_cnt)/count(distinct deposit_visit_cust_cnt)   as avg_deposit_cust_visit_cnt\\n,count(distinct sign_visit_cust_cnt)  sign_cust_visit_cnt\\n,sum(sign_visit_cnt)  as sign_visit_cnt\\n,sum(sign_visit_cnt)/count(distinct sign_visit_cust_cnt)   as avg_sign_cust_visit_cnt\\n  from \\n(   -- 回访过程\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,building_id\\n,visit_time2\\n,substr(visit_time2,1,4) as visit_year                         -- 列开的回访时间\\n,t.visit_time\\n,case when t.visit_time is not null and visit_time2 is not null and t.deposit_time_list is not null then 1 else 0 end deposit_visit_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.sign_time_list is not null then 1 else 0 end sign_visit_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.deposit_time_list is not null then intention_customer_id else null end deposit_visit_cust_cnt\\n,case when t.visit_time is not null and visit_time2 is not null and t.sign_time_list is not null then intention_customer_id else null end sign_visit_cust_cnt\\nfrom db_dw_hr.clife_hr_customer_crm_visit_building_info_tmp t \\nlateral view explode(split(visit_time,',')) l1 as visit_time2\\nlateral view explode(split(building_ids,',')) l2 as building_id\\n)  aa5 \\ngroup by aa5.sub_org_id,aa5.building_id,aa5.visit_year\\n)  tt5\\non b1.sub_org_id=tt5.sub_org_id and b1.building_id=tt5.building_id and b1.regist_year=tt5.visit_year\\nfull join \\n(\\nselect \\naa6.sub_org_id\\n,aa6.building_id\\n,aa6.assess_year\\n,count(distinct intention_customer_id)  as assess_cust_cnt  --'发起评估客户数'\\n,count(assess_time2)           as   assess_cnt              --'评估次数'\\nfrom \\n(     --评估相关过程\\nselect \\nt.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,building_id\\n,assess_time2\\n,substr(assess_time2,1,4) as assess_year                         -- 列开的发起评估时间\\nfrom db_dw_hr.clife_hr_customer_crm_visit_building_info_tmp t \\nlateral view explode(split(assess_time,',')) l1 as assess_time2\\nlateral view explode(split(building_ids,',')) l2 as building_id\\n)  aa6 \\ngroup by aa6.sub_org_id,aa6.building_id,aa6.assess_year\\n)  tt6\\non b1.sub_org_id=tt6.sub_org_id  and b1.building_id=tt6.building_id and b1.regist_year=tt6.assess_year\\nfull join \\n(\\nselect\\naa7.sub_org_id\\n,aa7.building_id\\n,aa7.apply_year\\n,count(distinct pre_membership_id) as apply_member_cnt\\n  from\\n(\\nselect \\nt.pre_membership_id\\n,t.sub_org_id\\n,t.building_id\\n,from_unixtime( cast(t.apply_time as int),'yyyy')  apply_year\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa7\\ngroup by aa7.sub_org_id,aa7.building_id,aa7.apply_year\\n) tt7\\non b1.sub_org_id=tt7.sub_org_id  and b1.building_id=tt7.building_id and b1.regist_year=tt7.apply_year\\nfull join \\n(\\nselect\\naa8.sub_org_id\\n,aa8.building_id\\n,aa8.transfer_to_year\\n,count(distinct membership_id) as transfer_to_member_cnt\\n,sum(other_transfor_to_amount)    other_transfor_to_amount     --  '其他转让费' \\n,sum(transfor_to_amount)          transfor_to_amount      --  '转让费'\\nfrom\\n(\\nselect \\nt.membership_id\\n,t.other_transfor_to_amount      --  '其他转让费' \\n,t.transfor_to_amount            --  '转让费'\\n,t.sub_org_id\\n,t.building_id\\n,from_unixtime( cast(t.transfor_to_time as int),'yyyy')  transfer_to_year\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa8\\ngroup by aa8.sub_org_id,aa8.building_id,aa8.transfer_to_year\\n) tt8\\non b1.sub_org_id=tt8.sub_org_id and b1.building_id=tt8.building_id and b1.regist_year=tt8.transfer_to_year\\nfull join \\n(\\nselect\\naa9.sub_org_id\\n,aa9.building_id\\n,aa9.transfer_from_year\\n,count(distinct membership_id) as transfer_from_member_cnt\\n,sum(other_transfer_from_amount)    other_transfer_from_amount     \\n,sum(transfer_from_amount)          transfer_from_amount\\n  from\\n(\\nselect \\nt.membership_id\\n,t.other_transfor_from_amount as other_transfer_from_amount       \\n,t.transfor_from_amount as transfer_from_amount           \\n,t.sub_org_id\\n,t.building_id\\n,from_unixtime( cast(t.transfor_from_time as int),'yyyy')  transfer_from_year\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa9\\ngroup by aa9.sub_org_id, aa9.building_id,aa9.transfer_from_year\\n) tt9\\non b1.sub_org_id=tt9.sub_org_id and b1.building_id=tt9.building_id and b1.regist_year=tt9.transfer_from_year\\nfull join \\n(\\nselect\\naa10.sub_org_id\\n,aa10.building_id\\n,aa10.withdraw_year\\n,count(distinct membership_id) as withdraw_member_cnt   \\n,sum(withdraw_amount)          withdraw_amount   \\n  from\\n(\\nselect \\nt.membership_id      \\n,t.withdraw_amount            \\n,t.sub_org_id\\n,t.building_id\\n,from_unixtime( cast(t.withdraw_time as int),'yyyy')  withdraw_year\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa10\\ngroup by aa10.sub_org_id,aa10.building_id,aa10.withdraw_year\\n) tt10\\non b1.sub_org_id=tt10.sub_org_id and b1.building_id=tt10.building_id and b1.regist_year=tt10.withdraw_year\",\"udfs\":\"14\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_market_by_building_y_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-99336\",\"name\":\"drop_clife_hr_dws_market_by_building_y_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_market_by_building_y_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_building_m\"]},{\"type\":\"SQL\",\"id\":\"tasks-1537\",\"name\":\"clife_hr_dws_market_by_building_y\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_building_y partition(part_date)\\nselect\\na.building_id\\n,a.sub_org_id                          --   '养老机构id'\\n,b.sub_org_name                        --   '养老机构名称'\\n,b.org_id                              --   '养老集团id'\\n,b.org_name                            --   '养老集团名称'\\n,c.area_id                             --   '区域id'\\n,c.area_name                           --   '区域名称'\\n,a.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,a.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,a.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,a.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,a.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,a.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,a.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,a.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,a.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,a.deposit_cust_cnt                    --   '下定客户数'\\n,a.sign_cust_cnt                       --   '签约客户数'\\n,a.transfer_to_member_cnt              --   '转让会籍数'\\n,a.transfer_from_member_cnt            --   '继承会籍数'\\n,a.withdraw_member_cnt                 --   '退会会籍数'\\n,a.crm_intent_cust_visit_cnt           --   '营销管理模块意向客户回访次数'\\n,a.deposit_cust_visit_cnt              --   '下定客户回访次数'\\n,a.sign_cust_visit_cnt                 --   '签约客户回访次数'\\n,a.avg_crm_intent_cust_visit_cnt       --   '营销管理模块意向客户平均回访次数'\\n,a.avg_deposit_cust_visit_cnt          --   '下定客户平均回访次数'\\n,a.avg_sign_cust_visit_cnt             --   '签约客户平均回访次数'\\n,a.apply_member_cnt                    --   '预申请会籍数量'\\n,a.deposit_member_cnt                  --   '下定会籍数量'\\n,a.deposit_room_cnt                    --   '下定房间数量'\\n,a.sign_member_cnt                     --   '签约会籍数量'\\n,a.sign_room_cnt                       --   '签约房间数量'\\n,a.deposit_amount                      --  '下定额'\\n,a.sales_amount                        --  '销售额'\\n,a.card_pay_amount                     --  '刷卡金额'\\n,a.cash_pay_amount                     --  '现金金额'\\n,a.weixin_pay_amount                   --  '微信支付金额'\\n,a.alipay_amount                       --  '阿里支付金额'\\t\\n,a.other_pay_amount                    --  '其他方式支付金额'\\n,a.received_amount                     --  '已收金额'\\n,a.other_transfor_to_amount            --  '其他转让费' \\n,a.transfor_to_amount                  --  '转让费' \\n,a.other_transfer_from_amount          --  '其他继承费' \\n,a.transfer_from_amount                --  '继承费'\\n,a.withdraw_amount                     --  '退会金额' \\n,a.assess_cust_cnt                     --   '评估客户数'\\n,a.assess_cnt                          --   '评估总次数'\\n,a.data_year                           --   '数据日期'\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom \\ndb_dw_hr.clife_hr_dws_market_by_building_y_tmp a \\nleft join \\ndb_dw_hr.clife_hr_dim_admin_sub_org b\\non a.sub_org_id=b.sub_org_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_geographic_info c \\non concat(substr(b.city,1,5),b.area,'0000')=c.area_id\\nand c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_building_y_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-39966\",\"name\":\"clife_hr_dws_crm_cust_room_type_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table db_dw_hr.clife_hr_dws_crm_cust_room_type_info_tmp stored as parquet as \\nselect \\n t.intention_customer_id\\n,max(t.sub_org_id )  sub_org_id                      --  '养老机构id'\\n,max(t.sub_org_name)   sub_org_name                    --  '养老机构名称'\\n,max(t.org_id)      org_id                      --  '集团id'\\n,max(t.org_name)    org_name                       --  '集团名称'\\n,max(t.area_id)     area_id                       --  '区域id'\\n,max(t.area_name)   area_name                       --  '区域名称'\\n,max(t.visit_cnt)   visit_cnt                       --  '回访次数'\\n,max(t.first_intention_type)    first_intention_type           --  '首次意向'\\n,max(t.intention_type)          intention_type           --  '当前意向' \\n,max(t.assess_cnt)    assess_cnt     \\n,max(t.regist_time)   regist_time               \\n,concat_ws(',',collect_list(from_unixtime( cast(t.deposit_time as int),'yyyy-MM-dd  HH:mm:ss')))   as deposit_time      -- '下定时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.sign_time as int),'yyyy-MM-dd  HH:mm:ss')))  as sign_time       -- '签约时间集合'\\n,concat_ws(',',collect_set(cast(room_type as string)))  as room_types       -- '房型s'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\ngroup by t.intention_customer_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_crm_cust_room_type_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-7440\",\"name\":\"drop_clife_hr_dws_crm_cust_room_type_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_crm_cust_room_type_info_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_building_y\"]},{\"type\":\"SQL\",\"id\":\"tasks-66089\",\"name\":\"clife_hr_dws_crm_member_room_type_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table db_dw_hr.clife_hr_dws_crm_member_room_type_info_tmp stored as parquet as \\nselect \\n t.membership_id  \\n,max(t.sub_org_id )  sub_org_id                      --  '养老机构id'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.apply_time as int),'yyyy-MM-dd  HH:mm:ss')))   as apply_time      -- '预申请时间集合' \\n,concat_ws(',',collect_list(from_unixtime( cast(t.deposit_time as int),'yyyy-MM-dd  HH:mm:ss')))   as deposit_time      -- '下定时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.sign_time as int),'yyyy-MM-dd  HH:mm:ss')))  as sign_time       -- '签约时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.transfor_to_time as int),'yyyy-MM-dd  HH:mm:ss')))  as transfer_to_time       -- '转让时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.transfor_from_time as int),'yyyy-MM-dd  HH:mm:ss')))  as transfer_from_time       -- '继承时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.withdraw_time as int),'yyyy-MM-dd  HH:mm:ss')))  as withdraw_time       -- '退会时间集合'\\n,concat_ws(',',collect_set(cast(room_type as string)))  as room_types       -- '房型s'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\ngroup by t.membership_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_crm_member_room_type_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-47544\",\"name\":\"drop_clife_hr_dws_crm_member_room_type_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_crm_member_room_type_info_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_crm_cust_room_type_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-62219\",\"name\":\"clife_hr_dws_market_by_room_type_f\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_room_type_f partition(part_date)\\nselect\\nb1.room_type as room_type      --'房型'\\n,b1.sub_org_id as sub_org_id                          --   '养老机构id',\\n,b1.sub_org_name as sub_org_name                        --   '养老机构名称'\\n,b1.org_id as org_id                              --   '养老集团id'\\n,b1.org_id as org_name                            --   '养老集团名称'\\n,b1.area_id as area_id                             --   '区域id'\\n,b1.area_name as area_name                           --   '区域名称'\\n,b1.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,b1.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,b1.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,b1.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,b1.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,b1.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,b1.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,b1.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,b1.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,b1.deposit_cust_cnt                    --   '下定客户数'\\n,b1.sign_cust_cnt                       --   '签约客户数'\\n,c1.transfer_to_member_cnt              --   '转让会籍数'\\n,c1.transfer_from_member_cnt            --   '继承会籍数'\\n,c1.withdraw_member_cnt                 --   '退会会籍数'\\n,c1.apply_member_cnt                    --   '预申请会籍数量'\\n,c1.deposit_member_cnt                  --   '下定会籍数量'\\n,d1.deposit_room_cnt                    --   '下定房间数量'\\n,c1.sign_member_cnt                     --   '签约会籍数量'\\n,d1.sign_room_cnt                       --   '签约房间数量'\\n,e1.deposit_amount                      --   '下定额'\\n,e1.sales_amount                        --   '销售额'\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom \\n(\\n select\\n t1.sub_org_id\\n,t1.room_type\\n,max(t1.sub_org_name) sub_org_name\\n,max(t1.org_id)    org_id\\n,max(t1.org_name)    org_name\\n,max(t1.area_id)     area_id\\n,max(t1.area_name)   area_name\\n,sum(first_high_cnt)  as crm_first_intent_high_cnt  --'营销管理模块首次意向感兴趣客户数'\\n,sum(first_mid_cnt)   as crm_first_intent_mid_cnt   --'营销管理模块首次意向兴趣一般客户数'\\n,sum(first_low_cnt)   as crm_first_intent_low_cnt   --'营销管理模块首次意向不感兴趣客户数'\\n,sum(first_highest_cnt)  as crm_first_intent_highest_cnt  --'营销管理模块首次意向希望购买客户数'\\n,sum(high_cnt)     as crm_intent_high_cnt  --'营销管理模块意向感兴趣客户数'\\n,sum(mid_cnt)      as crm_intent_mid_cnt   --'营销管理模块意向兴趣一般客户数'\\n,sum(low_cnt)      as crm_intent_low_cnt   --'营销管理模块意向不感兴趣客户数'\\n,sum(highest_cnt)  as crm_intent_highest_cnt  --'营销管理模块意向希望购买客户数'\\n,count(distinct intention_customer_id)  as crm_intent_cnt    --'营销管理模块意向客户数',\\n,sum(deposit_cust_cnt) as deposit_cust_cnt   --'下定客户数'\\n,sum(sign_cust_cnt)  as sign_cust_cnt        --'签约客户数'\\n from \\n(\\nselect \\n b.intention_customer_id\\n,b.sub_org_id\\n,b.sub_org_name\\n,b.org_id\\n,b.org_name\\n,b.area_id\\n,b.area_name\\n,b.visit_cnt\\n,b.assess_cnt\\n,b.room_type\\n,case when b.first_intention_type=1 then 1 else 0 end as first_high_cnt\\n,case when b.first_intention_type=2 then 1 else 0 end as first_mid_cnt\\n,case when b.first_intention_type=3 then 1 else 0 end as first_low_cnt\\n,case when b.first_intention_type=4 then 1 else 0 end as first_highest_cnt\\n,case when b.intention_type=1 then 1 else 0 end as high_cnt\\n,case when b.intention_type=2 then 1 else 0 end as mid_cnt\\n,case when b.intention_type=3 then 1 else 0 end as low_cnt\\n,case when b.intention_type=4 then 1 else 0 end as highest_cnt\\n,case when b.deposit_time is not null then 1 else 0 end as deposit_cust_cnt\\n,case when b.sign_time is not null then b.visit_cnt else 0 end as sign_cust_cnt\\n,case when b.deposit_time is not null then b.visit_cnt else 0 end as deposit_cust_visit_cnt\\n,case when b.sign_time is not null then b.visit_cnt else 0 end as sign_cust_vist_cnt\\n,case when b.assess_cnt is not null then 1 else 0 end as assess_cust_cnt\\nfrom \\n(\\nselect \\n t.intention_customer_id\\n,t.sub_org_id                      --  '养老机构id'\\n,t.sub_org_name                    --  '养老机构名称'\\n,t.org_id                      --  '集团id'\\n,t.org_name                       --  '集团名称'\\n,t.area_id                       --  '区域id'\\n,t.area_name                       --  '区域名称'\\n,t.visit_cnt                       --  '回访次数'\\n,t.first_intention_type           --  '首次意向'\\n,t.intention_type           --  '当前意向' \\n,t.assess_cnt                       \\n,t.deposit_time      -- '下定时间集合'\\n,t.sign_time       -- '签约时间集合'\\n,l1.room_type \\nfrom db_dw_hr.clife_hr_dws_crm_cust_room_type_info_tmp t \\nlateral view explode(split(room_types,','))   l1 as  room_type \\n) b\\n) t1\\ngroup by t1.sub_org_id,t1.room_type) b1 \\nfull join \\n(\\nselect\\nt1.sub_org_id\\n,t1.room_type\\n,sum(t1.apply_member_cnt)  apply_member_cnt\\n,sum(t1.deposit_member_cnt)  deposit_member_cnt\\n,sum(t1.sign_member_cnt)  sign_member_cnt\\n,sum(t1.transfer_to_member_cnt)   transfer_to_member_cnt\\n,sum(t1.transfer_from_member_cnt)  transfer_from_member_cnt\\n,sum(t1.withdraw_member_cnt)   withdraw_member_cnt\\nfrom \\n(\\nselect \\nc.membership_id\\n,c.sub_org_id\\n,c.room_type\\n,case when apply_time   is null then 1 else 0 end as apply_member_cnt\\n,case when deposit_time is null then 1 else 0 end as deposit_member_cnt\\n,case when sign_time   is null then 1 else 0 end as sign_member_cnt\\n,case when transfer_to_time is null then 1 else 0 end as transfer_to_member_cnt\\n,case when transfer_from_time is null then 1 else 0 end as transfer_from_member_cnt\\n,case when withdraw_time is null then 1 else 0 end as withdraw_member_cnt\\nfrom \\n(select \\n t.membership_id  \\n,t.sub_org_id                      --  '养老机构id'\\n,room_type\\n,apply_time      -- '预申请时间集合' \\n,deposit_time      -- '下定时间集合'\\n,sign_time       -- '签约时间集合'\\n,transfer_to_time       -- '转让时间集合'\\n,transfer_from_time       -- '继承时间集合'\\n,withdraw_time       -- '退会时间集合'\\nfrom \\ndb_dw_hr.clife_hr_dws_crm_member_room_type_info_tmp  t \\nlateral view explode(split(room_types,','))   l1 as  room_type )  c\\n) t1\\ngroup by t1.sub_org_id,t1.room_type) c1\\non b1.sub_org_id=c1.sub_org_id  and b1.room_type=c1.room_type\\nleft join \\n(\\nselect\\nt1.sub_org_id\\n,t1.room_type\\n,sum(t1.deposit_room_cnt)  deposit_room_cnt\\n,sum(t1.sign_room_cnt)  sign_room_cnt\\nfrom \\n(\\nselect \\nc.room_id\\n,c.sub_org_id\\n,c.room_type\\n,case when deposit_time is null then 1 else 0 end as deposit_room_cnt\\n,case when sign_time   is null then 1 else 0 end as sign_room_cnt\\nfrom \\n(select \\n t.room_id  \\n,max(t.sub_org_id )  sub_org_id                      --  '养老机构id' \\n,max(t.room_type)  room_type\\n,concat_ws(',',collect_list(from_unixtime( cast(t.deposit_time as int),'yyyy-MM-dd  HH:mm:ss')))   as deposit_time      -- '下定时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.sign_time as int),'yyyy-MM-dd  HH:mm:ss')))  as sign_time       -- '签约时间集合'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\ngroup by t.room_id,t.room_type)  c\\n) t1\\ngroup by t1.sub_org_id,t1.room_type) d1\\non b1.sub_org_id=d1.sub_org_id  and b1.room_type=d1.room_type\\nleft join \\n(select \\n sub_org_id\\n,room_type\\n,sum(deposit_amount)    deposit_amount         --     '下定额'\\n,sum(receivable_amount) sales_amount            --  '应收金额'\\n,sum(received_amount)   received_amount            --  '已收金额'\\nfrom db_dw_hr.clife_hr_dwm_market where part_date= regexp_replace(date_sub(current_date(),1),'-','')\\ngroup by sub_org_id,room_type\\n) e1\\non b1.sub_org_id=e1.sub_org_id  and b1.room_type=e1.room_type\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_crm_member_room_type_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-7529\",\"name\":\"clife_hr_dws_market_by_room_type_d_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table if not exists db_dw_hr.clife_hr_dws_market_by_room_type_d_tmp stored as parquet as \\nselect\\nsplit(getSet2(concat(if(b1.room_type is null,'',b1.room_type),',',if(tt2.room_type is null,'',tt2.room_type),',',if(tt3.room_type is null,'',tt3.room_type),',',if(tt7.room_type is null,'',tt7.room_type),',',if(tt8.room_type is null,'',tt8.room_type),',',if(tt9.room_type is null,'',tt9.room_type),',',if(tt10.room_type is null,'',tt10.room_type),',','')),',')[1] as room_type\\n,split(getSet2(concat(if(b1.sub_org_id is null,'',b1.sub_org_id),',',if(tt2.sub_org_id is null,'',tt2.sub_org_id),',',if(tt3.sub_org_id is null,'',tt3.sub_org_id),',',if(tt7.sub_org_id is null,'',tt7.sub_org_id),',',if(tt8.sub_org_id is null,'',tt8.sub_org_id),',',if(tt9.sub_org_id is null,'',tt9.sub_org_id),',',if(tt10.sub_org_id is null,'',tt10.sub_org_id),',','')),',')[1] as sub_org_id                          --   '养老机构id',\\n,b1.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,b1.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,b1.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,b1.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,b1.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,b1.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,b1.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,b1.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,b1.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,tt2.deposit_cust_cnt                    --   '下定客户数'\\n,tt3.sign_cust_cnt                       --   '签约客户数'\\n,tt8.transfer_to_member_cnt              --   '转让会籍数'\\n,tt9.transfer_from_member_cnt            --   '继承会籍数'\\n,tt10.withdraw_member_cnt                 --   '退会会籍数'\\n,tt7.apply_member_cnt                    --   '预申请会籍数量'\\n,tt2.deposit_member_cnt                  --   '下定会籍数量'\\n,tt2.deposit_room_cnt                    --   '下定房间数量'\\n,tt3.sign_member_cnt                     --   '签约会籍数量'\\n,tt3.sign_room_cnt                       --   '签约房间数量'\\n,tt2.deposit_amount                      --   '下定额'\\n,tt3.sales_amount                        --   '销售额' \\n,split(getSet2(concat(if(b1.regist_date is null,'',b1.regist_date),',',if(tt2.deposit_date is null,'',tt2.deposit_date),',',if(tt3.sign_date is null,'',tt3.sign_date),',',if(tt7.apply_date is null,'',tt7.apply_date),',',if(tt8.transfer_to_date is null,'',tt8.transfer_to_date),',',if(tt9.transfer_from_date is null,'',tt9.transfer_from_date),',',if(tt10.withdraw_date is null,'',tt10.withdraw_date),',','')),',')[1]  as data_date                  -- 数据日期\\nfrom  \\n(\\n select\\n t1.sub_org_id\\n,t1.room_type\\n,t1.regist_date\\n,sum(first_high_cnt)  as crm_first_intent_high_cnt  --'营销管理模块首次意向感兴趣客户数'\\n,sum(first_mid_cnt)   as crm_first_intent_mid_cnt   --'营销管理模块首次意向兴趣一般客户数'\\n,sum(first_low_cnt)   as crm_first_intent_low_cnt   --'营销管理模块首次意向不感兴趣客户数'\\n,sum(first_highest_cnt)  as crm_first_intent_highest_cnt  --'营销管理模块首次意向希望购买客户数'\\n,sum(high_cnt)     as crm_intent_high_cnt  --'营销管理模块意向感兴趣客户数'\\n,sum(mid_cnt)      as crm_intent_mid_cnt   --'营销管理模块意向兴趣一般客户数'\\n,sum(low_cnt)      as crm_intent_low_cnt   --'营销管理模块意向不感兴趣客户数'\\n,sum(highest_cnt)  as crm_intent_highest_cnt  --'营销管理模块意向希望购买客户数'\\n,count(distinct intention_customer_id)  as crm_intent_cnt    --'营销管理模块意向客户数',\\n from \\n(\\nselect \\n b.intention_customer_id\\n,b.sub_org_id\\n,b.sub_org_name\\n,b.org_id\\n,b.org_name\\n,b.area_id\\n,b.area_name\\n,case when b.first_intention_type=1 then 1 else 0 end as first_high_cnt\\n,case when b.first_intention_type=2 then 1 else 0 end as first_mid_cnt\\n,case when b.first_intention_type=3 then 1 else 0 end as first_low_cnt\\n,case when b.first_intention_type=4 then 1 else 0 end as first_highest_cnt\\n,case when b.intention_type=1 then 1 else 0 end as high_cnt\\n,case when b.intention_type=2 then 1 else 0 end as mid_cnt\\n,case when b.intention_type=3 then 1 else 0 end as low_cnt\\n,case when b.intention_type=4 then 1 else 0 end as highest_cnt\\n,from_unixtime( cast(regist_time as int),'yyyy-MM-dd')  as regist_date\\n,b.room_type\\nfrom \\n(\\nselect \\n t.intention_customer_id\\n,sub_org_id                      --  '养老机构id'\\n,sub_org_name                    --  '养老机构名称'\\n,org_id                      --  '集团id'\\n,org_name                       --  '集团名称'\\n,area_id                       --  '区域id'\\n,area_name                       --  '区域名称'\\n,first_intention_type           --  '首次意向'\\n,intention_type           --  '当前意向'                        \\n,regist_time\\n,room_type\\nfrom\\ndb_dw_hr.clife_hr_dws_crm_cust_room_type_info_tmp t \\nlateral view explode(split(room_types,',')) l1 as room_type\\n) b\\n) t1\\ngroup by t1.sub_org_id,t1.room_type,t1.regist_date) b1 \\nfull join \\n(\\nselect \\naa2.sub_org_id\\n,room_type\\n,aa2.deposit_date\\n,count(distinct intention_customer_id) as deposit_cust_cnt  -- '下定客户数'\\n,sum(deposit_amount)    deposit_amount         --     '下定额'\\n,count(distinct membership_id)   as deposit_member_cnt\\n,count(distinct room_id)         as deposit_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,room_type\\n,deposit_amount             --     '下定额'\\n,from_unixtime( cast(deposit_time as int),'yyyy-MM-dd')  as deposit_date \\n,t.membership_id\\n,t.room_id\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa2\\ngroup by aa2.sub_org_id,aa2.room_type,aa2.deposit_date\\n)  tt2\\non b1.sub_org_id=tt2.sub_org_id  and b1.room_type=tt2.room_type and b1.regist_date=tt2.deposit_date\\nfull join \\n(\\nselect \\naa3.sub_org_id\\n,aa3.sign_date\\n,aa3.room_type\\n,count(distinct intention_customer_id) as sign_cust_cnt  -- '下定客户数'\\n,sum(receivable_amount) sales_amount            --  '销售金额'\\n,sum(received_amount)   received_amount            --  '已收金额'\\n,count(distinct membership_id)   as sign_member_cnt\\n,count(distinct room_id)         as sign_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,room_type\\n,t.membership_id\\n,t.room_id\\n,from_unixtime( cast(sign_time as int),'yyyy-MM-dd')  as sign_date\\n,receivable_amount             --  '应收金额'\\n,received_amount               --  '已收金额' \\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa3\\ngroup by aa3.sub_org_id,aa3.room_type,aa3.sign_date\\n)  tt3\\non b1.sub_org_id=tt3.sub_org_id and b1.room_type=tt3.room_type and b1.regist_date=tt3.sign_date\\nfull join \\n(\\nselect\\naa7.sub_org_id\\n,aa7.room_type\\n,aa7.apply_date\\n,count(distinct pre_membership_id) as apply_member_cnt\\nfrom\\n(\\nselect \\nt.pre_membership_id\\n,t.sub_org_id\\n,t.room_type\\n,from_unixtime( cast(t.apply_time as int),'yyyy-MM-dd')  apply_date\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa7\\ngroup by aa7.sub_org_id,aa7.room_type,aa7.apply_date\\n) tt7\\non b1.sub_org_id=tt7.sub_org_id  and b1.room_type=tt7.room_type and b1.regist_date=tt7.apply_date\\nfull join \\n(\\nselect\\naa8.sub_org_id\\n,aa8.room_type\\n,aa8.transfer_to_date\\n,count(distinct membership_id) as transfer_to_member_cnt\\n,sum(other_transfor_to_amount)    other_transfor_to_amount     --  '其他转让费' \\n,sum(transfor_to_amount)          transfor_to_amount      --  '转让费'\\nfrom\\n(\\nselect \\nt.membership_id\\n,t.other_transfor_to_amount      --  '其他转让费' \\n,t.transfor_to_amount            --  '转让费'\\n,t.sub_org_id\\n,t.room_type\\n,from_unixtime( cast(t.transfor_to_time as int),'yyyy-MM-dd')  transfer_to_date\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa8\\ngroup by aa8.sub_org_id,aa8.room_type,aa8.transfer_to_date\\n) tt8\\non b1.sub_org_id=tt8.sub_org_id and b1.room_type=tt8.room_type and b1.regist_date=tt8.transfer_to_date\\nfull join \\n(\\nselect\\naa9.sub_org_id\\n,aa9.room_type\\n,aa9.transfer_from_date\\n,count(distinct membership_id) as transfer_from_member_cnt\\n,sum(other_transfer_from_amount)    other_transfer_from_amount     \\n,sum(transfer_from_amount)          transfer_from_amount  \\nfrom   \\n(\\nselect \\nt.membership_id\\n,t.other_transfor_from_amount  as other_transfer_from_amount       \\n,t.transfor_from_amount  as  transfer_from_amount            \\n,t.sub_org_id\\n,t.room_type\\n,from_unixtime( cast(t.transfor_from_time as int),'yyyy-MM-dd')  transfer_from_date\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa9\\ngroup by aa9.sub_org_id, aa9.room_type,aa9.transfer_from_date\\n) tt9\\non b1.sub_org_id=tt9.sub_org_id and b1.room_type=tt9.room_type and b1.regist_date=tt9.transfer_from_date\\nfull join \\n(\\nselect\\naa10.sub_org_id\\n,aa10.room_type\\n,aa10.withdraw_date\\n,count(distinct membership_id) as withdraw_member_cnt   \\n,sum(withdraw_amount)          withdraw_amount  \\nfrom   \\n(\\nselect \\nt.membership_id      \\n,t.withdraw_amount            \\n,t.sub_org_id\\n,t.room_type\\n,from_unixtime( cast(t.withdraw_time as int),'yyyy-MM-dd')  withdraw_date\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa10\\ngroup by aa10.sub_org_id,aa10.room_type,aa10.withdraw_date\\n) tt10\\non b1.sub_org_id=tt10.sub_org_id and b1.room_type=tt10.room_type and b1.regist_date=tt10.withdraw_date\",\"udfs\":\"14\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_market_by_room_type_d_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-96671\",\"name\":\"drop_clife_hr_dws_market_by_room_type_d_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_market_by_room_type_d_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_room_type_f\"]},{\"type\":\"SQL\",\"id\":\"tasks-51556\",\"name\":\"clife_hr_dws_market_by_room_type_d\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_room_type_d partition(part_date)\\nselect\\n a.room_type                           --   '房型'                             \\n,a.sub_org_id                          --   '养老机构id'\\n,b.sub_org_name                        --   '养老机构名称'\\n,b.org_id                              --   '养老集团id'\\n,b.org_name                            --   '养老集团名称'\\n,c.area_id                             --   '区域id'\\n,c.area_name                           --   '区域名称'\\n,a.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,a.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,a.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,a.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,a.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,a.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,a.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,a.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数''\\n,a.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,a.deposit_cust_cnt                    --   '下定客户数'\\n,a.sign_cust_cnt                       --   '签约客户数'\\n,a.transfer_to_member_cnt              --   '转让会籍数'\\n,a.transfer_from_member_cnt            --   '继承会籍数'\\n,a.withdraw_member_cnt                 --   '退会会籍数'\\n,a.apply_member_cnt                    --   '预申请会籍数量'\\n,a.deposit_member_cnt                  --   '下定会籍数量'\\n,a.deposit_room_cnt                    --   '下定房间数量'\\n,a.sign_member_cnt                     --   '签约会籍数量'\\n,a.sign_room_cnt                       --   '签约房间数量'\\n,a.deposit_amount                      --  '下定额'\\n,a.sales_amount                        --  '销售额'\\n,a.data_date                           --   '数据日期'\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom \\ndb_dw_hr.clife_hr_dws_market_by_room_type_d_tmp a \\nleft join \\ndb_dw_hr.clife_hr_dim_admin_sub_org b\\non a.sub_org_id=b.sub_org_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_geographic_info c \\non concat(substr(b.city,1,5),b.area,'0000')=c.area_id\\nand c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_room_type_d_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-88432\",\"name\":\"clife_hr_dws_market_by_room_type_m_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table if not exists db_dw_hr.clife_hr_dws_market_by_room_type_m_tmp stored as parquet as \\nselect\\nsplit(getSet2(concat(if(b1.room_type is null,'',b1.room_type),',',if(tt2.room_type is null,'',tt2.room_type),',',if(tt3.room_type is null,'',tt3.room_type),',',if(tt7.room_type is null,'',tt7.room_type),',',if(tt8.room_type is null,'',tt8.room_type),',',if(tt9.room_type is null,'',tt9.room_type),',',if(tt10.room_type is null,'',tt10.room_type),',','')),',')[1] as room_type\\n,split(getSet2(concat(if(b1.sub_org_id is null,'',b1.sub_org_id),',',if(tt2.sub_org_id is null,'',tt2.sub_org_id),',',if(tt3.sub_org_id is null,'',tt3.sub_org_id),',',if(tt7.sub_org_id is null,'',tt7.sub_org_id),',',if(tt8.sub_org_id is null,'',tt8.sub_org_id),',',if(tt9.sub_org_id is null,'',tt9.sub_org_id),',',if(tt10.sub_org_id is null,'',tt10.sub_org_id),',','')),',')[1] as sub_org_id                          --   '养老机构id',\\n,b1.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,b1.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,b1.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,b1.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,b1.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,b1.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,b1.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,b1.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,b1.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,tt2.deposit_cust_cnt                    --   '下定客户数'\\n,tt3.sign_cust_cnt                       --   '签约客户数'\\n,tt8.transfer_to_member_cnt              --   '转让会籍数'\\n,tt9.transfer_from_member_cnt            --   '继承会籍数'\\n,tt10.withdraw_member_cnt                 --   '退会会籍数'\\n,tt7.apply_member_cnt                    --   '预申请会籍数量'\\n,tt2.deposit_member_cnt                  --   '下定会籍数量'\\n,tt2.deposit_room_cnt                    --   '下定房间数量'\\n,tt3.sign_member_cnt                     --   '签约会籍数量'\\n,tt3.sign_room_cnt                       --   '签约房间数量'\\n,tt2.deposit_amount                      --   '下定额'\\n,tt3.sales_amount                        --   '销售额' \\n,split(getSet2(concat(if(b1.regist_month is null,'',b1.regist_month),',',if(tt2.deposit_month is null,'',tt2.deposit_month),',',if(tt3.sign_month is null,'',tt3.sign_month),',',if(tt7.apply_month is null,'',tt7.apply_month),',',if(tt8.transfer_to_month is null,'',tt8.transfer_to_month),',',if(tt9.transfer_from_month is null,'',tt9.transfer_from_month),',',if(tt10.withdraw_month is null,'',tt10.withdraw_month),',','')),',')[1]  as data_month                  -- 数据日期\\nfrom  \\n(\\n select\\n t1.sub_org_id\\n,t1.room_type\\n,t1.regist_month\\n,sum(first_high_cnt)  as crm_first_intent_high_cnt  --'营销管理模块首次意向感兴趣客户数'\\n,sum(first_mid_cnt)   as crm_first_intent_mid_cnt   --'营销管理模块首次意向兴趣一般客户数'\\n,sum(first_low_cnt)   as crm_first_intent_low_cnt   --'营销管理模块首次意向不感兴趣客户数'\\n,sum(first_highest_cnt)  as crm_first_intent_highest_cnt  --'营销管理模块首次意向希望购买客户数'\\n,sum(high_cnt)     as crm_intent_high_cnt  --'营销管理模块意向感兴趣客户数'\\n,sum(mid_cnt)      as crm_intent_mid_cnt   --'营销管理模块意向兴趣一般客户数'\\n,sum(low_cnt)      as crm_intent_low_cnt   --'营销管理模块意向不感兴趣客户数'\\n,sum(highest_cnt)  as crm_intent_highest_cnt  --'营销管理模块意向希望购买客户数'\\n,count(distinct intention_customer_id)  as crm_intent_cnt    --'营销管理模块意向客户数',\\n from \\n(\\nselect \\n b.intention_customer_id\\n,b.sub_org_id\\n,b.sub_org_name\\n,b.org_id\\n,b.org_name\\n,b.area_id\\n,b.area_name\\n,case when b.first_intention_type=1 then 1 else 0 end as first_high_cnt\\n,case when b.first_intention_type=2 then 1 else 0 end as first_mid_cnt\\n,case when b.first_intention_type=3 then 1 else 0 end as first_low_cnt\\n,case when b.first_intention_type=4 then 1 else 0 end as first_highest_cnt\\n,case when b.intention_type=1 then 1 else 0 end as high_cnt\\n,case when b.intention_type=2 then 1 else 0 end as mid_cnt\\n,case when b.intention_type=3 then 1 else 0 end as low_cnt\\n,case when b.intention_type=4 then 1 else 0 end as highest_cnt\\n,from_unixtime( cast(regist_time as int),'yyyy-MM')  as regist_month\\n,b.room_type\\nfrom \\n(\\nselect \\n t.intention_customer_id\\n,sub_org_id                      --  '养老机构id'\\n,sub_org_name                    --  '养老机构名称'\\n,org_id                      --  '集团id'\\n,org_name                       --  '集团名称'\\n,area_id                       --  '区域id'\\n,area_name                       --  '区域名称'\\n,first_intention_type           --  '首次意向'\\n,intention_type           --  '当前意向'                        \\n,regist_time\\n,room_type\\nfrom\\ndb_dw_hr.clife_hr_dws_crm_cust_room_type_info_tmp t \\nlateral view explode(split(room_types,',')) l1 as room_type\\n) b\\n) t1\\ngroup by t1.sub_org_id,t1.room_type,t1.regist_month) b1 \\nfull join \\n(\\nselect \\naa2.sub_org_id\\n,room_type\\n,aa2.deposit_month\\n,count(distinct intention_customer_id) as deposit_cust_cnt  -- '下定客户数'\\n,sum(deposit_amount)    deposit_amount         --     '下定额'\\n,count(distinct membership_id)   as deposit_member_cnt\\n,count(distinct room_id)         as deposit_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,room_type\\n,deposit_amount             --     '下定额'\\n,from_unixtime( cast(deposit_time as int),'yyyy-MM')  as deposit_month \\n,t.membership_id\\n,t.room_id\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa2\\ngroup by aa2.sub_org_id,aa2.room_type,aa2.deposit_month\\n)  tt2\\non b1.sub_org_id=tt2.sub_org_id  and b1.room_type=tt2.room_type and b1.regist_month=tt2.deposit_month\\nfull join \\n(\\nselect \\naa3.sub_org_id\\n,aa3.sign_month\\n,aa3.room_type\\n,count(distinct intention_customer_id) as sign_cust_cnt  -- '下定客户数'\\n,sum(receivable_amount) sales_amount            --  '销售金额'\\n,sum(received_amount)   received_amount            --  '已收金额'\\n,count(distinct membership_id)   as sign_member_cnt\\n,count(distinct room_id)         as sign_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,room_type\\n,t.membership_id\\n,t.room_id\\n,from_unixtime( cast(sign_time as int),'yyyy-MM')  as sign_month\\n,receivable_amount             --  '应收金额'\\n,received_amount               --  '已收金额' \\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa3\\ngroup by aa3.sub_org_id,aa3.room_type,aa3.sign_month\\n)  tt3\\non b1.sub_org_id=tt3.sub_org_id and b1.room_type=tt3.room_type and b1.regist_month=tt3.sign_month\\nfull join \\n(\\nselect\\naa7.sub_org_id\\n,aa7.room_type\\n,aa7.apply_month\\n,count(distinct pre_membership_id) as apply_member_cnt\\nfrom\\n(\\nselect \\nt.pre_membership_id\\n,t.sub_org_id\\n,t.room_type\\n,from_unixtime( cast(t.apply_time as int),'yyyy-MM')  apply_month\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa7\\ngroup by aa7.sub_org_id,aa7.room_type,aa7.apply_month\\n) tt7\\non b1.sub_org_id=tt7.sub_org_id  and b1.room_type=tt7.room_type and b1.regist_month=tt7.apply_month\\nfull join \\n(\\nselect\\naa8.sub_org_id\\n,aa8.room_type\\n,aa8.transfer_to_month\\n,count(distinct membership_id) as transfer_to_member_cnt\\n,sum(other_transfor_to_amount)    other_transfor_to_amount     --  '其他转让费' \\n,sum(transfor_to_amount)          transfor_to_amount      --  '转让费'\\nfrom\\n(\\nselect \\nt.membership_id\\n,t.other_transfor_to_amount      --  '其他转让费' \\n,t.transfor_to_amount            --  '转让费'\\n,t.sub_org_id\\n,t.room_type\\n,from_unixtime( cast(t.transfor_to_time as int),'yyyy-MM')  transfer_to_month\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa8\\ngroup by aa8.sub_org_id,aa8.room_type,aa8.transfer_to_month\\n) tt8\\non b1.sub_org_id=tt8.sub_org_id and b1.room_type=tt8.room_type and b1.regist_month=tt8.transfer_to_month\\nfull join \\n(\\nselect\\naa9.sub_org_id\\n,aa9.room_type\\n,aa9.transfer_from_month\\n,count(distinct membership_id) as transfer_from_member_cnt\\n,sum(other_transfer_from_amount)    other_transfer_from_amount     \\n,sum(transfer_from_amount)          transfer_from_amount  \\nfrom   \\n(\\nselect \\nt.membership_id\\n,t.other_transfor_from_amount  as other_transfer_from_amount       \\n,t.transfor_from_amount  as  transfer_from_amount            \\n,t.sub_org_id\\n,t.room_type\\n,from_unixtime( cast(t.transfor_from_time as int),'yyyy-MM')  transfer_from_month\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa9\\ngroup by aa9.sub_org_id, aa9.room_type,aa9.transfer_from_month\\n) tt9\\non b1.sub_org_id=tt9.sub_org_id and b1.room_type=tt9.room_type and b1.regist_month=tt9.transfer_from_month\\nfull join \\n(\\nselect\\naa10.sub_org_id\\n,aa10.room_type\\n,aa10.withdraw_month\\n,count(distinct membership_id) as withdraw_member_cnt   \\n,sum(withdraw_amount)          withdraw_amount  \\nfrom   \\n(\\nselect \\nt.membership_id      \\n,t.withdraw_amount            \\n,t.sub_org_id\\n,t.room_type\\n,from_unixtime( cast(t.withdraw_time as int),'yyyy-MM')  withdraw_month\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa10\\ngroup by aa10.sub_org_id,aa10.room_type,aa10.withdraw_month\\n) tt10\\non b1.sub_org_id=tt10.sub_org_id and b1.room_type=tt10.room_type and b1.regist_month=tt10.withdraw_month\",\"udfs\":\"14\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_market_by_room_type_m_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-64081\",\"name\":\"drop_clife_hr_dws_market_by_room_type_m_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table db_dw_hr.clife_hr_dws_market_by_room_type_m_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_room_type_d\"]},{\"type\":\"SQL\",\"id\":\"tasks-99423\",\"name\":\"clife_hr_dws_market_by_room_type_m\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_room_type_m partition(part_date)\\nselect\\n a.room_type                           --   '房型'                             \\n,a.sub_org_id                          --   '养老机构id'\\n,b.sub_org_name                        --   '养老机构名称'\\n,b.org_id                              --   '养老集团id'\\n,b.org_name                            --   '养老集团名称'\\n,c.area_id                             --   '区域id'\\n,c.area_name                           --   '区域名称'\\n,a.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,a.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,a.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,a.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,a.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,a.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,a.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,a.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数''\\n,a.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,a.deposit_cust_cnt                    --   '下定客户数'\\n,a.sign_cust_cnt                       --   '签约客户数'\\n,a.transfer_to_member_cnt              --   '转让会籍数'\\n,a.transfer_from_member_cnt            --   '继承会籍数'\\n,a.withdraw_member_cnt                 --   '退会会籍数'\\n,a.apply_member_cnt                    --   '预申请会籍数量'\\n,a.deposit_member_cnt                  --   '下定会籍数量'\\n,a.deposit_room_cnt                    --   '下定房间数量'\\n,a.sign_member_cnt                     --   '签约会籍数量'\\n,a.sign_room_cnt                       --   '签约房间数量'\\n,a.deposit_amount                      --  '下定额'\\n,a.sales_amount                        --  '销售额'\\n,a.data_month                           --   '数据日期'\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom \\ndb_dw_hr.clife_hr_dws_market_by_room_type_m_tmp a \\nleft join \\ndb_dw_hr.clife_hr_dim_admin_sub_org b\\non a.sub_org_id=b.sub_org_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_geographic_info c \\non concat(substr(b.city,1,5),b.area,'0000')=c.area_id\\nand c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_room_type_m_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-84872\",\"name\":\"clife_hr_dws_market_by_room_type_y_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table if not exists db_dw_hr.clife_hr_dws_market_by_room_type_y_tmp stored as parquet as \\nselect\\nsplit(getSet2(concat(if(b1.room_type is null,'',b1.room_type),',',if(tt2.room_type is null,'',tt2.room_type),',',if(tt3.room_type is null,'',tt3.room_type),',',if(tt7.room_type is null,'',tt7.room_type),',',if(tt8.room_type is null,'',tt8.room_type),',',if(tt9.room_type is null,'',tt9.room_type),',',if(tt10.room_type is null,'',tt10.room_type),',','')),',')[1] as room_type\\n,split(getSet2(concat(if(b1.sub_org_id is null,'',b1.sub_org_id),',',if(tt2.sub_org_id is null,'',tt2.sub_org_id),',',if(tt3.sub_org_id is null,'',tt3.sub_org_id),',',if(tt7.sub_org_id is null,'',tt7.sub_org_id),',',if(tt8.sub_org_id is null,'',tt8.sub_org_id),',',if(tt9.sub_org_id is null,'',tt9.sub_org_id),',',if(tt10.sub_org_id is null,'',tt10.sub_org_id),',','')),',')[1] as sub_org_id                          --   '养老机构id',\\n,b1.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,b1.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,b1.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,b1.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,b1.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,b1.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,b1.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,b1.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,b1.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,tt2.deposit_cust_cnt                    --   '下定客户数'\\n,tt3.sign_cust_cnt                       --   '签约客户数'\\n,tt8.transfer_to_member_cnt              --   '转让会籍数'\\n,tt9.transfer_from_member_cnt            --   '继承会籍数'\\n,tt10.withdraw_member_cnt                 --   '退会会籍数'\\n,tt7.apply_member_cnt                    --   '预申请会籍数量'\\n,tt2.deposit_member_cnt                  --   '下定会籍数量'\\n,tt2.deposit_room_cnt                    --   '下定房间数量'\\n,tt3.sign_member_cnt                     --   '签约会籍数量'\\n,tt3.sign_room_cnt                       --   '签约房间数量'\\n,tt2.deposit_amount                      --   '下定额'\\n,tt3.sales_amount                        --   '销售额' \\n,split(getSet2(concat(if(b1.regist_year is null,'',b1.regist_year),',',if(tt2.deposit_year is null,'',tt2.deposit_year),',',if(tt3.sign_year is null,'',tt3.sign_year),',',if(tt7.apply_year is null,'',tt7.apply_year),',',if(tt8.transfer_to_year is null,'',tt8.transfer_to_year),',',if(tt9.transfer_from_year is null,'',tt9.transfer_from_year),',',if(tt10.withdraw_year is null,'',tt10.withdraw_year),',','')),',')[1]  as data_year                  -- 数据日期\\nfrom  \\n(\\n select\\n t1.sub_org_id\\n,t1.room_type\\n,t1.regist_year\\n,sum(first_high_cnt)  as crm_first_intent_high_cnt  --'营销管理模块首次意向感兴趣客户数'\\n,sum(first_mid_cnt)   as crm_first_intent_mid_cnt   --'营销管理模块首次意向兴趣一般客户数'\\n,sum(first_low_cnt)   as crm_first_intent_low_cnt   --'营销管理模块首次意向不感兴趣客户数'\\n,sum(first_highest_cnt)  as crm_first_intent_highest_cnt  --'营销管理模块首次意向希望购买客户数'\\n,sum(high_cnt)     as crm_intent_high_cnt  --'营销管理模块意向感兴趣客户数'\\n,sum(mid_cnt)      as crm_intent_mid_cnt   --'营销管理模块意向兴趣一般客户数'\\n,sum(low_cnt)      as crm_intent_low_cnt   --'营销管理模块意向不感兴趣客户数'\\n,sum(highest_cnt)  as crm_intent_highest_cnt  --'营销管理模块意向希望购买客户数'\\n,count(distinct intention_customer_id)  as crm_intent_cnt    --'营销管理模块意向客户数',\\n from \\n(\\nselect \\n b.intention_customer_id\\n,b.sub_org_id\\n,b.sub_org_name\\n,b.org_id\\n,b.org_name\\n,b.area_id\\n,b.area_name\\n,case when b.first_intention_type=1 then 1 else 0 end as first_high_cnt\\n,case when b.first_intention_type=2 then 1 else 0 end as first_mid_cnt\\n,case when b.first_intention_type=3 then 1 else 0 end as first_low_cnt\\n,case when b.first_intention_type=4 then 1 else 0 end as first_highest_cnt\\n,case when b.intention_type=1 then 1 else 0 end as high_cnt\\n,case when b.intention_type=2 then 1 else 0 end as mid_cnt\\n,case when b.intention_type=3 then 1 else 0 end as low_cnt\\n,case when b.intention_type=4 then 1 else 0 end as highest_cnt\\n,from_unixtime( cast(regist_time as int),'yyyy')  as regist_year\\n,b.room_type\\nfrom \\n(\\nselect \\n t.intention_customer_id\\n,sub_org_id                      --  '养老机构id'\\n,sub_org_name                    --  '养老机构名称'\\n,org_id                      --  '集团id'\\n,org_name                       --  '集团名称'\\n,area_id                       --  '区域id'\\n,area_name                       --  '区域名称'\\n,first_intention_type           --  '首次意向'\\n,intention_type           --  '当前意向'                        \\n,regist_time\\n,room_type\\nfrom\\ndb_dw_hr.clife_hr_dws_crm_cust_room_type_info_tmp t \\nlateral view explode(split(room_types,',')) l1 as room_type\\n) b\\n) t1\\ngroup by t1.sub_org_id,t1.room_type,t1.regist_year) b1 \\nfull join \\n(\\nselect \\naa2.sub_org_id\\n,room_type\\n,aa2.deposit_year\\n,count(distinct intention_customer_id) as deposit_cust_cnt  -- '下定客户数'\\n,sum(deposit_amount)    deposit_amount         --     '下定额'\\n,count(distinct membership_id)   as deposit_member_cnt\\n,count(distinct room_id)         as deposit_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,room_type\\n,deposit_amount             --     '下定额'\\n,from_unixtime( cast(deposit_time as int),'yyyy')  as deposit_year \\n,t.membership_id\\n,t.room_id\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa2\\ngroup by aa2.sub_org_id,aa2.room_type,aa2.deposit_year\\n)  tt2\\non b1.sub_org_id=tt2.sub_org_id  and b1.room_type=tt2.room_type and b1.regist_year=tt2.deposit_year\\nfull join \\n(\\nselect \\naa3.sub_org_id\\n,aa3.sign_year\\n,aa3.room_type\\n,count(distinct intention_customer_id) as sign_cust_cnt  -- '下定客户数'\\n,sum(receivable_amount) sales_amount            --  '销售金额'\\n,sum(received_amount)   received_amount            --  '已收金额'\\n,count(distinct membership_id)   as sign_member_cnt\\n,count(distinct room_id)         as sign_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,room_type\\n,t.membership_id\\n,t.room_id\\n,from_unixtime( cast(sign_time as int),'yyyy')  as sign_year\\n,receivable_amount             --  '应收金额'\\n,received_amount               --  '已收金额' \\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa3\\ngroup by aa3.sub_org_id,aa3.room_type,aa3.sign_year\\n)  tt3\\non b1.sub_org_id=tt3.sub_org_id and b1.room_type=tt3.room_type and b1.regist_year=tt3.sign_year\\nfull join \\n(\\nselect\\naa7.sub_org_id\\n,aa7.room_type\\n,aa7.apply_year\\n,count(distinct pre_membership_id) as apply_member_cnt\\nfrom\\n(\\nselect \\nt.pre_membership_id\\n,t.sub_org_id\\n,t.room_type\\n,from_unixtime( cast(t.apply_time as int),'yyyy')  apply_year\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa7\\ngroup by aa7.sub_org_id,aa7.room_type,aa7.apply_year\\n) tt7\\non b1.sub_org_id=tt7.sub_org_id  and b1.room_type=tt7.room_type and b1.regist_year=tt7.apply_year\\nfull join \\n(\\nselect\\naa8.sub_org_id\\n,aa8.room_type\\n,aa8.transfer_to_year\\n,count(distinct membership_id) as transfer_to_member_cnt\\n,sum(other_transfor_to_amount)    other_transfor_to_amount     --  '其他转让费' \\n,sum(transfor_to_amount)          transfor_to_amount      --  '转让费'\\nfrom\\n(\\nselect \\nt.membership_id\\n,t.other_transfor_to_amount      --  '其他转让费' \\n,t.transfor_to_amount            --  '转让费'\\n,t.sub_org_id\\n,t.room_type\\n,from_unixtime( cast(t.transfor_to_time as int),'yyyy')  transfer_to_year\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa8\\ngroup by aa8.sub_org_id,aa8.room_type,aa8.transfer_to_year\\n) tt8\\non b1.sub_org_id=tt8.sub_org_id and b1.room_type=tt8.room_type and b1.regist_year=tt8.transfer_to_year\\nfull join \\n(\\nselect\\naa9.sub_org_id\\n,aa9.room_type\\n,aa9.transfer_from_year\\n,count(distinct membership_id) as transfer_from_member_cnt\\n,sum(other_transfer_from_amount)    other_transfer_from_amount     \\n,sum(transfer_from_amount)          transfer_from_amount  \\nfrom   \\n(\\nselect \\nt.membership_id\\n,t.other_transfor_from_amount  as other_transfer_from_amount       \\n,t.transfor_from_amount  as  transfer_from_amount            \\n,t.sub_org_id\\n,t.room_type\\n,from_unixtime( cast(t.transfor_from_time as int),'yyyy')  transfer_from_year\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa9\\ngroup by aa9.sub_org_id, aa9.room_type,aa9.transfer_from_year\\n) tt9\\non b1.sub_org_id=tt9.sub_org_id and b1.room_type=tt9.room_type and b1.regist_year=tt9.transfer_from_year\\nfull join \\n(\\nselect\\naa10.sub_org_id\\n,aa10.room_type\\n,aa10.withdraw_year\\n,count(distinct membership_id) as withdraw_member_cnt   \\n,sum(withdraw_amount)          withdraw_amount  \\nfrom   \\n(\\nselect \\nt.membership_id      \\n,t.withdraw_amount            \\n,t.sub_org_id\\n,t.room_type\\n,from_unixtime( cast(t.withdraw_time as int),'yyyy')  withdraw_year\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa10\\ngroup by aa10.sub_org_id,aa10.room_type,aa10.withdraw_year\\n) tt10\\non b1.sub_org_id=tt10.sub_org_id and b1.room_type=tt10.room_type and b1.regist_year=tt10.withdraw_year\",\"udfs\":\"14\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_market_by_room_type_y_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-94231\",\"name\":\"drop_clife_hr_dws_market_by_room_type_y_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_market_by_room_type_y_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_room_type_m\"]},{\"type\":\"SQL\",\"id\":\"tasks-5846\",\"name\":\"clife_hr_dws_market_by_room_type_y\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_room_type_y partition(part_date)\\nselect\\n a.room_type                           --   '房型'                             \\n,a.sub_org_id                          --   '养老机构id'\\n,b.sub_org_name                        --   '养老机构名称'\\n,b.org_id                              --   '养老集团id'\\n,b.org_name                            --   '养老集团名称'\\n,c.area_id                             --   '区域id'\\n,c.area_name                           --   '区域名称'\\n,a.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,a.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,a.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,a.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,a.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,a.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,a.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,a.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数''\\n,a.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,a.deposit_cust_cnt                    --   '下定客户数'\\n,a.sign_cust_cnt                       --   '签约客户数'\\n,a.transfer_to_member_cnt              --   '转让会籍数'\\n,a.transfer_from_member_cnt            --   '继承会籍数'\\n,a.withdraw_member_cnt                 --   '退会会籍数'\\n,a.apply_member_cnt                    --   '预申请会籍数量'\\n,a.deposit_member_cnt                  --   '下定会籍数量'\\n,a.deposit_room_cnt                    --   '下定房间数量'\\n,a.sign_member_cnt                     --   '签约会籍数量'\\n,a.sign_room_cnt                       --   '签约房间数量'\\n,a.deposit_amount                      --  '下定额'\\n,a.sales_amount                        --  '销售额'\\n,a.data_year                           --   '数据日期'\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom \\ndb_dw_hr.clife_hr_dws_market_by_room_type_y_tmp a \\nleft join \\ndb_dw_hr.clife_hr_dim_admin_sub_org b\\non a.sub_org_id=b.sub_org_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_geographic_info c \\non concat(substr(b.city,1,5),b.area,'0000')=c.area_id \\nand c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_room_type_y_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-83573\",\"name\":\"clife_hr_dws_crm_cust_card_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table db_dw_hr.clife_hr_dws_crm_cust_card_info_tmp stored as parquet as \\nselect \\n t.intention_customer_id\\n,max(t.sub_org_id )  sub_org_id                      --  '养老机构id'\\n,max(t.sub_org_name)   sub_org_name                    --  '养老机构名称'\\n,max(t.org_id)      org_id                      --  '集团id'\\n,max(t.org_name)    org_name                       --  '集团名称'\\n,max(t.area_id)     area_id                       --  '区域id'\\n,max(t.area_name)   area_name                       --  '区域名称'\\n,max(t.visit_cnt)   visit_cnt                       --  '回访次数'\\n,max(t.first_intention_type)    first_intention_type           --  '首次意向'\\n,max(t.intention_type)          intention_type           --  '当前意向' \\n,max(t.assess_cnt)    assess_cnt     \\n,max(t.regist_time)   regist_time               \\n,concat_ws(',',collect_list(from_unixtime( cast(t.deposit_time as int),'yyyy-MM-dd  HH:mm:ss')))   as deposit_time      -- '下定时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.sign_time as int),'yyyy-MM-dd  HH:mm:ss')))  as sign_time       -- '签约时间集合'\\n,concat_ws(',',collect_set(cast(card_id as string)))  as card_ids       -- '会籍卡ids'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\ngroup by t.intention_customer_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_crm_cust_card_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-847\",\"name\":\"drop_clife_hr_dws_crm_cust_card_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_crm_cust_card_info_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_room_type_y\"]},{\"type\":\"SQL\",\"id\":\"tasks-85611\",\"name\":\"clife_hr_dws_crm_member_card_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table db_dw_hr.clife_hr_dws_crm_member_card_info_tmp stored as parquet as \\nselect \\n t.membership_id  \\n,max(t.sub_org_id )  sub_org_id                      --  '养老机构id'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.apply_time as int),'yyyy-MM-dd  HH:mm:ss')))   as apply_time      -- '预申请时间集合' \\n,concat_ws(',',collect_list(from_unixtime( cast(t.deposit_time as int),'yyyy-MM-dd  HH:mm:ss')))   as deposit_time      -- '下定时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.sign_time as int),'yyyy-MM-dd  HH:mm:ss')))  as sign_time       -- '签约时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.transfor_to_time as int),'yyyy-MM-dd  HH:mm:ss')))  as transfer_to_time       -- '转让时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.transfor_from_time as int),'yyyy-MM-dd  HH:mm:ss')))  as transfer_from_time       -- '继承时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.withdraw_time as int),'yyyy-MM-dd  HH:mm:ss')))  as withdraw_time       -- '退会时间集合'\\n,concat_ws(',',collect_set(cast(card_id as string)))  as card_ids       -- '会籍卡ids'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\ngroup by t.membership_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_crm_member_card_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-83622\",\"name\":\"drop_clife_hr_dws_crm_member_card_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_crm_member_card_info_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_crm_cust_card_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-18847\",\"name\":\"clife_hr_dws_crm_room_card_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table db_dw_hr.clife_hr_dws_crm_room_card_info_tmp stored as parquet as \\nselect \\n t.room_id  \\n,max(t.sub_org_id )  sub_org_id                      --  '养老机构id'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.apply_time as int),'yyyy-MM-dd  HH:mm:ss')))   as apply_time      -- '预申请时间集合' \\n,concat_ws(',',collect_list(from_unixtime( cast(t.deposit_time as int),'yyyy-MM-dd  HH:mm:ss')))   as deposit_time      -- '下定时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.sign_time as int),'yyyy-MM-dd  HH:mm:ss')))  as sign_time       -- '签约时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.transfor_to_time as int),'yyyy-MM-dd  HH:mm:ss')))  as transfer_to_time       -- '转让时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.transfor_from_time as int),'yyyy-MM-dd  HH:mm:ss')))  as transfer_from_time       -- '继承时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.withdraw_time as int),'yyyy-MM-dd  HH:mm:ss')))  as withdraw_time       -- '退会时间集合'\\n,concat_ws(',',collect_set(cast(card_id as string)))  as card_ids       -- '会籍卡ids'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\ngroup by t.room_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_crm_room_card_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-23066\",\"name\":\"drop_clife_hr_dws_crm_room_card_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_crm_room_card_info_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_crm_member_card_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-80190\",\"name\":\"clife_hr_dws_market_by_card_f\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_card_f partition(part_date)\\nselect\\nb1.card_id as card_id      --'会籍卡id'\\n,b1.sub_org_id as sub_org_id                          --   '养老机构id',\\n,b1.sub_org_name as sub_org_name                        --   '养老机构名称'\\n,b1.org_id as org_id                              --   '养老集团id'\\n,b1.org_id as org_name                            --   '养老集团名称'\\n,b1.area_id as area_id                             --   '区域id'\\n,b1.area_name as area_name                           --   '区域名称'\\n,b1.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,b1.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,b1.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,b1.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,b1.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,b1.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,b1.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,b1.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,b1.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,b1.deposit_cust_cnt                    --   '下定客户数'\\n,b1.sign_cust_cnt                       --   '签约客户数'\\n,c1.transfer_to_member_cnt              --   '转让会籍数'\\n,c1.transfer_from_member_cnt            --   '继承会籍数'\\n,c1.withdraw_member_cnt                 --   '退会会籍数'\\n,c1.apply_member_cnt                    --   '预申请会籍数量'\\n,c1.deposit_member_cnt                  --   '下定会籍数量'\\n,d1.deposit_room_cnt                    --   '下定房间数量'\\n,c1.sign_member_cnt                     --   '签约会籍数量'\\n,d1.sign_room_cnt                       --   '签约房间数量'\\n,e1.deposit_amount                      --   '下定额'\\n,e1.sales_amount                        --   '销售额'\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom \\n(\\n select\\n t1.sub_org_id\\n,t1.card_id\\n,max(t1.sub_org_name) sub_org_name\\n,max(t1.org_id)    org_id\\n,max(t1.org_name)    org_name\\n,max(t1.area_id)     area_id\\n,max(t1.area_name)   area_name\\n,sum(first_high_cnt)  as crm_first_intent_high_cnt  --'营销管理模块首次意向感兴趣客户数'\\n,sum(first_mid_cnt)   as crm_first_intent_mid_cnt   --'营销管理模块首次意向兴趣一般客户数'\\n,sum(first_low_cnt)   as crm_first_intent_low_cnt   --'营销管理模块首次意向不感兴趣客户数'\\n,sum(first_highest_cnt)  as crm_first_intent_highest_cnt  --'营销管理模块首次意向希望购买客户数'\\n,sum(high_cnt)     as crm_intent_high_cnt  --'营销管理模块意向感兴趣客户数'\\n,sum(mid_cnt)      as crm_intent_mid_cnt   --'营销管理模块意向兴趣一般客户数'\\n,sum(low_cnt)      as crm_intent_low_cnt   --'营销管理模块意向不感兴趣客户数'\\n,sum(highest_cnt)  as crm_intent_highest_cnt  --'营销管理模块意向希望购买客户数'\\n,count(distinct intention_customer_id)  as crm_intent_cnt    --'营销管理模块意向客户数',\\n,sum(deposit_cust_cnt) as deposit_cust_cnt   --'下定客户数'\\n,sum(sign_cust_cnt)  as sign_cust_cnt        --'签约客户数'\\n from \\n(\\nselect \\n b.intention_customer_id\\n,b.sub_org_id\\n,b.sub_org_name\\n,b.org_id\\n,b.org_name\\n,b.area_id\\n,b.area_name\\n,b.visit_cnt\\n,b.assess_cnt\\n,b.card_id\\n,case when b.first_intention_type=1 then 1 else 0 end as first_high_cnt\\n,case when b.first_intention_type=2 then 1 else 0 end as first_mid_cnt\\n,case when b.first_intention_type=3 then 1 else 0 end as first_low_cnt\\n,case when b.first_intention_type=4 then 1 else 0 end as first_highest_cnt\\n,case when b.intention_type=1 then 1 else 0 end as high_cnt\\n,case when b.intention_type=2 then 1 else 0 end as mid_cnt\\n,case when b.intention_type=3 then 1 else 0 end as low_cnt\\n,case when b.intention_type=4 then 1 else 0 end as highest_cnt\\n,case when b.deposit_time is not null then 1 else 0 end as deposit_cust_cnt\\n,case when b.sign_time is not null then b.visit_cnt else 0 end as sign_cust_cnt\\n,case when b.deposit_time is not null then b.visit_cnt else 0 end as deposit_cust_visit_cnt\\n,case when b.sign_time is not null then b.visit_cnt else 0 end as sign_cust_vist_cnt\\n,case when b.assess_cnt is not null then 1 else 0 end as assess_cust_cnt\\nfrom \\n(\\nselect \\n t.intention_customer_id\\n,t.sub_org_id                      --  '养老机构id'\\n,t.sub_org_name                    --  '养老机构名称'\\n,t.org_id                      --  '集团id'\\n,t.org_name                       --  '集团名称'\\n,t.area_id                       --  '区域id'\\n,t.area_name                       --  '区域名称'\\n,t.visit_cnt                       --  '回访次数'\\n,t.first_intention_type           --  '首次意向'\\n,t.intention_type           --  '当前意向' \\n,t.assess_cnt                       \\n,t.deposit_time      -- '下定时间集合'\\n,t.sign_time       -- '签约时间集合'\\n,l1.card_id \\nfrom db_dw_hr.clife_hr_dws_crm_cust_card_info_tmp t \\nlateral view explode(split(card_ids,','))   l1 as  card_id \\n) b\\n) t1\\ngroup by t1.sub_org_id,t1.card_id) b1 \\nfull join \\n(\\nselect\\nt1.sub_org_id\\n,t1.card_id\\n,sum(t1.apply_member_cnt)  apply_member_cnt\\n,sum(t1.deposit_member_cnt)  deposit_member_cnt\\n,sum(t1.sign_member_cnt)  sign_member_cnt\\n,sum(t1.transfer_to_member_cnt)   transfer_to_member_cnt\\n,sum(t1.transfer_from_member_cnt)  transfer_from_member_cnt\\n,sum(t1.withdraw_member_cnt)   withdraw_member_cnt\\nfrom \\n(\\nselect \\nc.membership_id\\n,c.sub_org_id\\n,c.card_id\\n,case when apply_time   is null then 1 else 0 end as apply_member_cnt\\n,case when deposit_time is null then 1 else 0 end as deposit_member_cnt\\n,case when sign_time   is null then 1 else 0 end as sign_member_cnt\\n,case when transfer_to_time is null then 1 else 0 end as transfer_to_member_cnt\\n,case when transfer_from_time is null then 1 else 0 end as transfer_from_member_cnt\\n,case when withdraw_time is null then 1 else 0 end as withdraw_member_cnt\\nfrom \\n(select \\n t.membership_id  \\n,t.sub_org_id                      --  '养老机构id'\\n,card_id\\n,apply_time      -- '预申请时间集合' \\n,deposit_time      -- '下定时间集合'\\n,sign_time       -- '签约时间集合'\\n,transfer_to_time       -- '转让时间集合'\\n,transfer_from_time       -- '继承时间集合'\\n,withdraw_time       -- '退会时间集合'\\nfrom \\ndb_dw_hr.clife_hr_dws_crm_member_card_info_tmp  t \\nlateral view explode(split(card_ids,','))   l1 as  card_id )  c\\n) t1\\ngroup by t1.sub_org_id,t1.card_id) c1\\non b1.sub_org_id=c1.sub_org_id  and b1.card_id=c1.card_id\\nleft join \\n(\\nselect\\nt1.sub_org_id\\n,t1.card_id\\n,count(distinct t1.deposit_room_cnt)  deposit_room_cnt\\n,count(distinct t1.sign_room_cnt)  sign_room_cnt\\nfrom \\n(\\nselect \\nc.room_id\\n,c.sub_org_id\\n,c.card_id\\n,case when deposit_time is null then room_id else null end as deposit_room_cnt\\n,case when sign_time   is null then room_id else null end as sign_room_cnt\\nfrom \\n(select \\n t.room_id  \\n,sub_org_id                      --  '养老机构id' \\n,deposit_time      -- '下定时间集合'\\n,sign_time       -- '签约时间集合'\\n,card_id\\nfrom \\ndb_dw_hr.clife_hr_dws_crm_room_card_info_tmp t \\nlateral view explode(split(card_ids,','))   l1 as  card_id)  c\\n) t1\\ngroup by t1.sub_org_id,t1.card_id) d1\\non b1.sub_org_id=d1.sub_org_id  and b1.card_id=d1.card_id\\nleft join \\n(select \\n sub_org_id\\n,card_id\\n,sum(deposit_amount)    deposit_amount         --     '下定额'\\n,sum(receivable_amount) sales_amount            --  '应收金额'\\n,sum(received_amount)   received_amount            --  '已收金额'\\nfrom db_dw_hr.clife_hr_dwm_market where part_date= regexp_replace(date_sub(current_date(),1),'-','')\\ngroup by sub_org_id,card_id\\n) e1\\non b1.sub_org_id=e1.sub_org_id  and b1.card_id=e1.card_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_crm_room_card_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-19622\",\"name\":\"clife_hr_dws_market_by_card_d_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table if not exists db_dw_hr.clife_hr_dws_market_by_card_d_tmp stored as parquet as \\nselect\\nsplit(getSet2(concat(if(b1.card_id is null,'',b1.card_id),',',if(tt2.card_id is null,'',tt2.card_id),',',if(tt3.card_id is null,'',tt3.card_id),',',if(tt7.card_id is null,'',tt7.card_id),',',if(tt8.card_id is null,'',tt8.card_id),',',if(tt9.card_id is null,'',tt9.card_id),',',if(tt10.card_id is null,'',tt10.card_id),',','')),',')[1] as card_id\\n,split(getSet2(concat(if(b1.sub_org_id is null,'',b1.sub_org_id),',',if(tt2.sub_org_id is null,'',tt2.sub_org_id),',',if(tt3.sub_org_id is null,'',tt3.sub_org_id),',',if(tt7.sub_org_id is null,'',tt7.sub_org_id),',',if(tt8.sub_org_id is null,'',tt8.sub_org_id),',',if(tt9.sub_org_id is null,'',tt9.sub_org_id),',',if(tt10.sub_org_id is null,'',tt10.sub_org_id),',','')),',')[1] as sub_org_id                          --   '养老机构id',\\n,b1.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,b1.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,b1.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,b1.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,b1.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,b1.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,b1.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,b1.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,b1.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,tt2.deposit_cust_cnt                    --   '下定客户数'\\n,tt3.sign_cust_cnt                       --   '签约客户数'\\n,tt8.transfer_to_member_cnt              --   '转让会籍数'\\n,tt9.transfer_from_member_cnt            --   '继承会籍数'\\n,tt10.withdraw_member_cnt                 --   '退会会籍数'\\n,tt7.apply_member_cnt                    --   '预申请会籍数量'\\n,tt2.deposit_member_cnt                  --   '下定会籍数量'\\n,tt2.deposit_room_cnt                    --   '下定房间数量'\\n,tt3.sign_member_cnt                     --   '签约会籍数量'\\n,tt3.sign_room_cnt                       --   '签约房间数量'\\n,tt2.deposit_amount                      --   '下定额'\\n,tt3.sales_amount                        --   '销售额' \\n,split(getSet2(concat(if(b1.regist_date is null,'',b1.regist_date),',',if(tt2.deposit_date is null,'',tt2.deposit_date),',',if(tt3.sign_date is null,'',tt3.sign_date),',',if(tt7.apply_date is null,'',tt7.apply_date),',',if(tt8.transfer_to_date is null,'',tt8.transfer_to_date),',',if(tt9.transfer_from_date is null,'',tt9.transfer_from_date),',',if(tt10.withdraw_date is null,'',tt10.withdraw_date),',','')),',')[1]  as data_date                  -- 数据日期\\nfrom  \\n(\\n select\\n t1.sub_org_id\\n,t1.card_id\\n,t1.regist_date\\n,sum(first_high_cnt)  as crm_first_intent_high_cnt  --'营销管理模块首次意向感兴趣客户数'\\n,sum(first_mid_cnt)   as crm_first_intent_mid_cnt   --'营销管理模块首次意向兴趣一般客户数'\\n,sum(first_low_cnt)   as crm_first_intent_low_cnt   --'营销管理模块首次意向不感兴趣客户数'\\n,sum(first_highest_cnt)  as crm_first_intent_highest_cnt  --'营销管理模块首次意向希望购买客户数'\\n,sum(high_cnt)     as crm_intent_high_cnt  --'营销管理模块意向感兴趣客户数'\\n,sum(mid_cnt)      as crm_intent_mid_cnt   --'营销管理模块意向兴趣一般客户数'\\n,sum(low_cnt)      as crm_intent_low_cnt   --'营销管理模块意向不感兴趣客户数'\\n,sum(highest_cnt)  as crm_intent_highest_cnt  --'营销管理模块意向希望购买客户数'\\n,count(distinct intention_customer_id)  as crm_intent_cnt    --'营销管理模块意向客户数',\\n from \\n(\\nselect \\n b.intention_customer_id\\n,b.sub_org_id\\n,b.sub_org_name\\n,b.org_id\\n,b.org_name\\n,b.area_id\\n,b.area_name\\n,case when b.first_intention_type=1 then 1 else 0 end as first_high_cnt\\n,case when b.first_intention_type=2 then 1 else 0 end as first_mid_cnt\\n,case when b.first_intention_type=3 then 1 else 0 end as first_low_cnt\\n,case when b.first_intention_type=4 then 1 else 0 end as first_highest_cnt\\n,case when b.intention_type=1 then 1 else 0 end as high_cnt\\n,case when b.intention_type=2 then 1 else 0 end as mid_cnt\\n,case when b.intention_type=3 then 1 else 0 end as low_cnt\\n,case when b.intention_type=4 then 1 else 0 end as highest_cnt\\n,from_unixtime( cast(regist_time as int),'yyyy-MM-dd')  as regist_date\\n,b.card_id\\nfrom \\n(\\nselect \\n t.intention_customer_id\\n,sub_org_id                      --  '养老机构id'\\n,sub_org_name                    --  '养老机构名称'\\n,org_id                      --  '集团id'\\n,org_name                       --  '集团名称'\\n,area_id                       --  '区域id'\\n,area_name                       --  '区域名称'\\n,first_intention_type           --  '首次意向'\\n,intention_type           --  '当前意向'                        \\n,regist_time\\n,card_id\\nfrom\\ndb_dw_hr.clife_hr_dws_crm_cust_card_info_tmp t \\nlateral view explode(split(card_ids,',')) l1 as card_id\\n) b\\n) t1\\ngroup by t1.sub_org_id,t1.card_id,t1.regist_date) b1 \\nfull join \\n(\\nselect \\naa2.sub_org_id\\n,card_id\\n,aa2.deposit_date\\n,count(distinct intention_customer_id) as deposit_cust_cnt  -- '下定客户数'\\n,sum(deposit_amount)    deposit_amount         --     '下定额'\\n,count(distinct membership_id)   as deposit_member_cnt\\n,count(distinct room_id)         as deposit_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,card_id\\n,deposit_amount             --     '下定额'\\n,from_unixtime( cast(deposit_time as int),'yyyy-MM-dd')  as deposit_date \\n,t.membership_id\\n,t.room_id\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa2\\ngroup by aa2.sub_org_id,aa2.card_id,aa2.deposit_date\\n)  tt2\\non b1.sub_org_id=tt2.sub_org_id  and b1.card_id=tt2.card_id and b1.regist_date=tt2.deposit_date\\nfull join \\n(\\nselect \\naa3.sub_org_id\\n,aa3.sign_date\\n,aa3.card_id\\n,count(distinct intention_customer_id) as sign_cust_cnt  -- '下定客户数'\\n,sum(receivable_amount) sales_amount            --  '销售金额'\\n,sum(received_amount)   received_amount            --  '已收金额'\\n,count(distinct membership_id)   as sign_member_cnt\\n,count(distinct room_id)         as sign_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,card_id\\n,t.membership_id\\n,t.room_id\\n,from_unixtime( cast(sign_time as int),'yyyy-MM-dd')  as sign_date\\n,receivable_amount             --  '应收金额'\\n,received_amount               --  '已收金额' \\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa3\\ngroup by aa3.sub_org_id,aa3.card_id,aa3.sign_date\\n)  tt3\\non b1.sub_org_id=tt3.sub_org_id and b1.card_id=tt3.card_id and b1.regist_date=tt3.sign_date\\nfull join \\n(\\nselect\\naa7.sub_org_id\\n,aa7.card_id\\n,aa7.apply_date\\n,count(distinct pre_membership_id) as apply_member_cnt\\nfrom\\n(\\nselect \\nt.pre_membership_id\\n,t.sub_org_id\\n,t.card_id\\n,from_unixtime( cast(t.apply_time as int),'yyyy-MM-dd')  apply_date\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa7\\ngroup by aa7.sub_org_id,aa7.card_id,aa7.apply_date\\n) tt7\\non b1.sub_org_id=tt7.sub_org_id  and b1.card_id=tt7.card_id and b1.regist_date=tt7.apply_date\\nfull join \\n(\\nselect\\naa8.sub_org_id\\n,aa8.card_id\\n,aa8.transfer_to_date\\n,count(distinct membership_id) as transfer_to_member_cnt\\n,sum(other_transfor_to_amount)    other_transfor_to_amount     --  '其他转让费' \\n,sum(transfor_to_amount)          transfor_to_amount      --  '转让费'\\nfrom\\n(\\nselect \\nt.membership_id\\n,t.other_transfor_to_amount      --  '其他转让费' \\n,t.transfor_to_amount            --  '转让费'\\n,t.sub_org_id\\n,t.card_id\\n,from_unixtime( cast(t.transfor_to_time as int),'yyyy-MM-dd')  transfer_to_date\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa8\\ngroup by aa8.sub_org_id,aa8.card_id,aa8.transfer_to_date\\n) tt8\\non b1.sub_org_id=tt8.sub_org_id and b1.card_id=tt8.card_id and b1.regist_date=tt8.transfer_to_date\\nfull join \\n(\\nselect\\naa9.sub_org_id\\n,aa9.card_id\\n,aa9.transfer_from_date\\n,count(distinct membership_id) as transfer_from_member_cnt\\n,sum(other_transfer_from_amount)    other_transfer_from_amount     \\n,sum(transfer_from_amount)          transfer_from_amount   \\nfrom  \\n(\\nselect \\nt.membership_id\\n,t.other_transfor_from_amount  as other_transfer_from_amount       \\n,t.transfor_from_amount  as transfer_from_amount            \\n,t.sub_org_id\\n,t.card_id\\n,from_unixtime( cast(t.transfor_from_time as int),'yyyy-MM-dd')  transfer_from_date\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa9\\ngroup by aa9.sub_org_id, aa9.card_id,aa9.transfer_from_date\\n) tt9\\non b1.sub_org_id=tt9.sub_org_id and b1.card_id=tt9.card_id and b1.regist_date=tt9.transfer_from_date\\nfull join \\n(\\nselect\\naa10.sub_org_id\\n,aa10.card_id\\n,aa10.withdraw_date\\n,count(distinct membership_id) as withdraw_member_cnt   \\n,sum(withdraw_amount)          withdraw_amount\\nfrom      \\n(\\nselect \\nt.membership_id      \\n,t.withdraw_amount            \\n,t.sub_org_id\\n,t.card_id\\n,from_unixtime( cast(t.withdraw_time as int),'yyyy-MM-dd')  withdraw_date\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa10\\ngroup by aa10.sub_org_id,aa10.card_id,aa10.withdraw_date\\n) tt10\\non b1.sub_org_id=tt10.sub_org_id and b1.card_id=tt10.card_id and b1.regist_date=tt10.withdraw_date\",\"udfs\":\"14\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_market_by_card_d_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-40939\",\"name\":\"drop_clife_hr_dws_market_by_card_d_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_market_by_card_d_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_card_f\"]},{\"type\":\"SQL\",\"id\":\"tasks-7211\",\"name\":\"clife_hr_dws_market_by_card_d\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_card_d partition(part_date)\\nselect\\n a.card_id                           --   '会籍卡id'                             \\n,a.sub_org_id                          --   '养老机构id'\\n,b.sub_org_name                        --   '养老机构名称'\\n,b.org_id                              --   '养老集团id'\\n,b.org_name                            --   '养老集团名称'\\n,c.area_id                             --   '区域id'\\n,c.area_name                           --   '区域名称'\\n,a.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,a.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,a.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,a.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,a.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,a.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,a.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,a.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数''\\n,a.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,a.deposit_cust_cnt                    --   '下定客户数'\\n,a.sign_cust_cnt                       --   '签约客户数'\\n,a.transfer_to_member_cnt              --   '转让会籍数'\\n,a.transfer_from_member_cnt            --   '继承会籍数'\\n,a.withdraw_member_cnt                 --   '退会会籍数'\\n,a.apply_member_cnt                    --   '预申请会籍数量'\\n,a.deposit_member_cnt                  --   '下定会籍数量'\\n,a.deposit_room_cnt                    --   '下定房间数量'\\n,a.sign_member_cnt                     --   '签约会籍数量'\\n,a.sign_room_cnt                       --   '签约房间数量'\\n,a.deposit_amount                      --  '下定额'\\n,a.sales_amount                        --  '销售额'\\n,a.data_date                           --   '数据日期'\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom \\ndb_dw_hr.clife_hr_dws_market_by_card_d_tmp a \\nleft join \\ndb_dw_hr.clife_hr_dim_admin_sub_org b\\non a.sub_org_id=b.sub_org_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_geographic_info c \\non concat(substr(b.city,1,5),b.area,'0000')=c.area_id\\nand c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_card_d_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-98151\",\"name\":\"clife_hr_dws_market_by_card_m_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table if not exists db_dw_hr.clife_hr_dws_market_by_card_m_tmp stored as parquet as \\nselect\\nsplit(getSet2(concat(if(b1.card_id is null,'',b1.card_id),',',if(tt2.card_id is null,'',tt2.card_id),',',if(tt3.card_id is null,'',tt3.card_id),',',if(tt7.card_id is null,'',tt7.card_id),',',if(tt8.card_id is null,'',tt8.card_id),',',if(tt9.card_id is null,'',tt9.card_id),',',if(tt10.card_id is null,'',tt10.card_id),',','')),',')[1] as card_id\\n,split(getSet2(concat(if(b1.sub_org_id is null,'',b1.sub_org_id),',',if(tt2.sub_org_id is null,'',tt2.sub_org_id),',',if(tt3.sub_org_id is null,'',tt3.sub_org_id),',',if(tt7.sub_org_id is null,'',tt7.sub_org_id),',',if(tt8.sub_org_id is null,'',tt8.sub_org_id),',',if(tt9.sub_org_id is null,'',tt9.sub_org_id),',',if(tt10.sub_org_id is null,'',tt10.sub_org_id),',','')),',')[1] as sub_org_id                          --   '养老机构id',\\n,b1.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,b1.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,b1.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,b1.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,b1.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,b1.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,b1.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,b1.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,b1.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,tt2.deposit_cust_cnt                    --   '下定客户数'\\n,tt3.sign_cust_cnt                       --   '签约客户数'\\n,tt8.transfer_to_member_cnt              --   '转让会籍数'\\n,tt9.transfer_from_member_cnt            --   '继承会籍数'\\n,tt10.withdraw_member_cnt                 --   '退会会籍数'\\n,tt7.apply_member_cnt                    --   '预申请会籍数量'\\n,tt2.deposit_member_cnt                  --   '下定会籍数量'\\n,tt2.deposit_room_cnt                    --   '下定房间数量'\\n,tt3.sign_member_cnt                     --   '签约会籍数量'\\n,tt3.sign_room_cnt                       --   '签约房间数量'\\n,tt2.deposit_amount                      --   '下定额'\\n,tt3.sales_amount                        --   '销售额' \\n,split(getSet2(concat(if(b1.regist_month is null,'',b1.regist_month),',',if(tt2.deposit_month is null,'',tt2.deposit_month),',',if(tt3.sign_month is null,'',tt3.sign_month),',',if(tt7.apply_month is null,'',tt7.apply_month),',',if(tt8.transfer_to_month is null,'',tt8.transfer_to_month),',',if(tt9.transfer_from_month is null,'',tt9.transfer_from_month),',',if(tt10.withdraw_month is null,'',tt10.withdraw_month),',','')),',')[1]  as data_month                  -- 数据日期\\nfrom  \\n(\\n select\\n t1.sub_org_id\\n,t1.card_id\\n,t1.regist_month\\n,sum(first_high_cnt)  as crm_first_intent_high_cnt  --'营销管理模块首次意向感兴趣客户数'\\n,sum(first_mid_cnt)   as crm_first_intent_mid_cnt   --'营销管理模块首次意向兴趣一般客户数'\\n,sum(first_low_cnt)   as crm_first_intent_low_cnt   --'营销管理模块首次意向不感兴趣客户数'\\n,sum(first_highest_cnt)  as crm_first_intent_highest_cnt  --'营销管理模块首次意向希望购买客户数'\\n,sum(high_cnt)     as crm_intent_high_cnt  --'营销管理模块意向感兴趣客户数'\\n,sum(mid_cnt)      as crm_intent_mid_cnt   --'营销管理模块意向兴趣一般客户数'\\n,sum(low_cnt)      as crm_intent_low_cnt   --'营销管理模块意向不感兴趣客户数'\\n,sum(highest_cnt)  as crm_intent_highest_cnt  --'营销管理模块意向希望购买客户数'\\n,count(distinct intention_customer_id)  as crm_intent_cnt    --'营销管理模块意向客户数',\\n from \\n(\\nselect \\n b.intention_customer_id\\n,b.sub_org_id\\n,b.sub_org_name\\n,b.org_id\\n,b.org_name\\n,b.area_id\\n,b.area_name\\n,case when b.first_intention_type=1 then 1 else 0 end as first_high_cnt\\n,case when b.first_intention_type=2 then 1 else 0 end as first_mid_cnt\\n,case when b.first_intention_type=3 then 1 else 0 end as first_low_cnt\\n,case when b.first_intention_type=4 then 1 else 0 end as first_highest_cnt\\n,case when b.intention_type=1 then 1 else 0 end as high_cnt\\n,case when b.intention_type=2 then 1 else 0 end as mid_cnt\\n,case when b.intention_type=3 then 1 else 0 end as low_cnt\\n,case when b.intention_type=4 then 1 else 0 end as highest_cnt\\n,from_unixtime( cast(regist_time as int),'yyyy-MM')  as regist_month\\n,b.card_id\\nfrom \\n(\\nselect \\n t.intention_customer_id\\n,sub_org_id                      --  '养老机构id'\\n,sub_org_name                    --  '养老机构名称'\\n,org_id                      --  '集团id'\\n,org_name                       --  '集团名称'\\n,area_id                       --  '区域id'\\n,area_name                       --  '区域名称'\\n,first_intention_type           --  '首次意向'\\n,intention_type           --  '当前意向'                        \\n,regist_time\\n,card_id\\nfrom\\ndb_dw_hr.clife_hr_dws_crm_cust_card_info_tmp t \\nlateral view explode(split(card_ids,',')) l1 as card_id\\n) b\\n) t1\\ngroup by t1.sub_org_id,t1.card_id,t1.regist_month) b1 \\nfull join \\n(\\nselect \\naa2.sub_org_id\\n,card_id\\n,aa2.deposit_month\\n,count(distinct intention_customer_id) as deposit_cust_cnt  -- '下定客户数'\\n,sum(deposit_amount)    deposit_amount         --     '下定额'\\n,count(distinct membership_id)   as deposit_member_cnt\\n,count(distinct room_id)         as deposit_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,card_id\\n,deposit_amount             --     '下定额'\\n,from_unixtime( cast(deposit_time as int),'yyyy-MM')  as deposit_month \\n,t.membership_id\\n,t.room_id\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa2\\ngroup by aa2.sub_org_id,aa2.card_id,aa2.deposit_month\\n)  tt2\\non b1.sub_org_id=tt2.sub_org_id  and b1.card_id=tt2.card_id and b1.regist_month=tt2.deposit_month\\nfull join \\n(\\nselect \\naa3.sub_org_id\\n,aa3.sign_month\\n,aa3.card_id\\n,count(distinct intention_customer_id) as sign_cust_cnt  -- '下定客户数'\\n,sum(receivable_amount) sales_amount            --  '销售金额'\\n,sum(received_amount)   received_amount            --  '已收金额'\\n,count(distinct membership_id)   as sign_member_cnt\\n,count(distinct room_id)         as sign_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,card_id\\n,t.membership_id\\n,t.room_id\\n,from_unixtime( cast(sign_time as int),'yyyy-MM')  as sign_month\\n,receivable_amount             --  '应收金额'\\n,received_amount               --  '已收金额' \\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa3\\ngroup by aa3.sub_org_id,aa3.card_id,aa3.sign_month\\n)  tt3\\non b1.sub_org_id=tt3.sub_org_id and b1.card_id=tt3.card_id and b1.regist_month=tt3.sign_month\\nfull join \\n(\\nselect\\naa7.sub_org_id\\n,aa7.card_id\\n,aa7.apply_month\\n,count(distinct pre_membership_id) as apply_member_cnt\\nfrom\\n(\\nselect \\nt.pre_membership_id\\n,t.sub_org_id\\n,t.card_id\\n,from_unixtime( cast(t.apply_time as int),'yyyy-MM')  apply_month\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa7\\ngroup by aa7.sub_org_id,aa7.card_id,aa7.apply_month\\n) tt7\\non b1.sub_org_id=tt7.sub_org_id  and b1.card_id=tt7.card_id and b1.regist_month=tt7.apply_month\\nfull join \\n(\\nselect\\naa8.sub_org_id\\n,aa8.card_id\\n,aa8.transfer_to_month\\n,count(distinct membership_id) as transfer_to_member_cnt\\n,sum(other_transfor_to_amount)    other_transfor_to_amount     --  '其他转让费' \\n,sum(transfor_to_amount)          transfor_to_amount      --  '转让费'\\nfrom\\n(\\nselect \\nt.membership_id\\n,t.other_transfor_to_amount      --  '其他转让费' \\n,t.transfor_to_amount            --  '转让费'\\n,t.sub_org_id\\n,t.card_id\\n,from_unixtime( cast(t.transfor_to_time as int),'yyyy-MM')  transfer_to_month\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa8\\ngroup by aa8.sub_org_id,aa8.card_id,aa8.transfer_to_month\\n) tt8\\non b1.sub_org_id=tt8.sub_org_id and b1.card_id=tt8.card_id and b1.regist_month=tt8.transfer_to_month\\nfull join \\n(\\nselect\\naa9.sub_org_id\\n,aa9.card_id\\n,aa9.transfer_from_month\\n,count(distinct membership_id) as transfer_from_member_cnt\\n,sum(other_transfer_from_amount)    other_transfer_from_amount     \\n,sum(transfer_from_amount)          transfer_from_amount   \\nfrom  \\n(\\nselect \\nt.membership_id\\n,t.other_transfor_from_amount  as other_transfer_from_amount       \\n,t.transfor_from_amount  as transfer_from_amount            \\n,t.sub_org_id\\n,t.card_id\\n,from_unixtime( cast(t.transfor_from_time as int),'yyyy-MM')  transfer_from_month\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa9\\ngroup by aa9.sub_org_id, aa9.card_id,aa9.transfer_from_month\\n) tt9\\non b1.sub_org_id=tt9.sub_org_id and b1.card_id=tt9.card_id and b1.regist_month=tt9.transfer_from_month\\nfull join \\n(\\nselect\\naa10.sub_org_id\\n,aa10.card_id\\n,aa10.withdraw_month\\n,count(distinct membership_id) as withdraw_member_cnt   \\n,sum(withdraw_amount)          withdraw_amount\\nfrom      \\n(\\nselect \\nt.membership_id      \\n,t.withdraw_amount            \\n,t.sub_org_id\\n,t.card_id\\n,from_unixtime( cast(t.withdraw_time as int),'yyyy-MM')  withdraw_month\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa10\\ngroup by aa10.sub_org_id,aa10.card_id,aa10.withdraw_month\\n) tt10\\non b1.sub_org_id=tt10.sub_org_id and b1.card_id=tt10.card_id and b1.regist_month=tt10.withdraw_month\",\"udfs\":\"14\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_market_by_card_m_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-87302\",\"name\":\"drop_clife_hr_dws_market_by_card_m_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_market_by_card_m_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_card_d\"]},{\"type\":\"SQL\",\"id\":\"tasks-15659\",\"name\":\"clife_hr_dws_market_by_card_m\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_card_m partition(part_date)\\nselect\\n a.card_id                           --   '会籍卡id'                             \\n,a.sub_org_id                          --   '养老机构id'\\n,b.sub_org_name                        --   '养老机构名称'\\n,b.org_id                              --   '养老集团id'\\n,b.org_name                            --   '养老集团名称'\\n,c.area_id                             --   '区域id'\\n,c.area_name                           --   '区域名称'\\n,a.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,a.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,a.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,a.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,a.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,a.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,a.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,a.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数''\\n,a.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,a.deposit_cust_cnt                    --   '下定客户数'\\n,a.sign_cust_cnt                       --   '签约客户数'\\n,a.transfer_to_member_cnt              --   '转让会籍数'\\n,a.transfer_from_member_cnt            --   '继承会籍数'\\n,a.withdraw_member_cnt                 --   '退会会籍数'\\n,a.apply_member_cnt                    --   '预申请会籍数量'\\n,a.deposit_member_cnt                  --   '下定会籍数量'\\n,a.deposit_room_cnt                    --   '下定房间数量'\\n,a.sign_member_cnt                     --   '签约会籍数量'\\n,a.sign_room_cnt                       --   '签约房间数量'\\n,a.deposit_amount                      --  '下定额'\\n,a.sales_amount                        --  '销售额'\\n,a.data_month                           --   '数据日期'\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom \\ndb_dw_hr.clife_hr_dws_market_by_card_m_tmp a \\nleft join \\ndb_dw_hr.clife_hr_dim_admin_sub_org b\\non a.sub_org_id=b.sub_org_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_geographic_info c \\non concat(substr(b.city,1,5),b.area,'0000')=c.area_id\\nand c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_card_m_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-47236\",\"name\":\"clife_hr_dws_market_by_card_y_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table if not exists db_dw_hr.clife_hr_dws_market_by_card_y_tmp stored as parquet as \\nselect\\nsplit(getSet2(concat(if(b1.card_id is null,'',b1.card_id),',',if(tt2.card_id is null,'',tt2.card_id),',',if(tt3.card_id is null,'',tt3.card_id),',',if(tt7.card_id is null,'',tt7.card_id),',',if(tt8.card_id is null,'',tt8.card_id),',',if(tt9.card_id is null,'',tt9.card_id),',',if(tt10.card_id is null,'',tt10.card_id),',','')),',')[1] as card_id\\n,split(getSet2(concat(if(b1.sub_org_id is null,'',b1.sub_org_id),',',if(tt2.sub_org_id is null,'',tt2.sub_org_id),',',if(tt3.sub_org_id is null,'',tt3.sub_org_id),',',if(tt7.sub_org_id is null,'',tt7.sub_org_id),',',if(tt8.sub_org_id is null,'',tt8.sub_org_id),',',if(tt9.sub_org_id is null,'',tt9.sub_org_id),',',if(tt10.sub_org_id is null,'',tt10.sub_org_id),',','')),',')[1] as sub_org_id                          --   '养老机构id',\\n,b1.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,b1.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,b1.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,b1.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,b1.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,b1.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,b1.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,b1.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,b1.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,tt2.deposit_cust_cnt                    --   '下定客户数'\\n,tt3.sign_cust_cnt                       --   '签约客户数'\\n,tt8.transfer_to_member_cnt              --   '转让会籍数'\\n,tt9.transfer_from_member_cnt            --   '继承会籍数'\\n,tt10.withdraw_member_cnt                 --   '退会会籍数'\\n,tt7.apply_member_cnt                    --   '预申请会籍数量'\\n,tt2.deposit_member_cnt                  --   '下定会籍数量'\\n,tt2.deposit_room_cnt                    --   '下定房间数量'\\n,tt3.sign_member_cnt                     --   '签约会籍数量'\\n,tt3.sign_room_cnt                       --   '签约房间数量'\\n,tt2.deposit_amount                      --   '下定额'\\n,tt3.sales_amount                        --   '销售额' \\n,split(getSet2(concat(if(b1.regist_year is null,'',b1.regist_year),',',if(tt2.deposit_year is null,'',tt2.deposit_year),',',if(tt3.sign_year is null,'',tt3.sign_year),',',if(tt7.apply_year is null,'',tt7.apply_year),',',if(tt8.transfer_to_year is null,'',tt8.transfer_to_year),',',if(tt9.transfer_from_year is null,'',tt9.transfer_from_year),',',if(tt10.withdraw_year is null,'',tt10.withdraw_year),',','')),',')[1]  as data_year                  -- 数据日期\\nfrom  \\n(\\n select\\n t1.sub_org_id\\n,t1.card_id\\n,t1.regist_year\\n,sum(first_high_cnt)  as crm_first_intent_high_cnt  --'营销管理模块首次意向感兴趣客户数'\\n,sum(first_mid_cnt)   as crm_first_intent_mid_cnt   --'营销管理模块首次意向兴趣一般客户数'\\n,sum(first_low_cnt)   as crm_first_intent_low_cnt   --'营销管理模块首次意向不感兴趣客户数'\\n,sum(first_highest_cnt)  as crm_first_intent_highest_cnt  --'营销管理模块首次意向希望购买客户数'\\n,sum(high_cnt)     as crm_intent_high_cnt  --'营销管理模块意向感兴趣客户数'\\n,sum(mid_cnt)      as crm_intent_mid_cnt   --'营销管理模块意向兴趣一般客户数'\\n,sum(low_cnt)      as crm_intent_low_cnt   --'营销管理模块意向不感兴趣客户数'\\n,sum(highest_cnt)  as crm_intent_highest_cnt  --'营销管理模块意向希望购买客户数'\\n,count(distinct intention_customer_id)  as crm_intent_cnt    --'营销管理模块意向客户数',\\n from \\n(\\nselect \\n b.intention_customer_id\\n,b.sub_org_id\\n,b.sub_org_name\\n,b.org_id\\n,b.org_name\\n,b.area_id\\n,b.area_name\\n,case when b.first_intention_type=1 then 1 else 0 end as first_high_cnt\\n,case when b.first_intention_type=2 then 1 else 0 end as first_mid_cnt\\n,case when b.first_intention_type=3 then 1 else 0 end as first_low_cnt\\n,case when b.first_intention_type=4 then 1 else 0 end as first_highest_cnt\\n,case when b.intention_type=1 then 1 else 0 end as high_cnt\\n,case when b.intention_type=2 then 1 else 0 end as mid_cnt\\n,case when b.intention_type=3 then 1 else 0 end as low_cnt\\n,case when b.intention_type=4 then 1 else 0 end as highest_cnt\\n,from_unixtime( cast(regist_time as int),'yyyy')  as regist_year\\n,b.card_id\\nfrom \\n(\\nselect \\n t.intention_customer_id\\n,sub_org_id                      --  '养老机构id'\\n,sub_org_name                    --  '养老机构名称'\\n,org_id                      --  '集团id'\\n,org_name                       --  '集团名称'\\n,area_id                       --  '区域id'\\n,area_name                       --  '区域名称'\\n,first_intention_type           --  '首次意向'\\n,intention_type           --  '当前意向'                        \\n,regist_time\\n,card_id\\nfrom\\ndb_dw_hr.clife_hr_dws_crm_cust_card_info_tmp t \\nlateral view explode(split(card_ids,',')) l1 as card_id\\n) b\\n) t1\\ngroup by t1.sub_org_id,t1.card_id,t1.regist_year) b1 \\nfull join \\n(\\nselect \\naa2.sub_org_id\\n,card_id\\n,aa2.deposit_year\\n,count(distinct intention_customer_id) as deposit_cust_cnt  -- '下定客户数'\\n,sum(deposit_amount)    deposit_amount         --     '下定额'\\n,count(distinct membership_id)   as deposit_member_cnt\\n,count(distinct room_id)         as deposit_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,card_id\\n,deposit_amount             --     '下定额'\\n,from_unixtime( cast(deposit_time as int),'yyyy')  as deposit_year \\n,t.membership_id\\n,t.room_id\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa2\\ngroup by aa2.sub_org_id,aa2.card_id,aa2.deposit_year\\n)  tt2\\non b1.sub_org_id=tt2.sub_org_id  and b1.card_id=tt2.card_id and b1.regist_year=tt2.deposit_year\\nfull join \\n(\\nselect \\naa3.sub_org_id\\n,aa3.sign_year\\n,aa3.card_id\\n,count(distinct intention_customer_id) as sign_cust_cnt  -- '下定客户数'\\n,sum(receivable_amount) sales_amount            --  '销售金额'\\n,sum(received_amount)   received_amount            --  '已收金额'\\n,count(distinct membership_id)   as sign_member_cnt\\n,count(distinct room_id)         as sign_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,card_id\\n,t.membership_id\\n,t.room_id\\n,from_unixtime( cast(sign_time as int),'yyyy')  as sign_year\\n,receivable_amount             --  '应收金额'\\n,received_amount               --  '已收金额' \\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa3\\ngroup by aa3.sub_org_id,aa3.card_id,aa3.sign_year\\n)  tt3\\non b1.sub_org_id=tt3.sub_org_id and b1.card_id=tt3.card_id and b1.regist_year=tt3.sign_year\\nfull join \\n(\\nselect\\naa7.sub_org_id\\n,aa7.card_id\\n,aa7.apply_year\\n,count(distinct pre_membership_id) as apply_member_cnt\\nfrom\\n(\\nselect \\nt.pre_membership_id\\n,t.sub_org_id\\n,t.card_id\\n,from_unixtime( cast(t.apply_time as int),'yyyy')  apply_year\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa7\\ngroup by aa7.sub_org_id,aa7.card_id,aa7.apply_year\\n) tt7\\non b1.sub_org_id=tt7.sub_org_id  and b1.card_id=tt7.card_id and b1.regist_year=tt7.apply_year\\nfull join \\n(\\nselect\\naa8.sub_org_id\\n,aa8.card_id\\n,aa8.transfer_to_year\\n,count(distinct membership_id) as transfer_to_member_cnt\\n,sum(other_transfor_to_amount)    other_transfor_to_amount     --  '其他转让费' \\n,sum(transfor_to_amount)          transfor_to_amount      --  '转让费'\\nfrom\\n(\\nselect \\nt.membership_id\\n,t.other_transfor_to_amount      --  '其他转让费' \\n,t.transfor_to_amount            --  '转让费'\\n,t.sub_org_id\\n,t.card_id\\n,from_unixtime( cast(t.transfor_to_time as int),'yyyy')  transfer_to_year\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa8\\ngroup by aa8.sub_org_id,aa8.card_id,aa8.transfer_to_year\\n) tt8\\non b1.sub_org_id=tt8.sub_org_id and b1.card_id=tt8.card_id and b1.regist_year=tt8.transfer_to_year\\nfull join \\n(\\nselect\\naa9.sub_org_id\\n,aa9.card_id\\n,aa9.transfer_from_year\\n,count(distinct membership_id) as transfer_from_member_cnt\\n,sum(other_transfer_from_amount)    other_transfer_from_amount     \\n,sum(transfer_from_amount)          transfer_from_amount   \\nfrom  \\n(\\nselect \\nt.membership_id\\n,t.other_transfor_from_amount  as other_transfer_from_amount       \\n,t.transfor_from_amount  as transfer_from_amount            \\n,t.sub_org_id\\n,t.card_id\\n,from_unixtime( cast(t.transfor_from_time as int),'yyyy')  transfer_from_year\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa9\\ngroup by aa9.sub_org_id, aa9.card_id,aa9.transfer_from_year\\n) tt9\\non b1.sub_org_id=tt9.sub_org_id and b1.card_id=tt9.card_id and b1.regist_year=tt9.transfer_from_year\\nfull join \\n(\\nselect\\naa10.sub_org_id\\n,aa10.card_id\\n,aa10.withdraw_year\\n,count(distinct membership_id) as withdraw_member_cnt   \\n,sum(withdraw_amount)          withdraw_amount\\nfrom      \\n(\\nselect \\nt.membership_id      \\n,t.withdraw_amount            \\n,t.sub_org_id\\n,t.card_id\\n,from_unixtime( cast(t.withdraw_time as int),'yyyy')  withdraw_year\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa10\\ngroup by aa10.sub_org_id,aa10.card_id,aa10.withdraw_year\\n) tt10\\non b1.sub_org_id=tt10.sub_org_id and b1.card_id=tt10.card_id and b1.regist_year=tt10.withdraw_year\",\"udfs\":\"14\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_market_by_card_y_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-70861\",\"name\":\"drop_clife_hr_dws_market_by_card_y_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_market_by_card_y_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_card_m\"]},{\"type\":\"SQL\",\"id\":\"tasks-6146\",\"name\":\"clife_hr_dws_market_by_card_y\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_card_y partition(part_date)\\nselect\\n a.card_id                           --   '会籍卡id'                             \\n,a.sub_org_id                          --   '养老机构id'\\n,b.sub_org_name                        --   '养老机构名称'\\n,b.org_id                              --   '养老集团id'\\n,b.org_name                            --   '养老集团名称'\\n,c.area_id                             --   '区域id'\\n,c.area_name                           --   '区域名称'\\n,a.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,a.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,a.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,a.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,a.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,a.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,a.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,a.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数''\\n,a.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,a.deposit_cust_cnt                    --   '下定客户数'\\n,a.sign_cust_cnt                       --   '签约客户数'\\n,a.transfer_to_member_cnt              --   '转让会籍数'\\n,a.transfer_from_member_cnt            --   '继承会籍数'\\n,a.withdraw_member_cnt                 --   '退会会籍数'\\n,a.apply_member_cnt                    --   '预申请会籍数量'\\n,a.deposit_member_cnt                  --   '下定会籍数量'\\n,a.deposit_room_cnt                    --   '下定房间数量'\\n,a.sign_member_cnt                     --   '签约会籍数量'\\n,a.sign_room_cnt                       --   '签约房间数量'\\n,a.deposit_amount                      --  '下定额'\\n,a.sales_amount                        --  '销售额'\\n,a.data_year                           --   '数据日期'\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom \\ndb_dw_hr.clife_hr_dws_market_by_card_y_tmp a \\nleft join \\ndb_dw_hr.clife_hr_dim_admin_sub_org b\\non a.sub_org_id=b.sub_org_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_geographic_info c \\non concat(substr(b.city,1,5),b.area,'0000')=c.area_id\\nand c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_card_y_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-49954\",\"name\":\"clife_hr_dws_crm_cust_card_type_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table db_dw_hr.clife_hr_dws_crm_cust_card_type_info_tmp stored as parquet as \\nselect \\n t.intention_customer_id\\n,max(t.sub_org_id )  sub_org_id                      --  '养老机构id'\\n,max(t.sub_org_name)   sub_org_name                    --  '养老机构名称'\\n,max(t.org_id)      org_id                      --  '集团id'\\n,max(t.org_name)    org_name                       --  '集团名称'\\n,max(t.area_id)     area_id                       --  '区域id'\\n,max(t.area_name)   area_name                       --  '区域名称'\\n,max(t.visit_cnt)   visit_cnt                       --  '回访次数'\\n,max(t.first_intention_type)    first_intention_type           --  '首次意向'\\n,max(t.intention_type)          intention_type           --  '当前意向' \\n,max(t.assess_cnt)    assess_cnt     \\n,max(t.regist_time)   regist_time               \\n,concat_ws(',',collect_list(from_unixtime( cast(t.deposit_time as int),'yyyy-MM-dd  HH:mm:ss')))   as deposit_time      -- '下定时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.sign_time as int),'yyyy-MM-dd  HH:mm:ss')))  as sign_time       -- '签约时间集合'\\n,concat_ws(',',collect_set(cast(card_type  as string)))  as card_types       -- '会籍卡ids'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\ngroup by t.intention_customer_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_crm_cust_card_type_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-87956\",\"name\":\"drop_clife_hr_dws_crm_cust_card_type_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_crm_cust_card_type_info_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_card_y\"]},{\"type\":\"SQL\",\"id\":\"tasks-58772\",\"name\":\"clife_hr_dws_crm_member_card_type_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table db_dw_hr.clife_hr_dws_crm_member_card_type_info_tmp stored as parquet as \\nselect \\n t.membership_id  \\n,max(t.sub_org_id )  sub_org_id                      --  '养老机构id'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.apply_time as int),'yyyy-MM-dd  HH:mm:ss')))   as apply_time      -- '预申请时间集合' \\n,concat_ws(',',collect_list(from_unixtime( cast(t.deposit_time as int),'yyyy-MM-dd  HH:mm:ss')))   as deposit_time      -- '下定时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.sign_time as int),'yyyy-MM-dd  HH:mm:ss')))  as sign_time       -- '签约时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.transfor_to_time as int),'yyyy-MM-dd  HH:mm:ss')))  as transfer_to_time       -- '转让时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.transfor_from_time as int),'yyyy-MM-dd  HH:mm:ss')))  as transfer_from_time       -- '继承时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.withdraw_time as int),'yyyy-MM-dd  HH:mm:ss')))  as withdraw_time       -- '退会时间集合'\\n,concat_ws(',',collect_set(cast(card_type  as string)))  as card_types       -- '会籍卡ids'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\ngroup by t.membership_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_crm_member_card_type_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-31809\",\"name\":\"drop_clife_hr_dws_crm_member_card_type_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_crm_member_card_type_info_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_crm_cust_card_type_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-9606\",\"name\":\"clife_hr_dws_crm_room_card_type_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table db_dw_hr.clife_hr_dws_crm_room_card_type_info_tmp stored as parquet as \\nselect \\n t.room_id  \\n,max(t.sub_org_id )  sub_org_id                      --  '养老机构id'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.apply_time as int),'yyyy-MM-dd  HH:mm:ss')))   as apply_time      -- '预申请时间集合' \\n,concat_ws(',',collect_list(from_unixtime( cast(t.deposit_time as int),'yyyy-MM-dd  HH:mm:ss')))   as deposit_time      -- '下定时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.sign_time as int),'yyyy-MM-dd  HH:mm:ss')))  as sign_time       -- '签约时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.transfor_to_time as int),'yyyy-MM-dd  HH:mm:ss')))  as transfer_to_time       -- '转让时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.transfor_from_time as int),'yyyy-MM-dd  HH:mm:ss')))  as transfer_from_time       -- '继承时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.withdraw_time as int),'yyyy-MM-dd  HH:mm:ss')))  as withdraw_time       -- '退会时间集合'\\n,concat_ws(',',collect_set(cast(card_type  as string)))  as card_types       -- '会籍卡ids'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\ngroup by t.room_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_crm_room_card_type_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-3932\",\"name\":\"drop_clife_hr_dws_crm_room_card_type_info_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_crm_room_card_type_info_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_crm_member_card_type_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-80915\",\"name\":\"clife_hr_dws_market_by_card_type_f\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_card_type_f partition(part_date)\\nselect\\nb1.card_type as card_type      --'会籍卡id'\\n,b1.sub_org_id as sub_org_id                          --   '养老机构id',\\n,b1.sub_org_name as sub_org_name                        --   '养老机构名称'\\n,b1.org_id as org_id                              --   '养老集团id'\\n,b1.org_id as org_name                            --   '养老集团名称'\\n,b1.area_id as area_id                             --   '区域id'\\n,b1.area_name as area_name                           --   '区域名称'\\n,b1.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,b1.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,b1.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,b1.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,b1.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,b1.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,b1.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,b1.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,b1.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,b1.deposit_cust_cnt                    --   '下定客户数'\\n,b1.sign_cust_cnt                       --   '签约客户数'\\n,c1.transfer_to_member_cnt              --   '转让会籍数'\\n,c1.transfer_from_member_cnt            --   '继承会籍数'\\n,c1.withdraw_member_cnt                 --   '退会会籍数'\\n,c1.apply_member_cnt                    --   '预申请会籍数量'\\n,c1.deposit_member_cnt                  --   '下定会籍数量'\\n,d1.deposit_room_cnt                    --   '下定房间数量'\\n,c1.sign_member_cnt                     --   '签约会籍数量'\\n,d1.sign_room_cnt                       --   '签约房间数量'\\n,e1.deposit_amount                      --   '下定额'\\n,e1.sales_amount                        --   '销售额'\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom \\n(\\n select\\n t1.sub_org_id\\n,t1.card_type\\n,max(t1.sub_org_name) sub_org_name\\n,max(t1.org_id)    org_id\\n,max(t1.org_name)    org_name\\n,max(t1.area_id)     area_id\\n,max(t1.area_name)   area_name\\n,sum(first_high_cnt)  as crm_first_intent_high_cnt  --'营销管理模块首次意向感兴趣客户数'\\n,sum(first_mid_cnt)   as crm_first_intent_mid_cnt   --'营销管理模块首次意向兴趣一般客户数'\\n,sum(first_low_cnt)   as crm_first_intent_low_cnt   --'营销管理模块首次意向不感兴趣客户数'\\n,sum(first_highest_cnt)  as crm_first_intent_highest_cnt  --'营销管理模块首次意向希望购买客户数'\\n,sum(high_cnt)     as crm_intent_high_cnt  --'营销管理模块意向感兴趣客户数'\\n,sum(mid_cnt)      as crm_intent_mid_cnt   --'营销管理模块意向兴趣一般客户数'\\n,sum(low_cnt)      as crm_intent_low_cnt   --'营销管理模块意向不感兴趣客户数'\\n,sum(highest_cnt)  as crm_intent_highest_cnt  --'营销管理模块意向希望购买客户数'\\n,count(distinct intention_customer_id)  as crm_intent_cnt    --'营销管理模块意向客户数',\\n,sum(deposit_cust_cnt) as deposit_cust_cnt   --'下定客户数'\\n,sum(sign_cust_cnt)  as sign_cust_cnt        --'签约客户数'\\n from \\n(\\nselect \\n b.intention_customer_id\\n,b.sub_org_id\\n,b.sub_org_name\\n,b.org_id\\n,b.org_name\\n,b.area_id\\n,b.area_name\\n,b.visit_cnt\\n,b.assess_cnt\\n,b.card_type\\n,case when b.first_intention_type=1 then 1 else 0 end as first_high_cnt\\n,case when b.first_intention_type=2 then 1 else 0 end as first_mid_cnt\\n,case when b.first_intention_type=3 then 1 else 0 end as first_low_cnt\\n,case when b.first_intention_type=4 then 1 else 0 end as first_highest_cnt\\n,case when b.intention_type=1 then 1 else 0 end as high_cnt\\n,case when b.intention_type=2 then 1 else 0 end as mid_cnt\\n,case when b.intention_type=3 then 1 else 0 end as low_cnt\\n,case when b.intention_type=4 then 1 else 0 end as highest_cnt\\n,case when b.deposit_time is not null then 1 else 0 end as deposit_cust_cnt\\n,case when b.sign_time is not null then b.visit_cnt else 0 end as sign_cust_cnt\\n,case when b.deposit_time is not null then b.visit_cnt else 0 end as deposit_cust_visit_cnt\\n,case when b.sign_time is not null then b.visit_cnt else 0 end as sign_cust_vist_cnt\\n,case when b.assess_cnt is not null then 1 else 0 end as assess_cust_cnt\\nfrom \\n(\\nselect \\n t.intention_customer_id\\n,t.sub_org_id                      --  '养老机构id'\\n,t.sub_org_name                    --  '养老机构名称'\\n,t.org_id                      --  '集团id'\\n,t.org_name                       --  '集团名称'\\n,t.area_id                       --  '区域id'\\n,t.area_name                       --  '区域名称'\\n,t.visit_cnt                       --  '回访次数'\\n,t.first_intention_type           --  '首次意向'\\n,t.intention_type           --  '当前意向' \\n,t.assess_cnt                       \\n,t.deposit_time      -- '下定时间集合'\\n,t.sign_time       -- '签约时间集合'\\n,l1.card_type \\nfrom db_dw_hr.clife_hr_dws_crm_cust_card_type_info_tmp t \\nlateral view explode(split(card_types,','))   l1 as  card_type \\n) b\\n) t1\\ngroup by t1.sub_org_id,t1.card_type) b1 \\nfull join \\n(\\nselect\\nt1.sub_org_id\\n,t1.card_type\\n,sum(t1.apply_member_cnt)  apply_member_cnt\\n,sum(t1.deposit_member_cnt)  deposit_member_cnt\\n,sum(t1.sign_member_cnt)  sign_member_cnt\\n,sum(t1.transfer_to_member_cnt)   transfer_to_member_cnt\\n,sum(t1.transfer_from_member_cnt)  transfer_from_member_cnt\\n,sum(t1.withdraw_member_cnt)   withdraw_member_cnt\\nfrom \\n(\\nselect \\nc.membership_id\\n,c.sub_org_id\\n,c.card_type\\n,case when apply_time   is null then 1 else 0 end as apply_member_cnt\\n,case when deposit_time is null then 1 else 0 end as deposit_member_cnt\\n,case when sign_time   is null then 1 else 0 end as sign_member_cnt\\n,case when transfer_to_time is null then 1 else 0 end as transfer_to_member_cnt\\n,case when transfer_from_time is null then 1 else 0 end as transfer_from_member_cnt\\n,case when withdraw_time is null then 1 else 0 end as withdraw_member_cnt\\nfrom \\n(select \\n t.membership_id  \\n,t.sub_org_id                      --  '养老机构id'\\n,card_type\\n,apply_time      -- '预申请时间集合' \\n,deposit_time      -- '下定时间集合'\\n,sign_time       -- '签约时间集合'\\n,transfer_to_time       -- '转让时间集合'\\n,transfer_from_time       -- '继承时间集合'\\n,withdraw_time       -- '退会时间集合'\\nfrom \\ndb_dw_hr.clife_hr_dws_crm_member_card_type_info_tmp  t \\nlateral view explode(split(card_types,','))   l1 as  card_type )  c\\n) t1\\ngroup by t1.sub_org_id,t1.card_type) c1\\non b1.sub_org_id=c1.sub_org_id  and b1.card_type=c1.card_type\\nleft join \\n(\\nselect\\nt1.sub_org_id\\n,t1.card_type\\n,count(distinct t1.deposit_room_cnt)  deposit_room_cnt\\n,count(distinct t1.sign_room_cnt)  sign_room_cnt\\nfrom \\n(\\nselect \\nc.room_id\\n,c.sub_org_id\\n,c.card_type\\n,case when deposit_time is null then room_id else null end as deposit_room_cnt\\n,case when sign_time   is null then room_id else null end as sign_room_cnt\\nfrom \\n(select \\n t.room_id  \\n,sub_org_id                      --  '养老机构id' \\n,deposit_time      -- '下定时间集合'\\n,sign_time       -- '签约时间集合'\\n,card_type\\nfrom \\ndb_dw_hr.clife_hr_dws_crm_room_card_type_info_tmp t \\nlateral view explode(split(card_types,','))   l1 as  card_type)  c\\n) t1\\ngroup by t1.sub_org_id,t1.card_type) d1\\non b1.sub_org_id=d1.sub_org_id  and b1.card_type=d1.card_type\\nleft join \\n(\\n  select \\n sub_org_id\\n,ca.type as card_type\\n,sum(deposit_amount)    deposit_amount         --     '下定额'\\n,sum(receivable_amount) sales_amount            --  '应收金额'\\n,sum(received_amount)   received_amount            --  '已收金额'\\nfrom db_dw_hr.clife_hr_dwm_market t \\nleft join db_dw_hr.clife_hr_dim_card ca\\non t.card_id=ca.card_id and ca.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n where t.part_date= regexp_replace(date_sub(current_date(),1),'-','')\\ngroup by t.sub_org_id,ca.type\\n) e1\\non b1.sub_org_id=e1.sub_org_id  and b1.card_type=e1.card_type\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_crm_room_card_type_info_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-21332\",\"name\":\"clife_hr_dws_market_by_card_type_d_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table if not exists db_dw_hr.clife_hr_dws_market_by_card_type_d_tmp stored as parquet as \\nselect\\nsplit(getSet2(concat(if(b1.card_type is null,'',b1.card_type),',',if(tt2.card_type is null,'',tt2.card_type),',',if(tt3.card_type is null,'',tt3.card_type),',',if(tt7.card_type is null,'',tt7.card_type),',',if(tt8.card_type is null,'',tt8.card_type),',',if(tt9.card_type is null,'',tt9.card_type),',',if(tt10.card_type is null,'',tt10.card_type),',','')),',')[1] as card_type\\n,split(getSet2(concat(if(b1.sub_org_id is null,'',b1.sub_org_id),',',if(tt2.sub_org_id is null,'',tt2.sub_org_id),',',if(tt3.sub_org_id is null,'',tt3.sub_org_id),',',if(tt7.sub_org_id is null,'',tt7.sub_org_id),',',if(tt8.sub_org_id is null,'',tt8.sub_org_id),',',if(tt9.sub_org_id is null,'',tt9.sub_org_id),',',if(tt10.sub_org_id is null,'',tt10.sub_org_id),',','')),',')[1] as sub_org_id                          --   '养老机构id',\\n,b1.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,b1.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,b1.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,b1.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,b1.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,b1.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,b1.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,b1.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,b1.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,tt2.deposit_cust_cnt                    --   '下定客户数'\\n,tt3.sign_cust_cnt                       --   '签约客户数'\\n,tt8.transfer_to_member_cnt              --   '转让会籍数'\\n,tt9.transfer_from_member_cnt            --   '继承会籍数'\\n,tt10.withdraw_member_cnt                 --   '退会会籍数'\\n,tt7.apply_member_cnt                    --   '预申请会籍数量'\\n,tt2.deposit_member_cnt                  --   '下定会籍数量'\\n,tt2.deposit_room_cnt                    --   '下定房间数量'\\n,tt3.sign_member_cnt                     --   '签约会籍数量'\\n,tt3.sign_room_cnt                       --   '签约房间数量'\\n,tt2.deposit_amount                      --   '下定额'\\n,tt3.sales_amount                        --   '销售额' \\n,split(getSet2(concat(if(b1.regist_date is null,'',b1.regist_date),',',if(tt2.deposit_date is null,'',tt2.deposit_date),',',if(tt3.sign_date is null,'',tt3.sign_date),',',if(tt7.apply_date is null,'',tt7.apply_date),',',if(tt8.transfer_to_date is null,'',tt8.transfer_to_date),',',if(tt9.transfer_from_date is null,'',tt9.transfer_from_date),',',if(tt10.withdraw_date is null,'',tt10.withdraw_date),',','')),',')[1]  as data_date                  -- 数据日期\\nfrom  \\n(\\n select\\n t1.sub_org_id\\n,t1.card_type\\n,t1.regist_date\\n,sum(first_high_cnt)  as crm_first_intent_high_cnt  --'营销管理模块首次意向感兴趣客户数'\\n,sum(first_mid_cnt)   as crm_first_intent_mid_cnt   --'营销管理模块首次意向兴趣一般客户数'\\n,sum(first_low_cnt)   as crm_first_intent_low_cnt   --'营销管理模块首次意向不感兴趣客户数'\\n,sum(first_highest_cnt)  as crm_first_intent_highest_cnt  --'营销管理模块首次意向希望购买客户数'\\n,sum(high_cnt)     as crm_intent_high_cnt  --'营销管理模块意向感兴趣客户数'\\n,sum(mid_cnt)      as crm_intent_mid_cnt   --'营销管理模块意向兴趣一般客户数'\\n,sum(low_cnt)      as crm_intent_low_cnt   --'营销管理模块意向不感兴趣客户数'\\n,sum(highest_cnt)  as crm_intent_highest_cnt  --'营销管理模块意向希望购买客户数'\\n,count(distinct intention_customer_id)  as crm_intent_cnt    --'营销管理模块意向客户数',\\n from \\n(\\nselect \\n b.intention_customer_id\\n,b.sub_org_id\\n,b.sub_org_name\\n,b.org_id\\n,b.org_name\\n,b.area_id\\n,b.area_name\\n,case when b.first_intention_type=1 then 1 else 0 end as first_high_cnt\\n,case when b.first_intention_type=2 then 1 else 0 end as first_mid_cnt\\n,case when b.first_intention_type=3 then 1 else 0 end as first_low_cnt\\n,case when b.first_intention_type=4 then 1 else 0 end as first_highest_cnt\\n,case when b.intention_type=1 then 1 else 0 end as high_cnt\\n,case when b.intention_type=2 then 1 else 0 end as mid_cnt\\n,case when b.intention_type=3 then 1 else 0 end as low_cnt\\n,case when b.intention_type=4 then 1 else 0 end as highest_cnt\\n,from_unixtime( cast(regist_time as int),'yyyy-MM-dd')  as regist_date\\n,b.card_type\\nfrom \\n(\\nselect \\n t.intention_customer_id\\n,sub_org_id                      --  '养老机构id'\\n,sub_org_name                    --  '养老机构名称'\\n,org_id                      --  '集团id'\\n,org_name                       --  '集团名称'\\n,area_id                       --  '区域id'\\n,area_name                       --  '区域名称'\\n,first_intention_type           --  '首次意向'\\n,intention_type           --  '当前意向'                        \\n,regist_time\\n,card_type\\nfrom\\ndb_dw_hr.clife_hr_dws_crm_cust_card_type_info_tmp t \\nlateral view explode(split(card_types,',')) l1 as card_type\\n) b\\n) t1\\ngroup by t1.sub_org_id,t1.card_type,t1.regist_date) b1 \\nfull join \\n(\\nselect \\naa2.sub_org_id\\n,card_type\\n,aa2.deposit_date\\n,count(distinct intention_customer_id) as deposit_cust_cnt  -- '下定客户数'\\n,sum(deposit_amount)    deposit_amount         --     '下定额'\\n,count(distinct membership_id)   as deposit_member_cnt\\n,count(distinct room_id)         as deposit_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,card_type\\n,deposit_amount             --     '下定额'\\n,from_unixtime( cast(deposit_time as int),'yyyy-MM-dd')  as deposit_date \\n,t.membership_id\\n,t.room_id\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa2\\ngroup by aa2.sub_org_id,aa2.card_type,aa2.deposit_date\\n)  tt2\\non b1.sub_org_id=tt2.sub_org_id  and b1.card_type=tt2.card_type and b1.regist_date=tt2.deposit_date\\nfull join \\n(\\nselect \\naa3.sub_org_id\\n,aa3.sign_date\\n,aa3.card_type\\n,count(distinct intention_customer_id) as sign_cust_cnt  -- '下定客户数'\\n,sum(receivable_amount) sales_amount            --  '销售金额'\\n,sum(received_amount)   received_amount            --  '已收金额'\\n,count(distinct membership_id)   as sign_member_cnt\\n,count(distinct room_id)         as sign_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,card_type\\n,t.membership_id\\n,t.room_id\\n,from_unixtime( cast(sign_time as int),'yyyy-MM-dd')  as sign_date\\n,receivable_amount             --  '应收金额'\\n,received_amount               --  '已收金额' \\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa3\\ngroup by aa3.sub_org_id,aa3.card_type,aa3.sign_date\\n)  tt3\\non b1.sub_org_id=tt3.sub_org_id and b1.card_type=tt3.card_type and b1.regist_date=tt3.sign_date\\nfull join \\n(\\nselect\\naa7.sub_org_id\\n,aa7.card_type\\n,aa7.apply_date\\n,count(distinct pre_membership_id) as apply_member_cnt\\nfrom \\n(\\nselect \\nt.pre_membership_id\\n,t.sub_org_id\\n,t.card_type\\n,from_unixtime( cast(t.apply_time as int),'yyyy-MM-dd')  apply_date\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa7\\ngroup by aa7.sub_org_id,aa7.card_type,aa7.apply_date\\n) tt7\\non b1.sub_org_id=tt7.sub_org_id  and b1.card_type=tt7.card_type and b1.regist_date=tt7.apply_date\\nfull join \\n(\\nselect\\naa8.sub_org_id\\n,aa8.card_type\\n,aa8.transfer_to_date\\n,count(distinct membership_id) as transfer_to_member_cnt\\n,sum(other_transfor_to_amount)    other_transfor_to_amount     --  '其他转让费' \\n,sum(transfor_to_amount)          transfor_to_amount      --  '转让费'\\nfrom \\n(\\nselect \\nt.membership_id\\n,t.other_transfor_to_amount      --  '其他转让费' \\n,t.transfor_to_amount            --  '转让费'\\n,t.sub_org_id\\n,t.card_type\\n,from_unixtime( cast(t.transfor_to_time as int),'yyyy-MM-dd')  transfer_to_date\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa8\\ngroup by aa8.sub_org_id,aa8.card_type,aa8.transfer_to_date\\n) tt8\\non b1.sub_org_id=tt8.sub_org_id and b1.card_type=tt8.card_type and b1.regist_date=tt8.transfer_to_date\\nfull join \\n(\\nselect\\naa9.sub_org_id\\n,aa9.card_type\\n,aa9.transfer_from_date\\n,count(distinct membership_id) as transfer_from_member_cnt\\n,sum(other_transfer_from_amount)    other_transfer_from_amount     \\n,sum(transfer_from_amount)          transfer_from_amount   \\nfrom   \\n(\\nselect \\nt.membership_id\\n,t.other_transfor_from_amount as other_transfer_from_amount       \\n,t.transfor_from_amount  as transfer_from_amount            \\n,t.sub_org_id\\n,t.card_type\\n,from_unixtime( cast(t.transfor_from_time as int),'yyyy-MM-dd')  transfer_from_date\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa9\\ngroup by aa9.sub_org_id, aa9.card_type,aa9.transfer_from_date\\n) tt9\\non b1.sub_org_id=tt9.sub_org_id and b1.card_type=tt9.card_type and b1.regist_date=tt9.transfer_from_date\\nfull join \\n(\\nselect\\naa10.sub_org_id\\n,aa10.card_type\\n,aa10.withdraw_date\\n,count(distinct membership_id) as withdraw_member_cnt   \\n,sum(withdraw_amount)          withdraw_amount     \\nfrom \\n(\\nselect \\nt.membership_id      \\n,t.withdraw_amount            \\n,t.sub_org_id\\n,t.card_type\\n,from_unixtime( cast(t.withdraw_time as int),'yyyy-MM-dd')  withdraw_date\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa10\\ngroup by aa10.sub_org_id,aa10.card_type,aa10.withdraw_date\\n) tt10\\non b1.sub_org_id=tt10.sub_org_id and b1.card_type=tt10.card_type and b1.regist_date=tt10.withdraw_date\",\"udfs\":\"14\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_market_by_card_type_d_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-65872\",\"name\":\"drop_clife_hr_dws_market_by_card_type_d_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_market_by_card_type_d_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_card_type_f\"]},{\"type\":\"SQL\",\"id\":\"tasks-4185\",\"name\":\"clife_hr_dws_market_by_card_type_d\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_card_type_d partition(part_date)\\nselect\\n a.card_type                           --   '会籍卡id'                             \\n,a.sub_org_id                          --   '养老机构id'\\n,b.sub_org_name                        --   '养老机构名称'\\n,b.org_id                              --   '养老集团id'\\n,b.org_name                            --   '养老集团名称'\\n,c.area_id                             --   '区域id'\\n,c.area_name                           --   '区域名称'\\n,a.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,a.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,a.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,a.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,a.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,a.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,a.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,a.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数''\\n,a.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,a.deposit_cust_cnt                    --   '下定客户数'\\n,a.sign_cust_cnt                       --   '签约客户数'\\n,a.transfer_to_member_cnt              --   '转让会籍数'\\n,a.transfer_from_member_cnt            --   '继承会籍数'\\n,a.withdraw_member_cnt                 --   '退会会籍数'\\n,a.apply_member_cnt                    --   '预申请会籍数量'\\n,a.deposit_member_cnt                  --   '下定会籍数量'\\n,a.deposit_room_cnt                    --   '下定房间数量'\\n,a.sign_member_cnt                     --   '签约会籍数量'\\n,a.sign_room_cnt                       --   '签约房间数量'\\n,a.deposit_amount                      --  '下定额'\\n,a.sales_amount                        --  '销售额'\\n,a.data_date                           --   '数据日期'\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom \\ndb_dw_hr.clife_hr_dws_market_by_card_type_d_tmp a \\nleft join \\ndb_dw_hr.clife_hr_dim_admin_sub_org b\\non a.sub_org_id=b.sub_org_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_geographic_info c \\non concat(substr(b.city,1,5),b.area,'0000')=c.area_id\\nand c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_card_type_d_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-41851\",\"name\":\"clife_hr_dws_market_by_card_type_m_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table if not exists db_dw_hr.clife_hr_dws_market_by_card_type_m_tmp stored as parquet as \\nselect\\nsplit(getSet2(concat(if(b1.card_type is null,'',b1.card_type),',',if(tt2.card_type is null,'',tt2.card_type),',',if(tt3.card_type is null,'',tt3.card_type),',',if(tt7.card_type is null,'',tt7.card_type),',',if(tt8.card_type is null,'',tt8.card_type),',',if(tt9.card_type is null,'',tt9.card_type),',',if(tt10.card_type is null,'',tt10.card_type),',','')),',')[1] as card_type\\n,split(getSet2(concat(if(b1.sub_org_id is null,'',b1.sub_org_id),',',if(tt2.sub_org_id is null,'',tt2.sub_org_id),',',if(tt3.sub_org_id is null,'',tt3.sub_org_id),',',if(tt7.sub_org_id is null,'',tt7.sub_org_id),',',if(tt8.sub_org_id is null,'',tt8.sub_org_id),',',if(tt9.sub_org_id is null,'',tt9.sub_org_id),',',if(tt10.sub_org_id is null,'',tt10.sub_org_id),',','')),',')[1] as sub_org_id                          --   '养老机构id',\\n,b1.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,b1.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,b1.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,b1.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,b1.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,b1.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,b1.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,b1.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,b1.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,tt2.deposit_cust_cnt                    --   '下定客户数'\\n,tt3.sign_cust_cnt                       --   '签约客户数'\\n,tt8.transfer_to_member_cnt              --   '转让会籍数'\\n,tt9.transfer_from_member_cnt            --   '继承会籍数'\\n,tt10.withdraw_member_cnt                 --   '退会会籍数'\\n,tt7.apply_member_cnt                    --   '预申请会籍数量'\\n,tt2.deposit_member_cnt                  --   '下定会籍数量'\\n,tt2.deposit_room_cnt                    --   '下定房间数量'\\n,tt3.sign_member_cnt                     --   '签约会籍数量'\\n,tt3.sign_room_cnt                       --   '签约房间数量'\\n,tt2.deposit_amount                      --   '下定额'\\n,tt3.sales_amount                        --   '销售额' \\n,split(getSet2(concat(if(b1.regist_month is null,'',b1.regist_month),',',if(tt2.deposit_month is null,'',tt2.deposit_month),',',if(tt3.sign_month is null,'',tt3.sign_month),',',if(tt7.apply_month is null,'',tt7.apply_month),',',if(tt8.transfer_to_month is null,'',tt8.transfer_to_month),',',if(tt9.transfer_from_month is null,'',tt9.transfer_from_month),',',if(tt10.withdraw_month is null,'',tt10.withdraw_month),',','')),',')[1]  as data_month                  -- 数据日期\\nfrom  \\n(\\n select\\n t1.sub_org_id\\n,t1.card_type\\n,t1.regist_month\\n,sum(first_high_cnt)  as crm_first_intent_high_cnt  --'营销管理模块首次意向感兴趣客户数'\\n,sum(first_mid_cnt)   as crm_first_intent_mid_cnt   --'营销管理模块首次意向兴趣一般客户数'\\n,sum(first_low_cnt)   as crm_first_intent_low_cnt   --'营销管理模块首次意向不感兴趣客户数'\\n,sum(first_highest_cnt)  as crm_first_intent_highest_cnt  --'营销管理模块首次意向希望购买客户数'\\n,sum(high_cnt)     as crm_intent_high_cnt  --'营销管理模块意向感兴趣客户数'\\n,sum(mid_cnt)      as crm_intent_mid_cnt   --'营销管理模块意向兴趣一般客户数'\\n,sum(low_cnt)      as crm_intent_low_cnt   --'营销管理模块意向不感兴趣客户数'\\n,sum(highest_cnt)  as crm_intent_highest_cnt  --'营销管理模块意向希望购买客户数'\\n,count(distinct intention_customer_id)  as crm_intent_cnt    --'营销管理模块意向客户数',\\n from \\n(\\nselect \\n b.intention_customer_id\\n,b.sub_org_id\\n,b.sub_org_name\\n,b.org_id\\n,b.org_name\\n,b.area_id\\n,b.area_name\\n,case when b.first_intention_type=1 then 1 else 0 end as first_high_cnt\\n,case when b.first_intention_type=2 then 1 else 0 end as first_mid_cnt\\n,case when b.first_intention_type=3 then 1 else 0 end as first_low_cnt\\n,case when b.first_intention_type=4 then 1 else 0 end as first_highest_cnt\\n,case when b.intention_type=1 then 1 else 0 end as high_cnt\\n,case when b.intention_type=2 then 1 else 0 end as mid_cnt\\n,case when b.intention_type=3 then 1 else 0 end as low_cnt\\n,case when b.intention_type=4 then 1 else 0 end as highest_cnt\\n,from_unixtime( cast(regist_time as int),'yyyy-MM')  as regist_month\\n,b.card_type\\nfrom \\n(\\nselect \\n t.intention_customer_id\\n,sub_org_id                      --  '养老机构id'\\n,sub_org_name                    --  '养老机构名称'\\n,org_id                      --  '集团id'\\n,org_name                       --  '集团名称'\\n,area_id                       --  '区域id'\\n,area_name                       --  '区域名称'\\n,first_intention_type           --  '首次意向'\\n,intention_type           --  '当前意向'                        \\n,regist_time\\n,card_type\\nfrom\\ndb_dw_hr.clife_hr_dws_crm_cust_card_type_info_tmp t \\nlateral view explode(split(card_types,',')) l1 as card_type\\n) b\\n) t1\\ngroup by t1.sub_org_id,t1.card_type,t1.regist_month) b1 \\nfull join \\n(\\nselect \\naa2.sub_org_id\\n,card_type\\n,aa2.deposit_month\\n,count(distinct intention_customer_id) as deposit_cust_cnt  -- '下定客户数'\\n,sum(deposit_amount)    deposit_amount         --     '下定额'\\n,count(distinct membership_id)   as deposit_member_cnt\\n,count(distinct room_id)         as deposit_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,card_type\\n,deposit_amount             --     '下定额'\\n,from_unixtime( cast(deposit_time as int),'yyyy-MM')  as deposit_month \\n,t.membership_id\\n,t.room_id\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa2\\ngroup by aa2.sub_org_id,aa2.card_type,aa2.deposit_month\\n)  tt2\\non b1.sub_org_id=tt2.sub_org_id  and b1.card_type=tt2.card_type and b1.regist_month=tt2.deposit_month\\nfull join \\n(\\nselect \\naa3.sub_org_id\\n,aa3.sign_month\\n,aa3.card_type\\n,count(distinct intention_customer_id) as sign_cust_cnt  -- '下定客户数'\\n,sum(receivable_amount) sales_amount            --  '销售金额'\\n,sum(received_amount)   received_amount            --  '已收金额'\\n,count(distinct membership_id)   as sign_member_cnt\\n,count(distinct room_id)         as sign_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,card_type\\n,t.membership_id\\n,t.room_id\\n,from_unixtime( cast(sign_time as int),'yyyy-MM')  as sign_month\\n,receivable_amount             --  '应收金额'\\n,received_amount               --  '已收金额' \\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa3\\ngroup by aa3.sub_org_id,aa3.card_type,aa3.sign_month\\n)  tt3\\non b1.sub_org_id=tt3.sub_org_id and b1.card_type=tt3.card_type and b1.regist_month=tt3.sign_month\\nfull join \\n(\\nselect\\naa7.sub_org_id\\n,aa7.card_type\\n,aa7.apply_month\\n,count(distinct pre_membership_id) as apply_member_cnt\\nfrom \\n(\\nselect \\nt.pre_membership_id\\n,t.sub_org_id\\n,t.card_type\\n,from_unixtime( cast(t.apply_time as int),'yyyy-MM')  apply_month\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa7\\ngroup by aa7.sub_org_id,aa7.card_type,aa7.apply_month\\n) tt7\\non b1.sub_org_id=tt7.sub_org_id  and b1.card_type=tt7.card_type and b1.regist_month=tt7.apply_month\\nfull join \\n(\\nselect\\naa8.sub_org_id\\n,aa8.card_type\\n,aa8.transfer_to_month\\n,count(distinct membership_id) as transfer_to_member_cnt\\n,sum(other_transfor_to_amount)    other_transfor_to_amount     --  '其他转让费' \\n,sum(transfor_to_amount)          transfor_to_amount      --  '转让费'\\nfrom \\n(\\nselect \\nt.membership_id\\n,t.other_transfor_to_amount      --  '其他转让费' \\n,t.transfor_to_amount            --  '转让费'\\n,t.sub_org_id\\n,t.card_type\\n,from_unixtime( cast(t.transfor_to_time as int),'yyyy-MM')  transfer_to_month\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa8\\ngroup by aa8.sub_org_id,aa8.card_type,aa8.transfer_to_month\\n) tt8\\non b1.sub_org_id=tt8.sub_org_id and b1.card_type=tt8.card_type and b1.regist_month=tt8.transfer_to_month\\nfull join \\n(\\nselect\\naa9.sub_org_id\\n,aa9.card_type\\n,aa9.transfer_from_month\\n,count(distinct membership_id) as transfer_from_member_cnt\\n,sum(other_transfer_from_amount)    other_transfer_from_amount     \\n,sum(transfer_from_amount)          transfer_from_amount   \\nfrom   \\n(\\nselect \\nt.membership_id\\n,t.other_transfor_from_amount as other_transfer_from_amount       \\n,t.transfor_from_amount  as transfer_from_amount            \\n,t.sub_org_id\\n,t.card_type\\n,from_unixtime( cast(t.transfor_from_time as int),'yyyy-MM')  transfer_from_month\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa9\\ngroup by aa9.sub_org_id, aa9.card_type,aa9.transfer_from_month\\n) tt9\\non b1.sub_org_id=tt9.sub_org_id and b1.card_type=tt9.card_type and b1.regist_month=tt9.transfer_from_month\\nfull join \\n(\\nselect\\naa10.sub_org_id\\n,aa10.card_type\\n,aa10.withdraw_month\\n,count(distinct membership_id) as withdraw_member_cnt   \\n,sum(withdraw_amount)          withdraw_amount     \\nfrom \\n(\\nselect \\nt.membership_id      \\n,t.withdraw_amount            \\n,t.sub_org_id\\n,t.card_type\\n,from_unixtime( cast(t.withdraw_time as int),'yyyy-MM')  withdraw_month\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa10\\ngroup by aa10.sub_org_id,aa10.card_type,aa10.withdraw_month\\n) tt10\\non b1.sub_org_id=tt10.sub_org_id and b1.card_type=tt10.card_type and b1.regist_month=tt10.withdraw_month\",\"udfs\":\"14\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_market_by_card_type_m_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-48398\",\"name\":\"drop_clife_hr_dws_market_by_card_type_m_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_market_by_card_type_m_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_card_type_d\"]},{\"type\":\"SQL\",\"id\":\"tasks-28890\",\"name\":\"clife_hr_dws_market_by_card_type_m\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_card_type_m partition(part_date)\\nselect\\n a.card_type                           --   '会籍卡id'                             \\n,a.sub_org_id                          --   '养老机构id'\\n,b.sub_org_name                        --   '养老机构名称'\\n,b.org_id                              --   '养老集团id'\\n,b.org_name                            --   '养老集团名称'\\n,c.area_id                             --   '区域id'\\n,c.area_name                           --   '区域名称'\\n,a.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,a.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,a.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,a.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,a.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,a.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,a.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,a.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数''\\n,a.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,a.deposit_cust_cnt                    --   '下定客户数'\\n,a.sign_cust_cnt                       --   '签约客户数'\\n,a.transfer_to_member_cnt              --   '转让会籍数'\\n,a.transfer_from_member_cnt            --   '继承会籍数'\\n,a.withdraw_member_cnt                 --   '退会会籍数'\\n,a.apply_member_cnt                    --   '预申请会籍数量'\\n,a.deposit_member_cnt                  --   '下定会籍数量'\\n,a.deposit_room_cnt                    --   '下定房间数量'\\n,a.sign_member_cnt                     --   '签约会籍数量'\\n,a.sign_room_cnt                       --   '签约房间数量'\\n,a.deposit_amount                      --  '下定额'\\n,a.sales_amount                        --  '销售额'\\n,a.data_month                           --   '数据日期'\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom \\ndb_dw_hr.clife_hr_dws_market_by_card_type_m_tmp a \\nleft join \\ndb_dw_hr.clife_hr_dim_admin_sub_org b\\non a.sub_org_id=b.sub_org_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_geographic_info c \\non concat(substr(b.city,1,5),b.area,'0000')=c.area_id\\nand c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_card_type_m_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-98070\",\"name\":\"clife_hr_dws_market_by_card_type_y_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table if not exists db_dw_hr.clife_hr_dws_market_by_card_type_y_tmp stored as parquet as \\nselect\\nsplit(getSet2(concat(if(b1.card_type is null,'',b1.card_type),',',if(tt2.card_type is null,'',tt2.card_type),',',if(tt3.card_type is null,'',tt3.card_type),',',if(tt7.card_type is null,'',tt7.card_type),',',if(tt8.card_type is null,'',tt8.card_type),',',if(tt9.card_type is null,'',tt9.card_type),',',if(tt10.card_type is null,'',tt10.card_type),',','')),',')[1] as card_type\\n,split(getSet2(concat(if(b1.sub_org_id is null,'',b1.sub_org_id),',',if(tt2.sub_org_id is null,'',tt2.sub_org_id),',',if(tt3.sub_org_id is null,'',tt3.sub_org_id),',',if(tt7.sub_org_id is null,'',tt7.sub_org_id),',',if(tt8.sub_org_id is null,'',tt8.sub_org_id),',',if(tt9.sub_org_id is null,'',tt9.sub_org_id),',',if(tt10.sub_org_id is null,'',tt10.sub_org_id),',','')),',')[1] as sub_org_id                          --   '养老机构id',\\n,b1.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,b1.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,b1.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,b1.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,b1.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,b1.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,b1.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,b1.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数'\\n,b1.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,tt2.deposit_cust_cnt                    --   '下定客户数'\\n,tt3.sign_cust_cnt                       --   '签约客户数'\\n,tt8.transfer_to_member_cnt              --   '转让会籍数'\\n,tt9.transfer_from_member_cnt            --   '继承会籍数'\\n,tt10.withdraw_member_cnt                 --   '退会会籍数'\\n,tt7.apply_member_cnt                    --   '预申请会籍数量'\\n,tt2.deposit_member_cnt                  --   '下定会籍数量'\\n,tt2.deposit_room_cnt                    --   '下定房间数量'\\n,tt3.sign_member_cnt                     --   '签约会籍数量'\\n,tt3.sign_room_cnt                       --   '签约房间数量'\\n,tt2.deposit_amount                      --   '下定额'\\n,tt3.sales_amount                        --   '销售额' \\n,split(getSet2(concat(if(b1.regist_year is null,'',b1.regist_year),',',if(tt2.deposit_year is null,'',tt2.deposit_year),',',if(tt3.sign_year is null,'',tt3.sign_year),',',if(tt7.apply_year is null,'',tt7.apply_year),',',if(tt8.transfer_to_year is null,'',tt8.transfer_to_year),',',if(tt9.transfer_from_year is null,'',tt9.transfer_from_year),',',if(tt10.withdraw_year is null,'',tt10.withdraw_year),',','')),',')[1]  as data_year                  -- 数据日期\\nfrom  \\n(\\n select\\n t1.sub_org_id\\n,t1.card_type\\n,t1.regist_year\\n,sum(first_high_cnt)  as crm_first_intent_high_cnt  --'营销管理模块首次意向感兴趣客户数'\\n,sum(first_mid_cnt)   as crm_first_intent_mid_cnt   --'营销管理模块首次意向兴趣一般客户数'\\n,sum(first_low_cnt)   as crm_first_intent_low_cnt   --'营销管理模块首次意向不感兴趣客户数'\\n,sum(first_highest_cnt)  as crm_first_intent_highest_cnt  --'营销管理模块首次意向希望购买客户数'\\n,sum(high_cnt)     as crm_intent_high_cnt  --'营销管理模块意向感兴趣客户数'\\n,sum(mid_cnt)      as crm_intent_mid_cnt   --'营销管理模块意向兴趣一般客户数'\\n,sum(low_cnt)      as crm_intent_low_cnt   --'营销管理模块意向不感兴趣客户数'\\n,sum(highest_cnt)  as crm_intent_highest_cnt  --'营销管理模块意向希望购买客户数'\\n,count(distinct intention_customer_id)  as crm_intent_cnt    --'营销管理模块意向客户数',\\n from \\n(\\nselect \\n b.intention_customer_id\\n,b.sub_org_id\\n,b.sub_org_name\\n,b.org_id\\n,b.org_name\\n,b.area_id\\n,b.area_name\\n,case when b.first_intention_type=1 then 1 else 0 end as first_high_cnt\\n,case when b.first_intention_type=2 then 1 else 0 end as first_mid_cnt\\n,case when b.first_intention_type=3 then 1 else 0 end as first_low_cnt\\n,case when b.first_intention_type=4 then 1 else 0 end as first_highest_cnt\\n,case when b.intention_type=1 then 1 else 0 end as high_cnt\\n,case when b.intention_type=2 then 1 else 0 end as mid_cnt\\n,case when b.intention_type=3 then 1 else 0 end as low_cnt\\n,case when b.intention_type=4 then 1 else 0 end as highest_cnt\\n,from_unixtime( cast(regist_time as int),'yyyy')  as regist_year\\n,b.card_type\\nfrom \\n(\\nselect \\n t.intention_customer_id\\n,sub_org_id                      --  '养老机构id'\\n,sub_org_name                    --  '养老机构名称'\\n,org_id                      --  '集团id'\\n,org_name                       --  '集团名称'\\n,area_id                       --  '区域id'\\n,area_name                       --  '区域名称'\\n,first_intention_type           --  '首次意向'\\n,intention_type           --  '当前意向'                        \\n,regist_time\\n,card_type\\nfrom\\ndb_dw_hr.clife_hr_dws_crm_cust_card_type_info_tmp t \\nlateral view explode(split(card_types,',')) l1 as card_type\\n) b\\n) t1\\ngroup by t1.sub_org_id,t1.card_type,t1.regist_year) b1 \\nfull join \\n(\\nselect \\naa2.sub_org_id\\n,card_type\\n,aa2.deposit_year\\n,count(distinct intention_customer_id) as deposit_cust_cnt  -- '下定客户数'\\n,sum(deposit_amount)    deposit_amount         --     '下定额'\\n,count(distinct membership_id)   as deposit_member_cnt\\n,count(distinct room_id)         as deposit_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,card_type\\n,deposit_amount             --     '下定额'\\n,from_unixtime( cast(deposit_time as int),'yyyy')  as deposit_year \\n,t.membership_id\\n,t.room_id\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa2\\ngroup by aa2.sub_org_id,aa2.card_type,aa2.deposit_year\\n)  tt2\\non b1.sub_org_id=tt2.sub_org_id  and b1.card_type=tt2.card_type and b1.regist_year=tt2.deposit_year\\nfull join \\n(\\nselect \\naa3.sub_org_id\\n,aa3.sign_year\\n,aa3.card_type\\n,count(distinct intention_customer_id) as sign_cust_cnt  -- '下定客户数'\\n,sum(receivable_amount) sales_amount            --  '销售金额'\\n,sum(received_amount)   received_amount            --  '已收金额'\\n,count(distinct membership_id)   as sign_member_cnt\\n,count(distinct room_id)         as sign_room_cnt\\nfrom \\n(\\nselect\\n t.intention_customer_id\\n,sub_org_id \\n,card_type\\n,t.membership_id\\n,t.room_id\\n,from_unixtime( cast(sign_time as int),'yyyy')  as sign_year\\n,receivable_amount             --  '应收金额'\\n,received_amount               --  '已收金额' \\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa3\\ngroup by aa3.sub_org_id,aa3.card_type,aa3.sign_year\\n)  tt3\\non b1.sub_org_id=tt3.sub_org_id and b1.card_type=tt3.card_type and b1.regist_year=tt3.sign_year\\nfull join \\n(\\nselect\\naa7.sub_org_id\\n,aa7.card_type\\n,aa7.apply_year\\n,count(distinct pre_membership_id) as apply_member_cnt\\nfrom \\n(\\nselect \\nt.pre_membership_id\\n,t.sub_org_id\\n,t.card_type\\n,from_unixtime( cast(t.apply_time as int),'yyyy')  apply_year\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa7\\ngroup by aa7.sub_org_id,aa7.card_type,aa7.apply_year\\n) tt7\\non b1.sub_org_id=tt7.sub_org_id  and b1.card_type=tt7.card_type and b1.regist_year=tt7.apply_year\\nfull join \\n(\\nselect\\naa8.sub_org_id\\n,aa8.card_type\\n,aa8.transfer_to_year\\n,count(distinct membership_id) as transfer_to_member_cnt\\n,sum(other_transfor_to_amount)    other_transfor_to_amount     --  '其他转让费' \\n,sum(transfor_to_amount)          transfor_to_amount      --  '转让费'\\nfrom \\n(\\nselect \\nt.membership_id\\n,t.other_transfor_to_amount      --  '其他转让费' \\n,t.transfor_to_amount            --  '转让费'\\n,t.sub_org_id\\n,t.card_type\\n,from_unixtime( cast(t.transfor_to_time as int),'yyyy')  transfer_to_year\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa8\\ngroup by aa8.sub_org_id,aa8.card_type,aa8.transfer_to_year\\n) tt8\\non b1.sub_org_id=tt8.sub_org_id and b1.card_type=tt8.card_type and b1.regist_year=tt8.transfer_to_year\\nfull join \\n(\\nselect\\naa9.sub_org_id\\n,aa9.card_type\\n,aa9.transfer_from_year\\n,count(distinct membership_id) as transfer_from_member_cnt\\n,sum(other_transfer_from_amount)    other_transfer_from_amount     \\n,sum(transfer_from_amount)          transfer_from_amount   \\nfrom   \\n(\\nselect \\nt.membership_id\\n,t.other_transfor_from_amount as other_transfer_from_amount       \\n,t.transfor_from_amount  as transfer_from_amount            \\n,t.sub_org_id\\n,t.card_type\\n,from_unixtime( cast(t.transfor_from_time as int),'yyyy')  transfer_from_year\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa9\\ngroup by aa9.sub_org_id, aa9.card_type,aa9.transfer_from_year\\n) tt9\\non b1.sub_org_id=tt9.sub_org_id and b1.card_type=tt9.card_type and b1.regist_year=tt9.transfer_from_year\\nfull join \\n(\\nselect\\naa10.sub_org_id\\n,aa10.card_type\\n,aa10.withdraw_year\\n,count(distinct membership_id) as withdraw_member_cnt   \\n,sum(withdraw_amount)          withdraw_amount     \\nfrom \\n(\\nselect \\nt.membership_id      \\n,t.withdraw_amount            \\n,t.sub_org_id\\n,t.card_type\\n,from_unixtime( cast(t.withdraw_time as int),'yyyy')  withdraw_year\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  aa10\\ngroup by aa10.sub_org_id,aa10.card_type,aa10.withdraw_year\\n) tt10\\non b1.sub_org_id=tt10.sub_org_id and b1.card_type=tt10.card_type and b1.regist_year=tt10.withdraw_year\",\"udfs\":\"14\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_market_by_card_type_y_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-30269\",\"name\":\"drop_clife_hr_dws_market_by_card_type_y_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_market_by_card_type_y_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_card_type_m\"]},{\"type\":\"SQL\",\"id\":\"tasks-39298\",\"name\":\"clife_hr_dws_market_by_card_type_y\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_card_type_y partition(part_date)\\nselect\\n a.card_type                           --   '会籍卡id'                             \\n,a.sub_org_id                          --   '养老机构id'\\n,b.sub_org_name                        --   '养老机构名称'\\n,b.org_id                              --   '养老集团id'\\n,b.org_name                            --   '养老集团名称'\\n,c.area_id                             --   '区域id'\\n,c.area_name                           --   '区域名称'\\n,a.crm_first_intent_high_cnt           --   '营销管理模块首次意向感兴趣客户数'\\n,a.crm_first_intent_mid_cnt            --   '营销管理模块首次意向兴趣一般客户数'\\n,a.crm_first_intent_low_cnt            --   '营销管理模块首次意向不感兴趣客户数'\\n,a.crm_first_intent_highest_cnt        --   '营销管理模块首次意向希望购买客户数'\\n,a.crm_intent_high_cnt                 --   '营销管理模块当前意向感兴趣客户数'\\n,a.crm_intent_mid_cnt                  --   '营销管理模块当前意向兴趣一般客户数'\\n,a.crm_intent_low_cnt                  --   '营销管理模块当前意向不感兴趣客户数'\\n,a.crm_intent_highest_cnt              --   '营销管理模块当前意向希望购买客户数''\\n,a.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,a.deposit_cust_cnt                    --   '下定客户数'\\n,a.sign_cust_cnt                       --   '签约客户数'\\n,a.transfer_to_member_cnt              --   '转让会籍数'\\n,a.transfer_from_member_cnt            --   '继承会籍数'\\n,a.withdraw_member_cnt                 --   '退会会籍数'\\n,a.apply_member_cnt                    --   '预申请会籍数量'\\n,a.deposit_member_cnt                  --   '下定会籍数量'\\n,a.deposit_room_cnt                    --   '下定房间数量'\\n,a.sign_member_cnt                     --   '签约会籍数量'\\n,a.sign_room_cnt                       --   '签约房间数量'\\n,a.deposit_amount                      --  '下定额'\\n,a.sales_amount                        --  '销售额'\\n,a.data_year                           --   '数据日期'\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom \\ndb_dw_hr.clife_hr_dws_market_by_card_type_y_tmp a \\nleft join \\ndb_dw_hr.clife_hr_dim_admin_sub_org b\\non a.sub_org_id=b.sub_org_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_geographic_info c \\non concat(substr(b.city,1,5),b.area,'0000')=c.area_id\\nand c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_card_type_y_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-89930\",\"name\":\"clife_hr_dws_market_by_channel_y_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"create table db_dw_hr.clife_hr_dws_market_by_channel_y_tmp stored as parquet as \\nselect\\nsplit(getSet2(concat(if(tt1.channel_id is null,'',tt1.channel_id),',',if(tt2.channel_id is null,'',tt2.channel_id),',',if(tt3.channel_id is null,'',tt3.channel_id),',',if(tt4.channel_id is null,'',tt4.channel_id),',','')),',')[1]  as channel_id                          --  '渠道id'\\n,split(getSet2(concat(if(tt1.sub_org_id is null,'',tt1.sub_org_id),',',if(tt2.sub_org_id is null,'',tt2.sub_org_id),',',if(tt3.sub_org_id is null,'',tt3.sub_org_id),',',if(tt4.sub_org_id is null,'',tt4.sub_org_id),',','')),',')[1]  as sub_org_id                           --  '养老机构id'\\n,tt4.crm_intent_cnt                      --  '营销管理模块意向客户数'\\n,tt2.deposit_cust_cnt                    --  '下定客户数'\\n,tt3.sign_cust_cnt                       --  '签约客户数'\\n,tt1.apply_member_cnt                    --  '预申请会籍数量'\\n,tt2.deposit_member_cnt                  --  '下定会籍数量'\\n,tt2.deposit_room_cnt                    --  '下定房间数量'\\n,tt3.sign_member_cnt                     --  '签约会籍数量'\\n,tt3.sign_room_cnt                       --  '签约房间数量'\\n,tt2.deposit_amount                      -- '下定额'\\n,tt3.sales_amount                        -- '销售额'\\n,split(getSet2(concat(if(tt1.apply_year is null,'',tt1.apply_year),',',if(tt2.deposit_year is null,'',tt2.deposit_year),',',if(tt3.sign_year is null,'',tt3.sign_year),',',if(tt4.regist_year is null,'',tt4.regist_year),',','')),',')[1]  as data_year\\nfrom \\n(select \\na.sub_org_id\\n,a.channel_id\\n,a.apply_year  \\n,count(distinct pre_membership_id)     as apply_member_cnt \\nfrom \\n(\\nselect \\npre_membership_id                      --  '会籍id'\\n,trade_channel_ids                  --  '渠道id'\\n,sub_org_id                         --  '养老机构id'\\n,apply_time                       --  '申请时间'\\n,channel_id\\n,from_unixtime( cast(t.apply_time as int),'yyyy')  as apply_year    -- '申请日期'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nlateral view explode(split(trade_channel_ids,',')) l1 as  channel_id\\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n) a \\ngroup by a.sub_org_id,a.channel_id,a.apply_year\\n) tt1\\nfull join \\n(select \\na.sub_org_id\\n,a.channel_id\\n,a.deposit_year\\n,count(distinct intention_customer_id)  as deposit_cust_cnt   \\n,count(distinct membership_id)     as deposit_member_cnt\\n,count(distinct room_id)     as deposit_room_cnt\\n,sum(deposit_amount)         as deposit_amount   \\nfrom \\n(\\nselect \\nintention_customer_id              --  '意向客户id'\\n,membership_id                      --  '会籍id'\\n,room_id\\n,trade_channel_ids                  --  '渠道id'\\n,sub_org_id                         --  '养老机构id'\\n,deposit_time                       --  '下定时间'\\n,deposit_amount                     --  '定金金额'\\n,channel_id\\n,from_unixtime( cast(t.deposit_time as int),'yyyy')  as deposit_year    -- '下定日期'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nlateral view explode(split(trade_channel_ids,',')) l1 as  channel_id\\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n) a \\ngroup by a.sub_org_id,a.channel_id,a.deposit_year\\n) tt2\\non tt1.sub_org_id=tt2.sub_org_id and tt1.channel_id=tt2.channel_id and tt1.apply_year=tt2.deposit_year\\nfull join \\n(select \\na.sub_org_id\\n,a.channel_id\\n,a.sign_year\\n,count(distinct intention_customer_id)  as sign_cust_cnt   \\n,count(distinct membership_id)     as sign_member_cnt\\n,count(distinct room_id)     as sign_room_cnt\\n,sum(receivable_amount)         as sales_amount   \\nfrom \\n(\\nselect \\nintention_customer_id              --  '意向客户id'\\n,membership_id                      --  '会籍id'\\n,room_id\\n,trade_channel_ids                  --  '渠道id'\\n,sub_org_id                         --  '养老机构id'\\n,sign_time                       --  '签约时间'\\n,receivable_amount                     --  '应收金额'\\n,channel_id\\n,from_unixtime( cast(t.sign_time as int),'yyyy')  as sign_year    -- '签约日期'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nlateral view explode(split(trade_channel_ids,',')) l1 as  channel_id\\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n) a \\ngroup by a.sub_org_id,a.channel_id,a.sign_year\\n) tt3\\non tt1.sub_org_id=tt3.sub_org_id and tt1.channel_id=tt3.channel_id and tt1.apply_year=tt3.sign_year\\nfull join \\n(select \\na.sub_org_id\\n,a.channel_id\\n,a.regist_year  \\n,count(distinct intention_customer_id)     as crm_intent_cnt \\nfrom \\n(\\nselect \\nintention_customer_id              --  '意向客户id'\\n,trade_channel_ids                  --  '渠道id'\\n,sub_org_id                         --  '养老机构id'\\n,regist_time                       --  '录入时间'\\n,channel_id\\n,from_unixtime( cast(t.regist_time as int),'yyyy')  as regist_year    -- '申请日期'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nlateral view explode(split(trade_channel_ids,',')) l1 as  channel_id\\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n) a \\ngroup by a.sub_org_id,a.channel_id,a.regist_year\\n) tt4\\non tt1.sub_org_id=tt4.sub_org_id and tt1.channel_id=tt4.channel_id and tt1.apply_year=tt4.regist_year\",\"udfs\":\"14\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"drop_clife_hr_dws_market_by_channel_y_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-44426\",\"name\":\"drop_clife_hr_dws_market_by_channel_y_tmp\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"drop table if exists db_dw_hr.clife_hr_dws_market_by_channel_y_tmp\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_channel_m\"]},{\"type\":\"SQL\",\"id\":\"tasks-8-5as76q\",\"name\":\"clife_hr_dws_market_by_adv_member_f\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_adv_member_f partition(part_date)\\nselect\\n if(b1.membership_adviser_id is null,a1.membership_adviser_id,b1.membership_adviser_id) as membership_adviser_id  \\n,if(b1.sub_org_id is null,a1.sub_org_id,b1.sub_org_id) as sub_org_id                          --   '养老机构id',\\n,if(b1.sub_org_name is null,a1.sub_org_name,b1.sub_org_name) as sub_org_name                        --   '养老机构名称'\\n,if(b1.org_id is null,a1.org_id,b1.org_id) as org_id                              --   '养老集团id'\\n,if(b1.org_id is null,a1.org_id,b1.org_id) as org_name                            --   '养老集团名称'\\n,if(b1.area_id is null,a1.area_id,b1.area_id) as area_id                             --   '区域id'\\n,if(b1.area_name is null,a1.area_name,b1.area_name) as area_name                           --   '区域名称'\\n,if(b1.membership_adviser_name is null,a1.membership_adviser_name,b1.membership_adviser_name) as membership_adviser_name \\n,a1.advisory_customer_cnt               --   '咨询客户数'\\n,a1.pension_intent_cnt                  --   '客户跟踪模块意向客户数'\\n,b1.crm_intent_cnt                      --   '营销管理模块意向客户数'\\n,b1.crm_wait_vist_cnt                   --   '营销管理待回访客户数'\\n,b1.deposit_cust_cnt                    --   '下定客户数'\\n,b1.sign_cust_cnt                       --   '签约客户数'\\n,a1.advisory_cust_visit_cnt             --   '咨询客户回访次数'\\n,a1.pension_intent_cust_visit_cnt       --   '客户跟踪模块意向客户回访次数'\\n,b1.crm_intent_cust_visit_cnt           --   '营销管理模块意向客户回访次数'\\n,b1.deposit_cust_visit_cnt              --   '下定客户回访次数'\\n,b1.sign_cust_visit_cnt                 --   '签约客户回访次数'\\n,a1.avg_advisory_cust_visit_cnt         --   '咨询客户平均回访次数'\\n,a1.avg_pension_intent_cust_visit_cnt   --   '客户跟踪模块意向客户平均回访次数'\\n,b1.avg_crm_intent_cust_visit_cnt       --   '营销管理模块意向客户平均回访次数'\\n,b1.avg_deposit_cust_visit_cnt          --   '下定客户平均回访次数'\\n,b1.avg_sign_cust_visit_cnt             --   '签约客户平均回访次数'\\n,c1.apply_member_cnt                    --   '预申请会籍数量'\\n,c1.deposit_member_cnt                  --   '下定会籍数量'\\n,d1.deposit_room_cnt                    --   '下定房间数量'\\n,c1.sign_member_cnt                     --   '签约会籍数量'\\n,d1.sign_room_cnt                       --   '签约房间数量'\\n,e1.deposit_amount                      --   '下定额'\\n,e1.sales_amount                        --   '销售额'\\n,regexp_replace(date_sub(current_date(),1),'-','')  as part_date\\nfrom \\n(select\\na.sub_org_id\\n,a.membership_adviser_id\\n,max(a.membership_adviser_name)  as membership_adviser_name\\n,max(a.sub_org_name) sub_org_name\\n,max(a.org_id)    org_id\\n,max(org_name)    org_name\\n,max(area_id)     area_id\\n,max(area_name)   area_name\\n,count(distinct advisory_customer_id)  as advisory_customer_cnt     --'咨询客户数'\\n,count(distinct intention_customer_id)  as pension_intent_cnt    --'客户跟踪模块意向客户数',\\n,sum(advisory_visit_cnt)  as advisory_cust_visit_cnt   --'咨询客户回访次数'\\n,sum(intention_visit_cnt)   as pension_intent_cust_visit_cnt  -- '客户跟踪模块意向客户回访次数'\\n,sum(advisory_visit_cnt)/count(advisory_customer_id)  as avg_advisory_cust_visit_cnt  --'咨询客户平均回访次数'\\n,sum(intention_visit_cnt)/count(distinct intention_customer_id)  as avg_pension_intent_cust_visit_cnt  --'客户跟踪模块意向客户平均回访次数'\\nfrom \\n(select \\n t.advisory_customer_id\\n,t.intention_customer_id\\n,t.sub_org_id                         --  '养老机构id'\\n,t.sub_org_name                       --  '养老机构名称'\\n,t.org_id                             --  '集团id'\\n,t.org_name                           --  '集团名称'\\n,t.area_id                            --  '区域id'\\n,t.area_name\\n,t.membership_adviser_id\\n,t.membership_adviser_name\\n,case when t.advisory_customer_id is not null then visit_cnt else 0 end advisory_visit_cnt\\n,case when t.intention_customer_id is not null then visit_cnt else 0 end intention_visit_cnt\\nfrom db_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=0) a\\ngroup by a.sub_org_id,a.membership_adviser_id)  a1\\nfull join\\n(\\n select\\n t1.sub_org_id\\n,t1.membership_adviser_id\\n,max(t1.membership_adviser_name)  as membership_adviser_name\\n,max(t1.sub_org_name) sub_org_name\\n,max(t1.org_id)    org_id\\n,max(t1.org_name)    org_name\\n,max(t1.area_id)     area_id\\n,max(t1.area_name)   area_name\\n,count(distinct intention_customer_id)  as crm_intent_cnt    --'营销管理模块意向客户数',\\n,sum(t1.visit_cnt)   as crm_intent_cust_visit_cnt  -- '营销管理模块意向客户回访次数'\\n,sum(t1.visit_cnt)/count(distinct intention_customer_id)  as avg_crm_intent_cust_visit_cnt  --'营销管理模块意向客户平均回访次数'\\n,sum(deposit_cust_cnt) as deposit_cust_cnt   --'下定客户数'\\n,sum(sign_cust_cnt)  as sign_cust_cnt        --'签约客户数'\\n,sum(deposit_cust_visit_cnt)   as deposit_cust_visit_cnt  --'下定客户回访总次数'\\n,sum(sign_cust_vist_cnt)   as   sign_cust_visit_cnt    -- '签约客户回访总次数'\\n,sum(deposit_cust_visit_cnt)/sum(deposit_cust_cnt)  as avg_deposit_cust_visit_cnt  --'下定客户平均回访次数'\\n,sum(sign_cust_vist_cnt)/sum(sign_cust_cnt)  as avg_sign_cust_visit_cnt  --'签约客户平均回访次数'\\n,count(distinct crm_wait_vist_cust)  as crm_wait_vist_cnt\\n from \\n(\\nselect \\n b.intention_customer_id\\n,b.sub_org_id\\n,b.sub_org_name\\n,b.org_id\\n,b.org_name\\n,b.area_id\\n,b.area_name\\n,b.visit_cnt\\n,b.membership_adviser_id\\n,b.membership_adviser_name\\n,case when b.deposit_time is not null then 1 else 0 end as deposit_cust_cnt\\n,case when b.sign_time is not null then b.visit_cnt else 0 end as sign_cust_cnt\\n,case when b.deposit_time is not null then b.visit_cnt else 0 end as deposit_cust_visit_cnt\\n,case when b.sign_time is not null then b.visit_cnt else 0 end as sign_cust_vist_cnt\\n,case when b.visit_cnt=0 then b.intention_customer_id else null end as crm_wait_vist_cust\\nfrom \\n(\\nselect \\n t.intention_customer_id\\n,max(t.sub_org_id )  sub_org_id                      --  '养老机构id'\\n,max(t.sub_org_name)   sub_org_name                    --  '养老机构名称'\\n,max(t.org_id)      org_id                      --  '集团id'\\n,max(t.org_name)    org_name                       --  '集团名称'\\n,max(t.area_id)     area_id                       --  '区域id'\\n,max(t.area_name)   area_name                       --  '区域名称'\\n,max(t.visit_cnt)   visit_cnt                       --  '回访次数'\\n,max(t.membership_adviser_id)   membership_adviser_id\\n,max(t.membership_adviser_name)   membership_adviser_name                \\n,concat_ws(',',collect_list(from_unixtime( cast(t.deposit_time as int),'yyyy-MM-dd  HH:mm:ss')))   as deposit_time      -- '下定时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.sign_time as int),'yyyy-MM-dd  HH:mm:ss')))  as sign_time       -- '签约时间集合'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\ngroup by t.intention_customer_id\\n) b\\n) t1\\ngroup by t1.sub_org_id,t1.membership_adviser_id) b1 \\non a1.sub_org_id=b1.sub_org_id  and a1.membership_adviser_id=b1.membership_adviser_id\\nleft join \\n(\\nselect\\nt1.sub_org_id\\n,t1.membership_adviser_id\\n,sum(t1.apply_member_cnt)  apply_member_cnt\\n,sum(t1.deposit_member_cnt)  deposit_member_cnt\\n,sum(t1.sign_member_cnt)  sign_member_cnt\\n,sum(t1.transfer_to_member_cnt)   transfer_to_member_cnt\\n,sum(t1.transfer_from_member_cnt)  transfer_from_member_cnt\\n,sum(t1.withdraw_member_cnt)   withdraw_member_cnt\\nfrom \\n(\\nselect \\nc.membership_id\\n,c.sub_org_id\\n,c.membership_adviser_id\\n,case when apply_time   is null then 1 else 0 end as apply_member_cnt\\n,case when deposit_time is null then 1 else 0 end as deposit_member_cnt\\n,case when sign_time   is null then 1 else 0 end as sign_member_cnt\\n,case when transfer_to_time is null then 1 else 0 end as transfer_to_member_cnt\\n,case when transfer_from_time is null then 1 else 0 end as transfer_from_member_cnt\\n,case when withdraw_time is null then 1 else 0 end as withdraw_member_cnt\\nfrom \\n(select \\n t.membership_id \\n,max(t.membership_adviser_id)  membership_adviser_id \\n,max(t.sub_org_id )  sub_org_id                      --  '养老机构id'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.apply_time as int),'yyyy-MM-dd  HH:mm:ss')))   as apply_time      -- '预申请时间集合' \\n,concat_ws(',',collect_list(from_unixtime( cast(t.deposit_time as int),'yyyy-MM-dd  HH:mm:ss')))   as deposit_time      -- '下定时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.sign_time as int),'yyyy-MM-dd  HH:mm:ss')))  as sign_time       -- '签约时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.transfor_to_time as int),'yyyy-MM-dd  HH:mm:ss')))  as transfer_to_time       -- '转让时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.transfor_from_time as int),'yyyy-MM-dd  HH:mm:ss')))  as transfer_from_time       -- '继承时间集合'\\n,concat_ws(',',collect_list(from_unixtime( cast(t.withdraw_time as int),'yyyy-MM-dd  HH:mm:ss')))  as withdraw_time       -- '退会时间集合'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\ngroup by t.membership_id)  c\\n) t1\\ngroup by t1.sub_org_id,t1.membership_adviser_id) c1\\non b1.sub_org_id=c1.sub_org_id  and b1.membership_adviser_id=c1.membership_adviser_id\\nleft join \\n(\\nselect\\nt1.sub_org_id\\n,t1.membership_adviser_id\\n,count(distinct t1.deposit_room_cnt)  deposit_room_cnt\\n,count(distinct t1.sign_room_cnt)  sign_room_cnt\\nfrom \\n(\\nselect \\nc.room_id\\n,c.sub_org_id\\n,c.membership_adviser_id\\n,case when deposit_time is null then room_id else null end as deposit_room_cnt\\n,case when sign_time   is null then room_id else null end as sign_room_cnt\\nfrom \\n(select \\n t.room_id  \\n,t.sub_org_id  as   sub_org_id                      --  '养老机构id' \\n,t.membership_adviser_id\\n,t.deposit_time   as deposit_time      -- '下定时间集合'\\n,t.sign_time  as sign_time       -- '签约时间集合'\\nfrom \\ndb_dw_hr.clife_hr_dwd_market t \\nwhere t.part_date=regexp_replace(date_sub(current_date(),1),'-','') and customer_type=1\\n)  c\\n) t1\\ngroup by t1.sub_org_id,t1.membership_adviser_id) d1\\non b1.sub_org_id=d1.sub_org_id  and b1.membership_adviser_id=d1.membership_adviser_id\\nleft join \\n(select \\n sub_org_id\\n,membership_adviser_id\\n,sum(deposit_amount)    deposit_amount         --     '下定额'\\n,sum(receivable_amount) sales_amount            --  '应收金额'\\nfrom db_dw_hr.clife_hr_dwd_market where part_date= regexp_replace(date_sub(current_date(),1),'-','')\\ngroup by sub_org_id,membership_adviser_id\\n) e1\\non b1.sub_org_id=e1.sub_org_id  and b1.membership_adviser_id=e1.membership_adviser_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_channel_y\"]},{\"type\":\"SQL\",\"id\":\"tasks-34807\",\"name\":\"clife_hr_dws_market_by_channel_y\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_market_by_channel_y partition(part_date)\\nselect \\na.channel_id                         --   '渠道id'\\n,a.sub_org_id                         --   '养老机构id'\\n,b.sub_org_name                       --   '养老机构名称'\\n,b.org_id                             --   '养老集团id'\\n,b.org_name                           --   '养老集团名称'\\n,d.area_id                            --   '区域id'\\n,d.area_name                          --   '区域名称'\\n,c.trade_channel_name                       --   '渠道名称'\\n,c.channel_type                        --   '渠道类型'\\n,c.channel_type_name                  --   '渠道类型名称'\\n,a.crm_intent_cnt                     --   '营销管理模块意向客户数'\\n,a.deposit_cust_cnt                   --   '下定客户数'\\n,a.sign_cust_cnt                      --   '签约客户数'\\n,a.apply_member_cnt                   --   '预申请会籍数量'\\n,a.deposit_member_cnt                 --   '下定会籍数量'\\n,a.deposit_room_cnt                   --   '下定房间数量'\\n,a.sign_member_cnt                    --   '签约会籍数量'\\n,a.sign_room_cnt                      --   '签约房间数量'\\n,a.deposit_amount                     --  '下定额'\\n,a.sales_amount                       --  '销售额'\\n,a.data_year\\n,regexp_replace(date_sub(current_date(),1),'-','')  part_date\\nfrom \\ndb_dw_hr.clife_hr_dws_market_by_channel_y_tmp a \\nleft join \\ndb_dw_hr.clife_hr_dim_admin_sub_org b\\non a.sub_org_id=b.sub_org_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join \\ndb_dw_hr.clife_hr_dim_trade_channel c \\non a.channel_id=c.id  and c.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\nleft join db_dw_hr.clife_hr_dim_geographic_info d on concat(substr(b.city,1,5),b.area,'0000')=d.area_id\\nand d.part_date=regexp_replace(date_sub(current_date(),1),'-','')\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_market_by_channel_y_tmp\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-nb675\",\"name\":\"clife_hr_dws_reside_manage_by_soday\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_reside_manage_by_soday partition(part_date)\\nselect\\n     k.sub_org_id          --机构id\\n    ,k.sub_org_name        --机构名称\\n    ,k.org_id              --集团id\\n    ,k.org_name            --集团名称\\n    ,k.area_id             --区域id\\n    ,k.reside_cnt_day       --每天入住人数\\n    ,k.countermand_cnt_day  --每日退住人数\\n    ,k.room_num_day         --每日入住房间数\\n    ,k.bed_num_day          --每日入住床位数\\n    ,k.all_num              --每日总人数\\n    ,k.visit_num_day        --每日探访人数\\n    ,k.visit_time_day       --每日探访时长\\n    ,k.leave_num_day        --每日请假次数\\n    ,k.leave_time_day       --每日请假时长\\n    ,k.sick_leave_num_day   --每日病假次数\\n    ,k.casual_leave_num_day --每日事假次数\\n    ,k.other_leave_num_day  --每日其他假次数\\n    ,h.room_amount --楼层房间数\\n    ,h.bed_amount  --楼层床位数\\n    ,coalesce(k.reside_cnt_day/k.all_num,0)      as check_in_rate_day       --每日入住率\\n    ,coalesce(k.countermand_cnt_day/k.all_num,0) as countermand_rate_day    --每日退住率\\n    ,coalesce(k.room_num_day/h.room_amount,0)    as check_in_room_rate_day  --每日房间入住率\\n    ,coalesce((h.room_amount-k.room_num_day)/h.room_amount,0) as vacant_room_rate_day  --房间空房率\\n    ,coalesce(k.bed_num_day/h.bed_amount,0)                   as check_in_bed_rate_day --床位入住率\\n    ,coalesce((h.bed_amount-k.bed_num_day)/h.bed_amount,0)    as vacant_bed_rate_day   --床位空床率\\t\\n    ,k.contract_time_1_num_day        --录入合同数量（1年期）\\n    ,k.contract_time_2_num_day        --录入合同数量（2年期）\\n    ,k.contract_time_3_num_day        --录入合同数量（3年期）\\n    ,k.contract_time_4_num_day        --录入合同数量（4年期）\\n    ,k.contract_time_5_num_day        --录入合同数量（5年期）\\n    ,k.contract_time_surpass_5_num_day --录入合同数量（5年以上）\\n    ,k.refund_amount        --当天请假退费金额\\n    ,k.leave_reducation_fee --当天请假减免费用\\n    ,k.date_time --日期\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom\\n(\\n  select\\n       sub_org_id          --机构id\\n      ,max(sub_org_name)       as sub_org_name        --机构名称\\n      ,max(org_id)             as org_id              --集团id\\n      ,max(org_name)           as org_name            --集团名称\\n      ,max(area_id)            as area_id             --区域id \\n      ,sum(reside_cnt_day)     as reside_cnt_day\\n      ,sum(countermand_cnt_day) as countermand_cnt_day\\n      ,sum(room_num_day)        as room_num_day\\n      ,sum(bed_num_day)         as bed_num_day\\n      ,sum(all_num)               as all_num\\n      ,sum(visit_num_day)         as visit_num_day       \\n      ,sum(visit_time_day)        as visit_time_day      \\n      ,sum(leave_num_day)         as leave_num_day       \\n      ,sum(leave_time_day)        as leave_time_day      \\n      ,sum(sick_leave_num_day)    as sick_leave_num_day  \\n      ,sum(casual_leave_num_day)  as casual_leave_num_day\\n      ,sum(other_leave_num_day)   as other_leave_num_day \\n      ,sum(refund_amount)         as refund_amount\\n      ,sum(leave_reducation_fee)  as leave_reducation_fee\\n      ,sum(contract_time_1_num_day)        as contract_time_1_num_day        --录入合同数量（1年期）\\n      ,sum(contract_time_2_num_day)        as contract_time_2_num_day        --录入合同数量（2年期）\\n      ,sum(contract_time_3_num_day)        as contract_time_3_num_day        --录入合同数量（3年期）\\n      ,sum(contract_time_4_num_day)        as contract_time_4_num_day        --录入合同数量（4年期）\\n      ,sum(contract_time_5_num_day)        as contract_time_5_num_day        --录入合同数量（5年期）\\n      ,sum(contract_time_surpass_5_num_day)as contract_time_surpass_5_num_day--录入合同数量（5年以上）\\n      ,date_time\\n  from db_dw_hr.clife_hr_dws_reside_manage_by_nhday\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by sub_org_id\\n          ,date_time\\n)k\\nleft join\\n(\\n   select\\n        b.sub_org_id\\n        ,count(a.room_id)  as room_amount \\n        ,sum(a.bed_amount) as bed_amount\\n   from db_dw_hr.clife_hr_dim_location_room a\\n   left join db_dw_hr.clife_hr_dim_nursing_home b on a.nursing_homes_id=b.nursing_homes_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n   where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n   group by b.sub_org_id\\n)h on k.sub_org_id=h.sub_org_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_reside_manage_by_nhday\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-hpbt\",\"name\":\"clife_hr_dws_reside_manage_by_fday\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_reside_manage_by_fday partition(part_date)\\nselect\\n     a.floor_id            --楼层id\\n    ,a.building_id         --楼栋id\\n    ,a.nursin_homes_id     --养老院id\\n    ,a.nursing_homes_name  --养老院名称\\n    ,a.sub_org_id          --机构id\\n    ,a.sub_org_name        --机构名称\\n    ,a.org_id              --集团id\\n    ,a.org_name            --集团名称\\n    ,a.area_id             --区域id\\n    ,a.reside_cnt_day       --每天入住人数\\n    ,a.countermand_cnt_day  --每日退住人数\\n    ,a.room_num_day         --每日入住房间数\\n    ,a.bed_num_day          --每日入住床位数\\n    ,a.all_num              --每日总人数\\n    ,a.visit_num_day        --每日探访人数\\n    ,a.visit_time_day       --每日探访时长\\n    ,a.leave_num_day        --每日请假次数\\n    ,a.leave_time_day       --每日请假时长\\n    ,a.sick_leave_num_day   --每日病假次数\\n    ,a.casual_leave_num_day --每日事假次数\\n    ,a.other_leave_num_day  --每日其他假次数\\n    ,b.room_amount --楼层房间数\\n    ,b.bed_amount  --楼层床位数\\n    ,coalesce(a.reside_cnt_day/a.all_num,0)      as check_in_rate_day       --每日入住率\\n    ,coalesce(a.countermand_cnt_day/a.all_num,0) as countermand_rate_day    --每日退住率\\n    ,coalesce(a.room_num_day/b.room_amount,0)    as check_in_room_rate_day  --每日房间入住率\\n    ,coalesce((b.room_amount-a.room_num_day)/b.room_amount,0) as vacant_room_rate_day  --房间空房率\\n    ,coalesce(a.bed_num_day/b.bed_amount,0)                   as check_in_bed_rate_day --床位入住率\\n    ,coalesce((b.bed_amount-a.bed_num_day)/b.bed_amount,0)    as vacant_bed_rate_day   --床位空床率\\t\\n    ,0 as contract_time_1_num_day        --录入合同数量（1年期）\\n    ,0 as contract_time_2_num_day        --录入合同数量（2年期）\\n    ,0 as contract_time_3_num_day        --录入合同数量（3年期）\\n    ,0 as contract_time_4_num_day        --录入合同数量（4年期）\\n    ,0 as contract_time_5_num_day        --录入合同数量（5年期）\\n    ,0 as contract_time_surpass_5_num_day --录入合同数量（5年以上）\\n    ,a.refund_amount        --当天请假退费金额\\n    ,a.leave_reducation_fee --当天请假减免费用\\n    ,a.date_time --日期\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom\\n(\\n  select\\n       floor_id            --楼层id\\n      ,max(building_id) as     building_id      --楼栋id\\n      ,max(nursin_homes_id)    as nursin_homes_id     --养老院id\\n      ,max(nursing_homes_name) as nursing_homes_name  --养老院名称\\n      ,max(sub_org_id)         as sub_org_id          --机构id\\n      ,max(sub_org_name)       as sub_org_name        --机构名称\\n      ,max(org_id)             as org_id              --集团id\\n      ,max(org_name)           as org_name            --集团名称\\n      ,max(area_id)            as area_id             --区域id \\n      ,sum(reside_cnt_day)     as reside_cnt_day\\n      ,sum(countermand_cnt_day) as countermand_cnt_day\\n      ,sum(room_num_day)        as room_num_day\\n      ,sum(bed_num_day)         as bed_num_day\\n      ,sum(all_num)               as all_num\\n      ,sum(visit_num_day)         as visit_num_day       \\n      ,sum(visit_time_day)        as visit_time_day      \\n      ,sum(leave_num_day)         as leave_num_day       \\n      ,sum(leave_time_day)        as leave_time_day      \\n      ,sum(sick_leave_num_day)    as sick_leave_num_day  \\n      ,sum(casual_leave_num_day)  as casual_leave_num_day\\n      ,sum(other_leave_num_day)   as other_leave_num_day \\n      ,sum(refund_amount)         as refund_amount\\n      ,sum(leave_reducation_fee)  as leave_reducation_fee\\n      ,date_time\\n  from\\n  (\\n    select\\n         b.floor_id            --楼层id\\n        ,max(b.building_id) as     building_id      --楼栋id\\n        ,max(a.nursin_homes_id)    as nursin_homes_id     --养老院id\\n        ,max(a.nursing_homes_name) as nursing_homes_name  --养老院名称\\n        ,max(a.sub_org_id)         as sub_org_id          --机构id\\n        ,max(a.sub_org_name)       as sub_org_name        --机构名称\\n        ,max(a.org_id)             as org_id              --集团id\\n        ,max(a.org_name)           as org_name            --集团名称\\n        ,max(a.area_id)            as area_id             --区域id \\n        ,sum(case when a.reside_status = 3 then 1 else 0 end) as reside_cnt_day\\n        ,sum(case when a.reside_status = 4 then 1 else 0 end) as countermand_cnt_day\\n        ,count(case when a.reside_status = 3 then a.room_id else null end) as room_num_day\\n        ,count(case when a.reside_status = 3 then a.bed_id else null end) as bed_num_day\\n        ,0 as all_num\\n        ,0 as visit_num_day  --每天探访人数\\n        ,0 as visit_time_day --探访时长\\n        ,0 as leave_num_day        --请假次数\\n        ,0 as leave_time_day       --请假时长\\n        ,0 as sick_leave_num_day   --病假次数\\n        ,0 as casual_leave_num_day--事假次数\\n        ,0 as other_leave_num_day  --其他假次数\\n        ,0 as refund_amount\\n        ,0 as leave_reducation_fee\\n        ,substr(a.reside_time,1,10) as date_time\\n    from db_dw_hr.clife_hr_dwd_reside_manage_info a\\n    left join  db_dw_hr.clife_hr_dim_location_room b on a.room_id = b.room_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    group by b.floor_id\\n            ,substr(a.reside_time,1,10)\\n    union all\\n    select\\n         b.floor_id            --楼层id\\n        ,max(b.building_id) as     building_id      --楼栋id\\n        ,max(a.nursin_homes_id)    as nursin_homes_id     --养老院id\\n        ,max(a.nursing_homes_name) as nursing_homes_name  --养老院名称\\n        ,max(a.sub_org_id)         as sub_org_id          --机构id\\n        ,max(a.sub_org_name)       as sub_org_name        --机构名称\\n        ,max(a.org_id)             as org_id              --集团id\\n        ,max(a.org_name)           as org_name            --集团名称\\n        ,max(a.area_id)            as area_id             --区域id\\n        ,0 as reside_cnt_day\\n        ,0 as countermand_cnt_day\\n        ,0 as room_num_day\\n        ,0 as bed_num_day\\t\\n        ,count(1) as all_num\\n        ,0 as visit_num_day  --每天探访人数\\n        ,0 as visit_time_day --探访时长\\n        ,0 as leave_num_day        --请假次数\\n        ,0 as leave_time_day       --请假时长\\n        ,0 as sick_leave_num_day   --病假次数\\n        ,0 as casual_leave_num_day--事假次数\\n        ,0 as other_leave_num_day  --其他假次数\\n        ,0 as refund_amount\\n        ,0 as leave_reducation_fee\\n        ,substr(a.contract_entry_time,1,10) as date_time\\n    from db_dw_hr.clife_hr_dwd_reside_manage_info a\\n    left join  db_dw_hr.clife_hr_dim_location_room b on a.room_id = b.room_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    group by b.floor_id\\n            ,substr(a.contract_entry_time,1,10)\\n    union all\\n    select\\n         b.floor_id            --楼层id\\n        ,max(b.building_id) as     building_id      --楼栋id\\n        ,max(t.nursin_homes_id)    as nursin_homes_id     --养老院id\\n        ,max(t.nursing_homes_name) as nursing_homes_name  --养老院名称\\n        ,max(t.sub_org_id)         as sub_org_id          --机构id\\n        ,max(t.sub_org_name)       as sub_org_name        --机构名称\\n        ,max(t.org_id)             as org_id              --集团id\\n        ,max(t.org_name)           as org_name            --集团名称\\n        ,max(t.area_id)            as area_id             --区域id\\n        ,0 as reside_cnt_day\\n        ,0 as countermand_cnt_day\\n        ,0 as room_num_day\\n        ,0 as bed_num_day\\n        ,0 as all_num\\n        ,count(t.relatives_name) as visit_num_day  --每天探访人数\\n        ,sum(CAST((if(t.visit_end_time is null,unix_timestamp(),unix_timestamp(t.visit_end_time)) - unix_timestamp(t.visit_start_time)) / 60 AS int) % 60) as visit_time_day --探访时长\\n        ,0 as leave_num_day        --请假次数\\n        ,0 as leave_time_day       --请假时长\\n        ,0 as sick_leave_num_day   --病假次数\\n        ,0 as casual_leave_num_day--事假次数\\n        ,0 as other_leave_num_day  --其他假次数\\n        ,0 as refund_amount\\n        ,0 as leave_reducation_fee\\n    \\t,substr(t.visit_start_time,1,10) as date_time --每天探访日期\\n    from\\n    (\\n     select\\n          a.old_man_id\\n         ,a.room_id\\n         ,a.nursin_homes_id   \\n         ,a.nursing_homes_name\\n         ,a.sub_org_id        \\n         ,a.sub_org_name      \\n         ,a.org_id            \\n         ,a.org_name          \\n         ,a.area_id           \\n         ,ip.relatives_name\\n         ,split(ip.visit_time,'-')[0] as visit_start_time\\n         ,split(ip.visit_time,'-')[1] as visit_end_time\\n     from db_dw_hr.clife_hr_dwd_reside_manage_info a\\n     lateral view explodemulti(if(a.relatives_names is null,'',a.relatives_names),if(a.visit_times is null,'',a.visit_times))ip as relatives_name,visit_time\\n     where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    )t\\n    left join  db_dw_hr.clife_hr_dim_location_room b on t.room_id = b.room_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    group by b.floor_id\\n            ,substr(t.visit_start_time,1,10)\\n    union all\\n    select\\n         b.floor_id            --楼层id\\n        ,max(b.building_id) as     building_id      --楼栋id\\n        ,max(t.nursin_homes_id)    as nursin_homes_id     --养老院id\\n        ,max(t.nursing_homes_name) as nursing_homes_name  --养老院名称\\n        ,max(t.sub_org_id)         as sub_org_id          --机构id\\n        ,max(t.sub_org_name)       as sub_org_name        --机构名称\\n        ,max(t.org_id)             as org_id              --集团id\\n        ,max(t.org_name)           as org_name            --集团名称\\n        ,max(t.area_id)            as area_id             --区域id\\n        ,0 as reside_cnt_day\\n        ,0 as countermand_cnt_day\\n        ,0 as room_num_day\\n        ,0 as bed_num_day\\n        ,0 as all_num\\n        ,0 as visit_num_day  --每天探访人数\\n        ,0 as visit_time_day --探访时长\\n        ,count(1)    as leave_num_day        --请假次数\\n        ,sum(t.leave_time) as leave_time_day       --请假时长\\n        ,sum(case when t.leave_type = 0 then 1 else 0 end ) as sick_leave_num_day   --病假次数\\n        ,sum(case when t.leave_type = 1 then 1 else 0 end ) as casual_leave_num_day--事假次数\\n        ,sum(case when t.leave_type = 2 then 1 else 0 end ) as other_leave_num_day  --其他假次数\\n        ,0 as refund_amount\\n        ,0 as leave_reducation_fee\\n        ,substr(t.leave_create_time,1,10) as date_time\\n    from\\n    (\\n     select\\n           a.old_man_check_in_id\\n          ,a.room_id\\n          ,a.old_man_id\\n          ,a.nursin_homes_id   \\n          ,a.nursing_homes_name\\n          ,a.sub_org_id        \\n          ,a.sub_org_name      \\n          ,a.org_id            \\n          ,a.org_name          \\n          ,a.area_id  \\n          ,ip.leave_create_time\\n          ,ip.leave_time\\n          ,ip.leave_type\\n      from db_dw_hr.clife_hr_dwd_reside_manage_info a\\n      lateral view explodemulti(if(a.leave_create_times is null,'',a.leave_create_times),if(a.leave_times is null,'',a.leave_times),if(a.leave_types is null,'',a.leave_types))ip as leave_create_time,leave_time,leave_type\\n      where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    )t\\n    left join  db_dw_hr.clife_hr_dim_location_room b on t.room_id = b.room_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    group by b.floor_id\\n            ,substr(t.leave_create_time,1,10)\\n    union all\\n    select\\n         b.floor_id            --楼层id\\n        ,max(b.building_id) as     building_id      --楼栋id\\n        ,max(t1.nursin_homes_id)    as nursin_homes_id     --养老院id\\n        ,max(t1.nursing_homes_name) as nursing_homes_name  --养老院名称\\n        ,max(t1.sub_org_id)         as sub_org_id          --机构id\\n        ,max(t1.sub_org_name)       as sub_org_name        --机构名称\\n        ,max(t1.org_id)             as org_id              --集团id\\n        ,max(t1.org_name)           as org_name            --集团名称\\n        ,max(t1.area_id)            as area_id             --区域id\\n        ,0 as reside_cnt_day\\n        ,0 as countermand_cnt_day\\n        ,0 as room_num_day\\n        ,0 as bed_num_day\\n        ,0 as all_num\\n        ,0 as visit_num_day  --每天探访人数\\n        ,0 as visit_time_day --探访时长\\n        ,0 as leave_num_day        --请假次数\\n        ,0 as leave_time_day       --请假时长\\n        ,0 as sick_leave_num_day   --病假次数\\n        ,0 as casual_leave_num_day--事假次数\\n        ,0 as other_leave_num_day  --其他假次数\\n        ,sum(t1.refund_amount) as refund_amount\\n        ,sum(t1.leave_reducation_fee) as leave_reducation_fee\\n        ,substr(t1.leave_create_time,1,10) as leave_time\\n    from\\n    (\\n      select\\n       t.*\\n      ,row_number()over(partition by old_man_check_in_id order by t.leave_create_time desc) as rank\\n      from\\n      (\\n        select\\n             a.old_man_check_in_id\\n            ,a.room_id\\n            ,a.old_man_id\\n            ,a.nursin_homes_id   \\n            ,a.nursing_homes_name\\n            ,a.sub_org_id        \\n            ,a.sub_org_name      \\n            ,a.org_id            \\n            ,a.org_name          \\n            ,a.area_id  \\n            ,a.refund_amount                      --当天请假退费金额\\n            ,a.leave_reducation_fee               --当天请假减免费用\\n            ,ip.leave_create_time\\n            ,ip.leave_time\\n            ,ip.leave_type\\n        from db_dw_hr.clife_hr_dwd_reside_manage_info a\\n        lateral view explodemulti(if(a.leave_create_times is null,'',a.leave_create_times),if(a.leave_times is null,'',a.leave_times),if(a.leave_types is null,'',a.leave_types))ip as leave_create_time,leave_time,leave_type\\n        where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n      )t\\n    )t1\\n    left join  db_dw_hr.clife_hr_dim_location_room b on t1.room_id = b.room_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    where t1.rank = 1\\n    group by b.floor_id\\n            ,substr(t1.leave_create_time,1,10)\\n  )a\\n  group by floor_id\\n          ,date_time\\n)a\\nleft join\\n(\\n  select\\n       floor_id\\n      ,count(room_id)  as room_amount \\n      ,sum(bed_amount) as bed_amount\\n  from db_dw_hr.clife_hr_dim_location_room\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by floor_id\\n)b on a.floor_id=b.floor_id\",\"udfs\":\"13\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[]},{\"type\":\"SQL\",\"id\":\"tasks-2-6vmi\",\"name\":\"clife_hr_dws_activity_manage_by_soday\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_activity_manage_by_soday partition(part_date)\\nselect\\n     sub_org_id\\n    ,activity_type\\n    ,sub_org_name             --机构名称\\n    ,org_id                  --集团id\\n    ,org_name                --集团名称\\n    ,area_id                 --区域id\\n    ,reserve_cnt_day           --预定活动室次数\\n    ,template_cnt_day           --使用活动模板数量\\n    ,activity_cnt_day          --已创建活动数\\n    ,activity_fee_day          --活动费用\\n    ,host_activity_cnt_day     --已举办活动数\\n    ,confirm_old_man_cnt_day   --到场人次\\n    ,sign_old_man_cnt_day      --签到人次\\n    ,apply_old_man_cnt_day     --报名人次\\n    ,apply_activity_cnt_day    --已报名活动数\\n    ,date_time\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom\\n(\\n  select\\n       sub_org_id\\n      ,activity_type\\n      ,max(sub_org_name)      as sub_org_name             --机构名称\\n      ,max(org_id)             as org_id                  --集团id\\n      ,max(org_name)           as org_name                --集团名称\\n      ,max(area_id)            as area_id                 --区域id\\n      ,sum(reserve_cnt_day)          as reserve_cnt_day           --预定活动室次数\\n      ,sum(template_cnt_day)          as template_cnt_day           --使用活动模板数量\\n      ,sum(activity_cnt_day)         as activity_cnt_day          --已创建活动数\\n      ,sum(activity_fee_day)         as activity_fee_day          --活动费用\\n      ,sum(host_activity_cnt_day)    as host_activity_cnt_day     --已举办活动数\\n      ,sum(confirm_old_man_cnt_day)  as confirm_old_man_cnt_day   --到场人次\\n      ,sum(sign_old_man_cnt_day)     as sign_old_man_cnt_day      --签到人次\\n      ,sum(apply_old_man_cnt_day)    as apply_old_man_cnt_day     --报名人次\\n      ,sum(apply_activity_cnt_day)   as apply_activity_cnt_day    --已报名活动数\\n      ,date_time\\n  from\\n  (\\n    select\\n         sub_org_id\\n        ,activity_type\\n        ,max(sub_org_name)      as sub_org_name           --机构名称\\n        ,max(org_id)             as org_id                  --集团id\\n        ,max(org_name)           as org_name                --集团名称\\n        ,max(area_id)            as area_id                 --区域id\\n        ,count(t.reserve_id) as reserve_cnt_day  --预定活动室次数\\n        ,0 as template_cnt_day   --使用活动模板数量\\n        ,0 as activity_cnt_day  --已创建活动数\\n        ,0 as activity_fee_day   --活动费用\\n        ,0 as host_activity_cnt_day  --已举办活动数\\n        ,0 as confirm_old_man_cnt_day       --到场人次\\n        ,0 as sign_old_man_cnt_day       --签到人次\\n        ,0 as apply_old_man_cnt_day       --报名人次\\n        ,0 as apply_activity_cnt_day       --已报名活动数\\n        ,substr(t.reserve_time,1,10) as date_time\\n    from\\n    (\\n      select\\n           a.activity_type\\n          ,a.sub_org_id           --机构id\\n          ,a.sub_org_name         --机构名称\\n          ,a.org_id               --集团id\\n          ,a.org_name             --集团名称\\n          ,a.area_id              --区域id\\n          ,ip.reserve_id\\n          ,ip.reserve_time\\n      from db_dw_hr.clife_hr_dwd_activity_manage_info a\\n      lateral view explodemulti(if(a.reserve_ids is null,'',a.reserve_ids),if(a.reserve_times is null,'',a.reserve_times))ip as reserve_id,reserve_time\\n      where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    )t\\n    group by activity_type\\n            ,sub_org_id\\n            ,substr(t.reserve_time,1,10)\\n    union all\\n    select         \\n         sub_org_id\\n        ,activity_type\\t\\t\\t\\t\\n        ,max(sub_org_name)      as sub_org_name           --机构名称\\n        ,max(org_id)             as org_id                  --集团id\\n        ,max(org_name)           as org_name                --集团名称\\n        ,max(area_id)            as area_id                 --区域id\\n        ,0 as reserve_cnt_day  --预定活动室次数\\n        ,count(template_id) as template_cnt_day   --使用活动模板数量\\n        ,count(activity_id) as activity_cnt_day  --已创建活动数\\n        ,sum(activity_fee)  as activity_fee_day   --活动费用\\n        ,0 as host_activity_cnt_day  --已举办活动数\\n        ,0 as confirm_old_man_cnt_day       --到场人次\\n        ,0 as sign_old_man_cnt_day       --签到人次\\n        ,0 as apply_old_man_cnt_day       --报名人次\\n        ,0 as apply_activity_cnt_day       --已报名活动数\\n        ,substr(activity_create_time,1,10) as date_time --活动创建时间\\n    from db_dw_hr.clife_hr_dwd_activity_manage_info\\n    where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    group by activity_type\\t\\n            ,sub_org_id\\t\\n            ,substr(activity_create_time,1,10)\\n    union all\\n    select\\n         sub_org_id\\n        ,activity_type\\t \\n        ,max(sub_org_name)      as sub_org_name           --机构名称\\n        ,max(org_id)             as org_id                  --集团id\\n        ,max(org_name)           as org_name                --集团名称\\n        ,max(area_id)            as area_id                 --区域id\\n        ,0 as reserve_cnt_day  --预定活动室次数\\n        ,0 as template_cnt_day   --使用活动模板数量\\n        ,0 as activity_cnt_day  --已创建活动数\\n        ,0 as activity_fee_day   --活动费用\\n        ,count(activity_id) as host_activity_cnt_day  --已举办活动数\\n        ,0 as confirm_old_man_cnt_day       --到场人次\\n        ,0 as sign_old_man_cnt_day       --签到人次\\n        ,0 as apply_old_man_cnt_day       --报名人次\\n        ,0 as apply_activity_cnt_day       --已报名活动数\\n        ,substr(activity_time,1,10) as date_time --活动创建时间\\n    from db_dw_hr.clife_hr_dwd_activity_manage_info\\n    where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    group by activity_type\\n            ,sub_org_id\\t\\n            ,substr(activity_time,1,10)\\n    union all\\n    select\\n         sub_org_id\\n        ,activity_type\\t\\n        ,max(sub_org_name)      as sub_org_name           --机构名称\\n        ,max(org_id)             as org_id                  --集团id\\n        ,max(org_name)           as org_name                --集团名称\\n        ,max(area_id)            as area_id                 --区域id\\n        ,0 as reserve_cnt_day  --预定活动室次数\\n        ,0 as template_cnt_day   --使用活动模板数量\\n        ,0 as activity_cnt_day  --已创建活动数\\n        ,0 as activity_fee_day   --活动费用\\n        ,0 as host_activity_cnt_day  --已举办活动数\\n        ,count(t.confirm_old_man)  as confirm_old_man_cnt_day       --到场人次\\n        ,0 as sign_old_man_cnt_day       --签到人次\\n        ,0 as apply_old_man_cnt_day       --报名人次\\n        ,0 as apply_activity_cnt_day       --已报名活动数\\n        ,substr(t.confirm_time,1,10) as date_time\\n    from\\n    (\\n      select\\n           a.activity_id\\n          ,a.activity_type\\n          ,a.sub_org_id             --机构id\\n          ,a.sub_org_name           --机构名称\\n          ,a.org_id                --集团id\\n          ,a.org_name              --集团名称\\n          ,a.area_id               --区域id\\n          ,ip.confirm_old_man\\n          ,ip.confirm_time\\n      from db_dw_hr.clife_hr_dwd_activity_manage_info a\\n      lateral view explodemulti(if(a.confirm_old_mans is null,'',a.confirm_old_mans),if(a.confirm_times is null,'',a.confirm_times))ip as confirm_old_man,confirm_time\\n      where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    )t\\n    group by activity_type\\n            ,sub_org_id\\t\\n            ,substr(t.confirm_time,1,10)\\n    union all\\n    select\\n         activity_type\\n        ,sub_org_id\\n        ,max(sub_org_name)      as sub_org_name           --机构名称\\n        ,max(org_id)             as org_id                  --集团id\\n        ,max(org_name)           as org_name                --集团名称\\n        ,max(area_id)            as area_id                 --区域id\\n        ,0 as reserve_cnt_day  --预定活动室次数\\n        ,0 as template_cnt_day   --使用活动模板数量\\n        ,0 as activity_cnt_day  --已创建活动数\\n        ,0 as activity_fee_day   --活动费用\\n        ,0 as host_activity_cnt_day  --已举办活动数\\n        ,0 as confirm_old_man_cnt_day       --到场人次\\n        ,count(t.sign_old_man)       as sign_old_man_cnt_day       --签到人次\\n        ,0 as apply_old_man_cnt_day       --报名人次\\n        ,0 as apply_activity_cnt_day       --已报名活动数\\n        ,substr(t.sign_time,1,10) as date_time\\n    from\\n    (\\n      select\\n           a.activity_id\\n          ,a.activity_type\\n          ,a.nurse_home_id\\n          ,a.nursing_homes_name   --养老院名称\\n          ,a.sub_org_id           --机构id\\n          ,a.sub_org_name         --机构名称\\n          ,a.org_id               --集团id\\n          ,a.org_name             --集团名称\\n          ,a.area_id              --区域id\\n          ,ip.sign_old_man\\n          ,ip.sign_time\\n      from db_dw_hr.clife_hr_dwd_activity_manage_info a\\n      lateral view explodemulti(if(a.sign_old_mans is null,'',a.sign_old_mans),if(a.sign_times is null,'',a.sign_times))ip as sign_old_man,sign_time\\n      where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    )t\\n    group by activity_type\\n            ,sub_org_id\\n            ,substr(t.sign_time,1,10)\\n    union all\\n    select\\n         activity_type\\n        ,sub_org_id\\n        ,max(sub_org_name)      as sub_org_name           --机构名称\\n        ,max(org_id)             as org_id                  --集团id\\n        ,max(org_name)           as org_name                --集团名称\\n        ,max(area_id)            as area_id                 --区域id\\n        ,0 as reserve_cnt_day  --预定活动室次数\\n        ,0 as template_cnt_day   --使用活动模板数量\\n        ,0 as activity_cnt_day  --已创建活动数\\n        ,0 as activity_fee_day   --活动费用\\n        ,0 as host_activity_cnt_day  --已举办活动数\\n        ,0 as confirm_old_man_cnt_day       --到场人次\\n        ,0 as sign_old_man_cnt_day       --签到人次\\n        ,count(t.apply_time)       as apply_old_man_cnt_day       --报名人次\\n        ,count(t.apply_time)       as apply_activity_cnt_day       --已报名活动数\\n        ,substr(t.apply_time,1,10) as date_time\\n    from\\n    (\\n      select\\n           a.activity_id\\n          ,a.activity_type\\n          ,a.nurse_home_id\\n          ,a.nursing_homes_name   --养老院名称\\n          ,a.sub_org_id           --机构id\\n          ,a.sub_org_name         --机构名称\\n          ,a.org_id               --集团id\\n          ,a.org_name             --集团名称\\n          ,a.area_id              --区域id\\n          ,ip.apply_time\\n      from db_dw_hr.clife_hr_dwd_activity_manage_info a\\n      lateral view explodemulti(if(a.apply_times is null,'',a.apply_times)) ip as apply_time\\n      where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    )t\\n    group by activity_type\\n            ,sub_org_id\\n            ,substr(t.apply_time,1,10)\\n  )k\\n  group by  sub_org_id\\n            ,activity_type\\n            ,date_time\\n)h\",\"udfs\":\"13\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_activity_manage_by_suborg\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-6w31nd\",\"name\":\"clife_hr_dws_plan_snapshot_by_protypeyear\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_plan_snapshot_by_protypeyear partition(part_date)\\nselect\\n     sub_org_id         --机构id\\n    ,project_type_id    --项目类型id\\n    ,project_type_name  --项目类型名称\\n    ,sub_org_name       --机构名称\\n    ,org_id             --集团id\\n    ,org_name           --集团名称\\n    ,plan_num_year  --计划总数\\n    ,item_num_year  --任务总数\\n    ,complete_num_year --完成任务数\\n    ,coalesce(complete_num_year/item_num_year,0) as complete_rate_year --完成率\\n    ,date_year --年份\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --分区日期\\nfrom\\n(\\n  select\\n       sub_org_id        --机构id\\n      ,project_type_id    --项目类型id\\n      ,max(project_type_name)as project_type_name  --项目类型名称\\n      ,max(sub_org_name)     as sub_org_name       --机构名称\\n      ,max(org_id)           as org_id             --集团id\\n      ,max(org_name)         as org_name           --集团名称\\n      ,sum(plan_num_month) as plan_num_year  --计划总数\\n      ,sum(item_num_month) as item_num_year  --任务总数\\n      ,sum(complete_num_month) as complete_num_year --完成任务数\\n      ,substr(date_month,1,4) as date_year --年份\\n  from db_dw_hr.clife_hr_dws_plan_snapshot_by_protypemonth\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by project_type_id\\n           ,sub_org_id\\n           ,substr(date_month,1,4)\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_plan_snapshot_by_protypemonth\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-3v453v\",\"name\":\"clife_hr_dws_plan_snapshot_by_protypeday\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_plan_snapshot_by_protypeday partition(part_date)\\nselect\\n     sub_org_id         --机构id\\n    ,project_type_id    --项目类型id\\n    ,project_type_name  --项目类型名称\\n    ,sub_org_name       --机构名称\\n    ,org_id             --集团id\\n    ,org_name           --集团名称\\n    ,plan_num_day  --计划总数\\n    ,item_num_day  --任务总数\\n    ,complete_num_day --完成任务数\\n    ,coalesce(complete_num_day/item_num_day,0) as complete_rate_day --完成率\\n    ,date_time  --日期\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --分区日期\\nfrom\\n(\\n  select\\n       sub_org_id        --机构id\\n      ,project_type_id    --项目类型id\\n      ,max(project_type_name)as project_type_name  --项目类型名称\\n      ,max(sub_org_name)     as sub_org_name       --机构名称\\n      ,max(org_id)           as org_id             --集团id\\n      ,max(org_name)         as org_name           --集团名称\\n      ,sum(plan_num_day) as plan_num_day  --计划总数\\n      ,sum(item_num_day) as item_num_day  --任务总数\\n      ,sum(complete_num_day) as complete_num_day --完成任务数\\n      ,date_time\\n  from\\n  (\\n    select\\n         sub_org_id        --机构id\\n        ,project_type_id    --项目类型id\\n        ,max(project_type_name)as project_type_name  --项目类型名称\\n        ,max(sub_org_name)     as sub_org_name       --机构名称\\n        ,max(org_id)           as org_id             --集团id\\n        ,max(org_name)         as org_name           --集团名称\\n        ,0 as plan_num_day  --计划总数\\n        ,count(1) as  item_num_day  --任务总数\\n        ,sum(case when complete_stase = 1 then 1 else 0 end) as complete_num_day --完成任务数\\n        ,substr(plan_create_time,1,10) as date_time\\n    from db_dw_hr.clife_hr_dwd_plan_snapshot_info\\n    where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    group by project_type_id\\n            ,sub_org_id\\n            ,substr(plan_create_time,1,10)\\n    union all\\n    select\\n         sub_org_id        --机构id\\n        ,project_type_id    --项目类型id\\n        ,max(project_type_name)as project_type_name  --项目类型名称\\n        ,max(sub_org_name)     as sub_org_name       --机构名称\\n        ,max(org_id)           as org_id             --集团id\\n        ,max(org_name)         as org_name           --集团名称\\n        ,count(exec_date) as plan_num_day  --计划总数\\n        ,0 as  item_num_day  --任务总数\\n        ,0 as complete_num_day --完成任务数\\n        ,substr(exec_date,1,10) as date_time\\n    from db_dw_hr.clife_hr_dwd_plan_snapshot_info\\n    where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    group by project_type_id\\n            ,sub_org_id\\n             ,substr(exec_date,1,10)\\n  )a\\n  group by project_type_id\\n          ,sub_org_id\\n          ,date_time\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_plan_snapshot_by_protype\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-a91ir\",\"name\":\"clife_hr_dws_plan_snapshot_by_proyear\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_plan_snapshot_by_proyear partition(part_date)\\nselect\\n     project_id         --项目id\\n    ,sub_org_id         --机构id\\n    ,project_name       --项目名称\\n    ,project_type_id    --项目类型id\\n    ,project_type_name  --项目类型名称\\n    ,sub_org_name       --机构名称\\n    ,org_id             --集团id\\n    ,org_name           --集团名称\\n    ,plan_num_year  --计划总数\\n    ,item_num_year  --任务总数\\n    ,complete_num_year --完成任务数\\n    ,coalesce(complete_num_year/item_num_year,0) as complete_rate_year --完成率\\n    ,date_year --年份\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --分区日期\\nfrom\\n(\\n  select\\n       project_id        --项目id\\n      ,sub_org_id        --机构id\\n      ,max(project_name)     as project_name       --项目名称\\n      ,max(project_type_id)  as project_type_id    --项目类型id\\n      ,max(project_type_name)as project_type_name  --项目类型名称\\n      ,max(sub_org_name)     as sub_org_name       --机构名称\\n      ,max(org_id)           as org_id             --集团id\\n      ,max(org_name)         as org_name           --集团名称\\n      ,sum(plan_num_month) as plan_num_year  --计划总数\\n      ,sum(item_num_month) as item_num_year  --任务总数\\n      ,sum(complete_num_month) as complete_num_year --完成任务数\\n      ,substr(date_month,1,4) as date_year --年份\\n  from db_dw_hr.clife_hr_dws_plan_snapshot_by_promonth\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by project_id\\n           ,sub_org_id\\n           ,substr(date_month,1,4)\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_plan_snapshot_by_promonth\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-61ets\",\"name\":\"clife_hr_dws_plan_snapshot_by_proday\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_plan_snapshot_by_proday partition(part_date)\\nselect\\n     project_id         --项目id\\n    ,sub_org_id         --机构id\\n    ,project_name       --项目名称\\n    ,project_type_id    --项目类型id\\n    ,project_type_name  --项目类型名称\\n    ,sub_org_name       --机构名称\\n    ,org_id             --集团id\\n    ,org_name           --集团名称\\n    ,plan_num_day  --计划总数\\n    ,item_num_day  --任务总数\\n    ,complete_num_day --完成任务数\\n    ,coalesce(complete_num_day/item_num_day,0) as complete_rate_day --完成率\\n    ,date_time  --日期\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --分区日期\\nfrom\\n(\\n  select\\n       project_id        --项目id\\n      ,sub_org_id        --机构id\\n      ,max(project_name)     as project_name       --项目名称\\n      ,max(project_type_id)  as project_type_id    --项目类型id\\n      ,max(project_type_name)as project_type_name  --项目类型名称\\n      ,max(sub_org_name)     as sub_org_name       --机构名称\\n      ,max(org_id)           as org_id             --集团id\\n      ,max(org_name)         as org_name           --集团名称\\n      ,sum(plan_num_day) as plan_num_day  --计划总数\\n      ,sum(item_num_day) as item_num_day  --任务总数\\n      ,sum(complete_num_day) as complete_num_day --完成任务数\\n      ,date_time\\n  from\\n  (\\n    select\\n         project_id        --项目id\\n        ,sub_org_id        --机构id\\n        ,max(project_name)     as project_name       --项目名称\\n        ,max(project_type_id)  as project_type_id    --项目类型id\\n        ,max(project_type_name)as project_type_name  --项目类型名称\\n        ,max(sub_org_name)     as sub_org_name       --机构名称\\n        ,max(org_id)           as org_id             --集团id\\n        ,max(org_name)         as org_name           --集团名称\\n        ,0 as plan_num_day  --计划总数\\n        ,count(1) as  item_num_day  --任务总数\\n        ,sum(case when complete_stase = 1 then 1 else 0 end) as complete_num_day --完成任务数\\n        ,substr(plan_create_time,1,10) as date_time\\n    from db_dw_hr.clife_hr_dwd_plan_snapshot_info\\n    where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    group by project_id\\n            ,sub_org_id\\n            ,substr(plan_create_time,1,10)\\n    union all\\n    select\\n          project_id        --项目id\\n         ,sub_org_id        --机构id\\n         ,max(project_name)     as project_name       --项目名称\\n         ,max(project_type_id)  as project_type_id    --项目类型id\\n         ,max(project_type_name)as project_type_name  --项目类型名称\\n         ,max(sub_org_name)     as sub_org_name       --机构名称\\n         ,max(org_id)           as org_id             --集团id\\n         ,max(org_name)         as org_name           --集团名称\\n         ,count(exec_date) as plan_num_day  --计划总数\\n         ,0 as  item_num_day  --任务总数\\n         ,0 as complete_num_day --完成任务数\\n         ,substr(exec_date,1,10) as date_time\\n     from db_dw_hr.clife_hr_dwd_plan_snapshot_info\\n     where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n     group by project_id\\n             ,sub_org_id\\n             ,substr(exec_date,1,10)\\n  )a\\n  group by project_id\\n          ,sub_org_id\\n          ,date_time\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_plan_snapshot_by_project\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-241cg\",\"name\":\"clife_hr_dws_service_record_by_spstmonth\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_service_record_by_spstmonth partition(part_date)\\nselect\\n     service_project_id --服务项目id\\n    ,sub_org_id         --机构id\\n    ,service_type       --服务类型（增值or基础）\\n    ,service_project_name  --服务项目名称\\n    ,service_type_id       --服务类型id\\n    ,service_type_name     --服务类型id名\\n    ,sub_org_name          --机构名称\\n    ,org_id                --集团id\\n    ,org_name              --集团名称\\n    ,old_man_num_month     --养老院老人数\\n    ,cost_month                    --服务总费用\\n    ,service_num_month             --服务数\\n    ,already_settle_service_num    --已结算服务数\\n    ,no_settle_service_num         --未结算服务数\\n    ,wait_complete_service_num     --待完成服务数\\n    ,complete_service_num          --已完成服务数\\n    ,evaluation_service_num        --已评价服务数\\n    ,evaluation_wait_num           --待评价服务数\\n    ,evaluation_good_num           --好评数\\n    ,evaluation_middle_num         --中评数\\n    ,evaluation_bad_num            --差评数\\n    ,coalesce(cost_month/old_man_num_month,0) as recharge_avg_month                --人均服务费\\n    ,coalesce(service_num_month/old_man_num_month,0) as member_recharge_avg_month  --人均服务数\\n    ,date_month\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date  --分区日期\\nfrom\\n(\\n   select\\n        service_project_id --服务项目id\\n       ,sub_org_id         --机构id\\n       ,service_type       --服务类型（增值or基础）\\n       ,max(service_project_name)   as service_project_name  --服务项目名称\\n       ,max(service_type_id)        as service_type_id       --服务类型id\\n       ,max(service_type_name)      as service_type_name     --服务类型id名\\n       ,max(sub_org_name) as sub_org_name  --机构名称\\n       ,max(org_id)       as org_id        --集团id\\n       ,max(org_name)     as org_name      --集团名称\\n       ,sum(old_man_num_day)            as old_man_num_month              --养老院老人数\\n       ,sum(cost_day)                   as cost_month                     --服务总费用\\n       ,sum(service_num_day)            as service_num_month              --服务数\\n       ,sum(already_settle_service_num) as already_settle_service_num     --已结算服务数\\n       ,sum(no_settle_service_num)      as no_settle_service_num          --未结算服务数\\n       ,sum(wait_complete_service_num)  as wait_complete_service_num      --待完成服务数\\n       ,sum(complete_service_num)       as complete_service_num           --已完成服务数\\n       ,sum(evaluation_service_num)     as evaluation_service_num         --已评价服务数\\n       ,sum(evaluation_wait_num)        as evaluation_wait_num            --待评价服务数\\n       ,sum(evaluation_good_num)        as evaluation_good_num            --好评数\\n       ,sum(evaluation_middle_num)      as evaluation_middle_num          --中评数\\n       ,sum(evaluation_bad_num)         as evaluation_bad_num             --差评数\\n       ,substr(date_time,1,7) as date_month\\n   from db_dw_hr.clife_hr_dws_service_record_by_spstday\\n   where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n   group by service_project_id\\n          ,sub_org_id\\n          ,service_type\\n          ,substr(date_time,1,7)\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_service_record_by_spstday\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-7mv1b9\",\"name\":\"clife_hr_dws_service_record_by_spst\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_service_record_by_spst partition(part_date)\\nselect\\n     service_project_id    --服务项目id\\n    ,sub_org_id            --机构id\\n    ,service_type          --服务类型（增值or基础）\\n    ,service_project_name  --服务项目名称\\n    ,service_type_id       --服务类型id\\n    ,service_type_name     --服务类型id名\\n    ,sub_org_name          --机构名称\\n    ,org_id                --集团id\\n    ,org_name              --集团名称\\n    ,old_man_num           --养老院老人数\\n    ,cost                          --服务总费用\\n    ,service_cnt                   --服务数\\n    ,already_settle_service_num    --已结算服务数\\n    ,no_settle_service_num         --未结算服务数\\n    ,wait_complete_service_num     --待完成服务数\\n    ,complete_service_num          --已完成服务数\\n    ,evaluation_service_num        --已评价服务数\\n    ,evaluation_wait_num           --待评价服务数\\n    ,evaluation_good_num           --好评数\\n    ,evaluation_middle_num         --中评数\\n    ,evaluation_bad_num            --差评数\\n    ,coalesce(cost/old_man_num,0) as recharge_avg                --人均服务费\\n    ,coalesce(service_cnt/old_man_num,0) as member_recharge_avg  --人均服务数\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date  --分区日期\\nfrom\\n(\\n  select\\n       service_project_id --服务项目id\\n      ,sub_org_id         --机构id\\n      ,service_type       --服务类型（增值or基础）\\n      ,max(service_project_name)   as service_project_name  --服务项目名称\\n      ,max(service_type_id)        as service_type_id       --服务类型id\\n      ,max(service_type_name)      as service_type_name     --服务类型id名\\n      ,max(sub_org_name) as sub_org_name  --机构名称\\n      ,max(org_id)       as org_id        --集团id\\n      ,max(org_name)     as org_name      --集团名称\\n      ,sum(cost)         as cost                          --服务总费用\\n      ,sum(1)            as service_cnt                   --服务数\\n      ,count(distinct old_man_id) as old_man_num --养老院老人数\\n      ,sum(case when settlement_status =  2 then 1 else 0 end ) as  already_settle_service_num     --已结算服务数\\n      ,sum(case when settlement_status =  3 then 1 else 0 end ) as  no_settle_service_num          --未结算服务数\\n      ,sum(case when service_status = 1  then 1 else 0 end )    as  wait_complete_service_num      --待完成服务数\\n      ,sum(case when service_status = 2  then 1 else 0 end )    as  complete_service_num           --已完成服务数\\n      ,sum(case when service_status = 3  then 1 else 0 end )    as  evaluation_service_num         --已评价服务数\\n      ,sum(case when evaluation_status = 0  then 1 else 0 end ) as  evaluation_wait_num            --待评价服务数\\n      ,sum(case when evaluation_status = 1  then 1 else 0 end ) as  evaluation_good_num            --好评数\\n      ,sum(case when evaluation_status = 2  then 1 else 0 end ) as  evaluation_middle_num          --中评数\\n      ,sum(case when evaluation_status = 3  then 1 else 0 end ) as  evaluation_bad_num             --差评数\\n  from db_dw_hr.clife_hr_dwd_service_record_info\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by service_project_id\\n          ,sub_org_id\\n          ,service_type\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_activity_manage_by_soyear\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-213ig\",\"name\":\"clife_hr_dws_service_record_by_nhyear\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_service_record_by_nhyear partition(part_date)\\nselect\\n     nursin_homes_id  --养老院id\\n    ,service_type     --服务类型（增值or基础）\\n    ,nursing_homes_name    --养老院名称\\n    ,sub_org_id    --机构id\\n    ,sub_org_name  --机构名称\\n    ,org_id        --集团id\\n    ,org_name      --集团名称\\n    ,old_man_num_year    --养老院老人数\\n    ,cost_year                    --服务总费用\\n    ,service_num_year             --服务数\\n    ,already_settle_service_num    --已结算服务数\\n    ,no_settle_service_num         --未结算服务数\\n    ,wait_complete_service_num     --待完成服务数\\n    ,complete_service_num          --已完成服务数\\n    ,evaluation_service_num        --已评价服务数\\n    ,evaluation_wait_num           --待评价服务数\\n    ,evaluation_good_num           --好评数\\n    ,evaluation_middle_num         --中评数\\n    ,evaluation_bad_num            --差评数\\n    ,coalesce(cost_year/old_man_num_year,0) as recharge_avg_year                --人均服务费\\n    ,coalesce(service_num_year/old_man_num_year,0) as member_recharge_avg_year  --人均服务数\\n    ,date_year\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date  --分区日期\\nfrom\\n(\\n   select\\n        nursin_homes_id        --养老院id\\n       ,service_type           --服务类型（增值or基础）\\n       ,max(nursing_homes_name) as nursing_homes_name --养老院名称\\n       ,max(sub_org_id)         as sub_org_id--机构id\\n       ,max(sub_org_name)       as sub_org_name--机构名称\\n       ,max(org_id)             as org_id--集团id\\n       ,max(org_name)           as org_name--集团名称\\n       ,sum(old_man_num_month)            as old_man_num_year              --养老院老人数\\n       ,sum(cost_month)                   as cost_year                    --服务总费用\\n       ,sum(service_num_month)            as service_num_year             --服务数\\n       ,sum(already_settle_service_num) as already_settle_service_num     --已结算服务数\\n       ,sum(no_settle_service_num)      as no_settle_service_num          --未结算服务数\\n       ,sum(wait_complete_service_num)  as wait_complete_service_num      --待完成服务数\\n       ,sum(complete_service_num)       as complete_service_num           --已完成服务数\\n       ,sum(evaluation_service_num)     as evaluation_service_num         --已评价服务数\\n       ,sum(evaluation_wait_num)        as evaluation_wait_num            --待评价服务数\\n       ,sum(evaluation_good_num)        as evaluation_good_num            --好评数\\n       ,sum(evaluation_middle_num)      as evaluation_middle_num          --中评数\\n       ,sum(evaluation_bad_num)         as evaluation_bad_num             --差评数\\n       ,substr(date_month,1,4) as date_year\\n   from db_dw_hr.clife_hr_dws_service_record_by_nhmonth\\n   where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n   group by nursin_homes_id\\n           ,service_type\\n           ,substr(date_month,1,4)\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_service_record_by_nhmonth\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-6ut5gn\",\"name\":\"clife_hr_dws_coupon_manage_by_nhyear\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_coupon_manage_by_nhyear partition(part_date)\\nselect\\n     nurse_home_id --养老院id\\n    ,max(nursing_homes_name) as nursing_homes_name --养老院名称\\n    ,max(sub_org_id)         as sub_org_id         --机构id\\n    ,max(sub_org_name)       as sub_org_name       --机构名称\\n    ,max(org_id)             as org_id             --集团id\\n    ,max(org_name)           as org_name           --集团名称\\n    ,max(area_id)            as area_id            --区域id \\n    ,sum(deduction_coupon_num_month)    as deduction_coupon_num_year        --每年抵扣优惠券发放数量\\n    ,sum(discount_coupon_num_month)     as discount_coupon_num_year         --每年折扣优惠券发放数量\\n    ,sum(cash_coupon_num_month)         as cash_coupon_num_year             --每年现金优惠券发放数量\\n    ,sum(deduction_coupon_use_num_month)as deduction_coupon_use_num_year    --每年抵扣优惠券使用数量\\n    ,sum(discount_coupon_use_num_month) as discount_coupon_use_num_year     --每年折扣优惠券使用数量\\n    ,sum(cash_coupon_use_num_month)     as cash_coupon_use_num_year         --每年现金优惠券使用数量\\n    ,sum(deduction_coupon_cost_month)   as deduction_coupon_cost_year       --每年抵扣优惠券花费\\n    ,sum(discount_coupon_cost_month)    as discount_coupon_cost_year        --每年折扣优惠券花费\\n    ,sum(cash_coupon_cost_month)        as cash_coupon_cost_year            --每年现金优惠券花费\\n    ,substr(date_month,1,4) as date_year  --年份 \\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom db_dw_hr.clife_hr_dws_coupon_manage_by_nhmonth\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','')\\ngroup by nurse_home_id\\n        ,substr(date_month,1,4)\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_coupon_manage_by_nhmonth\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-5jy2u0\",\"name\":\"clife_hr_dws_activity_manage_by_somonth\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_activity_manage_by_somonth partition(part_date)\\nselect\\n     sub_org_id             --机构id\\n    ,activity_type\\n    ,sub_org_name           --机构名称\\n    ,org_id                 --集团id\\n    ,org_name               --集团名称\\n    ,area_id                --区域id \\n    ,reserve_cnt_month        --预定活动室次数\\n    ,template_cnt_month        --使用模板次数\\n    ,activity_cnt_month       --创建活动数\\n    ,activity_fee_month       --活动费用\\n    ,host_activity_cnt_month  --已举办活动数\\n    ,confirm_old_man_cnt_month--到场人次\\n    ,sign_old_man_cnt_month   --签到人次\\n    ,apply_old_man_cnt_month  --报名人次\\n    ,apply_activity_cnt_month --已报名活动数\\n    ,date_month --月份 \\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom\\n(\\n  select\\n       activity_type\\n      ,sub_org_id             --机构id\\n      ,max(sub_org_name)       as sub_org_name       --机构名称\\n      ,max(org_id)             as org_id             --集团id\\n      ,max(org_name)           as org_name           --集团名称\\n      ,max(area_id)            as area_id            --区域id \\n      ,sum(reserve_cnt_day)         as reserve_cnt_month        --预定活动室次数\\n      ,sum(template_cnt_day)         as template_cnt_month        --使用模板次数\\n      ,sum(activity_cnt_day)        as activity_cnt_month       --创建活动数\\n      ,sum(activity_fee_day)        as activity_fee_month       --活动费用\\n      ,sum(host_activity_cnt_day)   as host_activity_cnt_month  --已举办活动数\\n      ,sum(confirm_old_man_cnt_day) as confirm_old_man_cnt_month--到场人次\\n      ,sum(sign_old_man_cnt_day)    as sign_old_man_cnt_month   --签到人次\\n      ,sum(apply_old_man_cnt_day)   as apply_old_man_cnt_month  --报名人次\\n      ,sum(apply_activity_cnt_day)  as apply_activity_cnt_month --已报名活动数\\n      ,substr(date_time,1,7) as date_month --月份     \\n  from db_dw_hr.clife_hr_dws_activity_manage_by_soday\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by activity_type\\n          ,sub_org_id\\n          ,substr(date_time,1,7)\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_activity_manage_by_soday\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-5vr48i\",\"name\":\"clife_hr_dws_activity_manage_by_soyear\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_activity_manage_by_soyear partition(part_date)\\nselect\\n     sub_org_id             --机构id\\n    ,activity_type\\n    ,sub_org_name           --机构名称\\n    ,org_id                 --集团id\\n    ,org_name               --集团名称\\n    ,area_id                --区域id \\n    ,reserve_cnt_year        --预定活动室次数\\n    ,template_cnt_year        --使用模板次数\\n    ,activity_cnt_year       --创建活动数\\n    ,activity_fee_year       --活动费用\\n    ,host_activity_cnt_year  --已举办活动数\\n    ,confirm_old_man_cnt_year--到场人次\\n    ,sign_old_man_cnt_year   --签到人次\\n    ,apply_old_man_cnt_year  --报名人次\\n    ,apply_activity_cnt_year --已报名活动数\\n    ,date_year --年份 \\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom\\n(\\n  select\\n       activity_type\\n      ,sub_org_id             --机构id\\n      ,max(sub_org_name)       as sub_org_name       --机构名称\\n      ,max(org_id)             as org_id             --集团id\\n      ,max(org_name)           as org_name           --集团名称\\n      ,max(area_id)            as area_id            --区域id \\n      ,sum(reserve_cnt_month)         as reserve_cnt_year        --预定活动室次数\\n      ,sum(template_cnt_month)         as template_cnt_year        --使用模板次数\\n      ,sum(activity_cnt_month)        as activity_cnt_year       --创建活动数\\n      ,sum(activity_fee_month)        as activity_fee_year       --活动费用\\n      ,sum(host_activity_cnt_month)   as host_activity_cnt_year  --已举办活动数\\n      ,sum(confirm_old_man_cnt_month) as confirm_old_man_cnt_year--到场人次\\n      ,sum(sign_old_man_cnt_month)    as sign_old_man_cnt_year   --签到人次\\n      ,sum(apply_old_man_cnt_month)   as apply_old_man_cnt_year  --报名人次\\n      ,sum(apply_activity_cnt_month)  as apply_activity_cnt_year --已报名活动数\\n      ,substr(date_month,1,4) as date_year --年份     \\n  from db_dw_hr.clife_hr_dws_activity_manage_by_somonth\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by activity_type\\n          ,sub_org_id \\n          ,substr(date_month,1,4)\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_activity_manage_by_somonth\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-1lu6z1\",\"name\":\"clife_hr_dws_activity_manage_by_nhyear\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_activity_manage_by_nhyear partition(part_date)\\nselect\\n     nurse_home_id --养老院id\\n    ,nursing_homes_name     --养老院名称\\n    ,sub_org_id             --机构id\\n    ,sub_org_name           --机构名称\\n    ,org_id                 --集团id\\n    ,org_name               --集团名称\\n    ,area_id                --区域id \\n    ,reserve_cnt_year        --预定活动室次数\\n    ,template_cnt_year        --使用模板次数\\n    ,activity_cnt_year       --创建活动数\\n    ,activity_fee_year       --活动费用\\n    ,host_activity_cnt_year  --已举办活动数\\n    ,confirm_old_man_cnt_year--到场人次\\n    ,sign_old_man_cnt_year   --签到人次\\n    ,apply_old_man_cnt_year  --报名人次\\n    ,apply_activity_cnt_year --已报名活动数\\n    ,date_year --年份 \\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom\\n(\\n  select\\n       nurse_home_id --养老院id\\n      ,max(nursing_homes_name) as nursing_homes_name --养老院名称\\n      ,max(sub_org_id)         as sub_org_id         --机构id\\n      ,max(sub_org_name)       as sub_org_name       --机构名称\\n      ,max(org_id)             as org_id             --集团id\\n      ,max(org_name)           as org_name           --集团名称\\n      ,max(area_id)            as area_id            --区域id \\n      ,sum(reserve_cnt_month)         as reserve_cnt_year        --预定活动室次数\\n      ,sum(template_cnt_month)         as template_cnt_year        --使用模板次数\\n      ,sum(activity_cnt_month)        as activity_cnt_year       --创建活动数\\n      ,sum(activity_fee_month)        as activity_fee_year       --活动费用\\n      ,sum(host_activity_cnt_month)   as host_activity_cnt_year  --已举办活动数\\n      ,sum(confirm_old_man_cnt_month) as confirm_old_man_cnt_year--到场人次\\n      ,sum(sign_old_man_cnt_month)    as sign_old_man_cnt_year   --签到人次\\n      ,sum(apply_old_man_cnt_month)   as apply_old_man_cnt_year  --报名人次\\n      ,sum(apply_activity_cnt_month)  as apply_activity_cnt_year --已报名活动数\\n      ,substr(date_month,1,4) as date_year --年份     \\n  from db_dw_hr.clife_hr_dws_activity_manage_by_nhmonth\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by nurse_home_id\\n          ,substr(date_month,1,4)\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_activity_manage_by_nhmonth\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-56q5sb\",\"name\":\"clife_hr_dws_reside_manage_by_somonth\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_reside_manage_by_somonth partition(part_date)\\nselect\\n     sub_org_id          --机构id\\n    ,sub_org_name        --机构名称\\n    ,org_id              --集团id\\n    ,org_name            --集团名称\\n    ,area_id             --区域id\\n    ,reside_cnt_month        --每月入住人数\\n    ,countermand_cnt_month   --每月退住人数\\n    ,room_num_month          --每月入住房间数\\n    ,bed_num_month           --每月入住床位数\\n    ,all_num_month           --每月总人数\\n    ,visit_num_month         --每月探访人数\\n    ,visit_time_month        --每月探访时长\\n    ,leave_num_month         --每月请假次数\\n    ,leave_time_month      --每月请假时长\\n    ,sick_leave_num_month  --每月病假次数\\n    ,casual_leave_num_month--每月事假次数\\n    ,other_leave_num_month --每月其他假次数\\n    ,room_amount --楼层房间数\\n    ,bed_amount  --楼层床位数\\n    ,coalesce(reside_cnt_month/all_num_month,0)           as check_in_rate_month      --每月入住率\\n    ,coalesce(countermand_cnt_month/all_num_month,0)      as countermand_rate_month   --每月退住率\\n    ,coalesce(room_num_month/room_amount,0)               as check_in_room_rate_month --每月房间入住率\\n    ,coalesce((room_amount-room_num_month)/room_amount,0) as vacant_room_rate_month   --每月房间空房率\\n    ,coalesce(bed_num_month/bed_amount,0)                 as check_in_bed_rate_month  --每月床位入住率\\n    ,coalesce((bed_amount-bed_num_month)/bed_amount,0)    as vacant_bed_rate_month    --每月床位空床率\\t\\n    ,contract_time_1_num_month        --录入合同数量（1年期）\\n    ,contract_time_2_num_month        --录入合同数量（2年期）\\n    ,contract_time_3_num_month        --录入合同数量（3年期）\\n    ,contract_time_4_num_month        --录入合同数量（4年期）\\n    ,contract_time_5_num_month        --录入合同数量（5年期）\\n    ,contract_time_surpass_5_num_month --录入合同数量（5年以上）\\n    ,refund_amount        --当月请假退费金额\\t\\n    ,leave_reducation_fee --当月请假减免费用\\t\\n    ,date_month --月份\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom\\n(\\n  select\\n       sub_org_id          --机构id\\n      ,max(sub_org_name)       as sub_org_name        --机构名称\\n      ,max(org_id)             as org_id              --集团id\\n      ,max(org_name)           as org_name            --集团名称\\n      ,max(area_id)            as area_id             --区域id \\n      ,sum(reside_cnt_day)       as reside_cnt_month        --每月入住人数\\n      ,sum(countermand_cnt_day)  as countermand_cnt_month   --每月退住人数\\n      ,sum(room_num_day)         as room_num_month          --每月入住房间数\\n      ,sum(bed_num_day)          as bed_num_month           --每月入住床位数\\n      ,sum(all_num)              as all_num_month           --每月总人数\\n      ,sum(visit_num_day)        as visit_num_month         --每月探访人数\\n      ,sum(visit_time_day)       as visit_time_month        --每月探访时长\\n      ,sum(leave_num_day)        as leave_num_month         --每月请假次数\\n      ,sum(leave_time_day)       as leave_time_month      --每月请假时长\\n      ,sum(sick_leave_num_day)   as sick_leave_num_month  --每月病假次数\\n      ,sum(casual_leave_num_day) as casual_leave_num_month--每月事假次数\\n      ,sum(other_leave_num_day)  as other_leave_num_month --每月其他假次数\\n      ,sum(refund_amount)        as refund_amount        --当月请假退费金额\\n      ,sum(leave_reducation_fee) as leave_reducation_fee --当月请假减免费用\\n      ,max(room_amount) as room_amount --楼层房间数\\n      ,max(bed_amount)  as bed_amount  --楼层床位数\\t\\n      ,sum(contract_time_1_num_day)         as contract_time_1_num_month       --录入合同数量（1年期）\\n      ,sum(contract_time_2_num_day)         as contract_time_2_num_month       --录入合同数量（2年期）\\n      ,sum(contract_time_3_num_day)         as contract_time_3_num_month       --录入合同数量（3年期）\\n      ,sum(contract_time_4_num_day)         as contract_time_4_num_month       --录入合同数量（4年期）\\n      ,sum(contract_time_5_num_day)         as contract_time_5_num_month       --录入合同数量（5年期）\\n      ,sum(contract_time_surpass_5_num_day) as contract_time_surpass_5_num_month--录入合同数量（5年以上）\\n      ,substr(date_time,1,7) as date_month --月份\\n  from db_dw_hr.clife_hr_dws_reside_manage_by_soday\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by sub_org_id\\n          ,substr(date_time,1,7)\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_reside_manage_by_suborg\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-2d55xf\",\"name\":\"clife_hr_dws_reside_manage_by_nhyear\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_reside_manage_by_nhyear partition(part_date)\\nselect\\n     nursin_homes_id     --养老院id\\n    ,nursing_homes_name  --养老院名称\\n    ,sub_org_id          --机构id\\n    ,sub_org_name        --机构名称\\n    ,org_id              --集团id\\n    ,org_name            --集团名称\\n    ,area_id             --区域id\\n    ,reside_cnt_year         --每年入住人数\\n    ,countermand_cnt_year    --每年退住人数\\n    ,room_num_year           --每年入住房间数\\n    ,bed_num_year            --每年入住床位数\\n    ,all_num_year            --每年总人数\\n    ,visit_num_year          --每年探访人数\\n    ,visit_time_year         --每年探访时长\\n    ,leave_num_year          --每年请假次数\\n    ,leave_time_year         --每年请假时长\\n    ,sick_leave_num_year     --每年病假次数\\n    ,casual_leave_num_year   --每年事假次数\\n    ,other_leave_num_year    --每年其他假次数\\n    ,room_amount --楼层房间数\\n    ,bed_amount  --楼层床位数\\n    ,coalesce(reside_cnt_year/all_num_year,0)           as check_in_rate_year      --每年入住率\\n    ,coalesce(countermand_cnt_year/all_num_year,0)      as countermand_rate_year   --每年退住率\\n    ,coalesce(room_num_year/room_amount,0)               as check_in_room_rate_year--每年房间入住率\\n    ,coalesce((room_amount-room_num_year)/room_amount,0) as vacant_room_rate_year  --每年房间空房率\\n    ,coalesce(bed_num_year/bed_amount,0)                 as check_in_bed_rate_year --每年床位入住率\\n    ,coalesce((bed_amount-bed_num_year)/bed_amount,0)    as vacant_bed_rate_year   --每年床位空床率\\t\\n    ,contract_time_1_num_year        --录入合同数量（1年期）\\n    ,contract_time_2_num_year        --录入合同数量（2年期）\\n    ,contract_time_3_num_year        --录入合同数量（3年期）\\n    ,contract_time_4_num_year        --录入合同数量（4年期）\\n    ,contract_time_5_num_year        --录入合同数量（5年期）\\n    ,contract_time_surpass_5_num_year --录入合同数量（5年以上）\\n    ,refund_amount        --当年请假退费金额\\t\\n    ,leave_reducation_fee --当年请假减免费用\\n    ,date_year --年份\\n    ,regexp_replace(date_sub(current_date(),1),'-','')\\nfrom\\n(\\n  select\\n       nursin_homes_id     --养老院id\\n      ,max(nursing_homes_name) as nursing_homes_name  --养老院名称\\n      ,max(sub_org_id)         as sub_org_id          --机构id\\n      ,max(sub_org_name)       as sub_org_name        --机构名称\\n      ,max(org_id)             as org_id              --集团id\\n      ,max(org_name)           as org_name            --集团名称\\n      ,max(area_id)            as area_id             --区域id \\n      ,sum(reside_cnt_month)       as reside_cnt_year         --每年入住人数\\n      ,sum(countermand_cnt_month)  as countermand_cnt_year    --每年退住人数\\n      ,sum(room_num_month)         as room_num_year           --每年入住房间数\\n      ,sum(bed_num_month)          as bed_num_year            --每年入住床位数\\n      ,sum(all_num_month)          as all_num_year            --每年总人数\\n      ,sum(visit_num_month)        as visit_num_year          --每年探访人数\\n      ,sum(visit_time_month)       as visit_time_year         --每年探访时长\\n      ,sum(leave_num_month)        as leave_num_year          --每年请假次数\\n      ,sum(leave_time_month)       as leave_time_year         --每年请假时长\\n      ,sum(sick_leave_num_month)   as sick_leave_num_year     --每年病假次数\\n      ,sum(casual_leave_num_month) as casual_leave_num_year   --每年事假次数\\n      ,sum(other_leave_num_month)  as other_leave_num_year    --每年其他假次数\\n      ,sum(refund_amount)        as refund_amount        --当年请假退费金额\\n      ,sum(leave_reducation_fee) as leave_reducation_fee --当年请假减免费用\\n      ,max(room_amount) as room_amount --楼层房间数\\n      ,max(bed_amount)  as bed_amount  --楼层床位数\\t\\n      ,sum(contract_time_1_num_month)         contract_time_1_num_year        --录入合同数量（1年期）\\n      ,sum(contract_time_2_num_month)         contract_time_2_num_year        --录入合同数量（2年期）\\n      ,sum(contract_time_3_num_month)         contract_time_3_num_year        --录入合同数量（3年期）\\n      ,sum(contract_time_4_num_month)         contract_time_4_num_year        --录入合同数量（4年期）\\n      ,sum(contract_time_5_num_month)         contract_time_5_num_year        --录入合同数量（5年期）\\n      ,sum(contract_time_surpass_5_num_month) contract_time_surpass_5_num_year--录入合同数量（5年以上）\\n      ,substr(date_month,1,4) as date_year --年份\\n  from db_dw_hr.clife_hr_dws_reside_manage_by_nhmonth\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by nursin_homes_id\\n          ,substr(date_month,1,4)\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_reside_manage_by_nhmonth\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-53l7gb\",\"name\":\"clife_hr_dws_reside_manage_by_nhmonth\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_reside_manage_by_nhmonth partition(part_date)\\nselect\\n     nursin_homes_id     --养老院id\\n    ,nursing_homes_name  --养老院名称\\n    ,sub_org_id          --机构id\\n    ,sub_org_name        --机构名称\\n    ,org_id              --集团id\\n    ,org_name            --集团名称\\n    ,area_id             --区域id\\n    ,reside_cnt_month        --每月入住人数\\n    ,countermand_cnt_month   --每月退住人数\\n    ,room_num_month          --每月入住房间数\\n    ,bed_num_month           --每月入住床位数\\n    ,all_num_month           --每月总人数\\n    ,visit_num_month         --每月探访人数\\n    ,visit_time_month        --每月探访时长\\n    ,leave_num_month         --每月请假次数\\n    ,leave_time_month      --每月请假时长\\n    ,sick_leave_num_month  --每月病假次数\\n    ,casual_leave_num_month--每月事假次数\\n    ,other_leave_num_month --每月其他假次数\\n    ,room_amount --楼层房间数\\n    ,bed_amount  --楼层床位数\\n    ,coalesce(reside_cnt_month/all_num_month,0)           as check_in_rate_month      --每月入住率\\n    ,coalesce(countermand_cnt_month/all_num_month,0)      as countermand_rate_month   --每月退住率\\n    ,coalesce(room_num_month/room_amount,0)               as check_in_room_rate_month --每月房间入住率\\n    ,coalesce((room_amount-room_num_month)/room_amount,0) as vacant_room_rate_month   --每月房间空房率\\n    ,coalesce(bed_num_month/bed_amount,0)                 as check_in_bed_rate_month  --每月床位入住率\\n    ,coalesce((bed_amount-bed_num_month)/bed_amount,0)    as vacant_bed_rate_month    --每月床位空床率\\t\\n    ,contract_time_1_num_month        --录入合同数量（1年期）\\n    ,contract_time_2_num_month        --录入合同数量（2年期）\\n    ,contract_time_3_num_month        --录入合同数量（3年期）\\n    ,contract_time_4_num_month        --录入合同数量（4年期）\\n    ,contract_time_5_num_month        --录入合同数量（5年期）\\n    ,contract_time_surpass_5_num_month --录入合同数量（5年以上）\\n    ,refund_amount        --当月请假退费金额\\t\\n    ,leave_reducation_fee --当月请假减免费用\\t\\n    ,date_month --月份\\n    ,regexp_replace(date_sub(current_date(),1),'-','')\\nfrom\\n(\\n  select\\n       nursin_homes_id     --养老院id\\n      ,max(nursing_homes_name) as nursing_homes_name  --养老院名称\\n      ,max(sub_org_id)         as sub_org_id          --机构id\\n      ,max(sub_org_name)       as sub_org_name        --机构名称\\n      ,max(org_id)             as org_id              --集团id\\n      ,max(org_name)           as org_name            --集团名称\\n      ,max(area_id)            as area_id             --区域id \\n      ,sum(reside_cnt_day)       as reside_cnt_month        --每月入住人数\\n      ,sum(countermand_cnt_day)  as countermand_cnt_month   --每月退住人数\\n      ,sum(room_num_day)         as room_num_month          --每月入住房间数\\n      ,sum(bed_num_day)          as bed_num_month           --每月入住床位数\\n      ,sum(all_num)              as all_num_month           --每月总人数\\n      ,sum(visit_num_day)        as visit_num_month         --每月探访人数\\n      ,sum(visit_time_day)       as visit_time_month        --每月探访时长\\n      ,sum(leave_num_day)        as leave_num_month         --每月请假次数\\n      ,sum(leave_time_day)       as leave_time_month      --每月请假时长\\n      ,sum(sick_leave_num_day)   as sick_leave_num_month  --每月病假次数\\n      ,sum(casual_leave_num_day) as casual_leave_num_month--每月事假次数\\n      ,sum(other_leave_num_day)  as other_leave_num_month --每月其他假次数\\n      ,sum(refund_amount)        as refund_amount        --当月请假退费金额\\n      ,sum(leave_reducation_fee) as leave_reducation_fee --当月请假减免费用\\n      ,max(room_amount) as room_amount --楼层房间数\\n      ,max(bed_amount)  as bed_amount  --楼层床位数\\t\\n      ,sum(contract_time_1_num_day)         as contract_time_1_num_month       --录入合同数量（1年期）\\n      ,sum(contract_time_2_num_day)         as contract_time_2_num_month       --录入合同数量（2年期）\\n      ,sum(contract_time_3_num_day)         as contract_time_3_num_month       --录入合同数量（3年期）\\n      ,sum(contract_time_4_num_day)         as contract_time_4_num_month       --录入合同数量（4年期）\\n      ,sum(contract_time_5_num_day)         as contract_time_5_num_month       --录入合同数量（5年期）\\n      ,sum(contract_time_surpass_5_num_day) as contract_time_surpass_5_num_month--录入合同数量（5年以上）\\n      ,substr(date_time,1,7) as date_month --月份\\n  from db_dw_hr.clife_hr_dws_reside_manage_by_nhday\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by nursin_homes_id\\n          ,substr(date_time,1,7)\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_reside_manage_by_nhome\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-78b689\",\"name\":\"clife_hr_dws_reside_manage_by_floor\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_reside_manage_by_floor partition(part_date)\\nselect\\n     t.floor_id            --楼层id\\n    ,t.building_id         --楼栋id\\n    ,t.nursin_homes_id     --养老院id\\n    ,t.nursing_homes_name  --养老院名称\\n    ,t.sub_org_id          --机构id\\n    ,t.sub_org_name        --机构名称\\n    ,t.org_id              --集团id\\n    ,t.org_name            --集团名称\\n    ,t.area_id             --区域id\\n    ,t.check_in_num        --入住人数\\n    ,t.countermand_num     --退住人数\\n    ,coalesce(t.check_in_num/t.all_num,0) as  check_in_rate       --入住率\\n    ,coalesce(t.countermand_num/t.all_num,0) as countermand_rate  --退住率\\n    ,t2.room_num       --入住房间数\\n    ,t3.room_amount    --楼层房间数\\n    ,coalesce(t2.room_num/t3.room_amount,0) as check_in_room_rate               --房间入住率\\n    ,coalesce((t3.room_amount-t2.room_num)/t3.room_amount,0) as vacant_room_rate --房间空房率\\n    ,t2.bed_num       --入住床位数\\n    ,t3.bed_amount    --楼层床位数\\n    ,coalesce(t2.bed_num/t3.bed_amount,0) as check_in_bed_rate              --床位入住率\\n    ,coalesce((t3.bed_amount-t2.bed_num)/t3.bed_amount,0) as vacant_bed_rate --床位空床率\\n    ,t.relatives_num --探访人数\\n    ,t1.visit_time   --探访时长\\n    ,t.contract_time_1_num        --录入合同数量（1年期）\\n    ,t.contract_time_2_num        --录入合同数量（2年期）\\n    ,t.contract_time_3_num        --录入合同数量（3年期）\\n    ,t.contract_time_4_num        --录入合同数量（4年期）\\n    ,t.contract_time_5_num        --录入合同数量（5年期）\\n    ,t.contract_time_surpass_5_num --录入合同数量（5年以上）\\n    ,t.leave_num        --请假次数\\n    ,t.leave_time       --请假时长\\n    ,t.sick_leave_num   --病假次数\\n    ,t.casual_leave_num --事假次数\\n    ,t.other_leave_num  --其他假次数\\n    ,t.all_num          --总人数\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom\\n(\\n  select\\n       floor_id                                       --楼层id\\n      ,max(building_id)        as building_id         --楼栋id\\n      ,max(nursin_homes_id)    as nursin_homes_id     --养老院id\\n      ,max(nursing_homes_name) as nursing_homes_name  --养老院名称\\n      ,max(sub_org_id)         as sub_org_id          --机构id\\n      ,max(sub_org_name)       as sub_org_name        --机构名称\\n      ,max(org_id)             as org_id              --集团id\\n      ,max(org_name)           as org_name            --集团名称\\n      ,max(area_id)            as  area_id            --区域id\\n      ,count(1)                as all_num             --所有人数\\n      ,sum(check_in_num) as check_in_num    --入住人数\\n      ,sum(countermand_num) as countermand_num --退住人数\\n      ,sum(relatives_num) as relatives_num --探访人数\\n      ,sum(contract_time_1_num) as contract_time_1_num        --录入合同数量（1年期）\\n      ,sum(contract_time_2_num) as contract_time_2_num        --录入合同数量（2年期）\\n      ,sum(contract_time_3_num) as contract_time_3_num        --录入合同数量（3年期）\\n      ,sum(contract_time_4_num) as contract_time_4_num        --录入合同数量（4年期）\\n      ,sum(contract_time_5_num) as contract_time_5_num        --录入合同数量（5年期）\\n      ,sum(contract_time_surpass_5_num) as contract_time_surpass_5_num --录入合同数量（5年以上）\\n      ,sum(leave_num)        as leave_num --请假次数\\n      ,sum(leave_time)       as leave_time --请假时长\\n      ,sum(sick_leave_num)   as sick_leave_num     --病假次数\\n      ,sum(casual_leave_num) as casual_leave_num --事假次数\\n      ,sum(other_leave_num)  as other_leave_num   --其他假次数\\n  from db_dw_hr.clife_hr_dwm_reside_manage_aggregation\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by floor_id\\n)t \\nleft join\\n(\\n  select\\n       floor_id\\n      ,sum(CAST((if(a.visit_end_time is null,unix_timestamp(),unix_timestamp(a.visit_end_time)) - unix_timestamp(a.visit_start_time)) / 60 AS int) % 60) as visit_time --探访时长\\n  from\\n  (\\n     select\\n          b.old_man_id,b.floor_id,b.building_id\\n         ,ip.relatives_name\\n         ,split(ip.visit_time,'-')[0] as visit_start_time\\n         ,split(ip.visit_time,'-')[1] as visit_end_time\\n    from db_dw_hr.clife_hr_dwm_reside_manage_aggregation b\\n    lateral view explodemulti(if(b.relatives_names is null,'',b.relatives_names),if(b.visit_times is null,'',b.visit_times))ip as relatives_name,visit_time\\n    where b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n  ) a\\n  group by floor_id\\n)t1 on t.floor_id = t1.floor_id\\nleft join\\n(\\n  select\\n       floor_id\\n      ,count(case when a.reside_status = 3 then a.room_id else null end)   as room_num    --入住房间数\\n      ,count(case when a.reside_status = 3 then a.bed_id else null end)   as bed_num     --入住床位数\\n  from\\n  (\\n    select\\n         b.old_man_id,b.floor_id,b.building_id\\n        ,ip.reside_status\\n        ,ip.room_id\\n        ,ip.bed_id\\n    from db_dw_hr.clife_hr_dwm_reside_manage_aggregation b\\n    lateral view explodemulti(if(b.reside_status_list is null,'',b.reside_status_list),if(b.room_id_list is null,'',b.room_id_list),if(b.bed_id_list is null,'',b.bed_id_list))ip as reside_status,room_id,bed_id\\n    where b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n  ) a\\n  group by floor_id\\n)t2 on t.floor_id = t2.floor_id\\nleft join\\n(\\n  select\\n       floor_id\\n      ,count(room_id)  as room_amount \\n      ,sum(bed_amount) as bed_amount\\n  from db_dw_hr.clife_hr_dim_location_room\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by floor_id\\n)t3 on t.floor_id=t3.floor_id\",\"udfs\":\"13\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_reside_manage_by_soday\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-6jq25s\",\"name\":\"clife_hr_dws_reside_manage_by_bday\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_reside_manage_by_bday partition(part_date)\\nselect\\n     a.building_id         --楼栋id\\n    ,a.nursin_homes_id     --养老院id\\n    ,a.nursing_homes_name  --养老院名称\\n    ,a.sub_org_id          --机构id\\n    ,a.sub_org_name        --机构名称\\n    ,a.org_id              --集团id\\n    ,a.org_name            --集团名称\\n    ,a.area_id             --区域id\\n    ,a.reside_cnt_day       --每天入住人数\\n    ,a.countermand_cnt_day  --每日退住人数\\n    ,a.room_num_day         --每日入住房间数\\n    ,a.bed_num_day          --每日入住床位数\\n    ,a.all_num              --每日总人数\\n    ,a.visit_num_day        --每日探访人数\\n    ,a.visit_time_day       --每日探访时长\\n    ,a.leave_num_day        --每日请假次数\\n    ,a.leave_time_day       --每日请假时长\\n    ,a.sick_leave_num_day   --每日病假次数\\n    ,a.casual_leave_num_day --每日事假次数\\n    ,a.other_leave_num_day  --每日其他假次数\\n    ,b.room_amount --楼层房间数\\n    ,b.bed_amount  --楼层床位数\\n    ,coalesce(a.reside_cnt_day/a.all_num,0)      as check_in_rate_day       --每日入住率\\n    ,coalesce(a.countermand_cnt_day/a.all_num,0) as countermand_rate_day    --每日退住率\\n    ,coalesce(a.room_num_day/b.room_amount,0)    as check_in_room_rate_day  --每日房间入住率\\n    ,coalesce((b.room_amount-a.room_num_day)/b.room_amount,0) as vacant_room_rate_day  --房间空房率\\n    ,coalesce(a.bed_num_day/b.bed_amount,0)                   as check_in_bed_rate_day --床位入住率\\n    ,coalesce((b.bed_amount-a.bed_num_day)/b.bed_amount,0)    as vacant_bed_rate_day   --床位空床率\\t\\n    ,a.contract_time_1_num_day        --录入合同数量（1年期）\\n    ,a.contract_time_2_num_day        --录入合同数量（2年期）\\n    ,a.contract_time_3_num_day        --录入合同数量（3年期）\\n    ,a.contract_time_4_num_day        --录入合同数量（4年期）\\n    ,a.contract_time_5_num_day        --录入合同数量（5年期）\\n    ,a.contract_time_surpass_5_num_day --录入合同数量（5年以上）\\n    ,a.refund_amount        --当天请假退费金额\\n    ,a.leave_reducation_fee --当天请假减免费用\\n    ,a.date_time --日期\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom\\n(\\n  select\\n       building_id          --楼栋id\\n      ,max(nursin_homes_id)    as nursin_homes_id     --养老院id\\n      ,max(nursing_homes_name) as nursing_homes_name  --养老院名称\\n      ,max(sub_org_id)         as sub_org_id          --机构id\\n      ,max(sub_org_name)       as sub_org_name        --机构名称\\n      ,max(org_id)             as org_id              --集团id\\n      ,max(org_name)           as org_name            --集团名称\\n      ,max(area_id)            as area_id             --区域id \\n      ,sum(reside_cnt_day)     as reside_cnt_day\\n      ,sum(countermand_cnt_day) as countermand_cnt_day\\n      ,sum(room_num_day)        as room_num_day\\n      ,sum(bed_num_day)         as bed_num_day\\n      ,sum(all_num)               as all_num\\n      ,sum(visit_num_day)         as visit_num_day       \\n      ,sum(visit_time_day)        as visit_time_day      \\n      ,sum(leave_num_day)         as leave_num_day       \\n      ,sum(leave_time_day)        as leave_time_day      \\n      ,sum(sick_leave_num_day)    as sick_leave_num_day  \\n      ,sum(casual_leave_num_day)  as casual_leave_num_day\\n      ,sum(other_leave_num_day)   as other_leave_num_day \\n      ,sum(refund_amount)         as refund_amount\\n      ,sum(leave_reducation_fee)  as leave_reducation_fee\\n      ,sum(contract_time_1_num_day)        as contract_time_1_num_day        --录入合同数量（1年期）\\n      ,sum(contract_time_2_num_day)        as contract_time_2_num_day        --录入合同数量（2年期）\\n      ,sum(contract_time_3_num_day)        as contract_time_3_num_day        --录入合同数量（3年期）\\n      ,sum(contract_time_4_num_day)        as contract_time_4_num_day        --录入合同数量（4年期）\\n      ,sum(contract_time_5_num_day)        as contract_time_5_num_day        --录入合同数量（5年期）\\n      ,sum(contract_time_surpass_5_num_day)as contract_time_surpass_5_num_day--录入合同数量（5年以上）\\n      ,date_time --日期\\n  from db_dw_hr.clife_hr_dws_reside_manage_by_fday\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by building_id\\n          ,date_time\\n)a\\nleft join\\n(\\n  select\\n       building_id\\n      ,count(room_id)  as room_amount \\n      ,sum(bed_amount) as bed_amount\\n  from db_dw_hr.clife_hr_dim_location_room\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by building_id\\n)b on a.building_id=b.building_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"居住管理根据楼栋聚合\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_reside_manage_by_fday\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-44h4du\",\"name\":\"clife_hr_dws_reside_manage_by_nhday\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_reside_manage_by_nhday partition(part_date)\\nselect\\n     a.nursin_homes_id     --养老院id\\n    ,a.nursing_homes_name  --养老院名称\\n    ,a.sub_org_id          --机构id\\n    ,a.sub_org_name        --机构名称\\n    ,a.org_id              --集团id\\n    ,a.org_name            --集团名称\\n    ,a.area_id             --区域id\\n    ,a.reside_cnt_day       --每天入住人数\\n    ,a.countermand_cnt_day  --每日退住人数\\n    ,a.room_num_day         --每日入住房间数\\n    ,a.bed_num_day          --每日入住床位数\\n    ,a.all_num              --每日总人数\\n    ,a.visit_num_day        --每日探访人数\\n    ,a.visit_time_day       --每日探访时长\\n    ,a.leave_num_day        --每日请假次数\\n    ,a.leave_time_day       --每日请假时长\\n    ,a.sick_leave_num_day   --每日病假次数\\n    ,a.casual_leave_num_day --每日事假次数\\n    ,a.other_leave_num_day  --每日其他假次数\\n    ,b.room_amount --楼层房间数\\n    ,b.bed_amount  --楼层床位数\\n    ,coalesce(a.reside_cnt_day/a.all_num,0)      as check_in_rate_day       --每日入住率\\n    ,coalesce(a.countermand_cnt_day/a.all_num,0) as countermand_rate_day    --每日退住率\\n    ,coalesce(a.room_num_day/b.room_amount,0)    as check_in_room_rate_day  --每日房间入住率\\n    ,coalesce((b.room_amount-a.room_num_day)/b.room_amount,0) as vacant_room_rate_day  --房间空房率\\n    ,coalesce(a.bed_num_day/b.bed_amount,0)                   as check_in_bed_rate_day --床位入住率\\n    ,coalesce((b.bed_amount-a.bed_num_day)/b.bed_amount,0)    as vacant_bed_rate_day   --床位空床率\\t\\n    ,a.contract_time_1_num_day        --录入合同数量（1年期）\\n    ,a.contract_time_2_num_day        --录入合同数量（2年期）\\n    ,a.contract_time_3_num_day        --录入合同数量（3年期）\\n    ,a.contract_time_4_num_day        --录入合同数量（4年期）\\n    ,a.contract_time_5_num_day        --录入合同数量（5年期）\\n    ,a.contract_time_surpass_5_num_day --录入合同数量（5年以上）\\n    ,a.refund_amount        --当天请假退费金额\\n    ,a.leave_reducation_fee --当天请假减免费用\\n    ,a.date_time --日期\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom\\n(\\n  select\\n       nursin_homes_id     --养老院id\\n      ,max(nursing_homes_name) as nursing_homes_name  --养老院名称\\n      ,max(sub_org_id)         as sub_org_id          --机构id\\n      ,max(sub_org_name)       as sub_org_name        --机构名称\\n      ,max(org_id)             as org_id              --集团id\\n      ,max(org_name)           as org_name            --集团名称\\n      ,max(area_id)            as area_id             --区域id \\n      ,sum(reside_cnt_day)     as reside_cnt_day\\n      ,sum(countermand_cnt_day) as countermand_cnt_day\\n      ,sum(room_num_day)        as room_num_day\\n      ,sum(bed_num_day)         as bed_num_day\\n      ,sum(all_num)               as all_num\\n      ,sum(visit_num_day)         as visit_num_day       \\n      ,sum(visit_time_day)        as visit_time_day      \\n      ,sum(leave_num_day)         as leave_num_day       \\n      ,sum(leave_time_day)        as leave_time_day      \\n      ,sum(sick_leave_num_day)    as sick_leave_num_day  \\n      ,sum(casual_leave_num_day)  as casual_leave_num_day\\n      ,sum(other_leave_num_day)   as other_leave_num_day \\n      ,sum(refund_amount)         as refund_amount\\n      ,sum(leave_reducation_fee)  as leave_reducation_fee\\n      ,sum(contract_time_1_num_day)        as contract_time_1_num_day        --录入合同数量（1年期）\\n      ,sum(contract_time_2_num_day)        as contract_time_2_num_day        --录入合同数量（2年期）\\n      ,sum(contract_time_3_num_day)        as contract_time_3_num_day        --录入合同数量（3年期）\\n      ,sum(contract_time_4_num_day)        as contract_time_4_num_day        --录入合同数量（4年期）\\n      ,sum(contract_time_5_num_day)        as contract_time_5_num_day        --录入合同数量（5年期）\\n      ,sum(contract_time_surpass_5_num_day)as contract_time_surpass_5_num_day--录入合同数量（5年以上）\\n      ,date_time\\n  from db_dw_hr.clife_hr_dws_reside_manage_by_bday\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by nursin_homes_id\\n          ,date_time\\n)a\\nleft join\\n(\\n  select\\n       nursing_homes_id\\n      ,count(room_id)  as room_amount \\n      ,sum(bed_amount) as bed_amount\\n  from db_dw_hr.clife_hr_dim_location_room\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by nursing_homes_id\\n)b on a.nursin_homes_id=b.nursing_homes_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_reside_manage_by_bday\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-3mi46l\",\"name\":\"clife_hr_dws_recharge_consumption_by_asday\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_recharge_consumption_by_asday partition(part_date)\\nselect\\n     sub_org_id              --机构id\\n    ,account_name            --账户名称\\n    ,sub_org_name            --机构名称\\n    ,org_id                  --集团id\\n    ,org_name                --集团名称\\n    ,account_old_man_cnt     --账户老人数\\n    ,account_member_cnt      --账户会员数\\n    ,check_in_payment_num_day        --每天入住缴费次数\\n    ,check_in_payment_amount_day     --每天入住缴费金额\\n    ,recharge_num_day                --每天账户充值次数\\n    ,recharge_amount_day             --每天账户充值金额\\n    ,member_recharge_num_day         --每天会员充值次数\\n    ,member_recharge_amount_day      --每天会员充值金额\\n    ,consume_num_day                 --每天账户消费次数\\n    ,consume_amount_day              --每天账户消费金额\\n    ,member_consume_num_day          --每天会员消费次数\\n    ,member_consume_amount_day       --每天会员消费金额\\n    ,countermand_amount_day          --每天退住退费金额\\n    ,coalesce(recharge_amount_day/recharge_old_man_cnt,0) as recharge_avg_day --人均充值金额\\n    ,coalesce(member_recharge_amount_day/recharge_member_cnt,0) as member_recharge_avg_day  --会员人均充值金额\\n    ,date_time --日期\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom\\n(\\n  select \\n       b.account_name\\n      ,a.sub_org_id\\n      ,max(a.sub_org_name)       as sub_org_name            --机构名称\\n      ,max(a.org_id)             as org_id                  --集团id\\n      ,max(a.org_name)           as org_name                --集团名称\\n      ,count(distinct a.old_man_id) as account_old_man_cnt  --账户老人数\\n      ,count(distinct a.member_id)  as account_member_cnt   --账户会员数\\n      ,sum(case when a.behavior_type='入住缴费' then 1 else 0 end)      as check_in_payment_num_day      --每天入住缴费次数\\n      ,sum(case when a.behavior_type='入住缴费' then a.amount else 0 end) as check_in_payment_amount_day   --每天入住缴费金额\\n      ,sum(case when a.behavior_type='账户充值' then 1 else 0 end)      as recharge_num_day              --每天账户充值次数\\n      ,sum(case when a.behavior_type='账户充值' then a.amount else 0 end) as recharge_amount_day           --每天账户充值金额\\n      ,count(case when a.behavior_type='账户充值' then a.old_man_id else null end) as recharge_old_man_cnt --每天基础充值老人数\\n      ,sum(case when a.behavior_type='会员充值' then 1 else 0 end)      as member_recharge_num_day       --每天会员充值次数\\n      ,sum(case when a.behavior_type='会员充值' then a.amount else 0 end) as member_recharge_amount_day    --每天会员充值金额\\n      ,count(case when a.behavior_type='会员充值' then a.old_man_id else null end) as recharge_member_cnt  --每天会员充值老人数\\n      ,sum(case when a.behavior_type='账户消费' then 1 else 0 end)      as consume_num_day               --每天账户消费次数\\n      ,sum(case when a.behavior_type='账户消费' then a.amount else 0 end) as consume_amount_day            --每天账户消费金额\\n      ,sum(case when a.behavior_type='会员消费' then 1 else 0 end)      as member_consume_num_day        --每天账户消费次数\\n      ,sum(case when a.behavior_type='会员消费' then a.amount else 0 end) as member_consume_amount_day     --每天会员消费金额\\n      ,sum(case when a.behavior_type='退住退费' then a.amount else 0 end) as countermand_amount_day        --每天退住退费金额\\n      ,substr(a.recharge_consumption_time,1,10) as date_time\\n  from db_dw_hr.clife_hr_dwd_recharge_consumption_info a\\n  left join db_dw_hr.clife_hr_dim_account b on a.account_id = b.account_id and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n  where a.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n  group by b.account_name\\n          ,a.sub_org_id\\n          ,substr(a.recharge_consumption_time,1,10)\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_recharge_consumption_by_anso\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-a81fr\",\"name\":\"clife_hr_dws_reside_manage_by_bmonth\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_reside_manage_by_bmonth partition(part_date)\\nselect\\n     building_id         --楼栋id\\n    ,nursin_homes_id     --养老院id\\n    ,nursing_homes_name  --养老院名称\\n    ,sub_org_id          --机构id\\n    ,sub_org_name        --机构名称\\n    ,org_id              --集团id\\n    ,org_name            --集团名称\\n    ,area_id             --区域id\\n    ,reside_cnt_month        --每月入住人数\\n    ,countermand_cnt_month   --每月退住人数\\n    ,room_num_month          --每月入住房间数\\n    ,bed_num_month           --每月入住床位数\\n    ,all_num_month           --每月总人数\\n    ,visit_num_month         --每月探访人数\\n    ,visit_time_month        --每月探访时长\\n    ,leave_num_month         --每月请假次数\\n    ,leave_time_month      --每月请假时长\\n    ,sick_leave_num_month  --每月病假次数\\n    ,casual_leave_num_month--每月事假次数\\n    ,other_leave_num_month --每月其他假次数\\n    ,room_amount --楼层房间数\\n    ,bed_amount  --楼层床位数\\n    ,coalesce(reside_cnt_month/all_num_month,0)           as check_in_rate_month      --每月入住率\\n    ,coalesce(countermand_cnt_month/all_num_month,0)      as countermand_rate_month   --每月退住率\\n    ,coalesce(room_num_month/room_amount,0)               as check_in_room_rate_month --每月房间入住率\\n    ,coalesce((room_amount-room_num_month)/room_amount,0) as vacant_room_rate_month   --每月房间空房率\\n    ,coalesce(bed_num_month/bed_amount,0)                 as check_in_bed_rate_month  --每月床位入住率\\n    ,coalesce((bed_amount-bed_num_month)/bed_amount,0)    as vacant_bed_rate_month    --每月床位空床率\\t\\n    ,contract_time_1_num_month        --录入合同数量（1年期）\\n    ,contract_time_2_num_month        --录入合同数量（2年期）\\n    ,contract_time_3_num_month        --录入合同数量（3年期）\\n    ,contract_time_4_num_month        --录入合同数量（4年期）\\n    ,contract_time_5_num_month        --录入合同数量（5年期）\\n    ,contract_time_surpass_5_num_month --录入合同数量（5年以上）\\n    ,refund_amount        --当月请假退费金额\\t\\n    ,leave_reducation_fee --当月请假减免费用\\t\\n    ,date_month --月份\\n    ,regexp_replace(date_sub(current_date(),1),'-','')\\nfrom\\n(\\n  select\\n       building_id         --楼栋id\\n      ,max(nursin_homes_id)    as nursin_homes_id     --养老院id\\n      ,max(nursing_homes_name) as nursing_homes_name  --养老院名称\\n      ,max(sub_org_id)         as sub_org_id          --机构id\\n      ,max(sub_org_name)       as sub_org_name        --机构名称\\n      ,max(org_id)             as org_id              --集团id\\n      ,max(org_name)           as org_name            --集团名称\\n      ,max(area_id)            as area_id             --区域id \\n      ,sum(reside_cnt_day)       as reside_cnt_month        --每月入住人数\\n      ,sum(countermand_cnt_day)  as countermand_cnt_month   --每月退住人数\\n      ,sum(room_num_day)         as room_num_month          --每月入住房间数\\n      ,sum(bed_num_day)          as bed_num_month           --每月入住床位数\\n      ,sum(all_num)              as all_num_month           --每月总人数\\n      ,sum(visit_num_day)        as visit_num_month         --每月探访人数\\n      ,sum(visit_time_day)       as visit_time_month        --每月探访时长\\n      ,sum(leave_num_day)        as leave_num_month         --每月请假次数\\n      ,sum(leave_time_day)       as leave_time_month      --每月请假时长\\n      ,sum(sick_leave_num_day)   as sick_leave_num_month  --每月病假次数\\n      ,sum(casual_leave_num_day) as casual_leave_num_month--每月事假次数\\n      ,sum(other_leave_num_day)  as other_leave_num_month --每月其他假次数\\n      ,sum(refund_amount)        as refund_amount        --当月请假退费金额\\n      ,sum(leave_reducation_fee) as leave_reducation_fee --当月请假减免费用\\n      ,max(room_amount) as room_amount --楼层房间数\\n      ,max(bed_amount)  as bed_amount  --楼层床位数\\t\\n      ,sum(contract_time_1_num_day)         as contract_time_1_num_month        --录入合同数量（1年期）\\n      ,sum(contract_time_2_num_day)         as contract_time_2_num_month        --录入合同数量（2年期）\\n      ,sum(contract_time_3_num_day)         as contract_time_3_num_month        --录入合同数量（3年期）\\n      ,sum(contract_time_4_num_day)         as contract_time_4_num_month        --录入合同数量（4年期）\\n      ,sum(contract_time_5_num_day)         as contract_time_5_num_month        --录入合同数量（5年期）\\n      ,sum(contract_time_surpass_5_num_day ) as contract_time_surpass_5_num_month--录入合同数量（5年以上）\\n      ,substr(date_time,1,7) as date_month --月份\\n  from db_dw_hr.clife_hr_dws_reside_manage_by_bday\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by building_id\\n          ,substr(date_time,1,7)\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_reside_manage_by_building\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-7nk24h\",\"name\":\"clife_hr_dws_reside_manage_by_fyear\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_reside_manage_by_fyear partition(part_date)\\nselect\\n     floor_id            --楼层id\\n    ,building_id         --楼栋id\\n    ,nursin_homes_id     --养老院id\\n    ,nursing_homes_name  --养老院名称\\n    ,sub_org_id          --机构id\\n    ,sub_org_name        --机构名称\\n    ,org_id              --集团id\\n    ,org_name            --集团名称\\n    ,area_id             --区域id\\n    ,reside_cnt_year         --每年入住人数\\n    ,countermand_cnt_year    --每年退住人数\\n    ,room_num_year           --每年入住房间数\\n    ,bed_num_year            --每年入住床位数\\n    ,all_num_year            --每年总人数\\n    ,visit_num_year          --每年探访人数\\n    ,visit_time_year         --每年探访时长\\n    ,leave_num_year          --每年请假次数\\n    ,leave_time_year         --每年请假时长\\n    ,sick_leave_num_year     --每年病假次数\\n    ,casual_leave_num_year   --每年事假次数\\n    ,other_leave_num_year    --每年其他假次数\\n    ,room_amount --楼层房间数\\n    ,bed_amount  --楼层床位数\\n    ,coalesce(reside_cnt_year/all_num_year,0)           as check_in_rate_year      --每年入住率\\n    ,coalesce(countermand_cnt_year/all_num_year,0)      as countermand_rate_year   --每年退住率\\n    ,coalesce(room_num_year/room_amount,0)               as check_in_room_rate_year--每年房间入住率\\n    ,coalesce((room_amount-room_num_year)/room_amount,0) as vacant_room_rate_year  --每年房间空房率\\n    ,coalesce(bed_num_year/bed_amount,0)                 as check_in_bed_rate_year --每年床位入住率\\n    ,coalesce((bed_amount-bed_num_year)/bed_amount,0)    as vacant_bed_rate_year   --每年床位空床率\\t\\n    ,contract_time_1_num_year        --录入合同数量（1年期）\\n    ,contract_time_2_num_year        --录入合同数量（2年期）\\n    ,contract_time_3_num_year        --录入合同数量（3年期）\\n    ,contract_time_4_num_year        --录入合同数量（4年期）\\n    ,contract_time_5_num_year        --录入合同数量（5年期）\\n    ,contract_time_surpass_5_num_year --录入合同数量（5年以上）\\n    ,refund_amount        --当年请假退费金额\\t\\n    ,leave_reducation_fee --当年请假减免费用\\n    ,date_year --年份\\n    ,regexp_replace(date_sub(current_date(),1),'-','')\\nfrom\\n(\\n  select\\n       floor_id            --楼层id\\n      ,max(building_id)        as building_id         --楼栋id\\n      ,max(nursin_homes_id)    as nursin_homes_id     --养老院id\\n      ,max(nursing_homes_name) as nursing_homes_name  --养老院名称\\n      ,max(sub_org_id)         as sub_org_id          --机构id\\n      ,max(sub_org_name)       as sub_org_name        --机构名称\\n      ,max(org_id)             as org_id              --集团id\\n      ,max(org_name)           as org_name            --集团名称\\n      ,max(area_id)            as area_id             --区域id \\n      ,sum(reside_cnt_month)       as reside_cnt_year         --每年入住人数\\n      ,sum(countermand_cnt_month)  as countermand_cnt_year    --每年退住人数\\n      ,sum(room_num_month)         as room_num_year           --每年入住房间数\\n      ,sum(bed_num_month)          as bed_num_year            --每年入住床位数\\n      ,sum(all_num_month)          as all_num_year            --每年总人数\\n      ,sum(visit_num_month)        as visit_num_year          --每年探访人数\\n      ,sum(visit_time_month)       as visit_time_year         --每年探访时长\\n      ,sum(leave_num_month)        as leave_num_year          --每年请假次数\\n      ,sum(leave_time_month)       as leave_time_year         --每年请假时长\\n      ,sum(sick_leave_num_month)   as sick_leave_num_year     --每年病假次数\\n      ,sum(casual_leave_num_month) as casual_leave_num_year   --每年事假次数\\n      ,sum(other_leave_num_month)  as other_leave_num_year    --每年其他假次数\\n      ,sum(refund_amount)        as refund_amount        --当年请假退费金额\\n      ,sum(leave_reducation_fee) as leave_reducation_fee --当年请假减免费用\\n      ,max(room_amount) as room_amount --楼层房间数\\n      ,max(bed_amount)  as bed_amount  --楼层床位数\\t\\n      ,sum(contract_time_1_num_month)         contract_time_1_num_year        --录入合同数量（1年期）\\n      ,sum(contract_time_2_num_month)         contract_time_2_num_year        --录入合同数量（2年期）\\n      ,sum(contract_time_3_num_month)         contract_time_3_num_year        --录入合同数量（3年期）\\n      ,sum(contract_time_4_num_month)         contract_time_4_num_year        --录入合同数量（4年期）\\n      ,sum(contract_time_5_num_month)         contract_time_5_num_year        --录入合同数量（5年期）\\n      ,sum(contract_time_surpass_5_num_month) contract_time_surpass_5_num_year--录入合同数量（5年以上）\\n      ,substr(date_month,1,4) as date_year --年份\\n  from db_dw_hr.clife_hr_dws_reside_manage_by_fmonth\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by floor_id\\n          ,substr(date_month,1,4)\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_reside_manage_by_fmonth\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-4453y2\",\"name\":\"clife_hr_dws_reside_manage_by_fmonth\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_reside_manage_by_fmonth partition(part_date)\\nselect\\n     floor_id            --楼层id\\n    ,building_id         --楼栋id\\n    ,nursin_homes_id     --养老院id\\n    ,nursing_homes_name  --养老院名称\\n    ,sub_org_id          --机构id\\n    ,sub_org_name        --机构名称\\n    ,org_id              --集团id\\n    ,org_name            --集团名称\\n    ,area_id             --区域id\\n    ,reside_cnt_month        --每月入住人数\\n    ,countermand_cnt_month   --每月退住人数\\n    ,room_num_month          --每月入住房间数\\n    ,bed_num_month           --每月入住床位数\\n    ,all_num_month           --每月总人数\\n    ,visit_num_month         --每月探访人数\\n    ,visit_time_month        --每月探访时长\\n    ,leave_num_month         --每月请假次数\\n    ,leave_time_month      --每月请假时长\\n    ,sick_leave_num_month  --每月病假次数\\n    ,casual_leave_num_month--每月事假次数\\n    ,other_leave_num_month --每月其他假次数\\n    ,room_amount --楼层房间数\\n    ,bed_amount  --楼层床位数\\n    ,coalesce(reside_cnt_month/all_num_month,0)           as check_in_rate_month      --每月入住率\\n    ,coalesce(countermand_cnt_month/all_num_month,0)      as countermand_rate_month   --每月退住率\\n    ,coalesce(room_num_month/room_amount,0)               as check_in_room_rate_month --每月房间入住率\\n    ,coalesce((room_amount-room_num_month)/room_amount,0) as vacant_room_rate_month   --每月房间空房率\\n    ,coalesce(bed_num_month/bed_amount,0)                 as check_in_bed_rate_month  --每月床位入住率\\n    ,coalesce((bed_amount-bed_num_month)/bed_amount,0)    as vacant_bed_rate_month    --每月床位空床率\\t\\n    ,contract_time_1_num_month        --录入合同数量（1年期）\\n    ,contract_time_2_num_month        --录入合同数量（2年期）\\n    ,contract_time_3_num_month        --录入合同数量（3年期）\\n    ,contract_time_4_num_month        --录入合同数量（4年期）\\n    ,contract_time_5_num_month        --录入合同数量（5年期）\\n    ,contract_time_surpass_5_num_month --录入合同数量（5年以上）\\n    ,refund_amount        --当月请假退费金额\\t\\n    ,leave_reducation_fee --当月请假减免费用\\t\\n    ,date_month --月份\\n    ,regexp_replace(date_sub(current_date(),1),'-','')\\nfrom\\n(\\n  select\\n       floor_id            --楼层id\\n      ,max(building_id)        as building_id         --楼栋id\\n      ,max(nursin_homes_id)    as nursin_homes_id     --养老院id\\n      ,max(nursing_homes_name) as nursing_homes_name  --养老院名称\\n      ,max(sub_org_id)         as sub_org_id          --机构id\\n      ,max(sub_org_name)       as sub_org_name        --机构名称\\n      ,max(org_id)             as org_id              --集团id\\n      ,max(org_name)           as org_name            --集团名称\\n      ,max(area_id)            as area_id             --区域id \\n      ,sum(reside_cnt_day)       as reside_cnt_month        --每月入住人数\\n      ,sum(countermand_cnt_day)  as countermand_cnt_month   --每月退住人数\\n      ,sum(room_num_day)         as room_num_month          --每月入住房间数\\n      ,sum(bed_num_day)          as bed_num_month           --每月入住床位数\\n      ,sum(all_num)              as all_num_month           --每月总人数\\n      ,sum(visit_num_day)        as visit_num_month         --每月探访人数\\n      ,sum(visit_time_day)       as visit_time_month        --每月探访时长\\n      ,sum(leave_num_day)        as leave_num_month         --每月请假次数\\n      ,sum(leave_time_day)       as leave_time_month      --每月请假时长\\n      ,sum(sick_leave_num_day)   as sick_leave_num_month  --每月病假次数\\n      ,sum(casual_leave_num_day) as casual_leave_num_month--每月事假次数\\n      ,sum(other_leave_num_day)  as other_leave_num_month --每月其他假次数\\n      ,sum(refund_amount)        as refund_amount        --当月请假退费金额\\n      ,sum(leave_reducation_fee) as leave_reducation_fee --当月请假减免费用\\n      ,max(room_amount) as room_amount --楼层房间数\\n      ,max(bed_amount)  as bed_amount  --楼层床位数\\t\\n      ,sum(contract_time_1_num_day)         as contract_time_1_num_month       --录入合同数量（1年期）\\n      ,sum(contract_time_2_num_day)         as contract_time_2_num_month       --录入合同数量（2年期）\\n      ,sum(contract_time_3_num_day)         as contract_time_3_num_month       --录入合同数量（3年期）\\n      ,sum(contract_time_4_num_day)         as contract_time_4_num_month       --录入合同数量（4年期）\\n      ,sum(contract_time_5_num_day)         as contract_time_5_num_month       --录入合同数量（5年期）\\n      ,sum(contract_time_surpass_5_num_day) as contract_time_surpass_5_num_month--录入合同数量（5年以上）\\n      ,substr(date_time,1,7) as date_month --月份\\n  from db_dw_hr.clife_hr_dws_reside_manage_by_fday\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by floor_id\\n          ,substr(date_time,1,7)\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_reside_manage_by_floor\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-cj3p9\",\"name\":\"clife_hr_dws_reside_manage_by_building\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_reside_manage_by_building partition(part_date)\\nselect\\n     t.building_id         --楼栋id\\n    ,t.nursin_homes_id     --养老院id\\n    ,t.nursing_homes_name  --养老院名称\\n    ,t.sub_org_id          --机构id\\n    ,t.sub_org_name        --机构名称\\n    ,t.org_id              --集团id\\n    ,t.org_name            --集团名称\\n    ,t.area_id             --区域id\\n    ,t.check_in_num        --入住人数\\n    ,t.countermand_num     --退住人数\\n    ,coalesce(t.check_in_num/t.all_num,0) as  check_in_rate       --入住率\\n    ,coalesce(t.countermand_num/t.all_num,0) as countermand_rate  --退住率\\n    ,t.room_num       --入住房间数\\n    ,t3.room_amount    --楼层房间数\\n    ,coalesce(t.room_num/t3.room_amount,0) as check_in_room_rate               --房间入住率\\n    ,coalesce((t3.room_amount-t.room_num)/t3.room_amount,0) as vacant_room_rate --房间空房率\\n    ,t.bed_num       --入住床位数\\n    ,t3.bed_amount    --楼层床位数\\n    ,coalesce(t.bed_num/t3.bed_amount,0) as check_in_bed_rate              --床位入住率\\n    ,coalesce((t3.bed_amount-t.bed_num)/t3.bed_amount,0) as vacant_bed_rate --床位空床率\\n    ,t.relatives_num --探访人数\\n    ,t.visit_time   --探访时长\\n    ,t.contract_time_1_num        --录入合同数量（1年期）\\n    ,t.contract_time_2_num        --录入合同数量（2年期）\\n    ,t.contract_time_3_num        --录入合同数量（3年期）\\n    ,t.contract_time_4_num        --录入合同数量（4年期）\\n    ,t.contract_time_5_num        --录入合同数量（5年期）\\n    ,t.contract_time_surpass_5_num --录入合同数量（5年以上）\\n    ,t.leave_num        --请假次数\\n    ,t.leave_time       --请假时长\\n    ,t.sick_leave_num   --病假次数\\n    ,t.casual_leave_num --事假次数\\n    ,t.other_leave_num  --其他假次数\\n    ,t.all_num          --总人数\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom\\n(\\n  select\\n       building_id         --楼栋id\\n      ,max(nursin_homes_id)    as nursin_homes_id     --养老院id\\n      ,max(nursing_homes_name) as nursing_homes_name  --养老院名称\\n      ,max(sub_org_id)         as sub_org_id          --机构id\\n      ,max(sub_org_name)       as sub_org_name        --机构名称\\n      ,max(org_id)             as org_id              --集团id\\n      ,max(org_name)           as org_name            --集团名称\\n      ,max(area_id)            as  area_id            --区域id\\n      ,sum(all_num)           as all_num             --所有人数\\n      ,sum(check_in_num) as check_in_num    --入住人数\\n      ,sum(countermand_num) as countermand_num --退住人数\\n      ,sum(relatives_num) as relatives_num --探访人数\\n      ,sum(contract_time_1_num) as contract_time_1_num        --录入合同数量（1年期）\\n      ,sum(contract_time_2_num) as contract_time_2_num        --录入合同数量（2年期）\\n      ,sum(contract_time_3_num) as contract_time_3_num        --录入合同数量（3年期）\\n      ,sum(contract_time_4_num) as contract_time_4_num        --录入合同数量（4年期）\\n      ,sum(contract_time_5_num) as contract_time_5_num        --录入合同数量（5年期）\\n      ,sum(contract_time_surpass_5_num) as contract_time_surpass_5_num --录入合同数量（5年以上）\\n      ,sum(leave_num)        as leave_num --请假次数\\n      ,sum(leave_time)       as leave_time --请假时长\\n      ,sum(sick_leave_num)   as sick_leave_num     --病假次数\\n      ,sum(casual_leave_num) as casual_leave_num --事假次数\\n      ,sum(other_leave_num)  as other_leave_num   --其他假次数\\n      ,sum(visit_time)  as visit_time   --探访时长\\n      ,sum(room_num)    as room_num   --入住房间数\\n      ,sum(bed_num)  as bed_num   --入住床位数\\n  from db_dw_hr.clife_hr_dws_reside_manage_by_floor\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by building_id\\n)t \\nleft join\\n(\\n  select\\n       building_id\\n      ,count(room_id)  as room_amount \\n      ,sum(bed_amount) as bed_amount\\n  from db_dw_hr.clife_hr_dim_location_room\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by building_id\\n)t3 on t.building_id=t3.building_id\",\"udfs\":\"13\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_reside_manage_by_fyear\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-3fl5hk\",\"name\":\"clife_hr_dws_reside_manage_by_soyear\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_reside_manage_by_soyear partition(part_date)\\nselect\\n     sub_org_id          --机构id\\n    ,sub_org_name        --机构名称\\n    ,org_id              --集团id\\n    ,org_name            --集团名称\\n    ,area_id             --区域id\\n    ,reside_cnt_year         --每年入住人数\\n    ,countermand_cnt_year    --每年退住人数\\n    ,room_num_year           --每年入住房间数\\n    ,bed_num_year            --每年入住床位数\\n    ,all_num_year            --每年总人数\\n    ,visit_num_year          --每年探访人数\\n    ,visit_time_year         --每年探访时长\\n    ,leave_num_year          --每年请假次数\\n    ,leave_time_year         --每年请假时长\\n    ,sick_leave_num_year     --每年病假次数\\n    ,casual_leave_num_year   --每年事假次数\\n    ,other_leave_num_year    --每年其他假次数\\n    ,room_amount --楼层房间数\\n    ,bed_amount  --楼层床位数\\n    ,coalesce(reside_cnt_year/all_num_year,0)           as check_in_rate_year      --每年入住率\\n    ,coalesce(countermand_cnt_year/all_num_year,0)      as countermand_rate_year   --每年退住率\\n    ,coalesce(room_num_year/room_amount,0)               as check_in_room_rate_year--每年房间入住率\\n    ,coalesce((room_amount-room_num_year)/room_amount,0) as vacant_room_rate_year  --每年房间空房率\\n    ,coalesce(bed_num_year/bed_amount,0)                 as check_in_bed_rate_year --每年床位入住率\\n    ,coalesce((bed_amount-bed_num_year)/bed_amount,0)    as vacant_bed_rate_year   --每年床位空床率\\t\\n    ,contract_time_1_num_year        --录入合同数量（1年期）\\n    ,contract_time_2_num_year        --录入合同数量（2年期）\\n    ,contract_time_3_num_year        --录入合同数量（3年期）\\n    ,contract_time_4_num_year        --录入合同数量（4年期）\\n    ,contract_time_5_num_year        --录入合同数量（5年期）\\n    ,contract_time_surpass_5_num_year --录入合同数量（5年以上）\\n    ,refund_amount        --当年请假退费金额\\t\\n    ,leave_reducation_fee --当年请假减免费用\\n    ,date_year --年份\\n    ,regexp_replace(date_sub(current_date(),1),'-','')\\nfrom\\n(\\n  select\\n       sub_org_id          --机构id\\n      ,max(sub_org_name)       as sub_org_name        --机构名称\\n      ,max(org_id)             as org_id              --集团id\\n      ,max(org_name)           as org_name            --集团名称\\n      ,max(area_id)            as area_id             --区域id \\n      ,sum(reside_cnt_month)       as reside_cnt_year         --每年入住人数\\n      ,sum(countermand_cnt_month)  as countermand_cnt_year    --每年退住人数\\n      ,sum(room_num_month)         as room_num_year           --每年入住房间数\\n      ,sum(bed_num_month)          as bed_num_year            --每年入住床位数\\n      ,sum(all_num_month)          as all_num_year            --每年总人数\\n      ,sum(visit_num_month)        as visit_num_year          --每年探访人数\\n      ,sum(visit_time_month)       as visit_time_year         --每年探访时长\\n      ,sum(leave_num_month)        as leave_num_year          --每年请假次数\\n      ,sum(leave_time_month)       as leave_time_year         --每年请假时长\\n      ,sum(sick_leave_num_month)   as sick_leave_num_year     --每年病假次数\\n      ,sum(casual_leave_num_month) as casual_leave_num_year   --每年事假次数\\n      ,sum(other_leave_num_month)  as other_leave_num_year    --每年其他假次数\\n      ,sum(refund_amount)        as refund_amount        --当年请假退费金额\\n      ,sum(leave_reducation_fee) as leave_reducation_fee --当年请假减免费用\\n      ,max(room_amount) as room_amount --楼层房间数\\n      ,max(bed_amount)  as bed_amount  --楼层床位数\\t\\n      ,sum(contract_time_1_num_month)         contract_time_1_num_year        --录入合同数量（1年期）\\n      ,sum(contract_time_2_num_month)         contract_time_2_num_year        --录入合同数量（2年期）\\n      ,sum(contract_time_3_num_month)         contract_time_3_num_year        --录入合同数量（3年期）\\n      ,sum(contract_time_4_num_month)         contract_time_4_num_year        --录入合同数量（4年期）\\n      ,sum(contract_time_5_num_month)         contract_time_5_num_year        --录入合同数量（5年期）\\n      ,sum(contract_time_surpass_5_num_month) contract_time_surpass_5_num_year--录入合同数量（5年以上）\\n      ,substr(date_month,1,4) as date_year --年份\\n  from db_dw_hr.clife_hr_dws_reside_manage_by_somonth\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by sub_org_id\\n          ,substr(date_month,1,4)\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_reside_manage_by_somonth\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-7om5z8\",\"name\":\"clife_hr_dws_reside_manage_by_suborg\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_reside_manage_by_suborg partition(part_date)\\nselect\\n     t.sub_org_id          --机构id\\n    ,t.sub_org_name        --机构名称\\n    ,t.org_id              --集团id\\n    ,t.org_name            --集团名称\\n    ,t.area_id             --区域id\\n    ,t.check_in_num        --入住人数\\n    ,t.countermand_num     --退住人数\\n    ,coalesce(t.check_in_num/t.all_num,0) as  check_in_rate       --入住率\\n    ,coalesce(t.countermand_num/t.all_num,0) as countermand_rate  --退住率\\n    ,t.room_num       --入住房间数\\n    ,t3.room_amount    --楼层房间数\\n    ,coalesce(t.room_num/t3.room_amount,0) as check_in_room_rate               --房间入住率\\n    ,coalesce((t3.room_amount-t.room_num)/t3.room_amount,0) as vacant_room_rate --房间空房率\\n    ,t.bed_num       --入住床位数\\n    ,t3.bed_amount    --楼层床位数\\n    ,coalesce(t.bed_num/t3.bed_amount,0) as check_in_bed_rate              --床位入住率\\n    ,coalesce((t3.bed_amount-t.bed_num)/t3.bed_amount,0) as vacant_bed_rate --床位空床率\\n    ,t.relatives_num --探访人数\\n    ,t.visit_time   --探访时长\\n    ,t.contract_time_1_num        --录入合同数量（1年期）\\n    ,t.contract_time_2_num        --录入合同数量（2年期）\\n    ,t.contract_time_3_num        --录入合同数量（3年期）\\n    ,t.contract_time_4_num        --录入合同数量（4年期）\\n    ,t.contract_time_5_num        --录入合同数量（5年期）\\n    ,t.contract_time_surpass_5_num --录入合同数量（5年以上）\\n    ,t.leave_num        --请假次数\\n    ,t.leave_time       --请假时长\\n    ,t.sick_leave_num   --病假次数\\n    ,t.casual_leave_num --事假次数\\n    ,t.other_leave_num  --其他假次数\\n    ,t.all_num          --总人数\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom\\n(\\n   select\\n       sub_org_id          --机构id\\n      ,max(sub_org_name)       as sub_org_name        --机构名称\\n      ,max(org_id)             as org_id              --集团id\\n      ,max(org_name)           as org_name            --集团名称\\n      ,max(area_id)            as  area_id            --区域id\\n      ,sum(all_num)           as all_num             --所有人数\\n      ,sum(check_in_num)    as check_in_num    --入住人数\\n      ,sum(countermand_num) as countermand_num --退住人数\\n      ,sum(relatives_num) as relatives_num --探访人数\\n      ,sum(contract_time_1_num) as contract_time_1_num        --录入合同数量（1年期）\\n      ,sum(contract_time_2_num) as contract_time_2_num        --录入合同数量（2年期）\\n      ,sum(contract_time_3_num) as contract_time_3_num        --录入合同数量（3年期）\\n      ,sum(contract_time_4_num) as contract_time_4_num        --录入合同数量（4年期）\\n      ,sum(contract_time_5_num) as contract_time_5_num        --录入合同数量（5年期）\\n      ,sum(contract_time_surpass_5_num) as contract_time_surpass_5_num --录入合同数量（5年以上）\\n      ,sum(leave_num)        as leave_num --请假次数\\n      ,sum(leave_time)       as leave_time --请假时长\\n      ,sum(sick_leave_num)   as sick_leave_num     --病假次数\\n      ,sum(casual_leave_num) as casual_leave_num --事假次数\\n      ,sum(other_leave_num)  as other_leave_num   --其他假次数\\n      ,sum(visit_time)  as visit_time   --探访时长\\n      ,sum(room_num)    as room_num   --入住房间数\\n      ,sum(bed_num)     as bed_num   --入住床位数\\n  from db_dw_hr.clife_hr_dws_reside_manage_by_nhome\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by sub_org_id\\n)t \\nleft join\\n(\\n  select\\n       b.sub_org_id\\n      ,count(a.room_id)  as room_amount \\n      ,sum(a.bed_amount) as bed_amount\\n  from db_dw_hr.clife_hr_dim_location_room a\\n  left join db_dw_hr.clife_hr_dim_nursing_home b on a.nursing_homes_id = b.nursing_homes_id and b.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by b.sub_org_id\\n)t3 on t.sub_org_id=t3.sub_org_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_reside_manage_by_nhyear\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-58u1ai\",\"name\":\"clife_hr_dws_reside_manage_by_byear\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_reside_manage_by_byear partition(part_date)\\nselect\\n     building_id         --楼栋id\\n    ,nursin_homes_id     --养老院id\\n    ,nursing_homes_name  --养老院名称\\n    ,sub_org_id          --机构id\\n    ,sub_org_name        --机构名称\\n    ,org_id              --集团id\\n    ,org_name            --集团名称\\n    ,area_id             --区域id\\n    ,reside_cnt_year         --每年入住人数\\n    ,countermand_cnt_year    --每年退住人数\\n    ,room_num_year           --每年入住房间数\\n    ,bed_num_year            --每年入住床位数\\n    ,all_num_year            --每年总人数\\n    ,visit_num_year          --每年探访人数\\n    ,visit_time_year         --每年探访时长\\n    ,leave_num_year          --每年请假次数\\n    ,leave_time_year         --每年请假时长\\n    ,sick_leave_num_year     --每年病假次数\\n    ,casual_leave_num_year   --每年事假次数\\n    ,other_leave_num_year    --每年其他假次数\\n    ,room_amount --楼层房间数\\n    ,bed_amount  --楼层床位数\\n    ,coalesce(reside_cnt_year/all_num_year,0)           as check_in_rate_year      --每年入住率\\n    ,coalesce(countermand_cnt_year/all_num_year,0)      as countermand_rate_year   --每年退住率\\n    ,coalesce(room_num_year/room_amount,0)               as check_in_room_rate_year--每年房间入住率\\n    ,coalesce((room_amount-room_num_year)/room_amount,0) as vacant_room_rate_year  --每年房间空房率\\n    ,coalesce(bed_num_year/bed_amount,0)                 as check_in_bed_rate_year --每年床位入住率\\n    ,coalesce((bed_amount-bed_num_year)/bed_amount,0)    as vacant_bed_rate_year   --每年床位空床率\\t\\n    ,contract_time_1_num_year        --录入合同数量（1年期）\\n    ,contract_time_2_num_year        --录入合同数量（2年期）\\n    ,contract_time_3_num_year        --录入合同数量（3年期）\\n    ,contract_time_4_num_year        --录入合同数量（4年期）\\n    ,contract_time_5_num_year        --录入合同数量（5年期）\\n    ,contract_time_surpass_5_num_year --录入合同数量（5年以上）\\n    ,refund_amount        --当年请假退费金额\\t\\n    ,leave_reducation_fee --当年请假减免费用\\n    ,date_year --年份\\n    ,regexp_replace(date_sub(current_date(),1),'-','')\\nfrom\\n(\\n  select\\n       building_id         --楼栋id\\n      ,max(nursin_homes_id)    as nursin_homes_id     --养老院id\\n      ,max(nursing_homes_name) as nursing_homes_name  --养老院名称\\n      ,max(sub_org_id)         as sub_org_id          --机构id\\n      ,max(sub_org_name)       as sub_org_name        --机构名称\\n      ,max(org_id)             as org_id              --集团id\\n      ,max(org_name)           as org_name            --集团名称\\n      ,max(area_id)            as area_id             --区域id \\n      ,sum(reside_cnt_month)       as reside_cnt_year         --每年入住人数\\n      ,sum(countermand_cnt_month)  as countermand_cnt_year    --每年退住人数\\n      ,sum(room_num_month)         as room_num_year           --每年入住房间数\\n      ,sum(bed_num_month)          as bed_num_year            --每年入住床位数\\n      ,sum(all_num_month)          as all_num_year            --每年总人数\\n      ,sum(visit_num_month)        as visit_num_year          --每年探访人数\\n      ,sum(visit_time_month)       as visit_time_year         --每年探访时长\\n      ,sum(leave_num_month)        as leave_num_year          --每年请假次数\\n      ,sum(leave_time_month)       as leave_time_year         --每年请假时长\\n      ,sum(sick_leave_num_month)   as sick_leave_num_year     --每年病假次数\\n      ,sum(casual_leave_num_month) as casual_leave_num_year   --每年事假次数\\n      ,sum(other_leave_num_month)  as other_leave_num_year    --每年其他假次数\\n      ,sum(refund_amount)        as refund_amount        --当年请假退费金额\\n      ,sum(leave_reducation_fee) as leave_reducation_fee --当年请假减免费用\\n      ,max(room_amount) as room_amount --楼层房间数\\n      ,max(bed_amount)  as bed_amount  --楼层床位数\\t\\n      ,sum(contract_time_1_num_month)          as contract_time_1_num_year        \\n      ,sum(contract_time_2_num_month)          as contract_time_2_num_year        \\n      ,sum(contract_time_3_num_month)          as contract_time_3_num_year        \\n      ,sum(contract_time_4_num_month)          as contract_time_4_num_year        \\n      ,sum(contract_time_5_num_month)          as contract_time_5_num_year        \\n      ,sum(contract_time_surpass_5_num_month)  as contract_time_surpass_5_num_year\\n      ,substr(date_month,1,4) as date_year --年份\\n  from db_dw_hr.clife_hr_dws_reside_manage_by_bmonth\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by building_id\\n          ,substr(date_month,1,4)\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_reside_manage_by_bmonth\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-2fa6v\",\"name\":\"clife_hr_dws_reside_manage_by_nhome\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_reside_manage_by_nhome partition(part_date)\\nselect\\n     t.nursin_homes_id     --养老院id\\n    ,t.nursing_homes_name  --养老院名称\\n    ,t.sub_org_id          --机构id\\n    ,t.sub_org_name        --机构名称\\n    ,t.org_id              --集团id\\n    ,t.org_name            --集团名称\\n    ,t.area_id             --区域id\\n    ,t.check_in_num        --入住人数\\n    ,t.countermand_num     --退住人数\\n    ,coalesce(t.check_in_num/t.all_num,0) as  check_in_rate       --入住率\\n    ,coalesce(t.countermand_num/t.all_num,0) as countermand_rate  --退住率\\n    ,t.room_num       --入住房间数\\n    ,t3.room_amount    --楼层房间数\\n    ,coalesce(t.room_num/t3.room_amount,0) as check_in_room_rate               --房间入住率\\n    ,coalesce((t3.room_amount-t.room_num)/t3.room_amount,0) as vacant_room_rate --房间空房率\\n    ,t.bed_num       --入住床位数\\n    ,t3.bed_amount    --楼层床位数\\n    ,coalesce(t.bed_num/t3.bed_amount,0) as check_in_bed_rate              --床位入住率\\n    ,coalesce((t3.bed_amount-t.bed_num)/t3.bed_amount,0) as vacant_bed_rate --床位空床率\\n    ,t.relatives_num --探访人数\\n    ,t.visit_time   --探访时长\\n    ,t.contract_time_1_num        --录入合同数量（1年期）\\n    ,t.contract_time_2_num        --录入合同数量（2年期）\\n    ,t.contract_time_3_num        --录入合同数量（3年期）\\n    ,t.contract_time_4_num        --录入合同数量（4年期）\\n    ,t.contract_time_5_num        --录入合同数量（5年期）\\n    ,t.contract_time_surpass_5_num --录入合同数量（5年以上）\\n    ,t.leave_num        --请假次数\\n    ,t.leave_time       --请假时长\\n    ,t.sick_leave_num   --病假次数\\n    ,t.casual_leave_num --事假次数\\n    ,t.other_leave_num  --其他假次数\\n    ,t.all_num          --总人数\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom\\n(\\n   select\\n       nursin_homes_id     --养老院id\\n      ,max(nursing_homes_name) as nursing_homes_name  --养老院名称\\n      ,max(sub_org_id)         as sub_org_id          --机构id\\n      ,max(sub_org_name)       as sub_org_name        --机构名称\\n      ,max(org_id)             as org_id              --集团id\\n      ,max(org_name)           as org_name            --集团名称\\n      ,max(area_id)            as  area_id            --区域id\\n      ,sum(all_num)           as all_num             --所有人数\\n      ,sum(check_in_num)    as check_in_num    --入住人数\\n      ,sum(countermand_num) as countermand_num --退住人数\\n      ,sum(relatives_num) as relatives_num --探访人数\\n      ,sum(contract_time_1_num) as contract_time_1_num        --录入合同数量（1年期）\\n      ,sum(contract_time_2_num) as contract_time_2_num        --录入合同数量（2年期）\\n      ,sum(contract_time_3_num) as contract_time_3_num        --录入合同数量（3年期）\\n      ,sum(contract_time_4_num) as contract_time_4_num        --录入合同数量（4年期）\\n      ,sum(contract_time_5_num) as contract_time_5_num        --录入合同数量（5年期）\\n      ,sum(contract_time_surpass_5_num) as contract_time_surpass_5_num --录入合同数量（5年以上）\\n      ,sum(leave_num)        as leave_num --请假次数\\n      ,sum(leave_time)       as leave_time --请假时长\\n      ,sum(sick_leave_num)   as sick_leave_num     --病假次数\\n      ,sum(casual_leave_num) as casual_leave_num --事假次数\\n      ,sum(other_leave_num)  as other_leave_num   --其他假次数\\n      ,sum(visit_time)  as visit_time   --探访时长\\n      ,sum(room_num)    as room_num   --入住房间数\\n      ,sum(bed_num)     as bed_num   --入住床位数\\n  from db_dw_hr.clife_hr_dws_reside_manage_by_building\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by nursin_homes_id\\n)t \\nleft join\\n(\\n  select\\n       nursing_homes_id\\n      ,count(room_id)  as room_amount \\n      ,sum(bed_amount) as bed_amount\\n  from db_dw_hr.clife_hr_dim_location_room\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by nursing_homes_id\\n)t3 on t.nursin_homes_id=t3.nursing_homes_id\",\"udfs\":\"13\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_reside_manage_by_byear\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-4myps\",\"name\":\"clife_hr_dws_recharge_consumption_by_ityear\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_recharge_consumption_by_ityear partition(part_date)\\nselect\\n     fee_iteam_id\\n    ,sub_org_id\\n    ,sub_org_name                  --机构名称\\n    ,org_id                        --集团id\\n    ,org_name                      --集团名称\\n    ,fee_iteam_name                --费用项目名称\\n    ,fee_type_id                   --费用类型id\\n    ,fee_type_name                 --费用类型名称\\n    ,iteam_old_man_cnt_year      --账户老人数\\n    ,iteam_member_cnt_year       --账户会员数\\n    ,consume_amount_year         --每年账户消费金额\\n    ,consume_num_year            --每年账户消费次数\\n    ,member_consume_amount_year  --每年会员消费金额\\n    ,member_consume_num_year     --每年会员消费次数\\n    ,coalesce(consume_amount_year/iteam_old_man_cnt_year,0)       as consume_avg_year         --人均消费金额\\n    ,coalesce(consume_num_year/iteam_old_man_cnt_year,0)          as consume_cnt_avg_year  --人均消费次数\\n    ,coalesce(member_consume_amount_year/iteam_member_cnt_year,0) as member_consume_avg_year         --会员人均消费金额\\n    ,coalesce(member_consume_num_year/iteam_member_cnt_year,0)    as member_consume_cnt_avg_year  --会员人均消费次数\\n    ,date_year                     --年份\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom\\n(\\n  select\\n       fee_iteam_id\\n      ,sub_org_id\\n      ,max(sub_org_name)              as sub_org_name                 --机构名称\\n      ,max(org_id)                    as org_id                       --集团id\\n      ,max(org_name)                  as org_name                     --集团名称\\n      ,max(fee_iteam_name)            as fee_iteam_name               --费用项目名称\\n      ,max(fee_type_id)               as fee_type_id                  --费用类型id\\n      ,max(fee_type_name)             as fee_type_name                --费用类型名称\\n      ,sum(iteam_old_man_cnt_month)     as iteam_old_man_cnt_year      --账户老人数\\n      ,sum(iteam_member_cnt_month)      as iteam_member_cnt_year       --账户会员数\\n      ,sum(consume_amount_month)        as consume_amount_year         --每年账户消费金额\\n      ,sum(consume_num_month)           as consume_num_year            --每年账户消费次数\\n      ,sum(member_consume_amount_month) as member_consume_amount_year  --每年会员消费金额\\n      ,sum(member_consume_num_month)    as member_consume_num_year     --每年会员消费次数\\n      ,substr(date_month,1,4)           as date_year           --年份\\n  from db_dw_hr.clife_hr_dws_recharge_consumption_by_itmonth\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by fee_iteam_id\\n          ,sub_org_id\\n          ,substr(date_month,1,4)\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_recharge_consumption_by_itmonth\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-5cz12b\",\"name\":\"clife_hr_dws_recharge_consumption_by_itmonth\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_recharge_consumption_by_itmonth partition(part_date)\\nselect\\n     fee_iteam_id\\n    ,sub_org_id\\n    ,sub_org_name                  --机构名称\\n    ,org_id                        --集团id\\n    ,org_name                      --集团名称\\n    ,fee_iteam_name                --费用项目名称\\n    ,fee_type_id                   --费用类型id\\n    ,fee_type_name                 --费用类型名称\\n    ,iteam_old_man_cnt_month      --账户老人数\\n    ,iteam_member_cnt_month       --账户会员数\\n    ,consume_amount_month         --每月账户消费金额\\n    ,consume_num_month            --每月账户消费次数\\n    ,member_consume_amount_month  --每月会员消费金额\\n    ,member_consume_num_month     --每月会员消费次数\\n    ,coalesce(consume_amount_month/iteam_old_man_cnt_month,0)       as consume_avg_month         --人均消费金额\\n    ,coalesce(consume_num_month/iteam_old_man_cnt_month,0)          as consume_cnt_avg_month  --人均消费次数\\n    ,coalesce(member_consume_amount_month/iteam_member_cnt_month,0) as member_consume_avg_month         --会员人均消费金额\\n    ,coalesce(member_consume_num_month/iteam_member_cnt_month,0)    as member_consume_cnt_avg_month  --会员人均消费次数\\n    ,date_month                     --月份\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom\\n(\\n  select\\n       fee_iteam_id\\n      ,sub_org_id\\n      ,max(sub_org_name)              as sub_org_name                 --机构名称\\n      ,max(org_id)                    as org_id                       --集团id\\n      ,max(org_name)                  as org_name                     --集团名称\\n      ,max(fee_iteam_name)            as fee_iteam_name               --费用项目名称\\n      ,max(fee_type_id)               as fee_type_id                  --费用类型id\\n      ,max(fee_type_name)             as fee_type_name                --费用类型名称\\n      ,sum(iteam_old_man_cnt)         as iteam_old_man_cnt_month      --账户老人数\\n      ,sum(iteam_member_cnt)          as iteam_member_cnt_month       --账户会员数\\n      ,sum(consume_amount_day)        as consume_amount_month         --每月账户消费金额\\n      ,sum(consume_num_day)           as consume_num_month            --每月账户消费次数\\n      ,sum(member_consume_amount_day) as member_consume_amount_month  --每月会员消费金额\\n      ,sum(member_consume_num_day)    as member_consume_num_month     --每月会员消费次数\\n      ,substr(date_time,1,7)          as date_month           --月份\\n  from db_dw_hr.clife_hr_dws_recharge_consumption_by_itday\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by fee_iteam_id\\n          ,sub_org_id\\n          ,substr(date_time,1,7)\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_recharge_consumption_by_itday\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-5ip3p7\",\"name\":\"clife_hr_dws_recharge_consumption_by_itday\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_recharge_consumption_by_itday partition(part_date)\\nselect\\n     fee_iteam_id\\n    ,sub_org_id\\n    ,sub_org_name                  --机构名称\\n    ,org_id                        --集团id\\n    ,org_name                      --集团名称\\n    ,fee_iteam_name                --费用项目名称\\n    ,fee_type_id                   --费用类型id\\n    ,fee_type_name                 --费用类型名称\\n    ,iteam_old_man_cnt             --账户老人数\\n    ,iteam_member_cnt              --账户会员数\\n    ,consume_amount_day            --每天账户消费金额\\n    ,consume_num_day               --每天账户消费次数\\n    ,member_consume_amount_day     --每天会员消费金额\\n    ,member_consume_num_day        --每天会员消费次数\\n    ,coalesce(consume_amount_day/iteam_old_man_cnt,0)       as consume_avg --人均消费金额\\n    ,coalesce(consume_num_day/iteam_old_man_cnt,0)          as consume_cnt_avg  --人均消费次数\\n    ,coalesce(member_consume_amount_day/iteam_member_cnt,0) as member_consume_avg --会员人均消费金额\\n    ,coalesce(member_consume_num_day/iteam_member_cnt,0)    as member_consume_cnt_avg  --会员人均消费次数\\n    ,date_time                     --日期\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom\\n(\\n  select\\n       fee_iteam_id\\n      ,sub_org_id\\n      ,max(sub_org_name)        as sub_org_name      --机构名称\\n      ,max(org_id)              as org_id            --集团id\\n      ,max(org_name)            as org_name          --集团名称\\n      ,max(fee_iteam_name)      as fee_iteam_name    --费用项目名称\\n      ,max(fee_type_id)         as fee_type_id       --费用类型id\\n      ,max(fee_type_name)       as fee_type_name     --费用类型名称\\n      ,sum(member_consume_num_day)     as member_consume_num_day       --每天会员消费次数\\n      ,sum(member_consume_amount_day)  as member_consume_amount_day    --每天会员消费金额\\n      ,sum(consume_num_day)            as consume_num_day               --每天账户消费次数\\n      ,sum(consume_amount_day)         as consume_amount_day            --每天账户消费金额\\n      ,sum(iteam_member_cnt)         as iteam_member_cnt            --账户会员数\\n      ,sum(iteam_old_man_cnt)        as iteam_old_man_cnt           --账户老人数\\n      ,date_time\\n  from\\n  (\\n    select\\n         fee_iteam_id\\n        ,sub_org_id\\n        ,max(sub_org_name)        as sub_org_name      --机构名称\\n        ,max(org_id)              as org_id            --集团id\\n        ,max(org_name)            as org_name          --集团名称\\n        ,max(fee_iteam_name)      as fee_iteam_name    --费用项目名称\\n        ,max(fee_type_id)         as fee_type_id       --费用类型id\\n        ,max(fee_type_name)       as fee_type_name     --费用类型名称\\n        ,count(1)    as member_consume_num_day         --每天会员消费次数\\n        ,sum(amount) as member_consume_amount_day      --每天会员消费金额\\n        ,0 as consume_num_day         --每天账户消费次数\\n        ,0 as consume_amount_day      --每天账户消费金额\\n        ,count(distinct member_id)  as iteam_member_cnt   --账户会员数\\n        ,0 as iteam_old_man_cnt  --账户老人数\\n        ,substr(recharge_consumption_time,1,10) as date_time\\n     from db_dw_hr.clife_hr_dwd_recharge_consumption_info\\n     where part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n       and behavior_type = '会员消费'\\n     group by fee_iteam_id\\n             ,sub_org_id\\n             ,substr(recharge_consumption_time,1,10) \\n    union all\\n    select\\n         fee_iteam_id\\n        ,sub_org_id\\n        ,max(sub_org_name)        as sub_org_name      --机构名称\\n        ,max(org_id)              as org_id            --集团id\\n        ,max(org_name)            as org_name          --集团名称\\n        ,max(fee_iteam_name)      as fee_iteam_name    --费用项目名称\\n        ,max(fee_type_id)         as fee_type_id       --费用类型id\\n        ,max(fee_type_name)       as fee_type_name     --费用类型名称\\n        ,0 as member_consume_num_day         --每天会员消费次数\\n        ,0 as member_consume_amount_day      --每天会员消费金额\\n        ,count(1)    as consume_num_day         --每天账户消费次数\\n        ,sum(amount) as consume_amount_day      --每天账户消费金额\\n        ,0 as iteam_member_cnt   --账户会员数\\n        ,count(distinct old_man_id) as iteam_old_man_cnt  --账户老人数\\n        ,substr(recharge_consumption_time,1,10) as date_time\\n    from db_dw_hr.clife_hr_dwd_recharge_consumption_info\\n    where part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n      and behavior_type = '账户消费'\\n    group by fee_iteam_id\\n            ,sub_org_id\\n            ,substr(recharge_consumption_time,1,10)\\n  )a\\n  group by fee_iteam_id\\n          ,sub_org_id\\n          ,date_time\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_recharge_consumption_by_iteam\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-ct6b8\",\"name\":\"clife_hr_dws_recharge_consumption_by_iteam\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_recharge_consumption_by_iteam partition(part_date)\\nselect\\n     fee_iteam_id          --费用项目id\\n    ,sub_org_id            --养老机构id\\n    ,sub_org_name          --机构名称\\n    ,org_id                --集团id\\n    ,org_name              --集团名称\\n    ,fee_iteam_name        --费用项目名称\\n    ,fee_type_id           --费用类型id\\n    ,fee_type_name         --费用类型名称\\n    ,iteam_old_man_cnt     --老人数\\n    ,iteam_member_cnt      --会员数\\n    ,consume_amount    --花费总金额\\n    ,consume_num       --花费总次数\\n    ,member_consume_amount --会员消费总金额\\n    ,member_consume_num    --会员消费总次数\\n    ,coalesce(consume_amount/iteam_old_man_cnt,0) as consume_avg --人均消费金额\\n    ,coalesce(consume_num/iteam_old_man_cnt,0)    as consume_cnt_avg  --人均消费次数\\n    ,coalesce(member_consume_amount/iteam_member_cnt,0) as member_consume_avg --会员人均消费金额\\n    ,coalesce(member_consume_num/iteam_member_cnt,0)    as member_consume_cnt_avg  --会员人均消费次数\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom\\n(\\n  select\\n       fee_iteam_id        --费用项目id\\n      ,sub_org_id          --养老机构id\\n      ,max(sub_org_name)        as sub_org_name      --机构名称\\n      ,max(org_id)              as org_id            --集团id\\n      ,max(org_name)            as org_name          --集团名称\\n      ,max(fee_iteam_name)      as fee_iteam_name    --费用项目名称\\n      ,max(fee_type_id)         as fee_type_id       --费用类型id\\n      ,max(fee_type_name)       as fee_type_name     --费用类型名称\\n      ,count(distinct old_man_id) as iteam_old_man_cnt  --老人数\\n      ,count(distinct member_id)  as iteam_member_cnt   --会员数\\n      ,sum(consume_amount) as consume_amount --花费总金额\\n      ,sum(consume_num)    as consume_num  --花费总次数\\n      ,sum(member_consume_amount) as member_consume_amount --会员消费总金额\\n      ,sum(member_consume_num)    as member_consume_num    --会员消费总次数\\n  from db_dw_hr.clife_hr_dwm_recharge_consumption_aggregation\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by fee_iteam_id\\n          ,sub_org_id\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_recharge_consumption_by_asyear\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-49o1vs\",\"name\":\"clife_hr_dws_recharge_consumption_by_anso\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_recharge_consumption_by_anso partition(part_date)\\nselect\\n     account_name            --账户名称\\n    ,sub_org_id              --机构id\\n    ,sub_org_name            --机构名称\\n    ,org_id                  --集团id\\n    ,org_name                --集团名称\\n    ,account_old_man_cnt     --账户老人数\\n    ,account_member_cnt      --账户会员数\\n    ,check_in_payment_num    --入住缴费次数\\n    ,check_in_payment_amount --入住缴费金额\\n    ,recharge_num            --账户充值次数\\n    ,recharge_amount         --账户充值金额\\n    ,member_recharge_num     --会员充值次数\\n    ,member_recharge_amount  --会员充值金额\\n    ,consume_num             --账户消费次数\\n    ,consume_amount          --账户消费金额\\n    ,member_consume_num      --会员消费次数\\n    ,member_consume_amount   --会员消费金额\\n    ,countermand_amount      --退住退费金额\\n    ,coalesce(recharge_amount/recharge_old_man_num,0) as recharge_avg --人均充值金额\\n    ,coalesce(member_recharge_amount/recharge_member_man_num,0) as member_recharge_avg  --会员人均充值金额\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom\\n(\\n  select\\n       b.account_name  --账户名称\\n      ,a.sub_org_id  --机构id\\n      ,max(a.sub_org_name)       as sub_org_name            --机构名称\\n      ,max(a.org_id)             as org_id                  --集团id\\n      ,max(a.org_name)           as org_name                --集团名称\\n      ,count(distinct a.old_man_id) as account_old_man_cnt  --账户老人数\\n      ,count(distinct a.member_id)  as account_member_cnt   --账户会员数\\n      ,sum(case when a.behavior_type='入住缴费' then 1 else 0 end)      as check_in_payment_num      --入住缴费次数\\n      ,sum(case when a.behavior_type='入住缴费' then a.amount else 0 end) as check_in_payment_amount   --入住缴费金额\\n      ,sum(case when a.behavior_type='账户充值' then 1 else 0 end)      as recharge_num              --账户充值次数\\n      ,sum(case when a.behavior_type='账户充值' then a.amount else 0 end) as recharge_amount           --账户充值金额\\n      ,sum(case when a.behavior_type='会员充值' then 1 else 0 end)      as member_recharge_num       --会员充值次数\\n      ,sum(case when a.behavior_type='会员充值' then a.amount else 0 end) as member_recharge_amount    --会员充值金额\\n      ,sum(case when a.behavior_type='账户消费' then 1 else 0 end)      as consume_num               --账户消费次数\\n      ,sum(case when a.behavior_type='账户消费' then a.amount else 0 end) as consume_amount            --账户消费金额\\n      ,sum(case when a.behavior_type='会员消费' then 1 else 0 end)      as member_consume_num        --会员消费金额\\n      ,sum(case when a.behavior_type='会员消费' then a.amount else 0 end) as member_consume_amount     --会员消费次数\\n      ,sum(case when a.behavior_type='退住退费' then a.amount else 0 end) as countermand_amount        --退住退费金额\\n      ,count(distinct (case when a.behavior_type='账户充值' then a.old_man_id else null end)) as recharge_old_man_num   --账户充值老人数\\n      ,count(distinct (case when a.behavior_type='会员充值' then a.member_id else null end)) as recharge_member_man_num   --账户充值老人数\\n  from db_dw_hr.clife_hr_dwd_recharge_consumption_info a\\n  left join db_dw_hr.clife_hr_dim_account b on a.account_id = b.account_id and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n  where a.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n  group by b.account_name\\n          ,a.sub_org_id\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_reside_manage_by_soyear\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-bv2b8\",\"name\":\"clife_hr_dws_recharge_consumption_by_asyear\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_recharge_consumption_by_asyear partition(part_date)\\nselect\\n     sub_org_id              --机构id\\n    ,account_name            --账户名称\\n    ,sub_org_name            --机构名称\\n    ,org_id                  --集团id\\n    ,org_name                --集团名称\\n    ,account_old_man_cnt_year          --账户老人数\\n    ,account_member_cnt_year           --账户会员数\\n    ,check_in_payment_num_year     --每月入住缴费次数\\n    ,check_in_payment_amount_year  --每月入住缴费金额\\n    ,recharge_num_year             --每月账户充值次数\\n    ,recharge_amount_year          --每月账户充值金额\\n    ,member_recharge_num_year      --每月会员充值次数\\n    ,member_recharge_amount_year   --每月会员充值金额\\n    ,consume_num_year              --每月账户消费次数\\n    ,consume_amount_year           --每月账户消费金额\\n    ,member_consume_num_year       --每月会员消费次数\\n    ,member_consume_amount_year    --每月会员消费金额\\n    ,countermand_amount_year       --每月退住退费金额\\n    ,coalesce(recharge_amount_year/recharge_old_man_cnt,0) as recharge_avg_year --人均充值金额\\n    ,coalesce(member_recharge_amount_year/recharge_member_cnt,0) as  member_recharge_avg_year  --会员人均充值金额\\n    ,date_year\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom\\n(\\n  select\\n       sub_org_id              --机构id\\n      ,account_name            --账户名称\\n      ,max(sub_org_name) as   sub_org_name   --机构名称\\n      ,max(org_id)       as   org_id         --集团id\\n      ,max(org_name)     as   org_name       --集团名称\\n      ,sum(account_old_man_cnt_year)          as account_old_man_cnt_year          --账户老人数\\n      ,sum(account_member_cnt_year)           as account_member_cnt_year           --账户会员数\\n      ,sum(check_in_payment_num_year)     as check_in_payment_num_year     --每月入住缴费次数\\n      ,sum(check_in_payment_amount_year)  as check_in_payment_amount_year  --每月入住缴费金额\\n      ,sum(recharge_num_year)             as recharge_num_year             --每月账户充值次数\\n      ,sum(recharge_amount_year)          as recharge_amount_year          --每月账户充值金额\\n      ,sum(member_recharge_num_year)      as member_recharge_num_year      --每月会员充值次数\\n      ,sum(member_recharge_amount_year)   as member_recharge_amount_year   --每月会员充值金额\\n      ,sum(consume_num_year)              as consume_num_year              --每月账户消费次数\\n      ,sum(consume_amount_year)           as consume_amount_year           --每月账户消费金额\\n      ,sum(member_consume_num_year)       as member_consume_num_year       --每月会员消费次数\\n      ,sum(member_consume_amount_year)    as member_consume_amount_year    --每月会员消费金额\\n      ,sum(countermand_amount_year)       as countermand_amount_year       --每月退住退费金额\\n      ,sum(recharge_old_man_cnt)           as recharge_old_man_cnt         --基础充值老人数\\n      ,sum(recharge_member_cnt)            as recharge_member_cnt          --会员充值老人数\\n      ,date_year\\n  from\\n  (\\n    select\\n         sub_org_id              --机构id\\n        ,account_name            --账户名称\\n        ,max(sub_org_name) as   sub_org_name   --机构名称\\n        ,max(org_id)       as   org_id         --集团id\\n        ,max(org_name)     as   org_name       --集团名称\\n        ,sum(account_old_man_cnt_month)          as account_old_man_cnt_year            --账户老人数\\n        ,sum(account_member_cnt_month)           as account_member_cnt_year             --账户会员数\\n        ,sum(check_in_payment_num_month)     as check_in_payment_num_year     --每月入住缴费次数\\n        ,sum(check_in_payment_amount_month)  as check_in_payment_amount_year  --每月入住缴费金额\\n        ,sum(recharge_num_month)             as recharge_num_year             --每月账户充值次数\\n        ,sum(recharge_amount_month)          as recharge_amount_year          --每月账户充值金额\\n        ,sum(member_recharge_num_month)      as member_recharge_num_year      --每月会员充值次数\\n        ,sum(member_recharge_amount_month)   as member_recharge_amount_year   --每月会员充值金额\\n        ,sum(consume_num_month)              as consume_num_year              --每月账户消费次数\\n        ,sum(consume_amount_month)           as consume_amount_year           --每月账户消费金额\\n        ,sum(member_consume_num_month)       as member_consume_num_year       --每月会员消费次数\\n        ,sum(member_consume_amount_month)    as member_consume_amount_year    --每月会员消费金额\\n        ,sum(countermand_amount_month)       as countermand_amount_year       --每月退住退费金额\\n        ,0 as recharge_old_man_cnt  --基础充值老人数\\n        ,0 as recharge_member_cnt   --会员充值老人数\\n        ,substr(date_month,1,4) as date_year --月份\\n    from db_dw_hr.clife_hr_dws_recharge_consumption_by_asmonth\\n    where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    group by  sub_org_id  \\n             ,account_name\\n             ,substr(date_month,1,4)\\n   union all\\n   select\\n        a.sub_org_id\\n       ,b.account_name\\n       ,max(a.sub_org_name) as   sub_org_name   --机构名称\\n       ,max(a.org_id)       as   org_id         --集团id\\n       ,max(a.org_name)     as   org_name       --集团名称\\n       ,0 as account_old_man_cnt_year          --账户老人数\\t   \\n       ,0 as account_member_cnt_year           --账户会员数\\t   \\n       ,0 as check_in_payment_num_year    --每月入住缴费次数\\t   \\n       ,0 as check_in_payment_amount_year  --每月入住缴费金额\\t   \\n       ,0 as recharge_num_year             --每月账户充值次数\\t   \\n       ,0 as recharge_amount_year          --每月账户充值金额\\t   \\n       ,0 as member_recharge_num_year      --每月会员充值次数\\t   \\n       ,0 as member_recharge_amount_year   --每月会员充值金额\\t   \\n       ,0 as consume_num_year              --每月账户消费次数\\t   \\n       ,0 as consume_amount_year           --每月账户消费金额\\t   \\n       ,0 as member_consume_num_year       --每月会员消费次数\\t   \\n       ,0 as member_consume_amount_year    --每月会员消费金额\\t   \\n       ,0 as countermand_amount_year       --每月退住退费金额\\n       ,count(distinct a.old_man_id) as recharge_old_man_cnt  --基础充值老人数\\n       ,0 as recharge_member_cnt  --会员充值老人数\\n       ,substr(a.recharge_consumption_time,1,4) as date_year\\n   from db_dw_hr.clife_hr_dwd_recharge_consumption_info a\\n   left join db_dw_hr.clife_hr_dim_account b on a.account_id = b.account_id and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n   where a.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n     and a.behavior_type = '账户充值'\\n   group by b.account_name\\n           ,a.sub_org_id\\n           ,substr(a.recharge_consumption_time,1,4)\\n   union all\\n   select\\n        a.sub_org_id\\n       ,b.account_name\\n       ,max(a.sub_org_name) as   sub_org_name   --机构名称\\n       ,max(a.org_id)       as   org_id         --集团id\\n       ,max(a.org_name)     as   org_name       --集团名称\\n       ,0 as account_old_man_cnt_year          --账户老人数\\t   \\n       ,0 as account_member_cnt_year           --账户会员数\\t   \\n       ,0 as check_in_payment_num_year     --每月入住缴费次数\\t   \\n       ,0 as check_in_payment_amount_year  --每月入住缴费金额\\t   \\n       ,0 as recharge_num_year             --每月账户充值次数\\t   \\n       ,0 as recharge_amount_year          --每月账户充值金额\\t   \\n       ,0 as member_recharge_num_year      --每月会员充值次数\\t   \\n       ,0 as member_recharge_amount_year   --每月会员充值金额\\t   \\n       ,0 as consume_num_year              --每月账户消费次数\\t   \\n       ,0 as consume_amount_year           --每月账户消费金额\\t   \\n       ,0 as member_consume_num_year       --每月会员消费次数\\t   \\n       ,0 as member_consume_amount_year    --每月会员消费金额\\t   \\n       ,0 as countermand_amount_year       --每月退住退费金额\\n       ,0 as recharge_old_man_cnt  --基础充值老人数\\n       ,count(distinct a.old_man_id) as recharge_member_cnt  --会员充值老人数\\n       ,substr(a.recharge_consumption_time,1,4) as date_year\\n   from db_dw_hr.clife_hr_dwd_recharge_consumption_info a\\n   left join db_dw_hr.clife_hr_dim_account b on a.account_id = b.account_id and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n   where a.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n     and a.behavior_type = '会员充值'\\n   group by b.account_name\\n           ,a.sub_org_id\\n           ,substr(a.recharge_consumption_time,1,4)\\n  )a\\n  group by sub_org_id  \\n          ,account_name\\n          ,date_year\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_recharge_consumption_by_asmonth\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-2mf2hi\",\"name\":\"clife_hr_dws_recharge_consumption_by_asmonth\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_recharge_consumption_by_asmonth partition(part_date)\\nselect\\n     sub_org_id              --机构id\\n    ,account_name            --账户名称\\n    ,sub_org_name            --机构名称\\n    ,org_id                  --集团id\\n    ,org_name                --集团名称\\n    ,account_old_man_cnt_month          --账户老人数\\n    ,account_member_cnt_month           --账户会员数\\n    ,check_in_payment_num_month     --每月入住缴费次数\\n    ,check_in_payment_amount_month  --每月入住缴费金额\\n    ,recharge_num_month             --每月账户充值次数\\n    ,recharge_amount_month          --每月账户充值金额\\n    ,member_recharge_num_month      --每月会员充值次数\\n    ,member_recharge_amount_month   --每月会员充值金额\\n    ,consume_num_month              --每月账户消费次数\\n    ,consume_amount_month           --每月账户消费金额\\n    ,member_consume_num_month       --每月会员消费次数\\n    ,member_consume_amount_month    --每月会员消费金额\\n    ,countermand_amount_month       --每月退住退费金额\\n    ,coalesce(recharge_amount_month/recharge_old_man_cnt,0) as recharge_avg_month --人均充值金额\\n    ,coalesce(member_recharge_amount_month/recharge_member_cnt,0) as  member_recharge_avg_month  --会员人均充值金额\\n    ,date_month\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom\\n(\\n  select\\n       sub_org_id              --机构id\\n      ,account_name            --账户名称\\n      ,max(sub_org_name) as   sub_org_name   --机构名称\\n      ,max(org_id)       as   org_id         --集团id\\n      ,max(org_name)     as   org_name       --集团名称\\n      ,sum(account_old_man_cnt_month)          as account_old_man_cnt_month          --账户老人数\\n      ,sum(account_member_cnt_month)           as account_member_cnt_month           --账户会员数\\n      ,sum(check_in_payment_num_month)     as check_in_payment_num_month     --每月入住缴费次数\\n      ,sum(check_in_payment_amount_month)  as check_in_payment_amount_month  --每月入住缴费金额\\n      ,sum(recharge_num_month)             as recharge_num_month             --每月账户充值次数\\n      ,sum(recharge_amount_month)          as recharge_amount_month          --每月账户充值金额\\n      ,sum(member_recharge_num_month)      as member_recharge_num_month      --每月会员充值次数\\n      ,sum(member_recharge_amount_month)   as member_recharge_amount_month   --每月会员充值金额\\n      ,sum(consume_num_month)              as consume_num_month              --每月账户消费次数\\n      ,sum(consume_amount_month)           as consume_amount_month           --每月账户消费金额\\n      ,sum(member_consume_num_month)       as member_consume_num_month       --每月会员消费次数\\n      ,sum(member_consume_amount_month)    as member_consume_amount_month    --每月会员消费金额\\n      ,sum(countermand_amount_month)       as countermand_amount_month       --每月退住退费金额\\n      ,sum(recharge_old_man_cnt)         as recharge_old_man_cnt         --基础充值老人数\\n      ,sum(recharge_member_cnt)          as recharge_member_cnt          --会员充值老人数\\n      ,date_month\\n  from\\n  (\\n    select\\n         sub_org_id              --机构id\\n        ,account_name            --账户名称\\n        ,max(sub_org_name) as   sub_org_name   --机构名称\\n        ,max(org_id)       as   org_id         --集团id\\n        ,max(org_name)     as   org_name       --集团名称\\n        ,sum(account_old_man_cnt)          as account_old_man_cnt_month            --账户老人数\\n        ,sum(account_member_cnt)           as account_member_cnt_month             --账户会员数\\n        ,sum(check_in_payment_num_day)     as check_in_payment_num_month     --每月入住缴费次数\\n        ,sum(check_in_payment_amount_day)  as check_in_payment_amount_month  --每月入住缴费金额\\n        ,sum(recharge_num_day)             as recharge_num_month             --每月账户充值次数\\n        ,sum(recharge_amount_day)          as recharge_amount_month          --每月账户充值金额\\n        ,sum(member_recharge_num_day)      as member_recharge_num_month      --每月会员充值次数\\n        ,sum(member_recharge_amount_day)   as member_recharge_amount_month   --每月会员充值金额\\n        ,sum(consume_num_day)              as consume_num_month              --每月账户消费次数\\n        ,sum(consume_amount_day)           as consume_amount_month           --每月账户消费金额\\n        ,sum(member_consume_num_day)       as member_consume_num_month       --每月会员消费次数\\n        ,sum(member_consume_amount_day)    as member_consume_amount_month    --每月会员消费金额\\n        ,sum(countermand_amount_day)       as countermand_amount_month       --每月退住退费金额\\n        ,0 as recharge_old_man_cnt  --基础充值老人数\\n        ,0 as recharge_member_cnt   --会员充值老人数\\n        ,substr(date_time,1,7) as date_month --月份\\n    from db_dw_hr.clife_hr_dws_recharge_consumption_by_asday\\n    where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n    group by  sub_org_id  \\n             ,account_name\\n             ,substr(date_time,1,7)\\n   union all\\n   select\\n        a.sub_org_id\\n       ,b.account_name\\n       ,max(a.sub_org_name) as   sub_org_name   --机构名称\\n       ,max(a.org_id)       as   org_id         --集团id\\n       ,max(a.org_name)     as   org_name       --集团名称\\n       ,0 as account_old_man_cnt_month          --账户老人数\\t   \\n       ,0 as account_member_cnt_month           --账户会员数\\t   \\n       ,0 as check_in_payment_num_month    --每月入住缴费次数\\t   \\n       ,0 as check_in_payment_amount_month  --每月入住缴费金额\\t   \\n       ,0 as recharge_num_month             --每月账户充值次数\\t   \\n       ,0 as recharge_amount_month          --每月账户充值金额\\t   \\n       ,0 as member_recharge_num_month      --每月会员充值次数\\t   \\n       ,0 as member_recharge_amount_month   --每月会员充值金额\\t   \\n       ,0 as consume_num_month              --每月账户消费次数\\t   \\n       ,0 as consume_amount_month           --每月账户消费金额\\t   \\n       ,0 as member_consume_num_month       --每月会员消费次数\\t   \\n       ,0 as member_consume_amount_month    --每月会员消费金额\\t   \\n       ,0 as countermand_amount_month       --每月退住退费金额\\n       ,count(distinct a.old_man_id) as recharge_old_man_cnt  --基础充值老人数\\n       ,0 as recharge_member_cnt  --会员充值老人数\\n       ,substr(a.recharge_consumption_time,1,7) as date_month\\n   from db_dw_hr.clife_hr_dwd_recharge_consumption_info a\\n   left join db_dw_hr.clife_hr_dim_account b on a.account_id = b.account_id and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n   where a.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n     and a.behavior_type = '账户充值'\\n   group by b.account_name\\n           ,a.sub_org_id\\n           ,substr(a.recharge_consumption_time,1,7)\\n   union all\\n   select\\n        a.sub_org_id\\n       ,b.account_name\\n       ,max(a.sub_org_name) as   sub_org_name   --机构名称\\n       ,max(a.org_id)       as   org_id         --集团id\\n       ,max(a.org_name)     as   org_name       --集团名称\\n       ,0 as account_old_man_cnt_month          --账户老人数\\t   \\n       ,0 as account_member_cnt_month           --账户会员数\\t   \\n       ,0 as check_in_payment_num_month     --每月入住缴费次数\\t   \\n       ,0 as check_in_payment_amount_month  --每月入住缴费金额\\t   \\n       ,0 as recharge_num_month             --每月账户充值次数\\t   \\n       ,0 as recharge_amount_month          --每月账户充值金额\\t   \\n       ,0 as member_recharge_num_month      --每月会员充值次数\\t   \\n       ,0 as member_recharge_amount_month   --每月会员充值金额\\t   \\n       ,0 as consume_num_month              --每月账户消费次数\\t   \\n       ,0 as consume_amount_month           --每月账户消费金额\\t   \\n       ,0 as member_consume_num_month       --每月会员消费次数\\t   \\n       ,0 as member_consume_amount_month    --每月会员消费金额\\t   \\n       ,0 as countermand_amount_month       --每月退住退费金额\\n       ,0 as recharge_old_man_cnt  --基础充值老人数\\n       ,count(distinct a.old_man_id) as recharge_member_cnt  --会员充值老人数\\n       ,substr(a.recharge_consumption_time,1,7) as date_month\\n   from db_dw_hr.clife_hr_dwd_recharge_consumption_info a\\n   left join db_dw_hr.clife_hr_dim_account b on a.account_id = b.account_id and b.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n   where a.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n     and a.behavior_type = '会员充值'\\n   group by b.account_name\\n           ,a.sub_org_id\\n           ,substr(a.recharge_consumption_time,1,7)\\n  )a\\n  group by sub_org_id  \\n          ,account_name\\n          ,date_month\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_recharge_consumption_by_asday\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-3kc5bo\",\"name\":\"clife_hr_dws_coupon_manage_by_nhday\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_coupon_manage_by_nhday partition(part_date)\\nselect\\n     nurse_home_id\\n    ,max(nursing_homes_name) as nursing_homes_name --养老院名称\\n    ,max(sub_org_id)         as sub_org_id         --机构id\\n    ,max(sub_org_name)       as sub_org_name       --机构名称\\n    ,max(org_id)             as org_id             --集团id\\n    ,max(org_name)           as org_name           --集团名称\\n    ,max(area_id)            as area_id            --区域id\\n    ,sum(deduction_coupon_use_num_day)as deduction_coupon_use_num_day --每天抵扣优惠券使用数量\\n    ,sum(discount_coupon_use_num_day) as discount_coupon_use_num_day  --每天折扣优惠券使用数量\\n    ,sum(cash_coupon_use_num_day)     as cash_coupon_use_num_day      --每天现金优惠券使用数量\\n    ,sum(deduction_coupon_cost_day)   as deduction_coupon_cost_day    --抵扣优惠券花费\\n    ,sum(discount_coupon_cost_day)    as discount_coupon_cost_day     --折扣优惠券花费\\n    ,sum(cash_coupon_cost_day)        as cash_coupon_cost_day         --现金优惠券花费\\n    ,sum(deduction_coupon_num_day)    as  deduction_coupon_num_day  --每天抵扣优惠券发放数量\\t  \\n    ,sum(discount_coupon_num_day)     as  discount_coupon_num_day   --每天折扣优惠券发放数量\\t  \\n    ,sum(cash_coupon_num_day)         as  cash_coupon_num_day       --每天现金优惠券发放数量\\t  \\n    ,date_time\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom\\n(\\n  select\\n       nurse_home_id\\n      ,max(nursing_homes_name) as nursing_homes_name --养老院名称\\n      ,max(sub_org_id)         as sub_org_id         --机构id\\n      ,max(sub_org_name)       as sub_org_name       --机构名称\\n      ,max(org_id)             as org_id             --集团id\\n      ,max(org_name)           as org_name           --集团名称\\n      ,max(area_id)            as area_id            --区域id\\n      ,sum(case when type = 1 then use_frequency else 0 end) as deduction_coupon_use_num_day --每天抵扣优惠券使用数量\\n      ,sum(case when type = 2 then use_frequency else 0 end) as discount_coupon_use_num_day  --每天折扣优惠券使用数量\\n      ,sum(case when type = 3 then use_frequency else 0 end) as cash_coupon_use_num_day      --每天现金优惠券使用数量\\n      ,sum(case when type = 1 then cost else 0 end)          as deduction_coupon_cost_day    --抵扣优惠券花费\\n      ,sum(case when type = 2 then cost else 0 end)          as discount_coupon_cost_day     --折扣优惠券花费\\n      ,sum(case when type = 3 then cost else 0 end)          as cash_coupon_cost_day         --现金优惠券花费\\n      ,0 as  deduction_coupon_num_day  --每天抵扣优惠券发放数量\\t  \\n      ,0 as  discount_coupon_num_day   --每天折扣优惠券发放数量\\t  \\n      ,0 as  cash_coupon_num_day       --每天现金优惠券发放数量\\t  \\n      ,substr(use_date,1,10) as date_time\\n  from  db_dw_hr.clife_hr_dwd_coupon_manage_info\\n  where part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n  group by nurse_home_id\\n          ,substr(use_date,1,10)\\n  union all\\n  select\\n       nurse_home_id     --养老院id\\n      ,max(nursing_homes_name) as nursing_homes_name --养老院名称\\n      ,max(sub_org_id)         as sub_org_id         --机构id\\n      ,max(sub_org_name)       as sub_org_name       --机构名称\\n      ,max(org_id)             as org_id             --集团id\\n      ,max(org_name)           as org_name           --集团名称\\n      ,max(area_id)            as area_id            --区域id\\n      ,0 as deduction_coupon_use_num_day --每天抵扣优惠券使用数量\\n      ,0 as discount_coupon_use_num_day  --每天折扣优惠券使用数量\\n      ,0 as cash_coupon_use_num_day      --每天现金优惠券使用数量\\n      ,0 as deduction_coupon_cost_day    --抵扣优惠券花费\\n      ,0 as discount_coupon_cost_day     --折扣优惠券花费\\n      ,0 as cash_coupon_cost_day         --现金优惠券花费\\n      ,sum(case when type = 1 then 1 else 0 end) as deduction_coupon_num_day  --每天抵扣优惠券发放数量\\n      ,sum(case when type = 2 then 1 else 0 end) as discount_coupon_num_day   --每天折扣优惠券发放数量\\n      ,sum(case when type = 3 then 1 else 0 end) as cash_coupon_num_day       --每天现金优惠券发放数量\\n      ,substr(a.coupon_issue_time,1,10) as date_time  --发放时间\\n  from\\n  (\\n    select\\n         t.nurse_home_id         --养老院id\\n        ,t.nursing_homes_name    --养老院名称\\n        ,t.sub_org_id            --机构id\\n        ,t.sub_org_name          --机构名称\\n        ,t.org_id                --集团id\\n        ,t.org_name              --集团名称\\n        ,t.area_id               --区域id\\n        ,t.type                  --优惠券类型\\n        ,ip.coupon_issue_time\\n    from  db_dw_hr.clife_hr_dwd_coupon_manage_info t\\n    lateral view explodemulti(if(t.coupon_issue_times is null,'',t.coupon_issue_times))ip as coupon_issue_time\\n    where t.part_date = regexp_replace(date_sub(current_date(),1),'-','')\\n  )a\\n  group by nurse_home_id\\n          ,substr(a.coupon_issue_time,1,10)\\n)t\\ngroup by nurse_home_id\\n        ,date_time\",\"udfs\":\"13\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_coupon_manage_by_nhome\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-1hz6i\",\"name\":\"clife_hr_dws_coupon_manage_by_nhome\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_coupon_manage_by_nhome partition(part_date)\\nselect\\n     nurse_home_id     --养老院id\\n    ,max(nursing_homes_name) as nursing_homes_name --养老院名称\\n    ,max(sub_org_id)         as sub_org_id         --机构id\\n    ,max(sub_org_name)       as sub_org_name       --机构名称\\n    ,max(org_id)             as org_id             --集团id\\n    ,max(org_name)           as org_name           --集团名称\\n    ,max(area_id)            as area_id            --区域id\\n    ,sum(case when type = 1 then 1 else 0 end) as deduction_coupon_num                 --抵扣优惠券发放数量\\n    ,sum(case when type = 2 then 1 else 0 end) as discount_coupon_num                  --折扣优惠券发放数量\\n    ,sum(case when type = 3 then 1 else 0 end) as cash_coupon_num                      --现金优惠券发放数量\\n    ,sum(case when type = 1 then use_frequency else 0 end) as deduction_coupon_use_num --抵扣优惠券使用数量\\n    ,sum(case when type = 2 then use_frequency else 0 end) as discount_coupon_use_num  --折扣优惠券使用数量\\n    ,sum(case when type = 3 then use_frequency else 0 end) as cash_coupon_use_num      --现金优惠券使用数量\\n    ,sum(case when type = 1 then balance else 0 end) as deduction_coupon_balance       --抵扣优惠券总余额\\n    ,sum(case when type = 2 then balance else 0 end) as discount_coupon_balance        --折扣优惠券总余额\\n    ,sum(case when type = 3 then balance else 0 end) as cash_coupon_balance            --现金优惠券总余额\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --分区日期\\nfrom db_dw_hr.clife_hr_dwd_coupon_manage_info\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','')\\ngroup by nurse_home_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_recharge_consumption_by_ityear\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-61ilp\",\"name\":\"clife_hr_dws_coupon_manage_by_nhmonth\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_coupon_manage_by_nhmonth partition(part_date)\\nselect\\n     nurse_home_id --养老院id\\n    ,max(nursing_homes_name) as nursing_homes_name --养老院名称\\n    ,max(sub_org_id)         as sub_org_id         --机构id\\n    ,max(sub_org_name)       as sub_org_name       --机构名称\\n    ,max(org_id)             as org_id             --集团id\\n    ,max(org_name)           as org_name           --集团名称\\n    ,max(area_id)            as area_id            --区域id \\n    ,sum(deduction_coupon_num_day)    as deduction_coupon_num_month       --每月抵扣优惠券发放数量\\n    ,sum(discount_coupon_num_day)     as discount_coupon_num_month        --每月折扣优惠券发放数量\\n    ,sum(cash_coupon_num_day)         as cash_coupon_num_month            --每月现金优惠券发放数量\\n    ,sum(deduction_coupon_use_num_day)as deduction_coupon_use_num_month   --每月抵扣优惠券使用数量\\n    ,sum(discount_coupon_use_num_day) as discount_coupon_use_num_month    --每月折扣优惠券使用数量\\n    ,sum(cash_coupon_use_num_day)     as cash_coupon_use_num_month        --每月现金优惠券使用数量\\n    ,sum(deduction_coupon_cost_day)   as deduction_coupon_cost_month      --每月抵扣优惠券花费\\n    ,sum(discount_coupon_cost_day)    as discount_coupon_cost_month       --每月折扣优惠券花费\\n    ,sum(cash_coupon_cost_day)        as cash_coupon_cost_month           --每月现金优惠券花费\\n    ,substr(date_time,1,7) as date_month  --月期 \\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom db_dw_hr.clife_hr_dws_coupon_manage_by_nhday\\nwhere part_date = regexp_replace(date_sub(current_date(),1),'-','')\\ngroup by nurse_home_id\\n        ,substr(date_time,1,7)\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_coupon_manage_by_nhday\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-487pc\",\"name\":\"clife_hr_dws_activity_manage_by_nhday\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_activity_manage_by_nhday partition(part_date)\\nselect\\n     nurse_home_id\\n    ,max(nursing_homes_name) as nursing_homes_name     --养老院名称\\n    ,max(sub_org_id)         as sub_org_id             --机构id\\n    ,max(sub_org_name)       as sub_org_name           --机构名称\\n    ,max(org_id)             as org_id                --集团id\\n    ,max(org_name)           as org_name              --集团名称\\n    ,max(area_id)            as area_id               --区域id\\n    ,sum(apply_old_man_cnt_day)  as apply_old_man_cnt_day  --报名人次\\n    ,sum(apply_activity_cnt_day) as apply_activity_cnt_day --已报名活动数\\n    ,sum(sign_old_man_cnt_day)   as sign_old_man_cnt_day   --签到人次\\n    ,sum(confirm_old_man_cnt_day)as confirm_old_man_cnt_day--到场人次\\n    ,sum(host_activity_cnt_day)  as host_activity_cnt_day  --已举办活动数\\n    ,sum(template_cnt_day)        as template_cnt_day        --使用活动模板数量\\n    ,sum(activity_cnt_day)       as activity_cnt_day       --已创建活动数\\n    ,sum(activity_fee_day)       as activity_fee_day       --活动费用\\n    ,sum(reserve_cnt_day)        as reserve_cnt_day        --预定活动室次数\\n    ,date_time\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date\\nfrom\\n(\\n  select\\n       nurse_home_id\\n      ,max(nursing_homes_name) as nursing_homes_name     --养老院名称\\n      ,max(sub_org_id)         as sub_org_id             --机构id\\n      ,max(sub_org_name)       as sub_org_name           --机构名称\\n      ,max(org_id)             as org_id                --集团id\\n      ,max(org_name)           as org_name              --集团名称\\n      ,max(area_id)            as area_id               --区域id\\n      ,count(t.apply_time)           as apply_old_man_cnt_day        --报名人次\\n      ,count(t.apply_time)           as apply_activity_cnt_day       --已报名活动数\\n      ,0 as sign_old_man_cnt_day   --签到人次\\n      ,0 as confirm_old_man_cnt_day--到场人次\\n      ,0 as host_activity_cnt_day  --已举办活动数\\n  \\t  ,0 as template_cnt_day        --使用活动模板数量\\n  \\t  ,0 as activity_cnt_day       --已创建活动数\\n  \\t  ,0 as activity_fee_day       --活动费用\\n      ,0 as reserve_cnt_day  --预定活动室次数\\n      ,substr(t.apply_time,1,10)     as date_time\\n  from\\n  (\\n    select\\n         a.activity_id\\n        ,a.nurse_home_id\\n        ,a.nursing_homes_name     --养老院名称\\n        ,a.sub_org_id             --机构id\\n        ,a.sub_org_name           --机构名称\\n        ,a.org_id                --集团id\\n        ,a.org_name              --集团名称\\n        ,a.area_id               --区域id\\n        ,ip.apply_time\\n    from db_dw_hr.clife_hr_dwd_activity_manage_info a\\n    lateral view explodemulti(if(a.apply_times is null,'',a.apply_times)) ip as apply_time\\n    where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  )t\\n  group by nurse_home_id\\n          ,substr(t.apply_time,1,10)\\n  union all\\n  select\\n       nurse_home_id\\n      ,max(nursing_homes_name) as nursing_homes_name     --养老院名称\\n      ,max(sub_org_id)         as sub_org_id             --机构id\\n      ,max(sub_org_name)       as sub_org_name           --机构名称\\n      ,max(org_id)             as org_id                --集团id\\n      ,max(org_name)           as org_name              --集团名称\\n      ,max(area_id)            as area_id               --区域id\\n      ,0 as apply_old_man_cnt_day        --报名人次\\n      ,0 as apply_activity_cnt_day       --已报名活动数\\n      ,count(t.sign_old_man)       as sign_old_man_cnt_day       --签到人次\\n      ,0 as confirm_old_man_cnt_day--到场人次\\n      ,0 as host_activity_cnt_day  --已举办活动数\\n      ,0 as template_cnt_day        --使用活动模板数量\\n      ,0 as activity_cnt_day       --已创建活动数\\n      ,0 as activity_fee_day       --活动费用\\n      ,0 as reserve_cnt_day  --预定活动室次数\\n      ,substr(t.sign_time,1,10) as date_time\\n  from\\n  (\\n    select\\n         a.activity_id\\n        ,a.nurse_home_id\\n        ,a.nursing_homes_name     --养老院名称\\n        ,a.sub_org_id             --机构id\\n        ,a.sub_org_name           --机构名称\\n        ,a.org_id                --集团id\\n        ,a.org_name              --集团名称\\n        ,a.area_id               --区域id\\n        ,ip.sign_old_man\\n        ,ip.sign_time\\n    from db_dw_hr.clife_hr_dwd_activity_manage_info a\\n    lateral view explodemulti(if(a.sign_old_mans is null,'',a.sign_old_mans),if(a.sign_times is null,'',a.sign_times))ip as sign_old_man,sign_time\\n    where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  )t\\n  group by nurse_home_id\\n          ,substr(t.sign_time,1,10)\\n  union all\\n  select\\n       nurse_home_id\\n      ,max(nursing_homes_name) as nursing_homes_name     --养老院名称\\n      ,max(sub_org_id)         as sub_org_id             --机构id\\n      ,max(sub_org_name)       as sub_org_name           --机构名称\\n      ,max(org_id)             as org_id                --集团id\\n      ,max(org_name)           as org_name              --集团名称\\n      ,max(area_id)            as area_id               --区域id\\n      ,0 as apply_old_man_cnt_day        --报名人次\\n      ,0 as apply_activity_cnt_day       --已报名活动数\\n      ,0 as sign_old_man_cnt_day       --签到人次\\n      ,count(t.confirm_old_man)  as confirm_old_man_cnt_day       --到场人次\\n      ,0 as host_activity_cnt_day  --已举办活动数\\n  \\t,0 as template_cnt_day   --使用活动模板数量\\n  \\t,0 as activity_cnt_day  --已创建活动数\\n  \\t,0 as activity_fee_day   --活动费用\\n      ,0 as reserve_cnt_day  --预定活动室次数\\n      ,substr(t.confirm_time,1,10) as date_time\\n  from\\n  (\\n    select\\n         a.activity_id\\n        ,a.nurse_home_id\\n        ,a.nursing_homes_name     --养老院名称\\n        ,a.sub_org_id             --机构id\\n        ,a.sub_org_name           --机构名称\\n        ,a.org_id                --集团id\\n        ,a.org_name              --集团名称\\n        ,a.area_id               --区域id\\n        ,ip.confirm_old_man\\n        ,ip.confirm_time\\n    from db_dw_hr.clife_hr_dwd_activity_manage_info a\\n    lateral view explodemulti(if(a.confirm_old_mans is null,'',a.confirm_old_mans),if(a.confirm_times is null,'',a.confirm_times))ip as confirm_old_man,confirm_time\\n    where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  )t\\n  group by nurse_home_id\\n          ,substr(t.confirm_time,1,10)\\n  union all\\t \\n  select\\n       nurse_home_id \\n      ,max(nursing_homes_name) as nursing_homes_name     --养老院名称\\n      ,max(sub_org_id)         as sub_org_id             --机构id\\n      ,max(sub_org_name)       as sub_org_name           --机构名称\\n      ,max(org_id)             as org_id                --集团id\\n      ,max(org_name)           as org_name              --集团名称\\n      ,max(area_id)            as area_id               --区域id\\n      ,0 as apply_old_man_cnt_day        --报名人次\\n      ,0 as apply_activity_cnt_day       --已报名活动数\\n      ,0 as sign_old_man_cnt_day         --签到人次\\n      ,0 as confirm_old_man_cnt_day      --到场人次\\n      ,count(activity_id) as host_activity_cnt_day  --已举办活动数\\n  \\t,0 as template_cnt_day   --使用活动模板数量\\n  \\t,0 as activity_cnt_day  --已创建活动数\\n  \\t,0 as activity_fee_day   --活动费用\\n      ,0 as reserve_cnt_day  --预定活动室次数\\n      ,substr(activity_time,1,10) as date_time --活动创建时间\\n  from db_dw_hr.clife_hr_dwd_activity_manage_info\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by nurse_home_id\\n          ,substr(activity_time,1,10) \\n  union all\\n  select\\n       nurse_home_id\\n      ,max(nursing_homes_name)as nursing_homes_name     --养老院名称\\n      ,max(sub_org_id)        as sub_org_id             --机构id\\n      ,max(sub_org_name)      as sub_org_name           --机构名称\\n      ,max(org_id)             as org_id                --集团id\\n      ,max(org_name)           as org_name              --集团名称\\n      ,max(area_id)            as area_id               --区域id\\n      ,0 as apply_old_man_cnt_day        --报名人次\\n      ,0 as apply_activity_cnt_day       --已报名活动数\\n      ,0 as sign_old_man_cnt_day         --签到人次\\n      ,0 as confirm_old_man_cnt_day      --到场人次\\n      ,0 as host_activity_cnt_day  --已举办活动数\\n      ,count(template_id) as template_cnt_day   --使用活动模板数量\\n      ,count(activity_id) as activity_cnt_day  --已创建活动数\\n      ,sum(activity_fee)  as activity_fee_day   --活动费用\\n      ,0 as reserve_cnt_day  --预定活动室次数\\n      ,substr(activity_create_time,1,10) as date_time --活动创建时间\\n  from db_dw_hr.clife_hr_dwd_activity_manage_info\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by nurse_home_id\\n          ,substr(activity_create_time,1,10)\\n  union all\\n  select\\n       nurse_home_id\\n      ,max(nursing_homes_name)as nursing_homes_name     --养老院名称\\n      ,max(sub_org_id)        as sub_org_id             --机构id\\n      ,max(sub_org_name)      as sub_org_name           --机构名称\\n      ,max(org_id)             as org_id                  --集团id\\n      ,max(org_name)           as org_name                --集团名称\\n      ,max(area_id)            as area_id                 --区域id\\n      ,0 as apply_old_man_cnt_day        --报名人次\\n      ,0 as apply_activity_cnt_day       --已报名活动数\\n      ,0 as sign_old_man_cnt_day         --签到人次\\n      ,0 as confirm_old_man_cnt_day      --到场人次\\n      ,0 as host_activity_cnt_day  --已举办活动数\\n      ,0 as template_cnt_day   --使用活动模板数量\\n      ,0 as activity_cnt_day  --已创建活动数\\n      ,0 as activity_fee_day   --活动费用\\n      ,count(t.reserve_id) as reserve_cnt_day  --预定活动室次数\\n      ,substr(t.reserve_time,1,10) as date_time\\n  from\\n  (\\n    select\\n         a.activity_id\\n        ,a.nurse_home_id\\n        ,a.nursing_homes_name   --养老院名称\\n        ,a.sub_org_id           --机构id\\n        ,a.sub_org_name         --机构名称\\n        ,a.org_id               --集团id\\n        ,a.org_name             --集团名称\\n        ,a.area_id              --区域id\\n        ,ip.reserve_id\\n        ,ip.reserve_time\\n    from db_dw_hr.clife_hr_dwd_activity_manage_info a\\n    lateral view explodemulti(if(a.reserve_ids is null,'',a.reserve_ids),if(a.reserve_times is null,'',a.reserve_times))ip as reserve_id,reserve_time\\n    where a.part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  )t\\n  group by nurse_home_id\\n          ,substr(t.reserve_time,1,10)\\n)k\\ngroup by nurse_home_id\\n        ,date_time\",\"udfs\":\"13\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_activity_manage_by_nhome\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-5ri10h\",\"name\":\"clife_hr_dws_activity_manage_by_nhmonth\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_activity_manage_by_nhmonth partition(part_date)\\nselect\\n     nurse_home_id --养老院id\\n    ,nursing_homes_name     --养老院名称\\n    ,sub_org_id             --机构id\\n    ,sub_org_name           --机构名称\\n    ,org_id                 --集团id\\n    ,org_name               --集团名称\\n    ,area_id                --区域id \\n    ,reserve_cnt_month        --预定活动室次数\\n    ,template_cnt_month        --使用模板次数\\n    ,activity_cnt_month       --创建活动数\\n    ,activity_fee_month       --活动费用\\n    ,host_activity_cnt_month  --已举办活动数\\n    ,confirm_old_man_cnt_month--到场人次\\n    ,sign_old_man_cnt_month   --签到人次\\n    ,apply_old_man_cnt_month  --报名人次\\n    ,apply_activity_cnt_month --已报名活动数\\n    ,date_month --月份 \\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom\\n(\\n  select\\n       nurse_home_id --养老院id\\n      ,max(nursing_homes_name) as nursing_homes_name --养老院名称\\n      ,max(sub_org_id)         as sub_org_id         --机构id\\n      ,max(sub_org_name)       as sub_org_name       --机构名称\\n      ,max(org_id)             as org_id             --集团id\\n      ,max(org_name)           as org_name           --集团名称\\n      ,max(area_id)            as area_id            --区域id \\n      ,sum(reserve_cnt_day)         as reserve_cnt_month        --预定活动室次数\\n      ,sum(template_cnt_day)         as template_cnt_month        --使用模板次数\\n      ,sum(activity_cnt_day)        as activity_cnt_month       --创建活动数\\n      ,sum(activity_fee_day)        as activity_fee_month       --活动费用\\n      ,sum(host_activity_cnt_day)   as host_activity_cnt_month  --已举办活动数\\n      ,sum(confirm_old_man_cnt_day) as confirm_old_man_cnt_month--到场人次\\n      ,sum(sign_old_man_cnt_day)    as sign_old_man_cnt_month   --签到人次\\n      ,sum(apply_old_man_cnt_day)   as apply_old_man_cnt_month  --报名人次\\n      ,sum(apply_activity_cnt_day)  as apply_activity_cnt_month --已报名活动数\\n      ,substr(date_time,1,7) as date_month --月份     \\n  from db_dw_hr.clife_hr_dws_activity_manage_by_nhday\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by nurse_home_id\\n          ,substr(date_time,1,7)\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_activity_manage_by_nhday\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-1w33a7\",\"name\":\"clife_hr_dws_activity_manage_by_suborg\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_activity_manage_by_suborg partition(part_date)\\nselect\\n     activity_type           --活动类型,\\n\\t,sub_org_id             --机构id\\n    ,max(sub_org_name)      as sub_org_name           --机构名称\\n    ,max(org_id)             as org_id                  --集团id\\n    ,max(org_name)           as org_name                --集团名称\\n    ,max(area_id)            as area_id                 --区域id\\n    ,sum(reserve_num)       as reserve_num            --预定活动室次数\\n    ,sum(template_cnt)       as template_cnt            --使用活动模板数量\\n    ,sum(activity_num)      as activity_num           --已创建活动数\\n    ,sum(apply_activity_cnt)as apply_activity_cnt     --已报名活动数\\n    ,sum(host_activity_cnt) as host_activity_cnt      --已举办活动数\\n    ,sum(apply_old_man_cnt) as apply_old_man_cnt      --报名人次\\n    ,sum(sign_old_man_cnt)  as sign_old_man_cnt       --签到人次\\n    ,sum(confirm_old_man_cnt)  as confirm_old_man_cnt       --到场人次\\n    ,sum(activity_fee)      as activity_fee           --活动费用\\n    ,sum(good_evaluation_num)   as good_evaluation_num    --活动评价好评数\\n    ,sum(middle_evaluation_num) as middle_evaluation_num  --活动评价中评数\\n    ,sum(bad_evaluation_num)    as bad_evaluation_num     --活动评价差评数\\n    ,sum(good_feedback_num)     as good_feedback_num      --反馈非常好数\\n    ,sum(middle_feedback_num)   as middle_feedback_num    --反馈较好数\\n    ,sum(general_feedback_num)  as general_feedback_num   --反馈一般数\\n    ,sum(bad_feedback_num)      as bad_feedback_num       --反馈不理想数\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom db_dw_hr.clife_hr_dwm_activity_manage_aggregation\\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','')\\ngroup by activity_type\\n        ,sub_org_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_activity_manage_by_nhyear\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-7fl7mu\",\"name\":\"clife_hr_dws_activity_manage_by_nhome\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_activity_manage_by_nhome partition(part_date)\\nselect\\n     nurse_home_id           --养老院id\\n    ,max(nursing_homes_name)as nursing_homes_name     --养老院名称\\n    ,max(sub_org_id)        as sub_org_id             --机构id\\n    ,max(sub_org_name)      as sub_org_name           --机构名称\\n    ,max(org_id)             as org_id                  --集团id\\n    ,max(org_name)           as org_name                --集团名称\\n    ,max(area_id)            as area_id                 --区域id\\n    ,sum(reserve_num)       as reserve_num           --预定活动室次数\\n    ,sum(template_cnt)       as emplate_cnt            --使用活动模板数量\\n    ,sum(activity_num)      as activity_num           --已创建活动数\\n    ,sum(apply_activity_cnt)as apply_activity_cnt     --已报名活动数\\n    ,sum(host_activity_cnt) as host_activity_cnt      --已举办活动数\\n    ,sum(apply_old_man_cnt) as apply_old_man_cnt      --报名人次\\n    ,sum(sign_old_man_cnt)  as sign_old_man_cnt       --签到人次\\n    ,sum(confirm_old_man_cnt)  as confirm_old_man_cnt       --到场人次\\n    ,sum(activity_fee)      as activity_fee           --活动费用\\n    ,sum(good_evaluation_num)   as good_evaluation_num    --活动评价好评数\\n    ,sum(middle_evaluation_num) as middle_evaluation_num  --活动评价中评数\\n    ,sum(bad_evaluation_num)    as bad_evaluation_num     --活动评价差评数\\n    ,sum(good_feedback_num)     as good_feedback_num      --反馈非常好数\\n    ,sum(middle_feedback_num)   as middle_feedback_num    --反馈较好数\\n    ,sum(general_feedback_num)  as general_feedback_num   --反馈一般数\\n    ,sum(bad_feedback_num)      as bad_feedback_num       --反馈不理想数\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --日期分区\\nfrom db_dw_hr.clife_hr_dwm_activity_manage_aggregation\\nwhere part_date=regexp_replace(date_sub(current_date(),1),'-','')\\ngroup by nurse_home_id\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_coupon_manage_by_nhyear\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-4f45a0\",\"name\":\"clife_hr_dws_service_record_by_nhday\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_service_record_by_nhday partition(part_date)\\nselect\\n     nursin_homes_id  --养老院id\\n    ,service_type     --服务类型（增值or基础）\\n    ,nursing_homes_name    --养老院名称\\n    ,sub_org_id    --机构id\\n    ,sub_org_name  --机构名称\\n    ,org_id        --集团id\\n    ,org_name      --集团名称\\n    ,old_man_num_day    --养老院老人数\\n    ,cost_day                          --服务总费用\\n    ,service_num_day                   --服务数\\n    ,already_settle_service_num    --已结算服务数\\n    ,no_settle_service_num         --未结算服务数\\n    ,wait_complete_service_num     --待完成服务数\\n    ,complete_service_num          --已完成服务数\\n    ,evaluation_service_num        --已评价服务数\\n    ,evaluation_wait_num           --待评价服务数\\n    ,evaluation_good_num           --好评数\\n    ,evaluation_middle_num         --中评数\\n    ,evaluation_bad_num            --差评数\\n    ,coalesce(cost_day/old_man_num_day,0) as recharge_avg_day --人均服务费\\n    ,coalesce(service_num_day/old_man_num_day,0) as member_recharge_avg_day  --人均服务数\\n    ,date_time\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date  --分区日期\\nfrom \\n(\\n  select\\n       nursin_homes_id\\n      ,service_type\\n      ,max(nursing_homes_name) as nursing_homes_name --养老院名称\\n      ,max(sub_org_id)         as sub_org_id--机构id\\n      ,max(sub_org_name)       as sub_org_name--机构名称\\n      ,max(org_id)             as org_id--集团id\\n      ,max(org_name)           as org_name--集团名称\\n      ,substr(create_time,1,10) as date_time\\n      ,count(distinct old_man_id) as old_man_num_day --养老院老人数\\n      ,sum(cost) as cost_day        --服务总费用\\n      ,sum(1)    as service_num_day --服务数\\n      ,sum(case when settlement_status =  2 then 1 else 0 end ) as  already_settle_service_num     --已结算服务数\\n      ,sum(case when settlement_status =  3 then 1 else 0 end ) as  no_settle_service_num          --未结算服务数\\n      ,sum(case when service_status = 1  then 1 else 0 end )    as  wait_complete_service_num      --待完成服务数\\n      ,sum(case when service_status = 2  then 1 else 0 end )    as  complete_service_num           --已完成服务数\\n      ,sum(case when service_status = 3  then 1 else 0 end )    as  evaluation_service_num         --已评价服务数\\n      ,sum(case when evaluation_status = 0  then 1 else 0 end ) as  evaluation_wait_num            --待评价服务数\\n      ,sum(case when evaluation_status = 1  then 1 else 0 end ) as  evaluation_good_num            --好评数\\n      ,sum(case when evaluation_status = 2  then 1 else 0 end ) as  evaluation_middle_num          --中评数\\n      ,sum(case when evaluation_status = 3  then 1 else 0 end ) as  evaluation_bad_num             --差评数\\n  from db_dw_hr.clife_hr_dwd_service_record_info\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by nursin_homes_id\\n          ,service_type\\n          ,substr(create_time,1,10)\\n)t\\n\",\"udfs\":\"13\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_service_record_by_nhome\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-4231m0\",\"name\":\"clife_hr_dws_service_record_by_spstyear\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_service_record_by_spstyear partition(part_date)\\nselect\\n     service_project_id --服务项目id\\n    ,sub_org_id         --机构id\\n    ,service_type       --服务类型（增值or基础）\\n    ,service_project_name  --服务项目名称\\n    ,service_type_id       --服务类型id\\n    ,service_type_name     --服务类型id名\\n    ,sub_org_name          --机构名称\\n    ,org_id                --集团id\\n    ,org_name              --集团名称\\n    ,old_man_num_year    --养老院老人数\\n    ,cost_year                    --服务总费用\\n    ,service_num_year             --服务数\\n    ,already_settle_service_num    --已结算服务数\\n    ,no_settle_service_num         --未结算服务数\\n    ,wait_complete_service_num     --待完成服务数\\n    ,complete_service_num          --已完成服务数\\n    ,evaluation_service_num        --已评价服务数\\n    ,evaluation_wait_num           --待评价服务数\\n    ,evaluation_good_num           --好评数\\n    ,evaluation_middle_num         --中评数\\n    ,evaluation_bad_num            --差评数\\n    ,coalesce(cost_year/old_man_num_year,0)        as recharge_avg_year         --人均服务费\\n    ,coalesce(service_num_year/old_man_num_year,0) as member_recharge_avg_year  --人均服务数\\n    ,date_year\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date  --分区日期\\nfrom\\n(\\n   select\\n        service_project_id --服务项目id\\n       ,sub_org_id         --机构id\\n       ,service_type       --服务类型（增值or基础）\\n       ,max(service_project_name)   as service_project_name  --服务项目名称\\n       ,max(service_type_id)        as service_type_id       --服务类型id\\n       ,max(service_type_name)      as service_type_name     --服务类型id名\\n       ,max(sub_org_name) as sub_org_name  --机构名称\\n       ,max(org_id)       as org_id        --集团id\\n       ,max(org_name)     as org_name      --集团名称\\n       ,sum(old_man_num_month)            as old_man_num_year              --养老院老人数\\n       ,sum(cost_month)                   as cost_year                    --服务总费用\\n       ,sum(service_num_month)            as service_num_year             --服务数\\n       ,sum(already_settle_service_num) as already_settle_service_num     --已结算服务数\\n       ,sum(no_settle_service_num)      as no_settle_service_num          --未结算服务数\\n       ,sum(wait_complete_service_num)  as wait_complete_service_num      --待完成服务数\\n       ,sum(complete_service_num)       as complete_service_num           --已完成服务数\\n       ,sum(evaluation_service_num)     as evaluation_service_num         --已评价服务数\\n       ,sum(evaluation_wait_num)        as evaluation_wait_num            --待评价服务数\\n       ,sum(evaluation_good_num)        as evaluation_good_num            --好评数\\n       ,sum(evaluation_middle_num)      as evaluation_middle_num          --中评数\\n       ,sum(evaluation_bad_num)         as evaluation_bad_num             --差评数\\n       ,substr(date_month,1,4) as date_year\\n   from db_dw_hr.clife_hr_dws_service_record_by_spstmonth\\n   where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n   group by service_project_id\\n          ,sub_org_id\\n          ,service_type\\n          ,substr(date_month,1,4)\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_service_record_by_spstmonth\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-bc626\",\"name\":\"clife_hr_dws_service_record_by_spstday\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_service_record_by_spstday partition(part_date)\\nselect\\n     service_project_id    --服务项目id\\n    ,sub_org_id            --机构id\\n    ,service_type          --服务类型（增值or基础）\\n    ,service_project_name  --服务项目名称\\n    ,service_type_id       --服务类型id\\n    ,service_type_name     --服务类型id名\\n    ,sub_org_name          --机构名称\\n    ,org_id                --集团id\\n    ,org_name              --集团名称\\n    ,old_man_num_day       --养老院老人数\\n    ,cost_day                          --服务总费用\\n    ,service_num_day                   --服务数\\n    ,already_settle_service_num    --已结算服务数\\n    ,no_settle_service_num         --未结算服务数\\n    ,wait_complete_service_num     --待完成服务数\\n    ,complete_service_num          --已完成服务数\\n    ,evaluation_service_num        --已评价服务数\\n    ,evaluation_wait_num           --待评价服务数\\n    ,evaluation_good_num           --好评数\\n    ,evaluation_middle_num         --中评数\\n    ,evaluation_bad_num            --差评数\\n    ,coalesce(cost_day/old_man_num_day,0)        as recharge_avg_day --人均服务费\\n    ,coalesce(service_num_day/old_man_num_day,0) as member_recharge_avg_day  --人均服务数\\n    ,date_time\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date  --分区日期\\nfrom \\n(\\n select\\n       service_project_id --服务项目id\\n      ,sub_org_id         --机构id\\n      ,service_type       --服务类型（增值or基础）\\n      ,max(service_project_name)   as service_project_name  --服务项目名称\\n      ,max(service_type_id)        as service_type_id       --服务类型id\\n      ,max(service_type_name)      as service_type_name     --服务类型id名\\n      ,max(sub_org_name) as sub_org_name  --机构名称\\n      ,max(org_id)       as org_id        --集团id\\n      ,max(org_name)     as org_name      --集团名称\\n      ,sum(cost)         as cost_day                          --服务总费用\\n      ,sum(1)            as service_num_day                   --服务数\\n      ,count(distinct old_man_id) as old_man_num_day --养老院老人数\\n      ,sum(case when settlement_status =  2 then 1 else 0 end ) as  already_settle_service_num     --已结算服务数\\n      ,sum(case when settlement_status =  3 then 1 else 0 end ) as  no_settle_service_num          --未结算服务数\\n      ,sum(case when service_status = 1  then 1 else 0 end )    as  wait_complete_service_num      --待完成服务数\\n      ,sum(case when service_status = 2  then 1 else 0 end )    as  complete_service_num           --已完成服务数\\n      ,sum(case when service_status = 3  then 1 else 0 end )    as  evaluation_service_num         --已评价服务数\\n      ,sum(case when evaluation_status = 0  then 1 else 0 end ) as  evaluation_wait_num            --待评价服务数\\n      ,sum(case when evaluation_status = 1  then 1 else 0 end ) as  evaluation_good_num            --好评数\\n      ,sum(case when evaluation_status = 2  then 1 else 0 end ) as  evaluation_middle_num          --中评数\\n      ,sum(case when evaluation_status = 3  then 1 else 0 end ) as  evaluation_bad_num             --差评数\\n      ,substr(create_time,1,10) as date_time\\n  from db_dw_hr.clife_hr_dwd_service_record_info\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by service_project_id\\n          ,sub_org_id\\n          ,service_type\\n          ,substr(create_time,1,10)\\n)t\\n\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_service_record_by_spst\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-50d1lm\",\"name\":\"clife_hr_dws_service_record_by_nhmonth\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_service_record_by_nhmonth partition(part_date)\\nselect\\n     nursin_homes_id  --养老院id\\n    ,service_type     --服务类型（增值or基础）\\n    ,nursing_homes_name    --养老院名称\\n    ,sub_org_id    --机构id\\n    ,sub_org_name  --机构名称\\n    ,org_id        --集团id\\n    ,org_name      --集团名称\\n    ,old_man_num_month    --养老院老人数\\n    ,cost_month                    --服务总费用\\n    ,service_num_month             --服务数\\n    ,already_settle_service_num    --已结算服务数\\n    ,no_settle_service_num         --未结算服务数\\n    ,wait_complete_service_num     --待完成服务数\\n    ,complete_service_num          --已完成服务数\\n    ,evaluation_service_num        --已评价服务数\\n    ,evaluation_wait_num           --待评价服务数\\n    ,evaluation_good_num           --好评数\\n    ,evaluation_middle_num         --中评数\\n    ,evaluation_bad_num            --差评数\\n    ,coalesce(cost_month/old_man_num_month,0) as recharge_avg_month                --人均服务费\\n    ,coalesce(service_num_month/old_man_num_month,0) as member_recharge_avg_month  --人均服务数\\n    ,date_month\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date  --分区日期\\nfrom\\n(\\n   select\\n        nursin_homes_id        --养老院id\\n       ,service_type           --服务类型（增值or基础）\\n       ,max(nursing_homes_name) as nursing_homes_name --养老院名称\\n       ,max(sub_org_id)         as sub_org_id--机构id\\n       ,max(sub_org_name)       as sub_org_name--机构名称\\n       ,max(org_id)             as org_id--集团id\\n       ,max(org_name)           as org_name--集团名称\\n       ,sum(old_man_num_day)            as old_man_num_month              --养老院老人数\\n       ,sum(cost_day)                   as cost_month                     --服务总费用\\n       ,sum(service_num_day)            as service_num_month              --服务数\\n       ,sum(already_settle_service_num) as already_settle_service_num     --已结算服务数\\n       ,sum(no_settle_service_num)      as no_settle_service_num          --未结算服务数\\n       ,sum(wait_complete_service_num)  as wait_complete_service_num      --待完成服务数\\n       ,sum(complete_service_num)       as complete_service_num           --已完成服务数\\n       ,sum(evaluation_service_num)     as evaluation_service_num         --已评价服务数\\n       ,sum(evaluation_wait_num)        as evaluation_wait_num            --待评价服务数\\n       ,sum(evaluation_good_num)        as evaluation_good_num            --好评数\\n       ,sum(evaluation_middle_num)      as evaluation_middle_num          --中评数\\n       ,sum(evaluation_bad_num)         as evaluation_bad_num             --差评数\\n       ,substr(date_time,1,7) as date_month\\n   from db_dw_hr.clife_hr_dws_service_record_by_nhday\\n   where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n   group by nursin_homes_id\\n           ,service_type\\n           ,substr(date_time,1,7)\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_service_record_by_nhday\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-6gn570\",\"name\":\"clife_hr_dws_service_record_by_nhome\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_service_record_by_nhome partition(part_date)\\nselect\\n     a.nursin_homes_id  --养老院id\\n    ,a.service_type     --服务类型（增值or基础）\\n    ,a.nursing_homes_name    --养老院名称\\n    ,a.sub_org_id    --机构id\\n    ,a.sub_org_name  --机构名称\\n    ,a.org_id        --集团id\\n    ,a.org_name      --集团名称\\n    ,b.old_man_num    --养老院老人数\\n    ,a.cost                          --服务总费用\\n    ,a.service_cnt                   --服务数\\n    ,a.already_settle_service_num    --已结算服务数\\n    ,a.no_settle_service_num         --未结算服务数\\n    ,a.wait_complete_service_num     --待完成服务数\\n    ,a.complete_service_num          --已完成服务数\\n    ,a.evaluation_service_num        --已评价服务数\\n    ,a.evaluation_wait_num           --待评价服务数\\n    ,a.evaluation_good_num           --好评数\\n    ,a.evaluation_middle_num         --中评数\\n    ,a.evaluation_bad_num            --差评数\\n    ,coalesce(a.cost/b.old_man_num,0) as recharge_avg_day --人均服务费\\n    ,coalesce(a.service_cnt/b.old_man_num,0) as member_recharge_avg_day  --人均服务数\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date  --分区日期\\nfrom\\n(\\n  select\\n       nursin_homes_id  --养老院id\\n      ,service_type     --服务类型（增值or基础）\\n      ,max(nursing_homes_name)   as nursing_homes_name    --养老院名称\\n      ,max(sub_org_id)   as sub_org_id    --机构id\\n      ,max(sub_org_name) as sub_org_name  --机构名称\\n      ,max(org_id)       as org_id        --集团id\\n      ,max(org_name)     as org_name      --集团名称\\n      ,sum(cost)                       as cost                          --服务总费用\\n      ,sum(service_cnt)                as service_cnt                   --服务数\\n      ,sum(already_settle_service_num) as already_settle_service_num    --已结算服务数\\n      ,sum(no_settle_service_num)      as no_settle_service_num         --未结算服务数\\n      ,sum(wait_complete_service_num)  as wait_complete_service_num     --待完成服务数\\n      ,sum(complete_service_num)       as complete_service_num          --已完成服务数\\n      ,sum(evaluation_service_num)     as evaluation_service_num        --已评价服务数\\n      ,sum(evaluation_wait_num)        as evaluation_wait_num           --待评价服务数\\n      ,sum(evaluation_good_num)        as evaluation_good_num           --好评数\\n      ,sum(evaluation_middle_num)      as evaluation_middle_num         --中评数\\n      ,sum(evaluation_bad_num)         as evaluation_bad_num            --差评数\\n  from db_dw_hr.clife_hr_dwm_service_record_aggregation\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by  nursin_homes_id\\n           ,service_type\\n)a\\nleft join \\n(\\n  select\\n       nursin_homes_id  --养老院id\\n      ,service_type     --服务类型（增值or基础）\\n      ,count(distinct old_man_id) as old_man_num --养老院老人数\\n  from db_dw_hr.clife_hr_dwd_service_record_info\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by  nursin_homes_id\\n           ,service_type\\n)b on a.nursin_homes_id = b.nursin_homes_id and a.service_type = b.service_type\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_service_record_by_spstyear\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-3b9ah\",\"name\":\"clife_hr_dws_plan_snapshot_by_protypemonth\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_plan_snapshot_by_protypemonth partition(part_date)\\nselect\\n     sub_org_id         --机构id\\n    ,project_type_id    --项目类型id\\n    ,project_type_name  --项目类型名称\\n    ,sub_org_name       --机构名称\\n    ,org_id             --集团id\\n    ,org_name           --集团名称\\n    ,plan_num_month  --计划总数\\n    ,item_num_month  --任务总数\\n    ,complete_num_month --完成任务数\\n    ,coalesce(complete_num_month/item_num_month,0) as complete_rate_month --完成率\\n    ,date_month --月份\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --分区日期\\nfrom\\n(\\n  select\\n       sub_org_id        --机构id\\n      ,project_type_id    --项目类型id\\n      ,max(project_type_name)as project_type_name  --项目类型名称\\n      ,max(sub_org_name)     as sub_org_name       --机构名称\\n      ,max(org_id)           as org_id             --集团id\\n      ,max(org_name)         as org_name           --集团名称\\n      ,sum(plan_num_day) as plan_num_month  --计划总数\\n      ,sum(item_num_day) as item_num_month  --任务总数\\n      ,sum(complete_num_day) as complete_num_month --完成任务数\\n      ,substr(date_time,1,7) as date_month --月份\\n  from db_dw_hr.clife_hr_dws_plan_snapshot_by_protypeday\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by project_type_id\\n           ,sub_org_id\\n           ,substr(date_time,1,7)\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_plan_snapshot_by_protypeday\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-7kbzz\",\"name\":\"clife_hr_dws_plan_snapshot_by_protype\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_plan_snapshot_by_protype partition(part_date)\\nselect\\n     sub_org_id         --机构id\\n    ,project_type_id    --项目类型id\\n    ,project_type_name  --项目类型名称\\n    ,sub_org_name       --机构名称\\n    ,org_id             --集团id\\n    ,org_name           --集团名称\\n    ,plan_num  --计划总数\\n    ,item_num  --任务总数\\n    ,complete_num --完成任务数\\n    ,coalesce(complete_num/item_num,0) as complete_rate --完成率\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --分区日期\\nfrom\\n(\\n   select\\n        sub_org_id        --机构id\\n       ,project_type_id   --项目类型id\\n       ,max(project_type_name)as project_type_name  --项目类型名称\\n       ,max(sub_org_name)     as sub_org_name       --机构名称\\n       ,max(org_id)           as org_id             --集团id\\n       ,max(org_name)         as org_name           --集团名称\\n       ,count(exec_date) as plan_num  --计划总数\\n       ,count(1) as  item_num  --任务总数\\n       ,sum(case when complete_stase = 1 then 1 else 0 end) as complete_num --完成任务数\\n   from db_dw_hr.clife_hr_dwd_plan_snapshot_info\\n   where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n   group by project_type_id\\n           ,sub_org_id  \\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_plan_snapshot_by_proyear\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-42453d\",\"name\":\"clife_hr_dws_plan_snapshot_by_promonth\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_plan_snapshot_by_promonth partition(part_date)\\nselect\\n     project_id         --项目id\\n    ,sub_org_id         --机构id\\n    ,project_name       --项目名称\\n    ,project_type_id    --项目类型id\\n    ,project_type_name  --项目类型名称\\n    ,sub_org_name       --机构名称\\n    ,org_id             --集团id\\n    ,org_name           --集团名称\\n    ,plan_num_month  --计划总数\\n    ,item_num_month  --任务总数\\n    ,complete_num_month --完成任务数\\n    ,coalesce(complete_num_month/item_num_month,0) as complete_rate_month --完成率\\n    ,date_month --月份\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --分区日期\\nfrom\\n(\\n  select\\n       project_id        --项目id\\n      ,sub_org_id        --机构id\\n      ,max(project_name)     as project_name       --项目名称\\n      ,max(project_type_id)  as project_type_id    --项目类型id\\n      ,max(project_type_name)as project_type_name  --项目类型名称\\n      ,max(sub_org_name)     as sub_org_name       --机构名称\\n      ,max(org_id)           as org_id             --集团id\\n      ,max(org_name)         as org_name           --集团名称\\n      ,sum(plan_num_day) as plan_num_month  --计划总数\\n      ,sum(item_num_day) as item_num_month  --任务总数\\n      ,sum(complete_num_day) as complete_num_month --完成任务数\\n      ,substr(date_time,1,7) as date_month --月份\\n  from db_dw_hr.clife_hr_dws_plan_snapshot_by_proday\\n  where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n  group by project_id\\n           ,sub_org_id\\n           ,substr(date_time,1,7)\\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_plan_snapshot_by_proday\"]},{\"type\":\"SQL\",\"id\":\"tasks-2-15u6z0\",\"name\":\"clife_hr_dws_plan_snapshot_by_project\",\"params\":{\"type\":\"HIVE\",\"datasource\":104,\"sql\":\"insert overwrite table db_dw_hr.clife_hr_dws_plan_snapshot_by_project partition(part_date)\\nselect\\n     project_id         --项目id\\n    ,sub_org_id         --机构id\\n    ,project_name       --项目名称\\n    ,project_type_id    --项目类型id\\n    ,project_type_name  --项目类型名称\\n    ,sub_org_name       --机构名称\\n    ,org_id             --集团id\\n    ,org_name           --集团名称\\n    ,plan_num  --计划总数\\n    ,item_num  --任务总数\\n    ,complete_num --完成任务数\\n    ,coalesce(complete_num/item_num,0) as complete_rate --完成率\\n    ,regexp_replace(date_sub(current_date(),1),'-','') as part_date --分区日期\\nfrom\\n(\\n   select\\n        project_id        --项目id\\n       ,sub_org_id        --机构id\\n       ,max(project_name)     as project_name       --项目名称\\n       ,max(project_type_id)  as project_type_id    --项目类型id\\n       ,max(project_type_name)as project_type_name  --项目类型名称\\n       ,max(sub_org_name)     as sub_org_name       --机构名称\\n       ,max(org_id)           as org_id             --集团id\\n       ,max(org_name)         as org_name           --集团名称\\n       ,count(exec_date) as plan_num  --计划总数\\n       ,count(1) as  item_num  --任务总数\\n       ,sum(case when complete_stase = 1 then 1 else 0 end) as complete_num --完成任务数\\n   from db_dw_hr.clife_hr_dwd_plan_snapshot_info\\n   where part_date=regexp_replace(date_sub(current_date(),1),'-','')\\n   group by project_id\\n           ,sub_org_id  \\n)t\",\"udfs\":\"\",\"sqlType\":\"1\",\"title\":\"\",\"receivers\":\"\",\"receiversCc\":\"\",\"showType\":\"TABLE\",\"localParams\":[],\"connParams\":\"hive.exec.dynamic.partition=true;hive.exec.dynamic.partition.mode=nonstrict;\",\"preStatements\":[],\"postStatements\":[]},\"description\":\"\",\"runFlag\":\"NORMAL\",\"conditionResult\":{\"successNode\":[\"\"],\"failedNode\":[\"\"]},\"dependence\":{},\"maxRetryTimes\":\"0\",\"retryInterval\":\"1\",\"timeout\":{\"strategy\":\"\",\"interval\":null,\"enable\":false},\"taskInstancePriority\":\"MEDIUM\",\"workerGroup\":-1,\"preTasks\":[\"clife_hr_dws_service_record_by_nhyear\"]}],\"tenantId\":-1,\"timeout\":0}",
			"description": "华润数仓汇总层",
			"globalParams": "[]",
			"globalParamList": [],
			"globalParamMap": {},
			"createTime": "2021-07-22T01:59:39.000+0000",
			"updateTime": "2021-07-28T12:08:33.000+0000",
			"flag": "YES",
			"userId": 143,
			"userName": "shucang0907",
			"projectName": null,
			"locations": "{\"tasks-29812\":{\"name\":\"clife_hr_customer_crm_visit_base_info_tmp\",\"targetarr\":\"tasks-84421\",\"nodenumber\":\"0\",\"x\":340,\"y\":120},\"tasks-84421\":{\"name\":\"drop_clife_hr_customer_crm_visit_base_info_tmp\",\"targetarr\":\"\",\"nodenumber\":\"0\",\"x\":170,\"y\":120},\"tasks-73988\":{\"name\":\"clife_hr_dws_market_by_sub_org_f\",\"targetarr\":\"tasks-29812\",\"nodenumber\":\"0\",\"x\":510,\"y\":120},\"tasks-14647\":{\"name\":\"clife_hr_dws_market_by_sub_org_d_tmp\",\"targetarr\":\"tasks-5-13m4j4\",\"nodenumber\":\"0\",\"x\":850,\"y\":120},\"tasks-55309\":{\"name\":\"clife_hr_dws_market_by_sub_org_d\",\"targetarr\":\"tasks-14647\",\"nodenumber\":\"0\",\"x\":1020,\"y\":120},\"tasks-5-13m4j4\":{\"name\":\"drop_clife_hr_dws_market_by_sub_org_d_tmp\",\"targetarr\":\"tasks-73988\",\"nodenumber\":\"0\",\"x\":680,\"y\":120},\"tasks-69565\":{\"name\":\"drop_clife_hr_dws_market_by_sub_org_m_tmp\",\"targetarr\":\"tasks-55309\",\"nodenumber\":\"0\",\"x\":1190,\"y\":120},\"tasks-59070\":{\"name\":\"clife_hr_dws_market_by_sub_org_m_tmp\",\"targetarr\":\"tasks-69565\",\"nodenumber\":\"0\",\"x\":1360,\"y\":120},\"tasks-28229\":{\"name\":\"clife_hr_dws_market_by_sub_org_m\",\"targetarr\":\"tasks-59070\",\"nodenumber\":\"0\",\"x\":1530,\"y\":120},\"tasks-13268\":{\"name\":\"clife_hr_dws_market_by_sub_org_y_tmp\",\"targetarr\":\"tasks-9297\",\"nodenumber\":\"0\",\"x\":1870,\"y\":120},\"tasks-9297\":{\"name\":\"drop_clife_hr_dws_market_by_sub_org_y_tmp\",\"targetarr\":\"tasks-28229\",\"nodenumber\":\"0\",\"x\":1700,\"y\":120},\"tasks-38171\":{\"name\":\"clife_hr_dws_market_by_sub_org_y\",\"targetarr\":\"tasks-13268\",\"nodenumber\":\"0\",\"x\":2040,\"y\":120},\"tasks-26239\":{\"name\":\"clife_hr_dws_market_by_channel_f\",\"targetarr\":\"tasks-38171\",\"nodenumber\":\"0\",\"x\":2210,\"y\":120},\"tasks-93545\":{\"name\":\"clife_hr_dws_market_by_channel_d_tmp\",\"targetarr\":\"tasks-50210\",\"nodenumber\":\"0\",\"x\":2550,\"y\":120},\"tasks-50210\":{\"name\":\"drop_clife_hr_dws_market_by_channel_d_tmp\",\"targetarr\":\"tasks-26239\",\"nodenumber\":\"0\",\"x\":2380,\"y\":120},\"tasks-18848\":{\"name\":\"clife_hr_dws_market_by_channel_d\",\"targetarr\":\"tasks-93545\",\"nodenumber\":\"0\",\"x\":2720,\"y\":120},\"tasks-60591\":{\"name\":\"clife_hr_dws_market_by_channel_m_tmp\",\"targetarr\":\"tasks-27447\",\"nodenumber\":\"0\",\"x\":3060,\"y\":120},\"tasks-27447\":{\"name\":\"drop_clife_hr_dws_market_by_channel_m_tmp\",\"targetarr\":\"tasks-18848\",\"nodenumber\":\"0\",\"x\":2890,\"y\":120},\"tasks-84782\":{\"name\":\"clife_hr_dws_market_by_channel_m\",\"targetarr\":\"tasks-60591\",\"nodenumber\":\"0\",\"x\":3230,\"y\":120},\"tasks-95409\":{\"name\":\"clife_hr_dws_market_by_adv_member_d_tmp\",\"targetarr\":\"tasks-91762\",\"nodenumber\":\"0\",\"x\":4250,\"y\":120},\"tasks-91762\":{\"name\":\"drop_clife_hr_dws_market_by_adv_member_d_tmp\",\"targetarr\":\"tasks-8-5as76q\",\"nodenumber\":\"0\",\"x\":4080,\"y\":120},\"tasks-56748\":{\"name\":\"clife_hr_dws_market_by_adv_member_d\",\"targetarr\":\"tasks-95409\",\"nodenumber\":\"0\",\"x\":4420,\"y\":120},\"tasks-67054\":{\"name\":\"clife_hr_dws_market_by_adv_member_m_tmp\",\"targetarr\":\"tasks-38397\",\"nodenumber\":\"0\",\"x\":4760,\"y\":120},\"tasks-38397\":{\"name\":\"drop_clife_hr_dws_market_by_adv_member_m_tmp\",\"targetarr\":\"tasks-56748\",\"nodenumber\":\"0\",\"x\":4590,\"y\":120},\"tasks-99738\":{\"name\":\"clife_hr_dws_market_by_adv_member_m\",\"targetarr\":\"tasks-67054\",\"nodenumber\":\"0\",\"x\":4930,\"y\":120},\"tasks-74043\":{\"name\":\"clife_hr_dws_market_by_adv_member_y_tmp\",\"targetarr\":\"tasks-75049\",\"nodenumber\":\"0\",\"x\":5270,\"y\":120},\"tasks-75049\":{\"name\":\"drop_clife_hr_dws_market_by_adv_member_y_tmp\",\"targetarr\":\"tasks-99738\",\"nodenumber\":\"0\",\"x\":5100,\"y\":120},\"tasks-66049\":{\"name\":\"clife_hr_dws_market_by_adv_member_y\",\"targetarr\":\"tasks-74043\",\"nodenumber\":\"0\",\"x\":5440,\"y\":120},\"tasks-56289\":{\"name\":\"clife_hr_dws_crm_cust_building_info_tmp\",\"targetarr\":\"tasks-27310\",\"nodenumber\":\"0\",\"x\":5780,\"y\":120},\"tasks-27310\":{\"name\":\"drop_clife_hr_dws_crm_cust_building_info_tmp\",\"targetarr\":\"tasks-66049\",\"nodenumber\":\"0\",\"x\":5610,\"y\":120},\"tasks-4419\":{\"name\":\"clife_hr_dws_crm_member_building_info_tmp\",\"targetarr\":\"tasks-57976\",\"nodenumber\":\"0\",\"x\":6120,\"y\":120},\"tasks-57976\":{\"name\":\"drop_clife_hr_dws_crm_member_building_info_tmp\",\"targetarr\":\"tasks-56289\",\"nodenumber\":\"0\",\"x\":5950,\"y\":120},\"tasks-29712\":{\"name\":\"clife_hr_dws_market_by_building_f\",\"targetarr\":\"tasks-4419\",\"nodenumber\":\"0\",\"x\":6290,\"y\":120},\"tasks-37471\":{\"name\":\"clife_hr_customer_crm_visit_building_info_tmp\",\"targetarr\":\"tasks-81839\",\"nodenumber\":\"0\",\"x\":6630,\"y\":120},\"tasks-81839\":{\"name\":\"drop_clife_hr_customer_crm_visit_building_info_tmp\",\"targetarr\":\"tasks-29712\",\"nodenumber\":\"0\",\"x\":6460,\"y\":120},\"tasks-18930\":{\"name\":\"clife_hr_dws_market_by_building_d_tmp\",\"targetarr\":\"tasks-5428\",\"nodenumber\":\"0\",\"x\":6970,\"y\":120},\"tasks-5428\":{\"name\":\"drop_clife_hr_dws_market_by_building_d_tmp\",\"targetarr\":\"tasks-37471\",\"nodenumber\":\"0\",\"x\":6800,\"y\":120},\"tasks-24960\":{\"name\":\"clife_hr_dws_market_by_building_d\",\"targetarr\":\"tasks-18930\",\"nodenumber\":\"0\",\"x\":7140,\"y\":120},\"tasks-12222\":{\"name\":\"clife_hr_dws_market_by_building_m_tmp\",\"targetarr\":\"tasks-15896\",\"nodenumber\":\"0\",\"x\":7480,\"y\":120},\"tasks-15896\":{\"name\":\"drop_clife_hr_dws_market_by_building_m_tmp\",\"targetarr\":\"tasks-24960\",\"nodenumber\":\"0\",\"x\":7310,\"y\":120},\"tasks-41791\":{\"name\":\"clife_hr_dws_market_by_building_m\",\"targetarr\":\"tasks-12222\",\"nodenumber\":\"0\",\"x\":7650,\"y\":120},\"tasks-42924\":{\"name\":\"clife_hr_dws_market_by_building_y_tmp\",\"targetarr\":\"tasks-99336\",\"nodenumber\":\"0\",\"x\":7990,\"y\":120},\"tasks-99336\":{\"name\":\"drop_clife_hr_dws_market_by_building_y_tmp\",\"targetarr\":\"tasks-41791\",\"nodenumber\":\"0\",\"x\":7820,\"y\":120},\"tasks-1537\":{\"name\":\"clife_hr_dws_market_by_building_y\",\"targetarr\":\"tasks-42924\",\"nodenumber\":\"0\",\"x\":8160,\"y\":120},\"tasks-39966\":{\"name\":\"clife_hr_dws_crm_cust_room_type_info_tmp\",\"targetarr\":\"tasks-7440\",\"nodenumber\":\"0\",\"x\":8500,\"y\":120},\"tasks-7440\":{\"name\":\"drop_clife_hr_dws_crm_cust_room_type_info_tmp\",\"targetarr\":\"tasks-1537\",\"nodenumber\":\"0\",\"x\":8330,\"y\":120},\"tasks-66089\":{\"name\":\"clife_hr_dws_crm_member_room_type_info_tmp\",\"targetarr\":\"tasks-47544\",\"nodenumber\":\"0\",\"x\":8840,\"y\":120},\"tasks-47544\":{\"name\":\"drop_clife_hr_dws_crm_member_room_type_info_tmp\",\"targetarr\":\"tasks-39966\",\"nodenumber\":\"0\",\"x\":8670,\"y\":120},\"tasks-62219\":{\"name\":\"clife_hr_dws_market_by_room_type_f\",\"targetarr\":\"tasks-66089\",\"nodenumber\":\"0\",\"x\":9010,\"y\":120},\"tasks-7529\":{\"name\":\"clife_hr_dws_market_by_room_type_d_tmp\",\"targetarr\":\"tasks-96671\",\"nodenumber\":\"0\",\"x\":9350,\"y\":120},\"tasks-96671\":{\"name\":\"drop_clife_hr_dws_market_by_room_type_d_tmp\",\"targetarr\":\"tasks-62219\",\"nodenumber\":\"0\",\"x\":9180,\"y\":120},\"tasks-51556\":{\"name\":\"clife_hr_dws_market_by_room_type_d\",\"targetarr\":\"tasks-7529\",\"nodenumber\":\"0\",\"x\":9520,\"y\":120},\"tasks-88432\":{\"name\":\"clife_hr_dws_market_by_room_type_m_tmp\",\"targetarr\":\"tasks-64081\",\"nodenumber\":\"0\",\"x\":9860,\"y\":120},\"tasks-64081\":{\"name\":\"drop_clife_hr_dws_market_by_room_type_m_tmp\",\"targetarr\":\"tasks-51556\",\"nodenumber\":\"0\",\"x\":9690,\"y\":120},\"tasks-99423\":{\"name\":\"clife_hr_dws_market_by_room_type_m\",\"targetarr\":\"tasks-88432\",\"nodenumber\":\"0\",\"x\":10030,\"y\":120},\"tasks-84872\":{\"name\":\"clife_hr_dws_market_by_room_type_y_tmp\",\"targetarr\":\"tasks-94231\",\"nodenumber\":\"0\",\"x\":10370,\"y\":120},\"tasks-94231\":{\"name\":\"drop_clife_hr_dws_market_by_room_type_y_tmp\",\"targetarr\":\"tasks-99423\",\"nodenumber\":\"0\",\"x\":10200,\"y\":120},\"tasks-5846\":{\"name\":\"clife_hr_dws_market_by_room_type_y\",\"targetarr\":\"tasks-84872\",\"nodenumber\":\"0\",\"x\":10540,\"y\":120},\"tasks-83573\":{\"name\":\"clife_hr_dws_crm_cust_card_info_tmp\",\"targetarr\":\"tasks-847\",\"nodenumber\":\"0\",\"x\":10880,\"y\":120},\"tasks-847\":{\"name\":\"drop_clife_hr_dws_crm_cust_card_info_tmp\",\"targetarr\":\"tasks-5846\",\"nodenumber\":\"0\",\"x\":10710,\"y\":120},\"tasks-85611\":{\"name\":\"clife_hr_dws_crm_member_card_info_tmp\",\"targetarr\":\"tasks-83622\",\"nodenumber\":\"0\",\"x\":11220,\"y\":120},\"tasks-83622\":{\"name\":\"drop_clife_hr_dws_crm_member_card_info_tmp\",\"targetarr\":\"tasks-83573\",\"nodenumber\":\"0\",\"x\":11050,\"y\":120},\"tasks-18847\":{\"name\":\"clife_hr_dws_crm_room_card_info_tmp\",\"targetarr\":\"tasks-23066\",\"nodenumber\":\"0\",\"x\":11560,\"y\":120},\"tasks-23066\":{\"name\":\"drop_clife_hr_dws_crm_room_card_info_tmp\",\"targetarr\":\"tasks-85611\",\"nodenumber\":\"0\",\"x\":11390,\"y\":120},\"tasks-80190\":{\"name\":\"clife_hr_dws_market_by_card_f\",\"targetarr\":\"tasks-18847\",\"nodenumber\":\"0\",\"x\":11730,\"y\":120},\"tasks-19622\":{\"name\":\"clife_hr_dws_market_by_card_d_tmp\",\"targetarr\":\"tasks-40939\",\"nodenumber\":\"0\",\"x\":12070,\"y\":120},\"tasks-40939\":{\"name\":\"drop_clife_hr_dws_market_by_card_d_tmp\",\"targetarr\":\"tasks-80190\",\"nodenumber\":\"0\",\"x\":11900,\"y\":120},\"tasks-7211\":{\"name\":\"clife_hr_dws_market_by_card_d\",\"targetarr\":\"tasks-19622\",\"nodenumber\":\"0\",\"x\":12240,\"y\":120},\"tasks-98151\":{\"name\":\"clife_hr_dws_market_by_card_m_tmp\",\"targetarr\":\"tasks-87302\",\"nodenumber\":\"0\",\"x\":12580,\"y\":120},\"tasks-87302\":{\"name\":\"drop_clife_hr_dws_market_by_card_m_tmp\",\"targetarr\":\"tasks-7211\",\"nodenumber\":\"0\",\"x\":12410,\"y\":120},\"tasks-15659\":{\"name\":\"clife_hr_dws_market_by_card_m\",\"targetarr\":\"tasks-98151\",\"nodenumber\":\"0\",\"x\":12750,\"y\":120},\"tasks-47236\":{\"name\":\"clife_hr_dws_market_by_card_y_tmp\",\"targetarr\":\"tasks-70861\",\"nodenumber\":\"0\",\"x\":13090,\"y\":120},\"tasks-70861\":{\"name\":\"drop_clife_hr_dws_market_by_card_y_tmp\",\"targetarr\":\"tasks-15659\",\"nodenumber\":\"0\",\"x\":12920,\"y\":120},\"tasks-6146\":{\"name\":\"clife_hr_dws_market_by_card_y\",\"targetarr\":\"tasks-47236\",\"nodenumber\":\"0\",\"x\":13260,\"y\":120},\"tasks-49954\":{\"name\":\"clife_hr_dws_crm_cust_card_type_info_tmp\",\"targetarr\":\"tasks-87956\",\"nodenumber\":\"0\",\"x\":13600,\"y\":120},\"tasks-87956\":{\"name\":\"drop_clife_hr_dws_crm_cust_card_type_info_tmp\",\"targetarr\":\"tasks-6146\",\"nodenumber\":\"0\",\"x\":13430,\"y\":120},\"tasks-58772\":{\"name\":\"clife_hr_dws_crm_member_card_type_info_tmp\",\"targetarr\":\"tasks-31809\",\"nodenumber\":\"0\",\"x\":13940,\"y\":120},\"tasks-31809\":{\"name\":\"drop_clife_hr_dws_crm_member_card_type_info_tmp\",\"targetarr\":\"tasks-49954\",\"nodenumber\":\"0\",\"x\":13770,\"y\":120},\"tasks-9606\":{\"name\":\"clife_hr_dws_crm_room_card_type_info_tmp\",\"targetarr\":\"tasks-3932\",\"nodenumber\":\"0\",\"x\":14280,\"y\":120},\"tasks-3932\":{\"name\":\"drop_clife_hr_dws_crm_room_card_type_info_tmp\",\"targetarr\":\"tasks-58772\",\"nodenumber\":\"0\",\"x\":14110,\"y\":120},\"tasks-80915\":{\"name\":\"clife_hr_dws_market_by_card_type_f\",\"targetarr\":\"tasks-9606\",\"nodenumber\":\"0\",\"x\":14450,\"y\":120},\"tasks-21332\":{\"name\":\"clife_hr_dws_market_by_card_type_d_tmp\",\"targetarr\":\"tasks-65872\",\"nodenumber\":\"0\",\"x\":14790,\"y\":120},\"tasks-65872\":{\"name\":\"drop_clife_hr_dws_market_by_card_type_d_tmp\",\"targetarr\":\"tasks-80915\",\"nodenumber\":\"0\",\"x\":14620,\"y\":120},\"tasks-4185\":{\"name\":\"clife_hr_dws_market_by_card_type_d\",\"targetarr\":\"tasks-21332\",\"nodenumber\":\"0\",\"x\":14960,\"y\":120},\"tasks-41851\":{\"name\":\"clife_hr_dws_market_by_card_type_m_tmp\",\"targetarr\":\"tasks-48398\",\"nodenumber\":\"0\",\"x\":15300,\"y\":120},\"tasks-48398\":{\"name\":\"drop_clife_hr_dws_market_by_card_type_m_tmp\",\"targetarr\":\"tasks-4185\",\"nodenumber\":\"0\",\"x\":15130,\"y\":120},\"tasks-28890\":{\"name\":\"clife_hr_dws_market_by_card_type_m\",\"targetarr\":\"tasks-41851\",\"nodenumber\":\"0\",\"x\":15470,\"y\":120},\"tasks-98070\":{\"name\":\"clife_hr_dws_market_by_card_type_y_tmp\",\"targetarr\":\"tasks-30269\",\"nodenumber\":\"0\",\"x\":15810,\"y\":120},\"tasks-30269\":{\"name\":\"drop_clife_hr_dws_market_by_card_type_y_tmp\",\"targetarr\":\"tasks-28890\",\"nodenumber\":\"0\",\"x\":15640,\"y\":120},\"tasks-39298\":{\"name\":\"clife_hr_dws_market_by_card_type_y\",\"targetarr\":\"tasks-98070\",\"nodenumber\":\"0\",\"x\":15980,\"y\":120},\"tasks-89930\":{\"name\":\"clife_hr_dws_market_by_channel_y_tmp\",\"targetarr\":\"tasks-44426\",\"nodenumber\":\"0\",\"x\":3570,\"y\":120},\"tasks-44426\":{\"name\":\"drop_clife_hr_dws_market_by_channel_y_tmp\",\"targetarr\":\"tasks-84782\",\"nodenumber\":\"0\",\"x\":3400,\"y\":120},\"tasks-8-5as76q\":{\"name\":\"clife_hr_dws_market_by_adv_member_f\",\"targetarr\":\"tasks-34807\",\"nodenumber\":\"0\",\"x\":3910,\"y\":120},\"tasks-34807\":{\"name\":\"clife_hr_dws_market_by_channel_y\",\"targetarr\":\"tasks-89930\",\"nodenumber\":\"0\",\"x\":3740,\"y\":120},\"tasks-2-nb675\":{\"name\":\"clife_hr_dws_reside_manage_by_soday\",\"targetarr\":\"tasks-2-44h4du\",\"nodenumber\":\"3\",\"x\":727,\"y\":470},\"tasks-2-hpbt\":{\"name\":\"clife_hr_dws_reside_manage_by_fday\",\"targetarr\":\"\",\"nodenumber\":\"2\",\"x\":77,\"y\":468},\"tasks-2-6vmi\":{\"name\":\"clife_hr_dws_activity_manage_by_soday\",\"targetarr\":\"tasks-2-1w33a7\",\"nodenumber\":\"2\",\"x\":3284,\"y\":715},\"tasks-2-6w31nd\":{\"name\":\"clife_hr_dws_plan_snapshot_by_protypeyear\",\"targetarr\":\"tasks-2-3b9ah\",\"nodenumber\":\"1\",\"x\":854,\"y\":908},\"tasks-2-3v453v\":{\"name\":\"clife_hr_dws_plan_snapshot_by_protypeday\",\"targetarr\":\"tasks-2-7kbzz\",\"nodenumber\":\"2\",\"x\":308,\"y\":902},\"tasks-2-a91ir\":{\"name\":\"clife_hr_dws_plan_snapshot_by_proyear\",\"targetarr\":\"tasks-2-42453d\",\"nodenumber\":\"2\",\"x\":62,\"y\":691},\"tasks-2-61ets\":{\"name\":\"clife_hr_dws_plan_snapshot_by_proday\",\"targetarr\":\"tasks-2-15u6z0\",\"nodenumber\":\"2\",\"x\":591,\"y\":688},\"tasks-2-241cg\":{\"name\":\"clife_hr_dws_service_record_by_spstmonth\",\"targetarr\":\"tasks-2-bc626\",\"nodenumber\":\"2\",\"x\":2118,\"y\":693},\"tasks-2-7mv1b9\":{\"name\":\"clife_hr_dws_service_record_by_spst\",\"targetarr\":\"tasks-2-5vr48i\",\"nodenumber\":\"2\",\"x\":2552,\"y\":697},\"tasks-2-213ig\":{\"name\":\"clife_hr_dws_service_record_by_nhyear\",\"targetarr\":\"tasks-2-50d1lm\",\"nodenumber\":\"2\",\"x\":1059,\"y\":692},\"tasks-2-6ut5gn\":{\"name\":\"clife_hr_dws_coupon_manage_by_nhyear\",\"targetarr\":\"tasks-2-61ilp\",\"nodenumber\":\"3\",\"x\":4663,\"y\":736},\"tasks-2-5jy2u0\":{\"name\":\"clife_hr_dws_activity_manage_by_somonth\",\"targetarr\":\"tasks-2-6vmi\",\"nodenumber\":\"1\",\"x\":3030,\"y\":716},\"tasks-2-5vr48i\":{\"name\":\"clife_hr_dws_activity_manage_by_soyear\",\"targetarr\":\"tasks-2-5jy2u0\",\"nodenumber\":\"2\",\"x\":2772,\"y\":701},\"tasks-2-1lu6z1\":{\"name\":\"clife_hr_dws_activity_manage_by_nhyear\",\"targetarr\":\"tasks-2-5ri10h\",\"nodenumber\":\"2\",\"x\":3739,\"y\":718},\"tasks-2-56q5sb\":{\"name\":\"clife_hr_dws_reside_manage_by_somonth\",\"targetarr\":\"tasks-2-7om5z8\",\"nodenumber\":\"2\",\"x\":3205,\"y\":472},\"tasks-2-2d55xf\":{\"name\":\"clife_hr_dws_reside_manage_by_nhyear\",\"targetarr\":\"tasks-2-53l7gb\",\"nodenumber\":\"2\",\"x\":2780,\"y\":475},\"tasks-2-53l7gb\":{\"name\":\"clife_hr_dws_reside_manage_by_nhmonth\",\"targetarr\":\"tasks-2-2fa6v\",\"nodenumber\":\"2\",\"x\":2564,\"y\":470},\"tasks-2-78b689\":{\"name\":\"clife_hr_dws_reside_manage_by_floor\",\"targetarr\":\"tasks-2-nb675\",\"nodenumber\":\"1\",\"x\":949,\"y\":476},\"tasks-2-6jq25s\":{\"name\":\"clife_hr_dws_reside_manage_by_bday\",\"targetarr\":\"tasks-2-hpbt\",\"nodenumber\":\"1\",\"x\":291,\"y\":468},\"tasks-2-44h4du\":{\"name\":\"clife_hr_dws_reside_manage_by_nhday\",\"targetarr\":\"tasks-2-6jq25s\",\"nodenumber\":\"1\",\"x\":510,\"y\":468},\"tasks-2-3mi46l\":{\"name\":\"clife_hr_dws_recharge_consumption_by_asday\",\"targetarr\":\"tasks-2-49o1vs\",\"nodenumber\":\"1\",\"x\":3951,\"y\":483},\"tasks-2-a81fr\":{\"name\":\"clife_hr_dws_reside_manage_by_bmonth\",\"targetarr\":\"tasks-2-cj3p9\",\"nodenumber\":\"1\",\"x\":1915,\"y\":477},\"tasks-2-7nk24h\":{\"name\":\"clife_hr_dws_reside_manage_by_fyear\",\"targetarr\":\"tasks-2-4453y2\",\"nodenumber\":\"1\",\"x\":1465,\"y\":479},\"tasks-2-4453y2\":{\"name\":\"clife_hr_dws_reside_manage_by_fmonth\",\"targetarr\":\"tasks-2-78b689\",\"nodenumber\":\"1\",\"x\":1195,\"y\":475},\"tasks-2-cj3p9\":{\"name\":\"clife_hr_dws_reside_manage_by_building\",\"targetarr\":\"tasks-2-7nk24h\",\"nodenumber\":\"1\",\"x\":1687,\"y\":475},\"tasks-2-3fl5hk\":{\"name\":\"clife_hr_dws_reside_manage_by_soyear\",\"targetarr\":\"tasks-2-56q5sb\",\"nodenumber\":\"1\",\"x\":3452,\"y\":478},\"tasks-2-7om5z8\":{\"name\":\"clife_hr_dws_reside_manage_by_suborg\",\"targetarr\":\"tasks-2-2d55xf\",\"nodenumber\":\"1\",\"x\":2988,\"y\":476},\"tasks-2-58u1ai\":{\"name\":\"clife_hr_dws_reside_manage_by_byear\",\"targetarr\":\"tasks-2-a81fr\",\"nodenumber\":\"1\",\"x\":2120,\"y\":475},\"tasks-2-2fa6v\":{\"name\":\"clife_hr_dws_reside_manage_by_nhome\",\"targetarr\":\"tasks-2-58u1ai\",\"nodenumber\":\"1\",\"x\":2329,\"y\":473},\"tasks-2-4myps\":{\"name\":\"clife_hr_dws_recharge_consumption_by_ityear\",\"targetarr\":\"tasks-2-5cz12b\",\"nodenumber\":\"1\",\"x\":5470,\"y\":484},\"tasks-2-5cz12b\":{\"name\":\"clife_hr_dws_recharge_consumption_by_itmonth\",\"targetarr\":\"tasks-2-5ip3p7\",\"nodenumber\":\"1\",\"x\":5198,\"y\":489},\"tasks-2-5ip3p7\":{\"name\":\"clife_hr_dws_recharge_consumption_by_itday\",\"targetarr\":\"tasks-2-ct6b8\",\"nodenumber\":\"1\",\"x\":4920,\"y\":485},\"tasks-2-ct6b8\":{\"name\":\"clife_hr_dws_recharge_consumption_by_iteam\",\"targetarr\":\"tasks-2-bv2b8\",\"nodenumber\":\"1\",\"x\":4674,\"y\":478},\"tasks-2-49o1vs\":{\"name\":\"clife_hr_dws_recharge_consumption_by_anso\",\"targetarr\":\"tasks-2-3fl5hk\",\"nodenumber\":\"1\",\"x\":3723,\"y\":477},\"tasks-2-bv2b8\":{\"name\":\"clife_hr_dws_recharge_consumption_by_asyear\",\"targetarr\":\"tasks-2-2mf2hi\",\"nodenumber\":\"1\",\"x\":4432,\"y\":481},\"tasks-2-2mf2hi\":{\"name\":\"clife_hr_dws_recharge_consumption_by_asmonth\",\"targetarr\":\"tasks-2-3mi46l\",\"nodenumber\":\"1\",\"x\":4196,\"y\":479},\"tasks-2-3kc5bo\":{\"name\":\"clife_hr_dws_coupon_manage_by_nhday\",\"targetarr\":\"tasks-2-1hz6i\",\"nodenumber\":\"1\",\"x\":5212,\"y\":739},\"tasks-2-1hz6i\":{\"name\":\"clife_hr_dws_coupon_manage_by_nhome\",\"targetarr\":\"tasks-2-4myps\",\"nodenumber\":\"1\",\"x\":5468,\"y\":738},\"tasks-2-61ilp\":{\"name\":\"clife_hr_dws_coupon_manage_by_nhmonth\",\"targetarr\":\"tasks-2-3kc5bo\",\"nodenumber\":\"1\",\"x\":4907,\"y\":741},\"tasks-2-487pc\":{\"name\":\"clife_hr_dws_activity_manage_by_nhday\",\"targetarr\":\"tasks-2-7fl7mu\",\"nodenumber\":\"1\",\"x\":4214,\"y\":725},\"tasks-2-5ri10h\":{\"name\":\"clife_hr_dws_activity_manage_by_nhmonth\",\"targetarr\":\"tasks-2-487pc\",\"nodenumber\":\"1\",\"x\":3975,\"y\":719},\"tasks-2-1w33a7\":{\"name\":\"clife_hr_dws_activity_manage_by_suborg\",\"targetarr\":\"tasks-2-1lu6z1\",\"nodenumber\":\"1\",\"x\":3507,\"y\":716},\"tasks-2-7fl7mu\":{\"name\":\"clife_hr_dws_activity_manage_by_nhome\",\"targetarr\":\"tasks-2-6ut5gn\",\"nodenumber\":\"1\",\"x\":4439,\"y\":728},\"tasks-2-4f45a0\":{\"name\":\"clife_hr_dws_service_record_by_nhday\",\"targetarr\":\"tasks-2-6gn570\",\"nodenumber\":\"1\",\"x\":1484,\"y\":694},\"tasks-2-4231m0\":{\"name\":\"clife_hr_dws_service_record_by_spstyear\",\"targetarr\":\"tasks-2-241cg\",\"nodenumber\":\"1\",\"x\":1903,\"y\":696},\"tasks-2-bc626\":{\"name\":\"clife_hr_dws_service_record_by_spstday\",\"targetarr\":\"tasks-2-7mv1b9\",\"nodenumber\":\"1\",\"x\":2331,\"y\":692},\"tasks-2-50d1lm\":{\"name\":\"clife_hr_dws_service_record_by_nhmonth\",\"targetarr\":\"tasks-2-4f45a0\",\"nodenumber\":\"1\",\"x\":1282,\"y\":708},\"tasks-2-6gn570\":{\"name\":\"clife_hr_dws_service_record_by_nhome\",\"targetarr\":\"tasks-2-4231m0\",\"nodenumber\":\"1\",\"x\":1694,\"y\":694},\"tasks-2-3b9ah\":{\"name\":\"clife_hr_dws_plan_snapshot_by_protypemonth\",\"targetarr\":\"tasks-2-3v453v\",\"nodenumber\":\"1\",\"x\":594,\"y\":914},\"tasks-2-7kbzz\":{\"name\":\"clife_hr_dws_plan_snapshot_by_protype\",\"targetarr\":\"tasks-2-a91ir\",\"nodenumber\":\"1\",\"x\":51,\"y\":888},\"tasks-2-42453d\":{\"name\":\"clife_hr_dws_plan_snapshot_by_promonth\",\"targetarr\":\"tasks-2-61ets\",\"nodenumber\":\"1\",\"x\":359,\"y\":683},\"tasks-2-15u6z0\":{\"name\":\"clife_hr_dws_plan_snapshot_by_project\",\"targetarr\":\"tasks-2-213ig\",\"nodenumber\":\"1\",\"x\":816,\"y\":689}}",
			"connects": "[{\"endPointSourceId\":\"tasks-84421\",\"endPointTargetId\":\"tasks-29812\"},{\"endPointSourceId\":\"tasks-29812\",\"endPointTargetId\":\"tasks-73988\"},{\"endPointSourceId\":\"tasks-14647\",\"endPointTargetId\":\"tasks-55309\"},{\"endPointSourceId\":\"tasks-5-13m4j4\",\"endPointTargetId\":\"tasks-14647\"},{\"endPointSourceId\":\"tasks-73988\",\"endPointTargetId\":\"tasks-5-13m4j4\"},{\"endPointSourceId\":\"tasks-55309\",\"endPointTargetId\":\"tasks-69565\"},{\"endPointSourceId\":\"tasks-69565\",\"endPointTargetId\":\"tasks-59070\"},{\"endPointSourceId\":\"tasks-59070\",\"endPointTargetId\":\"tasks-28229\"},{\"endPointSourceId\":\"tasks-28229\",\"endPointTargetId\":\"tasks-9297\"},{\"endPointSourceId\":\"tasks-9297\",\"endPointTargetId\":\"tasks-13268\"},{\"endPointSourceId\":\"tasks-13268\",\"endPointTargetId\":\"tasks-38171\"},{\"endPointSourceId\":\"tasks-38171\",\"endPointTargetId\":\"tasks-26239\"},{\"endPointSourceId\":\"tasks-26239\",\"endPointTargetId\":\"tasks-50210\"},{\"endPointSourceId\":\"tasks-50210\",\"endPointTargetId\":\"tasks-93545\"},{\"endPointSourceId\":\"tasks-93545\",\"endPointTargetId\":\"tasks-18848\"},{\"endPointSourceId\":\"tasks-18848\",\"endPointTargetId\":\"tasks-27447\"},{\"endPointSourceId\":\"tasks-27447\",\"endPointTargetId\":\"tasks-60591\"},{\"endPointSourceId\":\"tasks-60591\",\"endPointTargetId\":\"tasks-84782\"},{\"endPointSourceId\":\"tasks-91762\",\"endPointTargetId\":\"tasks-95409\"},{\"endPointSourceId\":\"tasks-95409\",\"endPointTargetId\":\"tasks-56748\"},{\"endPointSourceId\":\"tasks-56748\",\"endPointTargetId\":\"tasks-38397\"},{\"endPointSourceId\":\"tasks-38397\",\"endPointTargetId\":\"tasks-67054\"},{\"endPointSourceId\":\"tasks-67054\",\"endPointTargetId\":\"tasks-99738\"},{\"endPointSourceId\":\"tasks-99738\",\"endPointTargetId\":\"tasks-75049\"},{\"endPointSourceId\":\"tasks-75049\",\"endPointTargetId\":\"tasks-74043\"},{\"endPointSourceId\":\"tasks-74043\",\"endPointTargetId\":\"tasks-66049\"},{\"endPointSourceId\":\"tasks-66049\",\"endPointTargetId\":\"tasks-27310\"},{\"endPointSourceId\":\"tasks-27310\",\"endPointTargetId\":\"tasks-56289\"},{\"endPointSourceId\":\"tasks-56289\",\"endPointTargetId\":\"tasks-57976\"},{\"endPointSourceId\":\"tasks-57976\",\"endPointTargetId\":\"tasks-4419\"},{\"endPointSourceId\":\"tasks-4419\",\"endPointTargetId\":\"tasks-29712\"},{\"endPointSourceId\":\"tasks-29712\",\"endPointTargetId\":\"tasks-81839\"},{\"endPointSourceId\":\"tasks-81839\",\"endPointTargetId\":\"tasks-37471\"},{\"endPointSourceId\":\"tasks-37471\",\"endPointTargetId\":\"tasks-5428\"},{\"endPointSourceId\":\"tasks-5428\",\"endPointTargetId\":\"tasks-18930\"},{\"endPointSourceId\":\"tasks-18930\",\"endPointTargetId\":\"tasks-24960\"},{\"endPointSourceId\":\"tasks-24960\",\"endPointTargetId\":\"tasks-15896\"},{\"endPointSourceId\":\"tasks-15896\",\"endPointTargetId\":\"tasks-12222\"},{\"endPointSourceId\":\"tasks-12222\",\"endPointTargetId\":\"tasks-41791\"},{\"endPointSourceId\":\"tasks-41791\",\"endPointTargetId\":\"tasks-99336\"},{\"endPointSourceId\":\"tasks-99336\",\"endPointTargetId\":\"tasks-42924\"},{\"endPointSourceId\":\"tasks-42924\",\"endPointTargetId\":\"tasks-1537\"},{\"endPointSourceId\":\"tasks-1537\",\"endPointTargetId\":\"tasks-7440\"},{\"endPointSourceId\":\"tasks-7440\",\"endPointTargetId\":\"tasks-39966\"},{\"endPointSourceId\":\"tasks-39966\",\"endPointTargetId\":\"tasks-47544\"},{\"endPointSourceId\":\"tasks-47544\",\"endPointTargetId\":\"tasks-66089\"},{\"endPointSourceId\":\"tasks-66089\",\"endPointTargetId\":\"tasks-62219\"},{\"endPointSourceId\":\"tasks-62219\",\"endPointTargetId\":\"tasks-96671\"},{\"endPointSourceId\":\"tasks-96671\",\"endPointTargetId\":\"tasks-7529\"},{\"endPointSourceId\":\"tasks-7529\",\"endPointTargetId\":\"tasks-51556\"},{\"endPointSourceId\":\"tasks-51556\",\"endPointTargetId\":\"tasks-64081\"},{\"endPointSourceId\":\"tasks-64081\",\"endPointTargetId\":\"tasks-88432\"},{\"endPointSourceId\":\"tasks-88432\",\"endPointTargetId\":\"tasks-99423\"},{\"endPointSourceId\":\"tasks-99423\",\"endPointTargetId\":\"tasks-94231\"},{\"endPointSourceId\":\"tasks-94231\",\"endPointTargetId\":\"tasks-84872\"},{\"endPointSourceId\":\"tasks-84872\",\"endPointTargetId\":\"tasks-5846\"},{\"endPointSourceId\":\"tasks-5846\",\"endPointTargetId\":\"tasks-847\"},{\"endPointSourceId\":\"tasks-847\",\"endPointTargetId\":\"tasks-83573\"},{\"endPointSourceId\":\"tasks-83573\",\"endPointTargetId\":\"tasks-83622\"},{\"endPointSourceId\":\"tasks-83622\",\"endPointTargetId\":\"tasks-85611\"},{\"endPointSourceId\":\"tasks-85611\",\"endPointTargetId\":\"tasks-23066\"},{\"endPointSourceId\":\"tasks-23066\",\"endPointTargetId\":\"tasks-18847\"},{\"endPointSourceId\":\"tasks-18847\",\"endPointTargetId\":\"tasks-80190\"},{\"endPointSourceId\":\"tasks-80190\",\"endPointTargetId\":\"tasks-40939\"},{\"endPointSourceId\":\"tasks-40939\",\"endPointTargetId\":\"tasks-19622\"},{\"endPointSourceId\":\"tasks-19622\",\"endPointTargetId\":\"tasks-7211\"},{\"endPointSourceId\":\"tasks-7211\",\"endPointTargetId\":\"tasks-87302\"},{\"endPointSourceId\":\"tasks-87302\",\"endPointTargetId\":\"tasks-98151\"},{\"endPointSourceId\":\"tasks-98151\",\"endPointTargetId\":\"tasks-15659\"},{\"endPointSourceId\":\"tasks-15659\",\"endPointTargetId\":\"tasks-70861\"},{\"endPointSourceId\":\"tasks-70861\",\"endPointTargetId\":\"tasks-47236\"},{\"endPointSourceId\":\"tasks-47236\",\"endPointTargetId\":\"tasks-6146\"},{\"endPointSourceId\":\"tasks-6146\",\"endPointTargetId\":\"tasks-87956\"},{\"endPointSourceId\":\"tasks-87956\",\"endPointTargetId\":\"tasks-49954\"},{\"endPointSourceId\":\"tasks-49954\",\"endPointTargetId\":\"tasks-31809\"},{\"endPointSourceId\":\"tasks-31809\",\"endPointTargetId\":\"tasks-58772\"},{\"endPointSourceId\":\"tasks-58772\",\"endPointTargetId\":\"tasks-3932\"},{\"endPointSourceId\":\"tasks-3932\",\"endPointTargetId\":\"tasks-9606\"},{\"endPointSourceId\":\"tasks-9606\",\"endPointTargetId\":\"tasks-80915\"},{\"endPointSourceId\":\"tasks-80915\",\"endPointTargetId\":\"tasks-65872\"},{\"endPointSourceId\":\"tasks-65872\",\"endPointTargetId\":\"tasks-21332\"},{\"endPointSourceId\":\"tasks-21332\",\"endPointTargetId\":\"tasks-4185\"},{\"endPointSourceId\":\"tasks-4185\",\"endPointTargetId\":\"tasks-48398\"},{\"endPointSourceId\":\"tasks-48398\",\"endPointTargetId\":\"tasks-41851\"},{\"endPointSourceId\":\"tasks-41851\",\"endPointTargetId\":\"tasks-28890\"},{\"endPointSourceId\":\"tasks-28890\",\"endPointTargetId\":\"tasks-30269\"},{\"endPointSourceId\":\"tasks-30269\",\"endPointTargetId\":\"tasks-98070\"},{\"endPointSourceId\":\"tasks-98070\",\"endPointTargetId\":\"tasks-39298\"},{\"endPointSourceId\":\"tasks-84782\",\"endPointTargetId\":\"tasks-44426\"},{\"endPointSourceId\":\"tasks-44426\",\"endPointTargetId\":\"tasks-89930\"},{\"endPointSourceId\":\"tasks-89930\",\"endPointTargetId\":\"tasks-34807\"},{\"endPointSourceId\":\"tasks-34807\",\"endPointTargetId\":\"tasks-8-5as76q\"},{\"endPointSourceId\":\"tasks-8-5as76q\",\"endPointTargetId\":\"tasks-91762\"},{\"endPointSourceId\":\"tasks-2-5jy2u0\",\"endPointTargetId\":\"tasks-2-5vr48i\"},{\"endPointSourceId\":\"tasks-2-hpbt\",\"endPointTargetId\":\"tasks-2-6jq25s\"},{\"endPointSourceId\":\"tasks-2-6jq25s\",\"endPointTargetId\":\"tasks-2-44h4du\"},{\"endPointSourceId\":\"tasks-2-44h4du\",\"endPointTargetId\":\"tasks-2-nb675\"},{\"endPointSourceId\":\"tasks-2-nb675\",\"endPointTargetId\":\"tasks-2-78b689\"},{\"endPointSourceId\":\"tasks-2-78b689\",\"endPointTargetId\":\"tasks-2-4453y2\"},{\"endPointSourceId\":\"tasks-2-4453y2\",\"endPointTargetId\":\"tasks-2-7nk24h\"},{\"endPointSourceId\":\"tasks-2-7nk24h\",\"endPointTargetId\":\"tasks-2-cj3p9\"},{\"endPointSourceId\":\"tasks-2-cj3p9\",\"endPointTargetId\":\"tasks-2-a81fr\"},{\"endPointSourceId\":\"tasks-2-a81fr\",\"endPointTargetId\":\"tasks-2-58u1ai\"},{\"endPointSourceId\":\"tasks-2-58u1ai\",\"endPointTargetId\":\"tasks-2-2fa6v\"},{\"endPointSourceId\":\"tasks-2-2fa6v\",\"endPointTargetId\":\"tasks-2-53l7gb\"},{\"endPointSourceId\":\"tasks-2-53l7gb\",\"endPointTargetId\":\"tasks-2-2d55xf\"},{\"endPointSourceId\":\"tasks-2-2d55xf\",\"endPointTargetId\":\"tasks-2-7om5z8\"},{\"endPointSourceId\":\"tasks-2-7om5z8\",\"endPointTargetId\":\"tasks-2-56q5sb\"},{\"endPointSourceId\":\"tasks-2-56q5sb\",\"endPointTargetId\":\"tasks-2-3fl5hk\"},{\"endPointSourceId\":\"tasks-2-3fl5hk\",\"endPointTargetId\":\"tasks-2-49o1vs\"},{\"endPointSourceId\":\"tasks-2-49o1vs\",\"endPointTargetId\":\"tasks-2-3mi46l\"},{\"endPointSourceId\":\"tasks-2-3mi46l\",\"endPointTargetId\":\"tasks-2-2mf2hi\"},{\"endPointSourceId\":\"tasks-2-2mf2hi\",\"endPointTargetId\":\"tasks-2-bv2b8\"},{\"endPointSourceId\":\"tasks-2-bv2b8\",\"endPointTargetId\":\"tasks-2-ct6b8\"},{\"endPointSourceId\":\"tasks-2-ct6b8\",\"endPointTargetId\":\"tasks-2-5ip3p7\"},{\"endPointSourceId\":\"tasks-2-5ip3p7\",\"endPointTargetId\":\"tasks-2-5cz12b\"},{\"endPointSourceId\":\"tasks-2-5cz12b\",\"endPointTargetId\":\"tasks-2-4myps\"},{\"endPointSourceId\":\"tasks-2-4myps\",\"endPointTargetId\":\"tasks-2-1hz6i\"},{\"endPointSourceId\":\"tasks-2-1hz6i\",\"endPointTargetId\":\"tasks-2-3kc5bo\"},{\"endPointSourceId\":\"tasks-2-3kc5bo\",\"endPointTargetId\":\"tasks-2-61ilp\"},{\"endPointSourceId\":\"tasks-2-61ilp\",\"endPointTargetId\":\"tasks-2-6ut5gn\"},{\"endPointSourceId\":\"tasks-2-6vmi\",\"endPointTargetId\":\"tasks-2-5jy2u0\"},{\"endPointSourceId\":\"tasks-2-487pc\",\"endPointTargetId\":\"tasks-2-5ri10h\"},{\"endPointSourceId\":\"tasks-2-5ri10h\",\"endPointTargetId\":\"tasks-2-1lu6z1\"},{\"endPointSourceId\":\"tasks-2-6ut5gn\",\"endPointTargetId\":\"tasks-2-7fl7mu\"},{\"endPointSourceId\":\"tasks-2-7fl7mu\",\"endPointTargetId\":\"tasks-2-487pc\"},{\"endPointSourceId\":\"tasks-2-1lu6z1\",\"endPointTargetId\":\"tasks-2-1w33a7\"},{\"endPointSourceId\":\"tasks-2-1w33a7\",\"endPointTargetId\":\"tasks-2-6vmi\"},{\"endPointSourceId\":\"tasks-2-5vr48i\",\"endPointTargetId\":\"tasks-2-7mv1b9\"},{\"endPointSourceId\":\"tasks-2-7mv1b9\",\"endPointTargetId\":\"tasks-2-bc626\"},{\"endPointSourceId\":\"tasks-2-bc626\",\"endPointTargetId\":\"tasks-2-241cg\"},{\"endPointSourceId\":\"tasks-2-241cg\",\"endPointTargetId\":\"tasks-2-4231m0\"},{\"endPointSourceId\":\"tasks-2-4231m0\",\"endPointTargetId\":\"tasks-2-6gn570\"},{\"endPointSourceId\":\"tasks-2-6gn570\",\"endPointTargetId\":\"tasks-2-4f45a0\"},{\"endPointSourceId\":\"tasks-2-4f45a0\",\"endPointTargetId\":\"tasks-2-50d1lm\"},{\"endPointSourceId\":\"tasks-2-50d1lm\",\"endPointTargetId\":\"tasks-2-213ig\"},{\"endPointSourceId\":\"tasks-2-213ig\",\"endPointTargetId\":\"tasks-2-15u6z0\"},{\"endPointSourceId\":\"tasks-2-15u6z0\",\"endPointTargetId\":\"tasks-2-61ets\"},{\"endPointSourceId\":\"tasks-2-61ets\",\"endPointTargetId\":\"tasks-2-42453d\"},{\"endPointSourceId\":\"tasks-2-42453d\",\"endPointTargetId\":\"tasks-2-a91ir\"},{\"endPointSourceId\":\"tasks-2-a91ir\",\"endPointTargetId\":\"tasks-2-7kbzz\"},{\"endPointSourceId\":\"tasks-2-7kbzz\",\"endPointTargetId\":\"tasks-2-3v453v\"},{\"endPointSourceId\":\"tasks-2-3v453v\",\"endPointTargetId\":\"tasks-2-3b9ah\"},{\"endPointSourceId\":\"tasks-2-3b9ah\",\"endPointTargetId\":\"tasks-2-6w31nd\"}]",
			"receivers": "",
			"receiversCc": "",
			"leadMobile": "",
			"ddAlarmId": 0,
			"scheduleReleaseState": null,
			"timeout": 0,
			"tenantId": -1,
			"taskType": "SHELL"
		}],
		"total": 7,
		"currentPage": 1,
		"totalPage": 1
	}
}